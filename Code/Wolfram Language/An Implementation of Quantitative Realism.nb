(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    829791,      18452]
NotebookOptionsPosition[    760510,      17332]
NotebookOutlinePosition[    760935,      17349]
CellTagsIndexPosition[    760892,      17346]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["An Implementation of Quantitative Realism", "Chapter",
 CellChangeTimes->{{3.754824346919694*^9, 3.754824352075512*^9}, {
  3.754998647106483*^9, 3.754998647599942*^9}, {3.7553480323327093`*^9, 
  3.755348040038451*^9}, {3.8010769762436323`*^9, 3.801076977967668*^9}, {
  3.801867866524091*^9, 3.801867884855688*^9}, {3.8018679247226543`*^9, 
  3.80186793309389*^9}, {3.801868288145259*^9, 3.801868322777247*^9}, {
  3.80186861206157*^9, 
  3.801868618448626*^9}},ExpressionUUID->"e032b05b-cd00-4572-9c6c-\
a9a26be56083"],

Cell[CellGroupData[{

Cell["Introduction", "Section",
 CellChangeTimes->{{3.819315849347554*^9, 
  3.81931585088074*^9}},ExpressionUUID->"2715d97a-f9b0-4ea8-b2b1-\
5dfaf4d1e610"],

Cell[CellGroupData[{

Cell["Context and Purpose", "Subsection",
 CellChangeTimes->{{3.819315944930428*^9, 
  3.819315948953229*^9}},ExpressionUUID->"f2086a09-da04-4e0f-8f72-\
6e8c8a0c11af"],

Cell[CellGroupData[{

Cell["About This Project", "Subsubsection",
 CellChangeTimes->{{3.819316810373084*^9, 
  3.819316815090063*^9}},ExpressionUUID->"2fa5c1cb-6be8-4490-b5da-\
f9dc2b36a8b7"],

Cell["\<\
This project implements quantitative realism, a computational theory of \
international relations. For more information, please see www.realpolitik.io.\
\
\>", "Text",
 CellChangeTimes->{{3.8193168170081463`*^9, 
  3.8193168734133883`*^9}},ExpressionUUID->"30c28822-228e-4872-a48e-\
a01544a260d7"]
}, Closed]],

Cell[CellGroupData[{

Cell["Github Repository", "Subsubsection",
 CellChangeTimes->{{3.819315995419013*^9, 
  3.8193160098557262`*^9}},ExpressionUUID->"132b521d-eec3-4c34-b335-\
990aa4eb8907"],

Cell["\<\
The Github repository for this code is \
github.com/mpoulshock/QuantitativeRealism.\
\>", "Text",
 CellChangeTimes->{{3.819316073267351*^9, 
  3.81931611729224*^9}},ExpressionUUID->"e474443b-6905-49b7-b666-\
c8e9869a4312"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Conventions", "Subsection",
 CellChangeTimes->{{3.8193159641630993`*^9, 
  3.819315966536294*^9}},ExpressionUUID->"9b5b2019-ceaf-483d-99fa-\
5afc3329422e"],

Cell[CellGroupData[{

Cell["General", "Subsubsection",
 CellChangeTimes->{{3.819316547310774*^9, 3.819316548417962*^9}, {
  3.819317692401963*^9, 
  3.819317693652793*^9}},ExpressionUUID->"51907911-1543-4a38-8968-\
e28e17494e85"],

Cell[CellGroupData[{

Cell["\<\
Functions that start with lower case letters are not intended to be invoked \
directly but instead to support other functions.\
\>", "ItemNumbered",
 CellChangeTimes->{{3.819316930073905*^9, 3.819316969267436*^9}, {
  3.819318832730514*^9, 
  3.8193188362363567`*^9}},ExpressionUUID->"2c00d0a8-d489-4366-8017-\
8b323ef5cdfb"],

Cell["\<\
An automated regression test suite can be found at the end of this notebook.\
\>", "ItemNumbered",
 CellChangeTimes->{{3.819316930073905*^9, 3.819316965472087*^9}, {
  3.819317037637586*^9, 
  3.8193170719416857`*^9}},ExpressionUUID->"9aa7cc33-1e5c-465b-b4ab-\
447e79a22a62"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Frequently Used Objects", "Subsubsection",
 CellChangeTimes->{{3.8193179778250027`*^9, 3.8193179789436693`*^9}, {
  3.819318064892021*^9, 
  3.8193180715308733`*^9}},ExpressionUUID->"1aae7f62-88f1-4dcf-9bf2-\
bf8319f210ab"],

Cell[TextData[{
 StyleBox["s", "Input"],
 " - size vector\n",
 StyleBox["T", "Input"],
 " - tactic matrix\n",
 StyleBox["TT", "Input"],
 " - ternary tactic matrix\n",
 StyleBox["tactic ", "Input"],
 "- tactic vector\n",
 StyleBox["i", "Input"],
 " - index of a given agent"
}], "Text",
 CellChangeTimes->{{3.819317983322098*^9, 3.81931804938732*^9}, {
  3.8214393499281282`*^9, 
  3.821439356132771*^9}},ExpressionUUID->"ac51f238-28dd-4662-893d-\
ca29dde48653"]
}, Closed]],

Cell[CellGroupData[{

Cell["Color Coding", "Subsubsection",
 CellChangeTimes->{{3.819316535689032*^9, 
  3.819316537597911*^9}},ExpressionUUID->"7ba111bd-3d5f-4e3f-9abd-\
5fd9eda92fde"],

Cell["Initialization cells are highlighted in gray.", "Text",
 CellChangeTimes->{{3.819317096349409*^9, 3.819317104437347*^9}},
 Background->GrayLevel[
  0.85],ExpressionUUID->"07d03c79-e548-4e17-93d3-3131fb0a3ef3"],

Cell["Alternate implementations are highlighted in blue.", "Text",
 CellChangeTimes->{{3.819316388277554*^9, 3.81931639665967*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"e1938aa8-d4b9-4069-b070-0e77efd3945d"],

Cell["Examples are highlighted in orange.", "Text",
 CellChangeTimes->{{3.8193164121235323`*^9, 3.819316432439526*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"d944d52b-6640-4cc9-9621-4b9a1d1a1e22"],

Cell["Unit tests are highlighted in brown.", "Text",
 CellChangeTimes->{{3.8193163689085293`*^9, 3.819316376609673*^9}},
 Background->RGBColor[
  0.94, 0.91, 0.88],ExpressionUUID->"281b74d7-181a-4b85-8130-1db100638697"],

Cell["Warnings are highlighted in red.", "Text",
 CellChangeTimes->{{3.819316776664094*^9, 3.8193167929973497`*^9}},
 Background->RGBColor[
  1, 0.85, 0.85],ExpressionUUID->"933bf063-5fe1-4eeb-8674-a51bad5dd692"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["License", "Subsection",
 CellChangeTimes->{{3.8193159800472803`*^9, 
  3.819315983749569*^9}},ExpressionUUID->"c7c2d8e3-c160-4f82-9d63-\
e3b306f83bfb"],

Cell["TBD", "Text",
 CellChangeTimes->{{3.819316130781337*^9, 
  3.81931613450533*^9}},ExpressionUUID->"d46be57b-1b04-4ae8-8e88-\
a2a131b05bce"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Data Structures", "Section",
 CellChangeTimes->{{3.754824378637003*^9, 
  3.754824382763324*^9}},ExpressionUUID->"569c4edd-10ae-430b-924b-\
fe830f881668"],

Cell[CellGroupData[{

Cell["Parameters", "Subsection",
 CellChangeTimes->{{3.754823511776359*^9, 3.7548235152615347`*^9}, {
  3.754852921370427*^9, 
  3.754852923112949*^9}},ExpressionUUID->"1f0dc824-0eea-452e-8eb2-\
cd040f79499a"],

Cell[CellGroupData[{

Cell["Get and Set", "Subsubsection",
 CellChangeTimes->{{3.801084080417551*^9, 
  3.8010840817064867`*^9}},ExpressionUUID->"49ce4e80-1dec-4c1e-b49a-\
43de4a65ffff"],

Cell["\<\
Global variables can be called by other functions without having them passed \
in as arguments. This function provides a way to set global parameters from \
an Association. Output: none.\
\>", "Text",
 CellChangeTimes->{{3.766670702135586*^9, 3.766670716410233*^9}, {
  3.80116289778531*^9, 3.801162900103189*^9}, {3.802372993764168*^9, 
  3.8023730011122227`*^9}},ExpressionUUID->"3f3168e2-e5c7-4960-bea1-\
00ad66f21a03"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetParameters", "[", "p_Association", "]"}], ":=", " ", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Beta]", "=", 
      RowBox[{"N", "[", 
       RowBox[{"Lookup", "[", 
        RowBox[{"p", ",", "\"\<\[Beta]\>\"", ",", "\[Beta]"}], "]"}], "]"}]}],
      ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"Constructive", " ", "power", " ", "multiplier"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[Mu]", "=", 
      RowBox[{"N", "[", 
       RowBox[{"Lookup", "[", 
        RowBox[{"p", ",", "\"\<\[Mu]\>\"", ",", "\[Mu]"}], "]"}], "]"}]}], 
     ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"Destructive", " ", "power", " ", "multiplier"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]", "=", 
      RowBox[{"N", "[", 
       RowBox[{"Lookup", "[", 
        RowBox[{"p", ",", "\"\<\[Lambda]\>\"", ",", "\[Lambda]"}], "]"}], 
       "]"}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"Rate", " ", "of", " ", "power", " ", "decay"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[Alpha]", "=", 
      RowBox[{"N", "[", 
       RowBox[{"Lookup", "[", 
        RowBox[{"p", ",", "\"\<\[Alpha]\>\"", ",", "\[Alpha]"}], "]"}], 
       "]"}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"Utility", " ", "function", " ", "exponent"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[Delta]", "=", 
      RowBox[{"N", "[", 
       RowBox[{"Lookup", "[", 
        RowBox[{"p", ",", "\"\<\[Delta]\>\"", ",", "0.85"}], "]"}], "]"}]}], 
     ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"Discount", " ", "rate"}], " ", "*)"}], "\[IndentingNewLine]", 
     StyleBox[
      RowBox[{"\[Rho]", "=", 
       RowBox[{"N", "[", 
        RowBox[{"Lookup", "[", 
         RowBox[{"p", ",", "\"\<\[Rho]\>\"", ",", "\[Rho]"}], "]"}], "]"}]}], 
      "Input"], 
     StyleBox[";", "Input"], 
     StyleBox[" ", "Input"], 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Minimum", " ", "self"}], "-", 
       RowBox[{"allocation", " ", "percentage"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"k", "=", 
      RowBox[{"Lookup", "[", 
       RowBox[{"p", ",", "\"\<k\>\"", ",", "10"}], "]"}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Steps", " ", "used", " ", "in", " ", "PrinceRank", " ", 
       "simulations"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"discountFactors", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Delta]"}], ")"}], "*", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"\[Delta]", "^", "i"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "k"}], "}"}]}], "]"}]}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7666705019387083`*^9, 3.766670517160874*^9}, {
   3.766670555454957*^9, 3.766670581056901*^9}, {3.7666706223295116`*^9, 
   3.7666706997585287`*^9}, {3.8011629152134743`*^9, 3.801162915544537*^9}, {
   3.802372105794817*^9, 3.802372123264974*^9}, {3.8023724546662083`*^9, 
   3.802372458854854*^9}, {3.802372709477127*^9, 3.8023727115896*^9}, {
   3.8023727652563257`*^9, 3.802372765542367*^9}, {3.80237294339675*^9, 
   3.802372975294971*^9}, {3.802374846016697*^9, 3.8023748497760973`*^9}, {
   3.80242713491628*^9, 3.802427146148679*^9}, {3.803986508596792*^9, 
   3.803986533694416*^9}, 3.8040696836310062`*^9, {3.804070624021386*^9, 
   3.804070685410823*^9}, {3.804072006395303*^9, 3.80407201850148*^9}, {
   3.8040721382788763`*^9, 3.8040721416785*^9}, 3.804072183056343*^9, {
   3.804073918866887*^9, 3.80407392765449*^9}, {3.804074020360235*^9, 
   3.804074060211913*^9}, {3.804074090410654*^9, 3.80407409220131*^9}, 
   3.8040741670346622`*^9, 3.804074266177785*^9, {3.804074817418956*^9, 
   3.80407481757056*^9}, {3.804192553407322*^9, 3.804192568434413*^9}, {
   3.808139996974359*^9, 3.808139998284724*^9}, {3.808163012402008*^9, 
   3.808163050532434*^9}, 3.808163084962551*^9, {3.821981430132515*^9, 
   3.821981431038398*^9}, {3.8219815674787083`*^9, 3.821981567848217*^9}, {
   3.8219816216550303`*^9, 3.821981629977603*^9}, {3.821981732620574*^9, 
   3.821981741621503*^9}, 3.8219818007559013`*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"ee5a77b2-10cf-4757-bce4-8367daad93f6"],

Cell["Set the global parameters. Output: none.", "Text",
 CellChangeTimes->{{3.80237775405525*^9, 3.80237775836726*^9}, {
  3.808163158991851*^9, 
  3.808163168606542*^9}},ExpressionUUID->"04b5a5f7-8712-4b59-818e-\
57215c27e06c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetParameters", "[", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\"\<\[Beta]\>\"", "\[Rule]", "2"}], ",", 
     RowBox[{"\"\<\[Mu]\>\"", "\[Rule]", "3"}], ",", 
     RowBox[{"\"\<\[Lambda]\>\"", "\[Rule]", "1"}], ",", 
     RowBox[{"\"\<\[Alpha]\>\"", "\[Rule]", "2.25"}], ",", " ", 
     RowBox[{"\"\<\[Rho]\>\"", "\[Rule]", "0.98"}]}], "\[RightAssociation]"}],
    "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.794492452677066*^9, {3.8023776709794073`*^9, 3.802377674441442*^9}, {
   3.804072214286968*^9, 3.804072220870434*^9}, 3.804074043449102*^9, {
   3.804074094620883*^9, 3.804074097757883*^9}, {3.8041925770073223`*^9, 
   3.8041925858837767`*^9}, {3.808163056572791*^9, 3.808163074743949*^9}, 
   3.808387639174089*^9, {3.809891902744701*^9, 3.809891942085637*^9}, 
   3.809892239018008*^9, {3.821981574741096*^9, 3.821981596938541*^9}, {
   3.821981688121377*^9, 3.8219817077143087`*^9}, 3.8219828270848227`*^9},
 CellLabel->"In[2]:=",ExpressionUUID->"e469c755-088c-4fba-a5ed-53cc6df42d97"],

Cell["A version that overrides default parameters. Output: none.", "Text",
 CellChangeTimes->{{3.8219816681363564`*^9, 3.821981683488538*^9}, {
  3.822047193164023*^9, 
  3.8220472036288023`*^9}},ExpressionUUID->"d38bcfd0-8c25-4ac3-85fe-\
4421ed52d2bb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetParameters", "[", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\"\<\[Beta]\>\"", "\[Rule]", "2"}], ",", 
     RowBox[{"\"\<\[Mu]\>\"", "\[Rule]", "3"}], ",", 
     RowBox[{"\"\<\[Lambda]\>\"", "\[Rule]", "1"}], ",", 
     RowBox[{"\"\<\[Alpha]\>\"", "\[Rule]", "2.25"}], ",", 
     RowBox[{"\"\<\[Delta]\>\"", "\[Rule]", "0.85"}], ",", " ", 
     RowBox[{"\"\<\[Rho]\>\"", "\[Rule]", "0.98"}], ",", 
     RowBox[{"\"\<k\>\"", "\[Rule]", "10"}]}], "\[RightAssociation]"}], "]"}],
   ";"}]], "Input",
 CellChangeTimes->{
  3.794492452677066*^9, {3.8023776709794073`*^9, 3.802377674441442*^9}, {
   3.804072214286968*^9, 3.804072220870434*^9}, 3.804074043449102*^9, {
   3.804074094620883*^9, 3.804074097757883*^9}, {3.8041925770073223`*^9, 
   3.8041925858837767`*^9}, {3.808163056572791*^9, 3.808163074743949*^9}, 
   3.808387639174089*^9, {3.809891902744701*^9, 3.809891942085637*^9}, 
   3.809892239018008*^9, {3.821981574741096*^9, 3.821981596938541*^9}, {
   3.821981664856215*^9, 3.821981699180541*^9}, 3.8219817797004128`*^9, 
   3.821982830742627*^9},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"d6fdecfe-ef81-4379-ba5e-22176d46939c"],

Cell["\<\
Assembles global parameters into an Association. Output: Association.\
\>", "Text",
 CellChangeTimes->{{3.766670724770932*^9, 3.7666707338179083`*^9}, {
  3.801162889874248*^9, 
  3.80116289391959*^9}},ExpressionUUID->"42fcc785-0832-43ed-b834-\
6bc517fb524f"],

Cell[BoxData[
 RowBox[{"GetParameters", ":=", " ", 
  RowBox[{"<|", 
   RowBox[{
    RowBox[{"\"\<\[Beta]\>\"", "\[Rule]", " ", "\[Beta]"}], ",", 
    RowBox[{"\"\<\[Mu]\>\"", "\[Rule]", " ", "\[Mu]"}], ",", 
    RowBox[{"\"\<\[Lambda]\>\"", "\[Rule]", " ", "\[Lambda]"}], ",", 
    RowBox[{"\"\<\[Alpha]\>\"", "\[Rule]", " ", "\[Alpha]"}], ",", 
    RowBox[{"\"\<\[Delta]\>\"", "\[Rule]", " ", "\[Delta]"}], ",", 
    RowBox[{"\"\<\[Rho]\>\"", "\[Rule]", " ", "\[Rho]"}], ",", 
    RowBox[{"\"\<k\>\"", "\[Rule]", "k"}]}], "|>"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.766670529779784*^9, 3.766670549390976*^9}, {
   3.7666707859556417`*^9, 3.766670840958477*^9}, {3.801162925324095*^9, 
   3.8011629256370583`*^9}, {3.8040722416076403`*^9, 
   3.8040722476077433`*^9}, {3.804074065111377*^9, 3.804074066630422*^9}, {
   3.804192598096628*^9, 3.804192599212812*^9}, {3.804192634667691*^9, 
   3.804192647527938*^9}, {3.8068485992273903`*^9, 3.8068486014590607`*^9}, {
   3.808163090811451*^9, 3.808163095386945*^9}, 3.821981585403783*^9},
 CellLabel->"In[3]:=",ExpressionUUID->"10e4ed7a-3c5e-49a6-ac41-1d44e75a0ac6"],

Cell["Generate a string showing the parameters. Output: string.", "Text",
 CellChangeTimes->{{3.766829742463194*^9, 3.766829750652875*^9}, {
  3.808163126477825*^9, 3.808163129814541*^9}, {3.808163174864501*^9, 
  3.808163177591538*^9}},ExpressionUUID->"6ca3a15f-d645-4b97-9a88-\
467b14bdf1d8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ParameterString", ":=", 
   RowBox[{"Caption", "[", "\[IndentingNewLine]", 
    RowBox[{"\"\<\[Beta]=\>\"", "<>", 
     RowBox[{"ToString", "[", "\[Beta]", "]"}], "<>", "\"\<, \[Mu]=\>\"", "<>", 
     RowBox[{"ToString", "[", "\[Mu]", "]"}], "<>", "\"\<, \[Lambda]=\>\"", "<>", 
     RowBox[{"ToString", "[", "\[Lambda]", "]"}], "<>", "\"\<, \[Alpha]=\>\"",
      "<>", 
     RowBox[{"ToString", "[", "\[Alpha]", "]"}], "<>", "\"\<, \[Rho]=\>\"", "<>", 
     RowBox[{"ToString", "[", "\[Rho]", "]"}], "<>", "\"\<, \[Delta]=\>\"", "<>", 
     RowBox[{"ToString", "[", "\[Delta]", "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.766829753369546*^9, 3.766829822778118*^9}, {
   3.766829860766601*^9, 3.766829890532473*^9}, {3.766830649949287*^9, 
   3.766830652902481*^9}, {3.767457271238203*^9, 3.7674573613269787`*^9}, {
   3.767457408927121*^9, 3.7674574382608013`*^9}, {3.767457576639862*^9, 
   3.767457579814802*^9}, {3.805281161242663*^9, 3.805281161937117*^9}, {
   3.806830856407621*^9, 3.806830866132279*^9}, {3.80816310749289*^9, 
   3.8081631203881063`*^9}, 3.808163181805903*^9, {3.817812711490568*^9, 
   3.817812726716845*^9}, 3.821981591683668*^9, 3.821981830505866*^9},
 CellLabel->"In[4]:=",ExpressionUUID->"c5653cb2-40d2-4d3d-9493-5f586ce670f9"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Num",
 IgnoreSpellCheck->True]], "Subsubsection",
 CellChangeTimes->{{3.8011627641059313`*^9, 3.801162767199546*^9}, {
  3.8185199468768873`*^9, 
  3.818519947321549*^9}},ExpressionUUID->"ae5b0b64-30df-405e-9ef8-\
ed1dd3024239"],

Cell["\<\
Determine the number of agents in a power structure. Beware of performance \
impact if this is used in a repetitive operation. Output: integer.\
\>", "Text",
 CellChangeTimes->{{3.800183291115673*^9, 3.800183298719304*^9}, {
   3.800221077917533*^9, 3.800221084974695*^9}, 3.8011627836840887`*^9, {
   3.8011628693235617`*^9, 3.801162872196609*^9}, {3.818519900540303*^9, 
   3.8185199319852324`*^9}},ExpressionUUID->"7ea9b458-1167-457e-9bc1-\
4743cd445d96"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Num", "[", "ps_Association", "]"}], ":=", 
   RowBox[{"Length", "[", 
    RowBox[{"ps", "[", "\"\<s\>\"", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Num", "[", "T_List", "]"}], ":=", 
   RowBox[{"Length", "[", "T", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8001832686840563`*^9, 3.8001832852313232`*^9}, {
  3.801162796381112*^9, 3.801162808185809*^9}, {3.804284111289085*^9, 
  3.804284114126876*^9}, {3.818519963218833*^9, 3.818519970512718*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"60531b0b-40b5-41f8-b258-0feda9fdd5b7"]
}, Closed]],

Cell[CellGroupData[{

Cell["Discount rate (\[Delta])", "Subsubsection",
 CellChangeTimes->{{3.801084757588441*^9, 
  3.8010847651279917`*^9}},ExpressionUUID->"d9ec568d-6cc4-40bf-85b5-\
0d58a9e7e10b"],

Cell["Discount rate error threshold (5%).", "Text",
 CellChangeTimes->{{3.804002675919044*^9, 3.804002679894905*^9}, {
  3.804002717687318*^9, 
  3.804002720801013*^9}},ExpressionUUID->"41b0bae5-c418-4e5d-adfc-\
06193d58533b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"discountErrorThreshold", " ", "=", " ", "0.05"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.804002682559252*^9, 3.804002691986122*^9}, 
   3.80400285715413*^9, {3.80406963388719*^9, 3.804069634234148*^9}, {
   3.8219759813284893`*^9, 3.821976010745284*^9}, {3.821982890826091*^9, 
   3.821982891128099*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"bc1a9d5f-383d-4c33-ba80-f3dd017c1f1a"],

Cell["\<\
Given the discount rate \[Delta], returns the number of future steps \
required. Output: integer.\
\>", "Text",
 CellChangeTimes->{{3.755802719896249*^9, 3.7558027614848843`*^9}, {
   3.802368002354416*^9, 3.802368009452757*^9}, 
   3.804002726740589*^9},ExpressionUUID->"769215bc-1382-427b-abda-\
dc6f9b4df0f9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DeltaToSteps", "[", "\[Delta]_Real", "]"}], ":=", 
  RowBox[{"Ceiling", "[", 
   RowBox[{"Log", "[", 
    RowBox[{"\[Delta]", ",", "discountErrorThreshold"}], "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7184445371273823`*^9, 3.718444551035158*^9}, 
   3.7184446582788153`*^9, {3.718444971328925*^9, 3.718444974213678*^9}, {
   3.754933760334337*^9, 3.754933783707287*^9}, {3.754999679360915*^9, 
   3.754999703643222*^9}, {3.75499974375385*^9, 3.754999744224615*^9}, {
   3.802355405574253*^9, 3.8023554094082813`*^9}, 3.802368023745994*^9, 
   3.804002707212358*^9, 3.804002814820077*^9},
 CellLabel->"In[8]:=",ExpressionUUID->"27536425-dab3-4c1b-bd78-cea8c1c59635"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DeltaToSteps", "[", "\[Delta]_Real", "]"}], ":=", 
  RowBox[{
   RowBox[{"DeltaToSteps", "[", "\[Delta]", "]"}], "=", 
   RowBox[{"Ceiling", "[", 
    RowBox[{"Log", "[", 
     RowBox[{"\[Delta]", ",", "discountErrorThreshold"}], "]"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7184445371273823`*^9, 3.718444551035158*^9}, 
   3.7184446582788153`*^9, {3.718444971328925*^9, 3.718444974213678*^9}, {
   3.754933760334337*^9, 3.754933783707287*^9}, {3.754999679360915*^9, 
   3.754999703643222*^9}, {3.75499974375385*^9, 3.754999744224615*^9}, {
   3.802355405574253*^9, 3.8023554094082813`*^9}, 3.802368023745994*^9, 
   3.804002707212358*^9},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[298]:=",ExpressionUUID->"c17f1eca-3314-421f-b8fb-41bc431b5de0"],

Cell["\<\
Given a number of steps, returns the value of \[Delta] that would require \
those steps. Output: real number.\
\>", "Text",
 CellChangeTimes->{{3.7558027676158752`*^9, 
  3.755802798186285*^9}},ExpressionUUID->"bc5dccd7-5491-493d-bd14-\
6485995d8a69"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StepsToDelta", "[", "steps_Integer", "]"}], ":=", " ", 
  RowBox[{"Surd", "[", 
   RowBox[{"discountErrorThreshold", ",", "steps"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7184445653389263`*^9, 3.718444576187901*^9}, {
   3.718444617142671*^9, 3.7184446211218863`*^9}, 3.718444661626711*^9, {
   3.718444977643258*^9, 3.718444979786929*^9}, {3.754999739612506*^9, 
   3.754999747657118*^9}, 3.802367805045156*^9, 3.802368025684516*^9, 
   3.804002710688884*^9},
 CellLabel->"In[9]:=",ExpressionUUID->"95e12c90-a564-48c6-8b13-06e746148eac"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Power Structures", "Subsection",
 CellChangeTimes->{{3.801077541752274*^9, 3.801077543766233*^9}, {
  3.801077863055863*^9, 
  3.801077863571185*^9}},ExpressionUUID->"8506c672-2421-4bfe-9241-\
d3e8767168c6"],

Cell[CellGroupData[{

Cell["PowerStructure", "Subsubsection",
 CellChangeTimes->{
  3.8010840122391367`*^9, {3.801162963595675*^9, 
   3.8011629665566807`*^9}},ExpressionUUID->"5d7ce8a4-12ff-4e73-b0ae-\
691ec4d61daf"],

Cell[TextData[{
 "A ",
 StyleBox["power structure",
  FontSlant->"Italic"],
 " is represented as an ",
 StyleBox["Association", "Input"],
 " composed of a size vector (",
 StyleBox["s", "Input"],
 ") and a tactic matrix (",
 StyleBox["T", "Input"],
 "). The following functions instantiate power structures. They should be \
avoided when performance matters."
}], "Text",
 CellChangeTimes->{{3.67329923939219*^9, 3.6732993137631493`*^9}, {
  3.677753502584754*^9, 3.677753510575326*^9}, {3.678110652020722*^9, 
  3.6781106543203583`*^9}, {3.678110747749786*^9, 3.678110753556567*^9}, {
  3.754852949295236*^9, 3.754852978167698*^9}, {3.7549293882425337`*^9, 
  3.754929392937166*^9}, {3.801077240194099*^9, 3.80107724500981*^9}, {
  3.80869415917267*^9, 
  3.8086941811769342`*^9}},ExpressionUUID->"c60b6a89-3f16-4065-8125-\
3018f9366a38"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\"\<s\>\"", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"4.3", ",", "4.2"}], "}"}]}], ",", 
   RowBox[{"\"\<T\>\"", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.5", ",", "0.5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.5"}], ",", "0.5"}], "}"}]}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Input",
 CellChangeTimes->{{3.675613415363093*^9, 3.675613471329142*^9}, {
   3.677753474351256*^9, 3.677753488348837*^9}, 3.678110646446787*^9, {
   3.678110757730147*^9, 3.67811077453677*^9}, {3.687209820823546*^9, 
   3.687209833387617*^9}, 3.703180790923745*^9, {3.754826675350614*^9, 
   3.7548266763455*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"05e0d7ec-c884-404e-968c-9a3b0bd76f62"],

Cell["\<\
Creates a new power structure object. If the tactic matrix is ternary, it \
gets legalized. Output: power structure. \
\>", "Text",
 CellChangeTimes->{3.801083941054783*^9, 
  3.801163100924333*^9},ExpressionUUID->"29e03def-44ed-48a7-bc8d-\
178610f41ea4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PowerStructure", "[", 
   RowBox[{"s_List", ",", 
    RowBox[{"T_List", "?", "TernaryMatrixQ"}]}], "]"}], ":=", " ", 
  RowBox[{"PowerStructure", "[", 
   RowBox[{"s", ",", 
    RowBox[{"NormalizeTernaryT", "[", "T", "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6736438256010723`*^9, 3.673643923839637*^9}, {
   3.673643958216683*^9, 3.673643999219006*^9}, {3.6741347716937857`*^9, 
   3.674134772367887*^9}, {3.674751846757329*^9, 3.674751856725263*^9}, {
   3.675604534301339*^9, 3.675604538206883*^9}, {3.675604697324479*^9, 
   3.675604697590345*^9}, {3.6768937362621803`*^9, 3.676893774066062*^9}, {
   3.676894445364437*^9, 3.67689445509875*^9}, {3.677150671477004*^9, 
   3.677150682909816*^9}, {3.678110598878175*^9, 3.678110601280881*^9}, {
   3.6781106738737707`*^9, 3.678110674280099*^9}, {3.6781107222448997`*^9, 
   3.6781107240643806`*^9}, {3.6867236532454357`*^9, 3.6867236669033937`*^9}, 
   3.6867236989919777`*^9, 3.6871275315295277`*^9, {3.7031808323998823`*^9, 
   3.703180842388369*^9}, {3.754826677567308*^9, 3.754826678600503*^9}, 
   3.754853007195805*^9, {3.7548539947211*^9, 3.754854013163815*^9}, {
   3.754854047767762*^9, 3.7548540520724573`*^9}, {3.754929412051035*^9, 
   3.754929413040325*^9}, {3.75492960130169*^9, 3.754929601816174*^9}, {
   3.755812528999836*^9, 3.75581253516299*^9}, 3.756041343585232*^9, {
   3.7560414777140326`*^9, 3.756041483954033*^9}, 3.801077384009169*^9, {
   3.801083962153755*^9, 3.80108398378687*^9}, {3.80116297046634*^9, 
   3.8011629724693327`*^9}, {3.802431022516563*^9, 3.802431025271282*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"8aa05fda-3ab3-4117-86e4-a7d2d4850cb7"],

Cell["\<\
Creates a new power structure object. This is the base function. Output: \
power structure.\
\>", "Text",
 CellChangeTimes->{{3.673644014741767*^9, 3.6736440268378487`*^9}, {
   3.678110796351482*^9, 3.678110809778256*^9}, 3.709928762754695*^9, 
   3.7548266938433867`*^9, {3.754929405902933*^9, 3.7549294082489758`*^9}, {
   3.755799819442276*^9, 3.7557998232127657`*^9}, {3.75631041069291*^9, 
   3.756310415365183*^9}},ExpressionUUID->"9015265f-45af-45b3-9561-\
be070744d0ef"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PowerStructure", "[", 
   RowBox[{"s_List", ",", 
    RowBox[{"T_List", "?", "MatrixQ"}]}], "]"}], ":=", " ", 
  RowBox[{"\[LeftAssociation]", 
   RowBox[{
    RowBox[{"\"\<s\>\"", "\[Rule]", 
     RowBox[{"N", "[", "s", "]"}]}], ",", 
    RowBox[{"\"\<T\>\"", "\[Rule]", 
     RowBox[{"N", "[", "T", "]"}]}]}], "\[RightAssociation]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6736438256010723`*^9, 3.673643923839637*^9}, {
   3.673643958216683*^9, 3.673643999219006*^9}, {3.6741347716937857`*^9, 
   3.674134772367887*^9}, {3.674751846757329*^9, 3.674751856725263*^9}, {
   3.675604534301339*^9, 3.675604538206883*^9}, {3.675604697324479*^9, 
   3.675604697590345*^9}, {3.6768937362621803`*^9, 3.676893774066062*^9}, {
   3.676894445364437*^9, 3.67689445509875*^9}, {3.677150671477004*^9, 
   3.677150682909816*^9}, {3.678110598878175*^9, 3.678110601280881*^9}, {
   3.6781106738737707`*^9, 3.678110674280099*^9}, {3.6781107222448997`*^9, 
   3.6781107240643806`*^9}, {3.6867236532454357`*^9, 3.6867236669033937`*^9}, 
   3.6867236989919777`*^9, 3.6871275315295277`*^9, {3.7031808323998823`*^9, 
   3.703180842388369*^9}, {3.754826677567308*^9, 3.754826678600503*^9}, 
   3.754853007195805*^9, {3.7548539947211*^9, 3.754854013163815*^9}, {
   3.754854047767762*^9, 3.7548540520724573`*^9}, {3.754929412051035*^9, 
   3.754929413040325*^9}, {3.75492960130169*^9, 3.754929601816174*^9}, {
   3.755812528999836*^9, 3.75581253516299*^9}, 3.7560413488892317`*^9, 
   3.801083990710556*^9, 3.801162974789461*^9, {3.803896407035222*^9, 
   3.803896408814172*^9}, {3.804588586159999*^9, 3.804588587939988*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"f7465fa8-56eb-4032-913a-34b1f9a7757c"],

Cell["\<\
Creates a new power structure from only a tactic matrix. If the tactic matrix \
is ternary, it gets legalized. The size vector is a list of 1s. Output: power \
structure.\
\>", "Text",
 CellChangeTimes->{{3.75572534436478*^9, 3.7557253721152782`*^9}, {
  3.755799829162674*^9, 3.755799829529634*^9}, {3.7560412887044315`*^9, 
  3.7560413072684317`*^9}, {3.756310323079486*^9, 
  3.7563103408889503`*^9}},ExpressionUUID->"7c3b1160-2d89-43a6-94ad-\
8b273299b45e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PowerStructure", "[", 
   RowBox[{"TT_List", "?", "TernaryMatrixQ"}], "]"}], ":=", " ", 
  RowBox[{"PowerStructure", "[", 
   RowBox[{"NormalizeTernaryT", "[", "TT", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6736438256010723`*^9, 3.673643923839637*^9}, {
   3.673643958216683*^9, 3.673643999219006*^9}, {3.6741347716937857`*^9, 
   3.674134772367887*^9}, {3.674751846757329*^9, 3.674751856725263*^9}, {
   3.675604534301339*^9, 3.675604538206883*^9}, {3.675604697324479*^9, 
   3.675604697590345*^9}, {3.6768937362621803`*^9, 3.676893774066062*^9}, {
   3.676894445364437*^9, 3.67689445509875*^9}, {3.677150671477004*^9, 
   3.677150682909816*^9}, {3.678110598878175*^9, 3.678110601280881*^9}, {
   3.6781106738737707`*^9, 3.678110674280099*^9}, {3.6781107222448997`*^9, 
   3.6781107240643806`*^9}, {3.6867236532454357`*^9, 3.6867236669033937`*^9}, 
   3.6867236989919777`*^9, 3.6871275315295277`*^9, {3.7031808323998823`*^9, 
   3.703180842388369*^9}, {3.754826677567308*^9, 3.754826678600503*^9}, 
   3.754853007195805*^9, {3.7548539947211*^9, 3.754854013163815*^9}, {
   3.754854047767762*^9, 3.7548540520724573`*^9}, {3.754929412051035*^9, 
   3.754929413040325*^9}, {3.75492960130169*^9, 3.754929601816174*^9}, {
   3.755725381069687*^9, 3.755725397018282*^9}, 3.755812548342911*^9, {
   3.756041221936431*^9, 3.7560412233716307`*^9}, {3.7560414314756327`*^9, 
   3.756041437762432*^9}, 3.801077392014296*^9, {3.801083995569627*^9, 
   3.8010839967158003`*^9}, {3.80116297714228*^9, 3.801162978730837*^9}, {
   3.8024310654346113`*^9, 3.802431068240253*^9}, {3.8216239555374193`*^9, 
   3.821623957218212*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"8500c6c7-eeb0-484a-87eb-21243d57ad1c"],

Cell["Same as the above, but it does not alter the tactic matrix.", "Text",
 CellChangeTimes->{{3.75572534436478*^9, 3.7557253721152782`*^9}, {
   3.755799829162674*^9, 3.755799829529634*^9}, {3.756310344459548*^9, 
   3.756310354755477*^9}, 
   3.803909754374269*^9},ExpressionUUID->"462d5b84-98ce-41e2-b4c4-\
be4852e6a4fe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PowerStructure", "[", 
   RowBox[{"T_List", "?", "MatrixQ"}], "]"}], ":=", " ", 
  RowBox[{"PowerStructure", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{"1.", ",", 
      RowBox[{"Length", "[", "T", "]"}]}], "]"}], ",", "T"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6736438256010723`*^9, 3.673643923839637*^9}, {
   3.673643958216683*^9, 3.673643999219006*^9}, {3.6741347716937857`*^9, 
   3.674134772367887*^9}, {3.674751846757329*^9, 3.674751856725263*^9}, {
   3.675604534301339*^9, 3.675604538206883*^9}, {3.675604697324479*^9, 
   3.675604697590345*^9}, {3.6768937362621803`*^9, 3.676893774066062*^9}, {
   3.676894445364437*^9, 3.67689445509875*^9}, {3.677150671477004*^9, 
   3.677150682909816*^9}, {3.678110598878175*^9, 3.678110601280881*^9}, {
   3.6781106738737707`*^9, 3.678110674280099*^9}, {3.6781107222448997`*^9, 
   3.6781107240643806`*^9}, {3.6867236532454357`*^9, 3.6867236669033937`*^9}, 
   3.6867236989919777`*^9, 3.6871275315295277`*^9, {3.7031808323998823`*^9, 
   3.703180842388369*^9}, {3.754826677567308*^9, 3.754826678600503*^9}, 
   3.754853007195805*^9, {3.7548539947211*^9, 3.754854013163815*^9}, {
   3.754854047767762*^9, 3.7548540520724573`*^9}, {3.754929412051035*^9, 
   3.754929413040325*^9}, {3.75492960130169*^9, 3.754929601816174*^9}, {
   3.755725381069687*^9, 3.755725397018282*^9}, 3.755812548342911*^9, 
   3.756041284820031*^9, {3.756041543998433*^9, 3.756041551190033*^9}, {
   3.8010839984033546`*^9, 3.801083999286315*^9}, {3.8011629805787163`*^9, 
   3.8011629819956627`*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"a0e2a544-5c45-4d20-8c74-a47fcdaeb644"]
}, Closed]],

Cell[CellGroupData[{

Cell["PowerStructureR", "Subsubsection",
 CellChangeTimes->{
  3.821783571954247*^9},ExpressionUUID->"6ba37977-2522-43f3-bcf2-\
c59198a4eeb8"],

Cell["\<\
Instantiate a power structure in which the ternary tactic matrix is \
reciprocalized. Output: power structure.\
\>", "Text",
 CellChangeTimes->{{3.8217835299527693`*^9, 
  3.821783558233144*^9}},ExpressionUUID->"87c489b0-5530-407a-92ec-\
717bcd00f725"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PowerStructureR", "[", 
   RowBox[{"s_", ",", "TT_"}], "]"}], ":=", 
  RowBox[{"PowerStructure", "[", 
   RowBox[{"s", ",", 
    RowBox[{"ReciprocalizeT", "[", 
     RowBox[{"s", ",", "TT"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.821783503877994*^9, 3.821783522816719*^9}, {
  3.8217835607616034`*^9, 3.821783562292942*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"35ec4c56-7d9f-4a67-b6f3-e869e9594d94"]
}, Closed]],

Cell[CellGroupData[{

Cell["AddAlphaList", "Subsubsection",
 CellChangeTimes->{
  3.822149363845173*^9},ExpressionUUID->"7a002ec9-5cd0-4bc7-ac3f-\
b544a7eb2e59"],

Cell["\<\
Adds a \[Alpha] vector as an attribute of a power structure. Output: power \
structure.\
\>", "Text",
 CellChangeTimes->{{3.818270451630034*^9, 3.818270481980158*^9}, 
   3.822149356105311*^9},ExpressionUUID->"6d8e35fb-f852-42a6-80de-\
a24dc64d5943"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AddAlphaList", "[", 
   RowBox[{"ps_Association", ",", "\[Alpha]_List"}], "]"}], ":=", 
  RowBox[{"Join", "[", 
   RowBox[{"ps", ",", 
    RowBox[{"<|", 
     RowBox[{"\"\<\[Alpha]\>\"", "\[Rule]", "\[Alpha]"}], "|>"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.818270389518135*^9, 3.81827040368606*^9}, {
  3.822149309109112*^9, 3.8221493371167383`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"4f5cd28b-aa15-47a9-bae2-95968514bff8"]
}, Closed]],

Cell[CellGroupData[{

Cell["Pretty", "Subsubsection",
 CellChangeTimes->{{3.756041705052834*^9, 
  3.756041705786034*^9}},ExpressionUUID->"0168f3ab-0c5c-4b1b-bdd7-\
c997d3fd7214"],

Cell[TextData[{
 "Displays a power structure with rounded values and components shown in ",
 StyleBox["MatrixForm", "Input"],
 ". Output: a power structure."
}], "Text",
 CellChangeTimes->{{3.756041661497634*^9, 3.7560416870660343`*^9}, {
  3.756041854812835*^9, 3.756041866856035*^9}, {3.7560427119492407`*^9, 
  3.756042731698841*^9}},ExpressionUUID->"fdf8324f-66fe-4fae-aa8b-\
3183513c1a1d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Pretty", "[", "ps_Association", "]"}], ":=", " ", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"MatrixForm", "[", 
      RowBox[{"PrettyRound", "[", 
       RowBox[{"#", ",", ".001"}], "]"}], "]"}], "&"}], ",", "ps"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PrettyRound", "[", 
    RowBox[{"x_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"DeDecimalize", "[", 
    RowBox[{"Round", "[", 
     RowBox[{"x", ",", "n"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PrettyRound", "[", 
    RowBox[{
     RowBox[{"x_List", "?", "TernaryMatrixQ"}], ",", "n_"}], "]"}], ":=", 
   RowBox[{"DeDecimalize", "[", "x", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.756041634494034*^9, 3.7560416557724338`*^9}, {
  3.7560416896868343`*^9, 3.7560416998736343`*^9}, {3.7560417457376347`*^9, 
  3.756041768763234*^9}, {3.7560420533408365`*^9, 3.7560420651968365`*^9}, {
  3.7560422487852373`*^9, 3.7560422518740377`*^9}, {3.756042346690838*^9, 
  3.756042347439638*^9}, {3.7560425204436393`*^9, 3.7560425339532394`*^9}, {
  3.75604261736644*^9, 3.75604262833324*^9}, {3.80848518308385*^9, 
  3.808485184800439*^9}, {3.808485261804344*^9, 3.808485265966465*^9}, {
  3.808485520948876*^9, 3.80848552520173*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"04631f1a-2e84-495e-a2ad-088c068d1477"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Pretty", "[", 
  RowBox[{"RandomPowerStructure", "[", "3", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7560417177824345`*^9, 3.756041723928834*^9}, {
  3.756043906644048*^9, 3.7560439155828485`*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"c63325e2-e052-4f92-881a-1096aa0013a0"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"s\"\>", "\[Rule]", 
    TagBox[
     RowBox[{"(", "\[NoBreak]", 
      TagBox[GridBox[{
         {"0.581`"},
         {"0.493`"},
         {"1.`"}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.5599999999999999]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       Column], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]]}], ",", 
   RowBox[{"\<\"T\"\>", "\[Rule]", 
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0.906`", 
         RowBox[{"-", "0.029`"}], 
         RowBox[{"-", "0.021`"}]},
        {
         RowBox[{"-", "0.073`"}], "0.9590000000000001`", 
         RowBox[{"-", "0.029`"}]},
        {"0.021`", "0.013000000000000001`", "0.9500000000000001`"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.756041724365634*^9, 3.7560417734432344`*^9, 3.75604264249804*^9, 
   3.7560426947112403`*^9, {3.7560439112304482`*^9, 
   3.7560439158636484`*^9}},ExpressionUUID->"32698c8a-52a0-4f34-8c00-\
41453a2dd227"]
}, Open  ]],

Cell["\<\
A version that can be called on a tactic matrix. Output: a tactic matrix.\
\>", "Text",
 CellChangeTimes->{{3.756043832731248*^9, 
  3.7560438482064476`*^9}},ExpressionUUID->"f63300ad-3616-42fd-b9e3-\
8a161ea508fc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Pretty", "[", 
   RowBox[{"T_List", "?", "MatrixQ"}], "]"}], ":=", 
  RowBox[{"MatrixForm", "[", 
   RowBox[{"PrettyRound", "[", 
    RowBox[{"T", ",", ".001"}], "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7560438500316477`*^9, 3.7560438821208477`*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"9e196b7d-defc-4ee2-ba02-e1726659019a"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Helper Functions", "Section",
 CellChangeTimes->{{3.754870050554776*^9, 
  3.754870053178916*^9}},ExpressionUUID->"e0823931-620a-4c85-9d94-\
6f3c5c4352cb"],

Cell[CellGroupData[{

Cell["Scalar", "Subsection",
 CellChangeTimes->{{3.805475259994822*^9, 
  3.8054752608079844`*^9}},ExpressionUUID->"71fe9890-3461-4228-b16a-\
af76f2d5d8b6"],

Cell[CellGroupData[{

Cell["DeDecimalize", "Subsubsection",
 CellChangeTimes->{
  3.8054752997978992`*^9},ExpressionUUID->"6f92986c-6cf1-4168-ad25-\
fe2bd8f47bad"],

Cell["\<\
Removes extraneous decimal points from integers. Output: number.\
\>", "Text",
 CellChangeTimes->{{3.805475272215726*^9, 3.805475286974794*^9}, {
  3.808485244307652*^9, 
  3.808485245163414*^9}},ExpressionUUID->"d0374ac5-17c7-412f-91ad-\
3482d1f0a24b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DeDecimalize", "[", "n_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"n", "\[Equal]", 
     RowBox[{"IntegerPart", "[", "n", "]"}]}], ",", 
    RowBox[{"IntegerPart", "[", "n", "]"}], ",", "n"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8054750761786413`*^9, 3.8054751312618113`*^9}, {
   3.805475177810298*^9, 3.8054751821519003`*^9}, {3.808485102373214*^9, 
   3.808485107131405*^9}, 3.808485253352311*^9},
 CellLabel->"In[20]:=",ExpressionUUID->"332aa180-841f-4115-892c-e480d6079234"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["List", "Subsection",
 CellChangeTimes->{{3.80109189065602*^9, 
  3.801091891196459*^9}},ExpressionUUID->"e5084a88-68a9-4d27-ae86-\
35ecd408efb8"],

Cell[CellGroupData[{

Cell["PositionLargest", "Subsubsection",
 CellChangeTimes->{{3.754499481453947*^9, 
  3.754499483413167*^9}},ExpressionUUID->"fdd52929-a3e7-4409-836c-\
83a85d246b25"],

Cell["\<\
Gives the position of the first element that has the largest value in list. \
Stolen from: \
https://resources.wolframcloud.com/FunctionRepository/resources/\
PositionLargest.  Output: list of integers.\
\>", "Text",
 CellChangeTimes->{{3.754499579961832*^9, 3.754499593227254*^9}, {
  3.755804080817729*^9, 
  3.7558040839894247`*^9}},ExpressionUUID->"c0f5cd0e-c8eb-405c-8139-\
f6d2d2f2fa3d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PositionLargest", "[", "list_List", "]"}], "/;", 
   RowBox[{"AllTrue", "[", 
    RowBox[{"list", ",", "NumericQ"}], "]"}]}], ":=", 
  RowBox[{"First", "[", 
   RowBox[{"FirstPosition", "[", 
    RowBox[{"list", ",", 
     RowBox[{"Max", "[", "list", "]"}]}], "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7449360211790257`*^9, 3.744936027017502*^9}, {
  3.744936138470478*^9, 3.744936145062724*^9}, {3.744936215001199*^9, 
  3.7449362168552732`*^9}, {3.744936295794567*^9, 3.74493629618392*^9}, {
  3.744936329164715*^9, 3.7449363359966307`*^9}},
 CellLabel->"In[21]:=",
 CellID->27851604,ExpressionUUID->"f90b618e-9dcf-4166-976f-ec42e1d9f804"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PositionLargest", "[", 
    RowBox[{"list_List", ",", "n_Integer"}], "]"}], "/;", 
   RowBox[{"AllTrue", "[", 
    RowBox[{"list", ",", "NumericQ"}], "]"}]}], ":=", 
  RowBox[{"Take", "[", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{"list", ",", "#"}], "]"}], "&"}], "/@", 
      RowBox[{"DeleteDuplicates", "[", 
       RowBox[{"TakeLargest", "[", 
        RowBox[{"list", ",", "n"}], "]"}], "]"}]}], "]"}], ",", "n"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7449360211790257`*^9, 3.744936027017502*^9}, {
   3.744936138470478*^9, 3.744936145062724*^9}, {3.744936215001199*^9, 
   3.7449362168552732`*^9}, 3.744936291177209*^9, {3.744936344660231*^9, 
   3.74493644612978*^9}, {3.744936484336041*^9, 3.74493648996622*^9}},
 CellLabel->"In[22]:=",
 CellID->395511347,ExpressionUUID->"8ec6264a-caba-4c52-a6f1-3174cd922ee1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PositionLargest", "[", 
    RowBox[{"list_List", ",", 
     RowBox[{
      RowBox[{"HoldPattern", "[", "UpTo", "]"}], "[", "n_Integer", "]"}]}], 
    "]"}], "/;", 
   RowBox[{"AllTrue", "[", 
    RowBox[{"list", ",", "NumericQ"}], "]"}]}], ":=", 
  RowBox[{"Take", "[", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{"list", ",", "#"}], "]"}], "&"}], "/@", 
      RowBox[{"DeleteDuplicates", "[", 
       RowBox[{"TakeLargest", "[", 
        RowBox[{"list", ",", 
         RowBox[{"UpTo", "[", "n", "]"}]}], "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"UpTo", "[", "n", "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7449360211790257`*^9, 3.744936027017502*^9}, {
   3.744936138470478*^9, 3.744936145062724*^9}, {3.744936215001199*^9, 
   3.7449362168552732`*^9}, 3.744936291177209*^9, {3.744936344660231*^9, 
   3.74493644612978*^9}, {3.744936484336041*^9, 3.74493648996622*^9}, {
   3.7482612040471487`*^9, 3.7482612308491488`*^9}},
 CellLabel->"In[23]:=",
 CellID->323133670,ExpressionUUID->"5c46d030-552f-4ec8-ba33-f557c431def8"]
}, Closed]],

Cell[CellGroupData[{

Cell["RandomPosition", "Subsubsection",
 CellChangeTimes->{{3.802354080469018*^9, 
  3.802354082221466*^9}},ExpressionUUID->"791e6515-e661-4159-b114-\
09bf7467f0de"],

Cell[TextData[{
 "Gives a random position at which objects matching ",
 Cell[BoxData[
  StyleBox["pattern", "TI"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "efde0e4a-2411-48fe-86e7-cf6da82725cb"],
 " appear in ",
 Cell[BoxData[
  StyleBox["expr", "TI"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "202139ff-f0da-43ad-a503-76b7c683539a"],
 ". "
}], "Text",
 CellChangeTimes->{{3.802354021074265*^9, 
  3.802354071655151*^9}},ExpressionUUID->"4f053fa2-654c-4c87-a92c-\
c2f760f93981"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RandomPosition", "[", 
   RowBox[{"expr_", ",", "pattern_"}], "]"}], ":=", " ", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Position", "[", 
     RowBox[{"expr", ",", "pattern"}], "]"}], "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.802353881158081*^9, 3.802353921267715*^9}, {
  3.8023540026001987`*^9, 3.802354012953044*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"70c61667-bfdc-4757-98bc-cc6bbe991194"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RandomPosition", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"a", ",", "a", ",", "b", ",", "a", ",", "c", ",", "b"}], "}"}], 
   ",", "b"}], "]"}]], "Input",
 CellChangeTimes->{{3.802354101642086*^9, 3.802354139823164*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"bf2690ba-4ba4-4ca0-a039-08450e03ddcc"],

Cell[BoxData["5"], "Output",
 CellChangeTimes->{{3.80235410559265*^9, 3.802354123852827*^9}},
 CellLabel->
  "Out[1070]=",ExpressionUUID->"702b8e23-3e26-4b93-8e1f-ad58d2fef061"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Softmax", "Subsubsection",
 CellChangeTimes->{{3.822307651728364*^9, 
  3.822307654106492*^9}},ExpressionUUID->"96db0ed2-69e3-4637-b324-\
21336c5e55ff"],

Cell[TextData[{
 "A homegrown implementation of ",
 StyleBox["SoftmaxLayer", "Input"],
 ". Output: list of reals."
}], "Text",
 CellChangeTimes->{{3.822307389022484*^9, 3.822307404333735*^9}, {
   3.8223076645447493`*^9, 3.822307666178331*^9}, 
   3.822312625483302*^9},ExpressionUUID->"2a04d710-9b3a-4a3b-a98d-\
89b36a8d57b0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Softmax", "[", "vec_", "]"}], ":=", 
  RowBox[{"Normalize", "[", 
   RowBox[{
    RowBox[{"Exp", "[", "vec", "]"}], ",", "Total"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.822307355232589*^9, 3.822307378643984*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"5133cedb-0757-4c02-90e6-908192ea753d"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Matrix", "Subsection",
 CellChangeTimes->{{3.8010918927838993`*^9, 
  3.8010918935177593`*^9}},ExpressionUUID->"e73bef0c-d049-4c78-ad44-\
b4ed8469b04d"],

Cell[CellGroupData[{

Cell["MapTransposed", "Subsubsection",
 CellChangeTimes->{{3.7541619878576064`*^9, 3.7541619981512065`*^9}, {
   3.75416251541311*^9, 3.75416254608981*^9}, 
   3.7556238997460938`*^9},ExpressionUUID->"14e84133-f928-4ba1-8fb5-\
7484be2628bf"],

Cell["\<\
Maps a function down the columns of a matrix. Output: matrix.\
\>", "Text",
 CellChangeTimes->{{3.7541734622216797`*^9, 3.75417349212188*^9}, {
  3.7558042145775423`*^9, 
  3.755804216277753*^9}},ExpressionUUID->"1060bf40-42e8-4dae-864e-\
96e384c51044"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MapTransposed", "[", 
    RowBox[{"f_", ",", 
     RowBox[{"M_List", "?", "MatrixQ"}]}], "]"}], ":=", " ", 
   RowBox[{"Transpose", "[", 
    RowBox[{"Map", "[", 
     RowBox[{"f", ",", 
      RowBox[{"Transpose", "[", "M", "]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"MapTransposed", ",", "HoldFirst"}], "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7541618886882057`*^9, 3.754161973110506*^9}, {
  3.7541622355532084`*^9, 3.7541622652140083`*^9}, {3.7541623243066087`*^9, 
  3.7541623405926085`*^9}, {3.75416255649321*^9, 3.75416257406141*^9}, {
  3.754162691290311*^9, 3.7541626934269114`*^9}, {3.7556238625605097`*^9, 
  3.755623869479594*^9}, {3.801164059439602*^9, 3.8011640609912663`*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"931a8962-1c73-4d0b-8d39-5e040defb1a1"]
}, Closed]],

Cell[CellGroupData[{

Cell["ReplaceColumn", "Subsubsection",
 CellChangeTimes->{{3.75493209181262*^9, 
  3.754932096162079*^9}},ExpressionUUID->"22069f9d-0eca-4eaa-b2d7-\
03c65c45ac30"],

Cell[TextData[{
 "Replace a column in a matrix ",
 StyleBox["M", "Input"],
 " with a given list. Output: matrix."
}], "Text",
 CellChangeTimes->{{3.7550439201990347`*^9, 3.755043948152079*^9}, 
   3.755804247022608*^9, {3.808440489713048*^9, 
   3.808440490185446*^9}},ExpressionUUID->"1a7a8d71-7284-4fe2-88b9-\
f357cc5f937a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReplaceColumn", "[", 
   RowBox[{"M_List", ",", "i_Integer", ",", "list_List"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"m", "=", "M"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"m", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "i"}], "]"}], "]"}], "=", "list"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "m", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.754932247697462*^9, 3.754932311453534*^9}, {
   3.801124009799946*^9, 3.8011240112814074`*^9}, {3.801164069708634*^9, 
   3.80116407175918*^9}, {3.8084349412254*^9, 3.8084349517503242`*^9}, {
   3.808435026354577*^9, 3.8084350421122427`*^9}, {3.808435089463604*^9, 
   3.808435089821786*^9}, 3.8084351987285147`*^9, {3.808440483032544*^9, 
   3.80844048319529*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"a5cbbd06-98a3-4224-9ac1-ee0fed09487f"]
}, Closed]],

Cell[CellGroupData[{

Cell["ReplaceDiagonal", "Subsubsection",
 CellChangeTimes->{{3.754498350532661*^9, 
  3.754498354948777*^9}},ExpressionUUID->"0b56b242-72b4-4890-82c1-\
e5988c6db015"],

Cell["\<\
Replaces the diagonal of a matrix with a given list.  This implementation is \
ugly but fast. Output: matrix. NOTE: This is not used anywhere.\
\>", "Text",
 CellChangeTimes->{{3.6912811656257563`*^9, 3.691281177673455*^9}, {
   3.6915370652373734`*^9, 3.691537072583271*^9}, {3.691766352800001*^9, 
   3.69176642460678*^9}, 3.755804252299378*^9, 3.8011640815925617`*^9, {
   3.8023576671382017`*^9, 3.802357669571126*^9}, {3.808517451741061*^9, 
   3.808517456561812*^9}},ExpressionUUID->"d685bb37-f6b9-4302-91b1-\
211ff526084d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReplaceDiagonal", "[", 
   RowBox[{
    RowBox[{"M_List", "?", "MatrixQ"}], ",", "diag_List"}], "]"}], " ", ":=", 
  " ", 
  RowBox[{"M", " ", "-", " ", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"Diagonal", "[", "M", "]"}], "]"}], " ", "+", " ", 
   RowBox[{"DiagonalMatrix", "[", "diag", "]"}], " "}]}]], "Input",
 CellChangeTimes->{{3.691680437186426*^9, 3.6916804513125477`*^9}, 
   3.7544984599852533`*^9, 3.7548620765181913`*^9, {3.801164083026101*^9, 
   3.801164086416046*^9}, 3.808517432775318*^9},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[32]:=",ExpressionUUID->"e9806dc7-9b23-4e7d-a1e2-285b9b086343"],

Cell["\<\
A faster version to use when all input elements are known to be reals.\
\>", "Text",
 CellChangeTimes->{{3.80237989148005*^9, 3.802379907086418*^9}, {
  3.802380251252264*^9, 
  3.802380260147728*^9}},ExpressionUUID->"a517e66f-1a27-4152-be4b-\
3c2b5a726f0b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReplaceDiagonalReals", "=", 
   RowBox[{"FunctionCompile", "[", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Typed", "[", 
         RowBox[{"M", ",", 
          RowBox[{
           RowBox[{"TypeSpecifier", "[", "\"\<PackedArray\>\"", "]"}], "[", 
           RowBox[{"\"\<Real64\>\"", ",", "2"}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Typed", "[", 
         RowBox[{"diag", ",", 
          RowBox[{
           RowBox[{"TypeSpecifier", "[", "\"\<PackedArray\>\"", "]"}], "[", 
           RowBox[{"\"\<Real64\>\"", ",", "1"}], "]"}]}], "]"}]}], 
       "\[IndentingNewLine]", "}"}], ",", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"R", "=", "M"}], ",", "i", ",", 
          RowBox[{"m", "=", 
           RowBox[{"Length", "[", "M", "]"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", 
           RowBox[{"i", "\[LessEqual]", "m"}], ",", 
           RowBox[{"i", "++"}], ",", "  ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"R", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "i"}], "]"}], "]"}], " ", "=", " ", 
             RowBox[{"diag", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "R", "]"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}]}], "]"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.691680437186426*^9, 3.6916804513125477`*^9}, 
   3.7544984599852533`*^9, 3.7548620765181913`*^9, {3.801164083026101*^9, 
   3.801164086416046*^9}, {3.802378956894918*^9, 3.802378982091714*^9}, {
   3.80237988396819*^9, 3.802379884861409*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"bdb876d0-a0e1-4b50-8946-bbf1c3fe3a20"]
}, Closed]],

Cell[CellGroupData[{

Cell["ZeroDiagonalize", "Subsubsection",
 CellChangeTimes->{{3.7572449438006463`*^9, 
  3.7572449469478393`*^9}},ExpressionUUID->"82b9f309-b584-4a15-8f41-\
4e1648278058"],

Cell["\<\
Overwrites the diagonal of a matrix with all zeroes. Every element in the \
matrix is assumed to be a Real. Output: a matrix.\
\>", "Text",
 CellChangeTimes->{{3.757245409918594*^9, 3.75724541999716*^9}, {
  3.757250531964736*^9, 3.7572505342251587`*^9}, {3.8085173169115877`*^9, 
  3.808517328264339*^9}},ExpressionUUID->"ad725d68-8d95-4187-8e30-\
b7effc0b2e12"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ZeroDiagonalize", "[", "M_List", "]"}], ":=", 
  RowBox[{"ReplaceDiagonalReals", "[", 
   RowBox[{"M", ",", 
    RowBox[{"Table", "[", 
     RowBox[{"0.", ",", 
      RowBox[{"Length", "[", "M", "]"}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7572445612316628`*^9, 3.7572445988270354`*^9}, {
   3.80116409544867*^9, 3.8011640985113697`*^9}, 3.8023793598093653`*^9, 
   3.802379547908339*^9, {3.808433772702058*^9, 3.808433785556573*^9}, {
   3.808434075668199*^9, 3.808434075811672*^9}, 3.80843411895431*^9, {
   3.8084342349063663`*^9, 3.808434249947301*^9}, 3.808517275942481*^9},
 CellLabel->"In[30]:=",ExpressionUUID->"a1387404-2ee9-4cd8-b0a9-b92684ce38bc"]
}, Closed]],

Cell[CellGroupData[{

Cell["ZeroMatrix", "Subsubsection",
 CellChangeTimes->{{3.8023410986943207`*^9, 
  3.802341100896497*^9}},ExpressionUUID->"a98ae373-a640-438b-b026-\
cbfc4f21f394"],

Cell["\<\
Creates a matrix of all zeroes, of a given dimension. Output: matrix.\
\>", "Text",
 CellChangeTimes->{{3.802341109896386*^9, 
  3.8023411222363977`*^9}},ExpressionUUID->"c6311e98-7a44-4a0a-9f8d-\
1ecb4aa6eded"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ZeroMatrix", "[", "n_", "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{"0", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "n"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8023410093719807`*^9, 3.802341021421091*^9}, {
  3.802341066212339*^9, 3.802341073493745*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"7d6da790-fc33-43df-97a5-4a97e6520422"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ZeroMatrix", "[", "4", "]"}]], "Input",
 CellChangeTimes->{{3.802341026083613*^9, 3.802341028994874*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[462]:=",ExpressionUUID->"357aa799-c6d0-408a-887c-3019dbb87763"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.802341029394573*^9, 3.802341076212393*^9},
 CellLabel->
  "Out[462]=",ExpressionUUID->"19f06388-7953-4483-84a3-d70620742f59"]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Unit tests", "Subsection",
 CellChangeTimes->{{3.7550936967474327`*^9, 
  3.755093698829698*^9}},ExpressionUUID->"cc26c9e7-5dc7-4ccf-9827-\
1bf5e85d9f51"],

Cell["Unit tests for the helper functions:", "Text",
 CellChangeTimes->{{3.755085357688162*^9, 3.755085360162019*^9}, {
  3.755094442385968*^9, 3.755094446540848*^9}, {3.755094644426935*^9, 
  3.755094645448432*^9}},ExpressionUUID->"6aac6bc5-f681-4656-ab02-\
3d2defb24223"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"unitTests", "[", "\"\<HelperFunctions\>\"", "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"MapTransposed", "[", 
        RowBox[{"Differences", ",", 
         RowBox[{"IdentityMatrix", "[", "4", "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", "1"}], ",", "1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
       "TestID", "\[Rule]", "\"\<HelperFunctions_MapTransposed1\>\""}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ReplaceColumn", "[", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", "1", ",", 
         RowBox[{"{", 
          RowBox[{"5", ",", "6", ",", "7"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"5", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"6", ",", "1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"7", ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
       "TestID", "\[Rule]", "\"\<HelperFunctions_ReplaceColumn1\>\""}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ReplaceDiagonalReals", "[", 
        RowBox[{
         RowBox[{"N", "[", 
          RowBox[{"IdentityMatrix", "[", "3", "]"}], "]"}], ",", 
         RowBox[{"N", "[", 
          RowBox[{"{", 
           RowBox[{"9", ",", "10", ",", "11"}], "}"}], "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"N", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"9", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "10", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "11"}], "}"}]}], "}"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
       "TestID", "\[Rule]", "\"\<HelperFunctions_ReplaceDiagonal1\>\""}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PositionLargest", "[", 
        RowBox[{"{", 
         RowBox[{"100", ",", "200", ",", "100", ",", "200", ",", "50"}], 
         "}"}], "]"}], ",", "\[IndentingNewLine]", "2", ",", 
       "\[IndentingNewLine]", 
       RowBox[{
       "TestID", "\[Rule]", "\"\<HelperFunctions_PositionLargest1\>\""}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PositionLargest", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"100", ",", "200", ",", "100", ",", "200", ",", "50"}], 
          "}"}], ",", "1"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", "2", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
       "TestID", "\[Rule]", "\"\<HelperFunctions_PositionLargest2\>\""}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PositionLargest", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"100", ",", "200", ",", "100", ",", "200", ",", "50"}], 
          "}"}], ",", "3"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"2", ",", "4", ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
       "TestID", "\[Rule]", "\"\<HelperFunctions_PositionLargest3\>\""}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ZeroDiagonalize", "[", 
        RowBox[{"N", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "6", ",", "8"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"5", ",", "9", ",", "6"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"6", ",", "6", ",", "2"}], "}"}]}], "}"}], "]"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"N", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "6", ",", "8"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"5", ",", "0", ",", "6"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"6", ",", "6", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
       "TestID", "\[Rule]", "\"\<HelperFunctions_ZeroDiagonalize1\>\""}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7550841330433683`*^9, 3.755084135437353*^9}, {
   3.7550841708582687`*^9, 3.755084177444426*^9}, {3.75508488110111*^9, 
   3.755084921944516*^9}, {3.755085004683037*^9, 3.755085019160364*^9}, {
   3.755085236775576*^9, 3.7550852605358467`*^9}, {3.755085299455575*^9, 
   3.7550853362271223`*^9}, 3.755085432033588*^9, {3.755085559417843*^9, 
   3.755085605499104*^9}, {3.755085657127652*^9, 3.755085684055829*^9}, {
   3.7550857227312603`*^9, 3.755085757850277*^9}, {3.755085791385973*^9, 
   3.755085806043363*^9}, {3.755085848538776*^9, 3.7550858726824923`*^9}, {
   3.755085921688486*^9, 3.755085975595923*^9}, {3.755086010930608*^9, 
   3.755086084763026*^9}, {3.7550861278999023`*^9, 3.755086145884115*^9}, {
   3.7550861893032513`*^9, 3.7550863415526657`*^9}, {3.755086381974959*^9, 
   3.755086392501211*^9}, {3.75508644659693*^9, 3.7550864513013277`*^9}, {
   3.75508649799314*^9, 3.7550865090662107`*^9}, {3.755086565163678*^9, 
   3.755086585445758*^9}, {3.755086655240406*^9, 3.755086701383586*^9}, {
   3.755086806299365*^9, 3.755086837717898*^9}, {3.755086948783966*^9, 
   3.755087022479724*^9}, {3.7550870816896*^9, 3.755087134007586*^9}, {
   3.755087422831038*^9, 3.755087427098736*^9}, {3.755087460919154*^9, 
   3.755087557692718*^9}, {3.755087590425846*^9, 3.755087598858591*^9}, {
   3.755093710975533*^9, 3.755093717606208*^9}, {3.755093748877844*^9, 
   3.755093757013233*^9}, {3.755093876560425*^9, 3.755094002514143*^9}, {
   3.7550940348396397`*^9, 3.7550940848874483`*^9}, {3.755094121277615*^9, 
   3.755094208136566*^9}, {3.755094299823888*^9, 3.755094353396225*^9}, {
   3.755094385568523*^9, 3.755094426864455*^9}, {3.7551116631067123`*^9, 
   3.755111713667102*^9}, {3.755117028275385*^9, 3.755117035862824*^9}, {
   3.7551987879627523`*^9, 3.755198789961357*^9}, {3.755369348083087*^9, 
   3.755369483792511*^9}, {3.7556239393014193`*^9, 3.755623964514538*^9}, {
   3.755624022131209*^9, 3.75562403433648*^9}, {3.755624125806178*^9, 
   3.755624198808324*^9}, {3.7562244392716265`*^9, 3.756224494168027*^9}, {
   3.757281337096888*^9, 3.757281347480287*^9}, {3.757281383466137*^9, 
   3.757281397063533*^9}, {3.801165371450492*^9, 3.8011654000871887`*^9}, {
   3.802379430664377*^9, 3.802379433131817*^9}, {3.802379957934548*^9, 
   3.802379960738443*^9}, {3.8084358524634542`*^9, 3.808435853113304*^9}, {
   3.8085983040061607`*^9, 3.808598323909079*^9}, {3.808598356797709*^9, 
   3.808598388189486*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[32]:=",ExpressionUUID->"e655e5ca-96ec-4a50-ab44-a108c89eece4"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Manipulating Power Structures", "Section",
 CellChangeTimes->{{3.754824389549128*^9, 3.754824391300934*^9}, {
  3.822323614098823*^9, 
  3.82232361932585*^9}},ExpressionUUID->"12a285f5-b612-46b1-b366-\
d09dd462e4ff"],

Cell[CellGroupData[{

Cell["Normalization", "Subsection",
 CellChangeTimes->{{3.754825048831605*^9, 
  3.7548250513457737`*^9}},ExpressionUUID->"a4331544-ea50-4beb-8671-\
e3432c341f8c"],

Cell[CellGroupData[{

Cell["NormalizeS", "Subsubsection",
 CellChangeTimes->{{3.754825072123945*^9, 3.754825074961195*^9}, {
   3.754998139985374*^9, 3.754998140976158*^9}, 
   3.801077655356333*^9},ExpressionUUID->"581d3789-9c5a-4340-9e22-\
f260f6a2da06"],

Cell["\<\
Normalizes the size vector so that all sizes are between 0 and 1.  The \
largest agent always ends up with a size of 1. This is slightly faster than \
an equivalent complied version. Output: size vector.\
\>", "Text",
 CellChangeTimes->{{3.7053508195878067`*^9, 3.70535086657171*^9}, {
   3.705351001670951*^9, 3.705351005241795*^9}, 3.734368976046644*^9, {
   3.7522366994798403`*^9, 3.7522367107520857`*^9}, {3.755799865045836*^9, 
   3.755799867436447*^9}},ExpressionUUID->"58afa13f-d4eb-4290-85d0-\
88c2b6398f70"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NormalizeS", "[", "s_List", "]"}], " ", ":=", " ", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"max", "=", 
      RowBox[{"Max", "[", "s", "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"N", "[", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"max", "\[Equal]", "0"}], ",", "s", ",", 
       RowBox[{"s", "/", "max"}]}], "]"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.705350724556303*^9, 3.7053507455987587`*^9}, {
   3.705350796333295*^9, 3.7053507998397017`*^9}, {3.7370433085028963`*^9, 
   3.7370433750534735`*^9}, 3.737043422799554*^9, {3.737118850157627*^9, 
   3.7371188522040205`*^9}, {3.737473216435109*^9, 3.7374732410784817`*^9}, {
   3.742305700264259*^9, 3.742305706151347*^9}, {3.7522366120572777`*^9, 
   3.752236637386401*^9}, 3.752236686736147*^9, 3.7548533773427467`*^9, {
   3.754854806979151*^9, 3.754854807844222*^9}, 3.755037728392378*^9, {
   3.7550379367633753`*^9, 3.755037937996545*^9}, 3.801077603592969*^9},
 CellLabel->"In[33]:=",ExpressionUUID->"a5e4d0e7-d62d-4c86-9b94-7949671a123f"],

Cell["\<\
A version that works on power structures. Output: power structure.\
\>", "Text",
 CellChangeTimes->{{3.809726019764646*^9, 
  3.8097260323121367`*^9}},ExpressionUUID->"26e7ef8e-4ad4-42be-a25d-\
5321f29ef663"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NormalizeS", "[", "ps_Association", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"r", "=", "ps"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"AssociateTo", "[", 
      RowBox[{"r", ",", 
       RowBox[{"\"\<s\>\"", "\[Rule]", 
        RowBox[{"NormalizeS", "[", 
         RowBox[{"ps", "[", "\"\<s\>\"", "]"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "r", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.820417128584844*^9, 3.8204171490986233`*^9}, {
  3.8204172608469152`*^9, 3.820417303580927*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"0182e3d1-47db-4202-b80d-853914145471"],

Cell["Unit tests:", "Text",
 CellChangeTimes->{{3.755085357688162*^9, 
  3.755085360162019*^9}},ExpressionUUID->"2c00ac8e-98fb-46ad-96aa-\
3de21449f3ac"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"unitTests", "[", "\"\<NormalizeS\>\"", "]"}], " ", ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NormalizeS", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TestID", "\[Rule]", "\"\<NormalizeS1\>\""}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NormalizeS", "[", 
        RowBox[{"{", 
         RowBox[{".5", ",", ".3", ",", "0"}], "}"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"1.`", ",", "0.6`", ",", "0.`"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TestID", "\[Rule]", "\"\<NormalizeS2\>\""}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NormalizeS", "[", 
        RowBox[{"{", 
         RowBox[{"5", ",", "13", ",", "0.3"}], "}"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "0.38461538461538464`", ",", "1.`", ",", "0.023076923076923078`"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"TestID", "\[Rule]", "\"\<NormalizeS3\>\""}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7550841330433683`*^9, 3.755084135437353*^9}, {
   3.7550841708582687`*^9, 3.755084177444426*^9}, {3.75508488110111*^9, 
   3.755084921944516*^9}, {3.755085004683037*^9, 3.755085019160364*^9}, {
   3.755085121661146*^9, 3.755085155017577*^9}, 3.755085426379653*^9, {
   3.755088016412532*^9, 3.7550880193423653`*^9}, {3.755094981589958*^9, 
   3.755094993648829*^9}, {3.801077618007181*^9, 3.801077626138361*^9}, {
   3.8010777347658443`*^9, 3.801077740573101*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[35]:=",ExpressionUUID->"5fb5d78e-9d0b-40a3-ab82-3096ea647306"]
}, Closed]],

Cell[CellGroupData[{

Cell["NormalizeTactic", "Subsubsection",
 CellChangeTimes->{{3.802429702503912*^9, 
  3.802429705043367*^9}},ExpressionUUID->"7b18151a-2297-47d4-aae0-\
29f41291c91a"],

Cell[TextData[{
 "Given a random tactic vector, this function adjusts its length so as to \
make it a legal tactic.  A legal tactic is a point on the surface of a \
cross-polytope whose dimension is equal to the number of agents. Note: A zero \
vector ",
 StyleBox["0",
  FontWeight->"Bold"],
 " will remain ",
 StyleBox["0",
  FontWeight->"Bold"],
 ". Output: tactic vector."
}], "Text",
 CellChangeTimes->{{3.6915368595653954`*^9, 3.69153688260851*^9}, {
  3.729039303951309*^9, 3.7290393240304537`*^9}, {3.752236739189604*^9, 
  3.752236753950879*^9}, {3.754826212542219*^9, 3.754826213626995*^9}, {
  3.754853837108588*^9, 3.75485384957441*^9}, {3.755038171408772*^9, 
  3.75503818491436*^9}, {3.755799846394298*^9, 
  3.7557998561024427`*^9}},ExpressionUUID->"51410b13-2bbe-4d8a-9534-\
02659154110a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NormalizeTactic", "[", "list_List", "]"}], ":=", 
  RowBox[{"NormalizeTacticCompiled", "[", 
   RowBox[{"N", "[", "list", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.735424846539838*^9, 3.735424876076406*^9}, {
   3.7354249370590563`*^9, 3.7354249377349625`*^9}, {3.735425087140498*^9, 
   3.735425115788927*^9}, 3.7357235373939357`*^9, 3.7357249039847946`*^9, 
   3.754853798252289*^9, {3.754854801409169*^9, 3.7548548027648973`*^9}, {
   3.7550372272782907`*^9, 3.7550372354639053`*^9}, {3.755038385271389*^9, 
   3.755038407835023*^9}, 3.8010776926721907`*^9, 3.8024305979432707`*^9, {
   3.802432782986539*^9, 3.8024327893384666`*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"f8bc0f93-4fe1-498c-8dae-1ee400f02937"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NormalizeTacticCompiled", "=", 
   RowBox[{"FunctionCompile", "[", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"Typed", "[", 
        RowBox[{"list", ",", 
         RowBox[{
          RowBox[{"TypeSpecifier", "[", "\"\<PackedArray\>\"", "]"}], "[", 
          RowBox[{"\"\<Real64\>\"", ",", "1"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", "}"}], ",", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"tot", "=", 
          RowBox[{"Total", "[", 
           RowBox[{"Abs", "[", "list", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"tot", "\[Equal]", "0"}], ",", "list", ",", 
          RowBox[{"list", " ", "/", " ", "tot"}]}], "]"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.649206144851355*^9, 3.649206148651795*^9}, {
   3.661121352574053*^9, 3.661121387218481*^9}, 3.674430201672263*^9, 
   3.6744681680692673`*^9, 3.686726631590466*^9, {3.8023774606781273`*^9, 
   3.802377472443514*^9}, {3.802377502855513*^9, 3.802377598050089*^9}, {
   3.802384399165329*^9, 3.8023844445581217`*^9}, {3.8023845844312773`*^9, 
   3.802384586152059*^9}, {3.8024325400696173`*^9, 3.802432540271508*^9}, {
   3.802432585964978*^9, 3.802432634315682*^9}, {3.8024327660407953`*^9, 
   3.802432771873838*^9}, {3.821385735335742*^9, 3.8213857612593937`*^9}, 
   3.8213858660891*^9},
 CellLabel->"In[37]:=",ExpressionUUID->"3078804f-b5f7-4048-8e64-dedc169d08cd"],

Cell["Unit tests:", "Text",
 CellChangeTimes->{{3.755085357688162*^9, 
  3.755085360162019*^9}},ExpressionUUID->"047917e6-aecc-4f49-99fe-\
6d38607265b4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"unitTests", "[", "\"\<NormalizeTactic\>\"", "]"}], " ", ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NormalizeTactic", "[", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", "0", ",", "0"}], "}"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"1.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TestID", "\[Rule]", "\"\<NormalizeTactic1\>\""}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NormalizeTactic", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TestID", "\[Rule]", "\"\<NormalizeTactic2\>\""}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NormalizeTactic", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "4", ",", "4."}], "}"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "0.09090909090909091`", ",", "0.18181818181818182`", ",", 
         "0.36363636363636365`", ",", "0.36363636363636365`"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TestID", "\[Rule]", "\"\<NormalizeTactic3\>\""}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NormalizeTactic", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "1"}], "}"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.5"}], ",", "0.", ",", "0.", ",", "0.5"}], "}"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"TestID", "\[Rule]", "\"\<NormalizeTactic2\>\""}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7550841330433683`*^9, 3.755084135437353*^9}, {
   3.7550841708582687`*^9, 3.755084177444426*^9}, {3.75508488110111*^9, 
   3.755084921944516*^9}, {3.755085004683037*^9, 3.755085019160364*^9}, 
   3.755085414831155*^9, {3.755088026631571*^9, 3.755088029426392*^9}, {
   3.755094896785777*^9, 3.7550949414804296`*^9}, {3.8010776985162*^9, 
   3.801077724334634*^9}, {3.8011633921696997`*^9, 3.801163392642374*^9}, {
   3.802430603236143*^9, 3.802430644718812*^9}, {3.802430684147846*^9, 
   3.802430693651062*^9}, {3.8024312287903*^9, 3.802431229204958*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[38]:=",ExpressionUUID->"84df6515-1916-4245-a240-158aaf55debc"]
}, Closed]],

Cell[CellGroupData[{

Cell["NormalizeT", "Subsubsection",
 CellChangeTimes->{{3.802430266441366*^9, 3.802430268038661*^9}, {
  3.8084363749933567`*^9, 3.808436376645249*^9}, {3.808694294483302*^9, 
  3.808694296093234*^9}},ExpressionUUID->"0bc484df-8b1c-4fcf-978b-\
2bca2e956652"],

Cell["Output: a normalized tactic matrix.", "Text",
 CellChangeTimes->{{3.758745836459744*^9, 
  3.758745852003644*^9}},ExpressionUUID->"d598fb19-0f9c-4889-85be-\
99a088c3fc73"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NormalizeT", "[", 
   RowBox[{"T_List", "?", "MatrixQ"}], "]"}], ":=", 
  RowBox[{"MapTransposed", "[", 
   RowBox[{"NormalizeTactic", ",", "T"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7587458541668587`*^9, 3.75874586686872*^9}, {
  3.758745909324032*^9, 3.7587459244781837`*^9}, {3.801077681634454*^9, 
  3.801077685831356*^9}, {3.80843643232582*^9, 3.808436433160832*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"0bb49d5d-e4b4-4bea-9098-89477234bf40"]
}, Closed]],

Cell[CellGroupData[{

Cell["NormalizeTernaryT", "Subsubsection",
 CellChangeTimes->{{3.7548250656948843`*^9, 3.75482506899996*^9}, {
   3.7549981354323063`*^9, 3.754998136457725*^9}, 3.801077658502221*^9, {
   3.8024301754553003`*^9, 
   3.80243017647867*^9}},ExpressionUUID->"c31d912d-e18b-4bd4-a2a0-\
976c4597146a"],

Cell["\<\
Legalizes a ternary matrix, which is a different algorithm because \[Rho] has \
to be inserted for the self-allocations. Note: the self-allocation will \
always be \[Rho], even if all other allocations are 0. Output: tactic matrix.\
\
\>", "Text",
 CellChangeTimes->{{3.75474975554489*^9, 3.754749758792066*^9}, 
   3.7548581383267736`*^9, {3.755800042907732*^9, 3.755800046760186*^9}, {
   3.801163442158244*^9, 3.801163484102563*^9}, {3.808128234550782*^9, 
   3.808128241328451*^9}},ExpressionUUID->"0d4af79c-117a-48f2-a9e5-\
8dafe2a28899"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NormalizeTernaryT", "[", "TT_List", "]"}], " ", ":=", 
  RowBox[{"ReplaceDiagonalReals", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", "TT", "]"}], "/", 
       RowBox[{"ReplaceAll", "[", 
        RowBox[{
         RowBox[{"N", "[", 
          RowBox[{"Total", "[", 
           RowBox[{"Abs", "[", "TT", "]"}], "]"}], "]"}], ",", " ", 
         RowBox[{"0.", "\[Rule]", "1."}]}], "]"}]}], "]"}], "*", 
     RowBox[{"(", 
      RowBox[{"1.", "-", "\[Rho]"}], ")"}]}], ",", 
    RowBox[{"Table", "[", 
     RowBox[{"\[Rho]", ",", 
      RowBox[{"Length", "[", "TT", "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.808093547368218*^9, 3.80809356824786*^9}, 
   3.8080936157964153`*^9, 3.808093730522738*^9, {3.808094062553307*^9, 
   3.80809406382518*^9}, 3.808094357783413*^9, {3.808127807699098*^9, 
   3.808127811746667*^9}, 3.808127940453211*^9, {3.8085169104858923`*^9, 
   3.808516911273973*^9}, {3.821624073750122*^9, 3.821624079438485*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[1437]:=",ExpressionUUID->"02a7961a-310f-4841-9b9e-a942904679f3"],

Cell["A version that sets \[Rho] to 1 when all other allocations are 0:", \
"Text",
 CellChangeTimes->{{3.809073238120923*^9, 
  3.809073256001882*^9}},ExpressionUUID->"37f10875-1648-4ff7-b935-\
0d05d2a3cb8d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NormalizeTernaryT", "[", "TT_List", "]"}], " ", ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"t", "=", 
       RowBox[{"N", "[", 
        RowBox[{"Total", "[", 
         RowBox[{"RealAbs", "[", "TT", "]"}], "]"}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"x", "=", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", "TT", "]"}], "/", 
         RowBox[{"ReplaceAll", "[", 
          RowBox[{"t", ",", " ", 
           RowBox[{"0.", "\[Rule]", "1."}]}], "]"}]}], "]"}], "*", 
       RowBox[{"(", 
        RowBox[{"1.", "-", "\[Rho]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"ReplaceDiagonalReals", "[", 
      RowBox[{"x", ",", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"#", "\[Equal]", "0."}], ",", "1.", ",", "\[Rho]"}], 
           "]"}], "&"}], ",", "t"}], "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.808093547368218*^9, 3.80809356824786*^9}, 
   3.8080936157964153`*^9, 3.808093730522738*^9, {3.808094062553307*^9, 
   3.80809406382518*^9}, 3.808094357783413*^9, {3.808127807699098*^9, 
   3.808127811746667*^9}, 3.808127940453211*^9, {3.8085169104858923`*^9, 
   3.808516911273973*^9}, {3.8090727856981363`*^9, 3.8090727982760267`*^9}, {
   3.8090728296507998`*^9, 3.809072864884*^9}, {3.809073005835248*^9, 
   3.809073049423956*^9}, {3.8090731731215277`*^9, 3.809073173883068*^9}, 
   3.8090732625536346`*^9, {3.8216241290821733`*^9, 3.82162413388229*^9}, {
   3.8223411412416363`*^9, 3.822341141760124*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"6742c770-4354-4231-929c-f0ada24626f6"],

Cell["Unit tests:", "Text",
 CellChangeTimes->{{3.755085357688162*^9, 
  3.755085360162019*^9}},ExpressionUUID->"25be8066-7ca4-4af4-99fa-\
b4c893d470d9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"unitTests", "[", "\"\<NormalizeTernaryT\>\"", "]"}], " ", ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"NormalizeTernaryT", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.9`", ",", "0.09999999999999998`"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "0.09999999999999998`"}], ",", "0.9`"}], "}"}]}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"TestID", "\[Rule]", "\"\<NormalizeTernaryT1\>\""}]}], 
     "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7550841330433683`*^9, 3.755084135437353*^9}, {
   3.7550841708582687`*^9, 3.755084177444426*^9}, {3.75508488110111*^9, 
   3.755084921944516*^9}, {3.755085004683037*^9, 3.755085019160364*^9}, 
   3.755085414831155*^9, {3.755088026631571*^9, 3.755088029426392*^9}, {
   3.755094896785777*^9, 3.7550949414804296`*^9}, {3.8010776985162*^9, 
   3.801077724334634*^9}, {3.8011633921696997`*^9, 3.801163392642374*^9}, {
   3.802430603236143*^9, 3.802430644718812*^9}, {3.802430684147846*^9, 
   3.802430693651062*^9}, {3.802431158681628*^9, 3.802431175048699*^9}, 
   3.808094451406736*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[41]:=",ExpressionUUID->"de89ab68-ea32-422c-a781-071c922e9c76"]
}, Closed]],

Cell[CellGroupData[{

Cell["NormalizeTernaryTactic ", "Subsubsection",
 CellChangeTimes->{{3.8023752772839603`*^9, 3.802375279563321*^9}, {
   3.802375346286888*^9, 3.802375347331963*^9}, {3.802429528292358*^9, 
   3.802429536273375*^9}, {3.80843555149428*^9, 3.8084355690867033`*^9}, 
   3.8084356327599993`*^9, {3.808435711947591*^9, 3.8084357140413523`*^9}, 
   3.808685115669077*^9},ExpressionUUID->"eb5b4d15-ad84-4b9e-9db3-\
4fa1f5bdd905"],

Cell["\<\
Given a ternary tactic vector, convert it to a legal tactic vector. The focal \
agent gets a preset self-allocation, and all of the outgoing allocations are \
apportioned accordingly. Self-allocations on the input tactic are ignored. \
Output: tactic vector.\
\>", "Text",
 CellChangeTimes->{{3.72182927500725*^9, 3.721829291944759*^9}, {
   3.7218298112704287`*^9, 3.721829866830014*^9}, 3.754857819671235*^9, {
   3.755086300837954*^9, 3.75508630464487*^9}, {3.755800031151215*^9, 
   3.755800031647378*^9}, {3.802430372819262*^9, 
   3.802430378554119*^9}},ExpressionUUID->"ecd40e32-6b58-4080-8b42-\
a9cb5b5264b9"],

Cell[TextData[{
 "Compile this (same pattern as ",
 StyleBox["FixSelfAllocation", "Input"],
 ")"
}], "Text",
 CellChangeTimes->{{3.820698824336515*^9, 3.820698840420177*^9}},
 Background->RGBColor[
  1, 0.85, 0.85],ExpressionUUID->"9868d6ab-d26e-4bf1-9fd6-8d1b540c38d5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NormalizeTernaryTactic", "[", 
   RowBox[{"tactic_List", ",", "i_Integer"}], "]"}], ":=", " ", 
  RowBox[{"ReplacePart", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NormalizeTacticCompiled", "[", "tactic", "]"}], " ", "*", " ", 
     RowBox[{"(", 
      RowBox[{"1.", "-", "\[Rho]"}], ")"}]}], ",", 
    RowBox[{"i", "\[Rule]", "\[Rho]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.755036565706621*^9, 3.755036592026376*^9}, {
   3.755036745855489*^9, 3.755036748954224*^9}, {3.755036807997538*^9, 
   3.755036813543141*^9}, {3.7550388983166933`*^9, 3.755038901521715*^9}, {
   3.7551187600518017`*^9, 3.7551187613582067`*^9}, 3.7551191887451487`*^9, {
   3.8010903570024233`*^9, 3.801090366262381*^9}, {3.801091649188361*^9, 
   3.801091652639645*^9}, 3.801163333262727*^9, 3.802430445772275*^9, {
   3.802430729223535*^9, 3.80243072983504*^9}, {3.803896499561098*^9, 
   3.803896502197434*^9}, {3.8086857031802273`*^9, 3.808685711147482*^9}, 
   3.808685807987541*^9, 3.808685974059373*^9},
 CellLabel->"In[42]:=",ExpressionUUID->"4e248999-6fda-4a2e-96eb-6c1d1a29aeff"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Random Power Structures", "Subsection",
 CellChangeTimes->{{3.822478330875486*^9, 
  3.822478343145691*^9}},ExpressionUUID->"e760fc8f-70ca-4c64-a5b6-\
d0951b1e0960"],

Cell[CellGroupData[{

Cell["RandomPowerStructure", "Subsubsection",
 CellChangeTimes->{
  3.6278919441400895`*^9, {3.644078853917965*^9, 3.644078856993073*^9}, 
   3.647885368355063*^9, {3.661112963024188*^9, 3.66111296328378*^9}, {
   3.661120967483095*^9, 3.6611209847008944`*^9}, 3.704287940051653*^9, {
   3.754857407721493*^9, 3.75485740940547*^9}, 3.754857487045141*^9, {
   3.754930030874466*^9, 
   3.7549300345857677`*^9}},ExpressionUUID->"2ecc0880-c683-42a0-9674-\
060966962af2"],

Cell["\<\
Generate a random power structure, specifying the number of nodes (n). By \
convention, the size vector in the first state of a simulation is normalized. \
Output: power structure.\
\>", "Text",
 CellChangeTimes->{{3.627716603982214*^9, 3.627716628790778*^9}, {
   3.6277166623812194`*^9, 3.6277166828098555`*^9}, {3.6278799225059032`*^9, 
   3.6278799504946127`*^9}, 3.6611208724517384`*^9, {3.6611209074029837`*^9, 
   3.6611209310254707`*^9}, {3.7053520812854652`*^9, 3.70535210302413*^9}, {
   3.754857466693098*^9, 3.754857475941832*^9}, {3.754930048138178*^9, 
   3.754930050326964*^9}, {3.7557999869430037`*^9, 3.755799991896553*^9}, {
   3.804172278621086*^9, 
   3.804172288408249*^9}},ExpressionUUID->"566f6f43-24db-4c6b-a071-\
2977eefac2aa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RandomPowerStructure", "[", "n_Integer", "]"}], ":=", " ", 
  RowBox[{"PowerStructure", "[", 
   RowBox[{
    RowBox[{"RandomS", "[", "n", "]"}], ",", 
    RowBox[{"RandomT", "[", "n", "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6277166352520924`*^9, 3.6277166922911944`*^9}, {
   3.6277167786458664`*^9, 3.6277168194220963`*^9}, {3.627722955015895*^9, 
   3.6277229587714105`*^9}, {3.644077705561212*^9, 3.6440777105186653`*^9}, 
   3.656357208631587*^9, {3.656357267029236*^9, 3.65635727484309*^9}, {
   3.6611207563771963`*^9, 3.661120789060957*^9}, {3.661120831516164*^9, 
   3.6611208318182507`*^9}, {3.661351752856061*^9, 3.661351778725481*^9}, {
   3.661558947176117*^9, 3.661558954007531*^9}, {3.665093646514216*^9, 
   3.665093700023489*^9}, {3.665093814326667*^9, 3.665093816287241*^9}, {
   3.665093906858342*^9, 3.665093909231789*^9}, {3.673301303955235*^9, 
   3.67330130721707*^9}, 3.673302061842124*^9, {3.6734307196689873`*^9, 
   3.6734307225507927`*^9}, {3.6734308222640667`*^9, 3.673430839603198*^9}, {
   3.673430870698122*^9, 3.673430916322979*^9}, {3.673430954848942*^9, 
   3.6734310155960083`*^9}, {3.67345791516455*^9, 3.673457936819441*^9}, {
   3.674134788788311*^9, 3.6741347894200172`*^9}, {3.6747517897229652`*^9, 
   3.674751793695509*^9}, {3.6756041064365892`*^9, 3.675604168860093*^9}, {
   3.675604206174737*^9, 3.675604240488626*^9}, {3.675604353470484*^9, 
   3.6756044021455812`*^9}, 3.6756044415412407`*^9, {3.686723810138239*^9, 
   3.686723844283762*^9}, {3.686723912873129*^9, 3.686723922467502*^9}, 
   3.6871276895899067`*^9, {3.7038889445675793`*^9, 3.703888970201421*^9}, {
   3.705352114778905*^9, 3.705352119657754*^9}, {3.754857412192873*^9, 
   3.75485743872511*^9}, {3.754857491766026*^9, 3.7548575123976297`*^9}, 
   3.754930002068129*^9, 3.754930054254426*^9, {3.804172295538699*^9, 
   3.804172299533173*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"82127684-67fd-44fd-b520-ef73e0f7cae2"]
}, Closed]],

Cell[CellGroupData[{

Cell["RandomS", "Subsubsection",
 CellChangeTimes->{{3.808437192948846*^9, 
  3.8084371941231413`*^9}},ExpressionUUID->"d8f424fd-2465-4a68-bac0-\
c87e19b08cbf"],

Cell[TextData[{
 "Creates a random size vector for ",
 StyleBox["n", "Input"],
 " agents, normalized to unity. Output: size vector."
}], "Text",
 CellChangeTimes->{{3.7548537645436497`*^9, 3.7548537773989077`*^9}, {
  3.755799975693853*^9, 
  3.7557999799434853`*^9}},ExpressionUUID->"820ac0b6-b306-4896-8f26-\
737764da7627"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RandomS", "[", "n_Integer", "]"}], ":=", " ", 
  RowBox[{"NormalizeS", "[", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", "n"}], "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.754853318692387*^9, 3.754853395518837*^9}, {
  3.754853980934988*^9, 3.754853981721686*^9}, {3.754854814286764*^9, 
  3.7548548150996*^9}, {3.801083746247527*^9, 3.801083758792429*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"78801d66-0068-47e6-850b-0958933da4c5"],

Cell["Unit tests:", "Text",
 CellChangeTimes->{{3.755085357688162*^9, 
  3.755085360162019*^9}},ExpressionUUID->"88c357ae-c049-45dd-810e-\
b90d9fd7fb5d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"unitTests", "[", "\"\<RandomS\>\"", "]"}], " ", ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Max", "[", 
       RowBox[{"RandomS", "[", "5", "]"}], "]"}], ",", "\[IndentingNewLine]", 
      "1.", ",", "\[IndentingNewLine]", 
      RowBox[{"TestID", "\[Rule]", "\"\<RandomS1\>\""}]}], 
     "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7550841330433683`*^9, 3.755084135437353*^9}, {
   3.7550841708582687`*^9, 3.755084177444426*^9}, {3.75508488110111*^9, 
   3.755084921944516*^9}, {3.755085004683037*^9, 3.755085019160364*^9}, {
   3.755085236775576*^9, 3.7550852605358467`*^9}, {3.755085299455575*^9, 
   3.7550853362271223`*^9}, 3.755085432033588*^9, {3.755085559417843*^9, 
   3.755085605499104*^9}, {3.755085657127652*^9, 3.755085684055829*^9}, {
   3.7550857227312603`*^9, 3.755085757850277*^9}, {3.755085791385973*^9, 
   3.755085806043363*^9}, {3.755085848538776*^9, 3.7550858726824923`*^9}, {
   3.755085921688486*^9, 3.755085975595923*^9}, {3.755086010930608*^9, 
   3.755086084763026*^9}, {3.75508793444206*^9, 3.755087937378335*^9}, {
   3.801083851917948*^9, 3.801083857003615*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[45]:=",ExpressionUUID->"85c9f8a7-593f-4374-b985-6a30f0f8ae4c"]
}, Closed]],

Cell[CellGroupData[{

Cell["RandomTactic", "Subsubsection",
 CellChangeTimes->{{3.754826913801381*^9, 3.754826916187499*^9}, {
   3.754855200053014*^9, 3.754855200881139*^9}, 
   3.804162003966209*^9},ExpressionUUID->"2e80c3c9-f865-46b6-ba32-\
6e33f96849ab"],

Cell["\<\
Generates a random tactic vector. Note that this may entail self-harm. \
Output: tactic vector.\
\>", "Text",
 CellChangeTimes->{{3.754854874255307*^9, 3.7548549022074337`*^9}, {
  3.755799873894764*^9, 
  3.755799874232149*^9}},ExpressionUUID->"25054d41-0608-46c5-921c-\
1de798149a75"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RandomTactic", "[", "n_Integer", "]"}], ":=", 
  RowBox[{"NormalizeTactic", "[", 
   RowBox[{"RandomPoint", "[", 
    RowBox[{"Sphere", "[", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", "n"}], "]"}], "]"}], "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7208255632327547`*^9, 3.7208256391763487`*^9}, {
  3.720826528826228*^9, 3.7208265297882285`*^9}, {3.75485472877743*^9, 
  3.754854782062243*^9}, {3.7548549828305407`*^9, 3.7548549836339293`*^9}, {
  3.804162010584504*^9, 3.804162029244647*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"655b3504-977d-4b39-84f6-1d30b97abbba"],

Cell["\<\
Generates a random tactic vector in which a specified agent is not harming \
itself. The allocation to the focal agent is at least \[Rho]. Output: tactic \
vector.\
\>", "Text",
 CellChangeTimes->{{3.720827955467896*^9, 3.720827983498523*^9}, {
  3.754854925642741*^9, 3.7548549475969276`*^9}, {3.755799876069839*^9, 
  3.7557998764416637`*^9}, {3.756043702502447*^9, 
  3.756043728024047*^9}},ExpressionUUID->"c6bbb1e4-9dce-478e-9eae-\
12bc7e94ca08"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RandomTactic", "[", 
   RowBox[{"n_Integer", ",", "index_Integer"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{"\[Rho]", ",", "1"}], "}"}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Insert", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "a"}], ")"}], 
       RowBox[{"RandomTactic", "[", 
        RowBox[{"n", "-", "1"}], "]"}]}], ",", "a", ",", "index"}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7208255632327547`*^9, 3.7208256391763487`*^9}, {
   3.720826528826228*^9, 3.7208265297882285`*^9}, {3.75485472877743*^9, 
   3.7548547330065117`*^9}, {3.754854988479024*^9, 3.754854989429923*^9}, 
   3.754855289716732*^9, {3.7548553391000853`*^9, 3.754855340332735*^9}, {
   3.754855507619267*^9, 3.754855533066737*^9}, {3.754855630043507*^9, 
   3.754855630859475*^9}, {3.755119669955501*^9, 3.755119670995346*^9}, {
   3.7557866840621853`*^9, 3.755786688183839*^9}, {3.7560402844856253`*^9, 
   3.756040293050025*^9}, {3.804162014060232*^9, 3.804162015023292*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"d827cbdd-c066-430d-8b38-32bb44601d12"],

Cell["Unit tests:", "Text",
 CellChangeTimes->{{3.755085357688162*^9, 
  3.755085360162019*^9}},ExpressionUUID->"e80d08a5-0a72-4a30-9aa1-\
a52127a93016"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"unitTests", "[", "\"\<RandomTactic\>\"", "]"}], " ", ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LegalTacticQ", "[", 
        RowBox[{"RandomTactic", "[", "5", "]"}], "]"}], ",", 
       "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
       RowBox[{"TestID", "\[Rule]", "\"\<RandomTacticVector1\>\""}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"First", "[", 
         RowBox[{"RandomTactic", "[", 
          RowBox[{"5", ",", "1"}], "]"}], "]"}], ">", "0"}], ",", 
       "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
       RowBox[{"TestID", "\[Rule]", "\"\<RandomTacticVector2\>\""}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7550841330433683`*^9, 3.755084135437353*^9}, {
   3.7550841708582687`*^9, 3.755084177444426*^9}, {3.75508488110111*^9, 
   3.755084921944516*^9}, {3.755085004683037*^9, 3.755085019160364*^9}, {
   3.755085236775576*^9, 3.7550852605358467`*^9}, {3.755085299455575*^9, 
   3.7550853362271223`*^9}, 3.755085432033588*^9, {3.7550880066191483`*^9, 
   3.755088009238163*^9}, 3.755119701738057*^9, {3.8041620171084547`*^9, 
   3.804162037452044*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[48]:=",ExpressionUUID->"d01b6b38-7eb0-4e2d-9a05-ca6823fa4402"]
}, Closed]],

Cell[CellGroupData[{

Cell["RandomT", "Subsubsection",
 CellChangeTimes->{{3.7548269772831078`*^9, 3.754826979712179*^9}, {
   3.754856508748313*^9, 3.754856509753202*^9}, 
   3.8041721134738407`*^9},ExpressionUUID->"f9affc49-91d0-40fd-ac8c-\
711f62964e8f"],

Cell[TextData[{
 "Generates a random tactic matrix for ",
 StyleBox["n", "Input"],
 " agents. Output: tactic matrix."
}], "Text",
 CellChangeTimes->{{3.754856706079275*^9, 3.754856716545257*^9}, {
  3.755799910540742*^9, 
  3.755799916277315*^9}},ExpressionUUID->"01f97a09-488c-40c7-8fc8-\
c8134586b5dc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RandomT", "[", "n_Integer", "]"}], " ", ":=", 
  RowBox[{"Transpose", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomTactic", "[", 
      RowBox[{"n", ",", "i"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "n"}], "}"}]}], "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.72125361033244*^9, 3.7212536507556887`*^9}, 
   3.754856511865924*^9, {3.754856722579459*^9, 3.754856750722517*^9}, {
   3.7548567931865873`*^9, 3.754856796661397*^9}, {3.754856922151009*^9, 
   3.754856923003478*^9}, {3.754856981385087*^9, 3.754856984810362*^9}, {
   3.804172116599025*^9, 3.80417212278498*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"fd1f6a41-1b95-47e6-9781-67cee9aefa05"],

Cell["Unit tests:", "Text",
 CellChangeTimes->{{3.755085357688162*^9, 
  3.755085360162019*^9}},ExpressionUUID->"fdcc0722-f0fa-4dc4-88d2-\
17d573b2730e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"unitTests", "[", "\"\<RandomTacticMatrix\>\"", "]"}], " ", ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"LegalTQ", "[", 
       RowBox[{"RandomT", "[", "3", "]"}], "]"}], ",", "\[IndentingNewLine]", 
      "True", ",", "\[IndentingNewLine]", 
      RowBox[{"TestID", "\[Rule]", "\"\<RandomTacticMatrix1\>\""}]}], 
     "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7550841330433683`*^9, 3.755084135437353*^9}, {
   3.7550841708582687`*^9, 3.755084177444426*^9}, {3.75508488110111*^9, 
   3.755084921944516*^9}, {3.755085004683037*^9, 3.755085019160364*^9}, {
   3.755085236775576*^9, 3.7550852605358467`*^9}, {3.755085299455575*^9, 
   3.7550853362271223`*^9}, 3.755085432033588*^9, {3.755085559417843*^9, 
   3.755085605499104*^9}, {3.755085657127652*^9, 3.755085684055829*^9}, {
   3.7550857227312603`*^9, 3.755085757850277*^9}, {3.755087978510264*^9, 
   3.7550879813734703`*^9}, {3.755119767327677*^9, 3.755119773942486*^9}, {
   3.804172128213621*^9, 3.804172135883445*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[50]:=",ExpressionUUID->"3276fdcc-651d-4b72-a6f4-53cb29f47e3f"]
}, Closed]],

Cell[CellGroupData[{

Cell["RandomTernaryPowerStructure", "Subsubsection",
 CellChangeTimes->{{3.796221508609517*^9, 3.796221514659994*^9}, {
   3.79622904540075*^9, 3.796229046196447*^9}, 3.8010838859596024`*^9, 
   3.80108401869071*^9, 
   3.8011630771244497`*^9},ExpressionUUID->"c09796df-0b88-4cf8-81c8-\
22e229ac78ab"],

Cell["\<\
Generate a random power structure, of size n, with symmetric ternary edges \
and small-world connectivity. Output: power structure.\
\>", "Text",
 CellChangeTimes->{{3.7962215242537203`*^9, 3.7962215406437397`*^9}, {
  3.796851963870482*^9, 3.796851969963531*^9}, {3.8011631136160107`*^9, 
  3.80116311792273*^9}},ExpressionUUID->"a84d0564-a5cf-45b8-8027-\
af3e81ccf546"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RandomTernaryPowerStructure", "[", "n_Integer", "]"}], ":=", 
  RowBox[{"RandomTernaryPowerStructure", "[", 
   RowBox[{"n", ",", 
    RowBox[{"2", "n"}], ",", "0.1"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.796851667176853*^9, 3.796851743091979*^9}, {
  3.796851858316976*^9, 3.796851859081624*^9}, {3.80108387933638*^9, 
  3.8010838922869453`*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"9533717c-a028-4ce0-9e21-73ef8de49264"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RandomTernaryPowerStructure", "[", 
   RowBox[{"n_Integer", ",", "edges_Integer", ",", "negativity_Real"}], "]"}],
   ":=", 
  RowBox[{"PowerStructureR", "[", 
   RowBox[{
    RowBox[{"RandomS", "[", "n", "]"}], ",", 
    RowBox[{"RandomTernaryT", "[", 
     RowBox[{"n", ",", "edges", ",", "negativity"}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.796851667176853*^9, 3.796851702481245*^9}, {
   3.796851862602276*^9, 3.7968518665609083`*^9}, 3.801083751040411*^9, 
   3.801083844323194*^9, 3.801083888582253*^9, {3.808435939456296*^9, 
   3.8084359420719233`*^9}, {3.822480734963876*^9, 3.8224807402073603`*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"51460cbf-ba19-4656-a0e4-c721df9dfe18"]
}, Closed]],

Cell[CellGroupData[{

Cell["RandomTernaryT", "Subsubsection",
 CellChangeTimes->{{3.801166062154512*^9, 3.801166065401816*^9}, 
   3.8224786805477552`*^9},ExpressionUUID->"0d0c48df-fde4-43d2-97d9-\
a78f5e867780"],

Cell[TextData[{
 "Generate a random symmetric ternary tactic matrix of size ",
 StyleBox["n", "Input"],
 ", with a given number of edges, some percentage of which are negative. This \
function piggybacks on ",
 StyleBox["RandomGraph", "Input"],
 " to generate a small-world graph with a given number of nodes and edges. \
Output: tactic matrix."
}], "Text",
 CellChangeTimes->{{3.796832566088626*^9, 3.79683260545319*^9}, {
   3.7968497180295486`*^9, 3.7968497545235987`*^9}, {3.796849830204949*^9, 
   3.7968498532702837`*^9}, {3.796849884157516*^9, 3.796849891552992*^9}, 
   3.796851112138688*^9, {3.796851818538796*^9, 
   3.7968518381675577`*^9}},ExpressionUUID->"65bdde95-9385-4018-90e5-\
507f39cd3bd0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RandomTernaryT", "[", "n_Integer", "]"}], ":=", 
  RowBox[{"RandomTernaryT", "[", 
   RowBox[{"n", ",", 
    RowBox[{"2", "n"}], ",", "0.1"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.801165996836048*^9, 3.801166020140954*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"ede7e7f0-b64e-4801-bc8a-2fc01a07244c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RandomTernaryT", "[", 
   RowBox[{"n_Integer", ",", "edges_Integer", ",", "negativity_Real"}], "]"}],
   ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"T", ",", 
      RowBox[{"g", "=", 
       RowBox[{"RandomGraph", "[", 
        RowBox[{"{", 
         RowBox[{"n", ",", "edges"}], "}"}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"T", "=", 
      RowBox[{"Normal", "[", 
       RowBox[{"SparseArray", "[", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", " ", 
             RowBox[{"RandomChoice", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"negativity", ",", 
                 RowBox[{"1", "-", "negativity"}]}], "}"}], "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1."}], ",", "1."}], "}"}]}], "]"}]}], "&"}], 
           ",", 
           RowBox[{"Drop", "[", 
            RowBox[{
             RowBox[{"ArrayRules", "[", 
              RowBox[{"UpperTriangularize", "[", 
               RowBox[{"AdjacencyMatrix", "[", "g", "]"}], "]"}], "]"}], ",", 
             
             RowBox[{"-", "1"}]}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "n"}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"N", "[", 
      RowBox[{"T", "+", 
       RowBox[{"Transpose", "[", "T", "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.796830276253199*^9, 3.796830286526082*^9}, {
   3.796830372161745*^9, 3.796830378343092*^9}, {3.796830419885601*^9, 
   3.796830438362981*^9}, 3.796831789270012*^9, {3.796832665752548*^9, 
   3.796832700421194*^9}, 3.79683273288306*^9, {3.7968499348603373`*^9, 
   3.7968499424105988`*^9}, {3.796850370909976*^9, 3.796850395513981*^9}, {
   3.796850439257182*^9, 3.796850453515562*^9}, {3.7968506618854227`*^9, 
   3.796850662930633*^9}, {3.7968507213071012`*^9, 3.79685072887535*^9}, {
   3.79685094653611*^9, 3.796850947468034*^9}, {3.7968509893969393`*^9, 
   3.796850990168664*^9}, 3.7968510232967377`*^9, {3.796851055590591*^9, 
   3.796851063398066*^9}, 3.801083849521549*^9, 3.801163070156027*^9, {
   3.808485415868792*^9, 3.808485429232205*^9}, {3.808485461067813*^9, 
   3.808485463304563*^9}, 3.808485499642239*^9},
 CellLabel->"In[54]:=",ExpressionUUID->"324f85c1-76b5-4a3f-91c5-712ed26c3ebb"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Manipulating Tactics", "Subsection",
 CellChangeTimes->{{3.754823700922165*^9, 3.754823715290255*^9}, {
  3.822477066030527*^9, 
  3.8224770678651342`*^9}},ExpressionUUID->"839559cd-c490-402c-acd5-\
535fe6ddbeac"],

Cell[CellGroupData[{

Cell["GravitizeTernaryT", "Subsubsection",
 CellChangeTimes->{
  3.8120523054673433`*^9},ExpressionUUID->"b68fefcc-3720-4341-9fe0-\
12186ee379c5"],

Cell["\<\
Given a ternary tactic matrix, adjust the allocations to make them \
proportional to the sizes of the agents. The resulting allocations will be \
akin to a gravity model of trade. Output: tactic matrix.\
\>", "Text",
 CellChangeTimes->{{3.8120514929399147`*^9, 3.8120515354444036`*^9}, {
  3.8120522086725483`*^9, 
  3.8120522519931383`*^9}},ExpressionUUID->"74bbc5bf-1ebd-4251-9293-\
493d758b07f5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GravitizeTernaryT", "[", 
   RowBox[{"TT_", ",", "s_"}], "]"}], ":=", 
  RowBox[{"NormalizeTernaryT", "[", 
   RowBox[{"s", "*", "TT"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.812051471107965*^9, 3.812051489473475*^9}, {
  3.8120515773644648`*^9, 3.8120515796161413`*^9}, {3.8120521472672453`*^9, 
  3.812052157596567*^9}, {3.82162415625594*^9, 3.8216241590401287`*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"7528b720-5639-48df-8496-bf5d99a25e15"],

Cell["\<\
A second form of gravitization gives each relationship a fixed amount of \
potential power that\[CloseCurlyQuote]s proportional to the other agents\
\[CloseCurlyQuote] sizes. The tactic vector is then normalized by allocating \
all unused power back to each agent. Output: tactic vector.\
\>", "Text",
 CellChangeTimes->{{3.815401889877002*^9, 3.815401940338389*^9}, {
  3.815402311759156*^9, 
  3.815402323038365*^9}},ExpressionUUID->"59c8c2f5-f9a3-4195-8da3-\
be6834eb490e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GravitizeTernaryTactic", "[", 
   RowBox[{"tactic_", ",", "s_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"ReplacePart", "[", 
   RowBox[{
    RowBox[{"tactic", "*", "s", "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Rho]"}], ")"}], "/", 
      RowBox[{"Total", "[", "s", "]"}]}]}], ",", 
    RowBox[{"i", "\[Rule]", 
     RowBox[{"1", "-", 
      RowBox[{"Total", "[", 
       RowBox[{"Abs", "[", "tactic", "]"}], "]"}]}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.815401464937978*^9, 3.815401480937256*^9}, {
  3.8154017092626143`*^9, 3.8154017188440647`*^9}, {3.82247750757403*^9, 
  3.8224775152229137`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"fe79a586-2730-45f3-b374-179d73c68b30"],

Cell["\<\
Applies the second form of gravitization to a tactic matrix. Output: tactic \
matrix.\
\>", "Text",
 CellChangeTimes->{{3.815402328540268*^9, 
  3.815402345194605*^9}},ExpressionUUID->"241ce7b2-2b2c-43b5-b6e5-\
61a70ef5179c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GravitizeTernaryT", "[", 
   RowBox[{"TT_", ",", "s_"}], "]"}], ":=", 
  RowBox[{"Transpose", "[", 
   RowBox[{"MapIndexed", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"GravitizeTernaryTactic", "[", 
       RowBox[{"#", ",", "s", ",", 
        RowBox[{"First", "[", "#2", "]"}]}], "]"}], "&"}], ",", 
     RowBox[{"Transpose", "[", "TT", "]"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.812051471107965*^9, 3.812051489473475*^9}, {
  3.8120515773644648`*^9, 3.8120515796161413`*^9}, {3.8120521472672453`*^9, 
  3.812052157596567*^9}, {3.815402181272551*^9, 3.8154022438543053`*^9}, {
  3.8216241621429243`*^9, 3.821624164048952*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"2c859201-3c03-4e01-a48d-564643af1aed"]
}, Closed]],

Cell[CellGroupData[{

Cell["ReciprocalizeT", "Subsubsection",
 CellChangeTimes->{
  3.820317090888475*^9},ExpressionUUID->"13556158-5359-4c5a-9ed6-\
389ec5de6d70"],

Cell["\<\
Given a move matrix M, return a tactic matrix such that for each pair of \
agents, the relationship is made reciprocal to the more negative of the two \
transfers of power. The amount transferred is based on the percentage of \
power allocated times the size of the allocating agent. The motivation for \
this function is to try to equalize the amount of flow between any two \
agents. Note that perfect reciprocity is often not achieved due to size \
differences. Output: tactic matrix.\
\>", "Text",
 CellChangeTimes->{{3.8203169970986357`*^9, 3.8203170852062073`*^9}, {
  3.820328469922967*^9, 3.820328495746046*^9}, {3.820408909766342*^9, 
  3.820408991279378*^9}, {3.8204090623105087`*^9, 3.8204090696517487`*^9}, {
  3.8204118878932543`*^9, 
  3.82041189593008*^9}},ExpressionUUID->"fa82e1cd-d6c5-4f1f-939d-\
2def57b9a5f4"],

Cell["\<\
Processing steps:
(a) Transpose, normalize the ternary T, and multiply it by s;
(b) Symmetrize the T;
(c) Divide the T by s;
(d) Fix the self-allocations and transpose back;\
\>", "Text",
 CellChangeTimes->{{3.82077531805373*^9, 3.820775351565185*^9}, {
  3.820775460644238*^9, 3.820775495107656*^9}, {3.8207756740626287`*^9, 
  3.820775697165202*^9}, {3.820775962366848*^9, 3.820775980473193*^9}, {
  3.820776020399989*^9, 3.820776034402409*^9}, {3.820776123304762*^9, 
  3.8207761508378696`*^9}},ExpressionUUID->"29694a1f-4b8a-4fbb-b70b-\
1c43a7dcb064"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReciprocalizeT", "[", 
   RowBox[{"s_", ",", "M_"}], "]"}], ":=", 
  RowBox[{"Transpose", "[", 
   RowBox[{"MapIndexed", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"FixSelfAllocation", "[", 
       RowBox[{"#", ",", 
        RowBox[{"First", "[", "#2", "]"}], ",", "\[Rho]"}], "]"}], "&"}], ",", 
     RowBox[{"ReciprocalizeTCompiled", "[", 
      RowBox[{"s", ",", "M", ",", "\[Rho]"}], "]"}]}], "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.820316980400601*^9, 3.820316994009666*^9}, 
   3.820317129648231*^9, 3.820328227477436*^9, 3.820406912843152*^9, 
   3.820407474328147*^9, 3.820407672280821*^9, {3.820412723294245*^9, 
   3.820412724162154*^9}, {3.820430258849889*^9, 3.8204302769837523`*^9}, 
   3.8205739766513853`*^9, {3.820585174678985*^9, 3.820585177251894*^9}, {
   3.820690825693696*^9, 3.8206908314323378`*^9}, 3.820691217721266*^9, {
   3.8206955164770107`*^9, 3.820695517530854*^9}, 3.8207516374110003`*^9, 
   3.820751688479042*^9, {3.8207775706946363`*^9, 3.820777591916069*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"103fc6d3-aada-4df2-a0f4-2b2bb04ec184"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReciprocalizeTCompiled", "=", 
   RowBox[{"FunctionCompile", "[", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Typed", "[", 
         RowBox[{"s", ",", 
          RowBox[{
           RowBox[{"TypeSpecifier", "[", "\"\<PackedArray\>\"", "]"}], "[", 
           RowBox[{"\"\<Real64\>\"", ",", "1"}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Typed", "[", 
         RowBox[{"M", ",", 
          RowBox[{
           RowBox[{"TypeSpecifier", "[", "\"\<PackedArray\>\"", "]"}], "[", 
           RowBox[{"\"\<Real64\>\"", ",", "2"}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Typed", "[", 
         RowBox[{"\[Rho]", ",", 
          RowBox[{"TypeSpecifier", "[", "\"\<Real64\>\"", "]"}]}], "]"}]}], 
       "\[IndentingNewLine]", "}"}], ",", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"a", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1.", "-", "\[Rho]"}], ")"}], 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Block", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"t", "=", 
                  RowBox[{"Total", "[", 
                   RowBox[{"Abs", "[", "#", "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"t", "\[Equal]", "0"}], ",", "#", ",", 
                  RowBox[{"#", " ", "/", " ", "t"}]}], "]"}]}], "]"}], "&"}], 
             ",", 
             RowBox[{"Transpose", "[", "M", "]"}]}], "]"}], "*", "s"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"b", "=", 
          RowBox[{"a", "-", 
           RowBox[{"Ramp", "[", 
            RowBox[{"a", "-", 
             RowBox[{"Transpose", "[", "a", "]"}]}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"c", "=", 
          RowBox[{"MapIndexed", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"s", "[", 
                 RowBox[{"[", 
                  RowBox[{"First", "[", "#2", "]"}], "]"}], "]"}], "\[Equal]",
                 "0."}], ",", "#", ",", 
               RowBox[{"#", "/", 
                RowBox[{"s", "[", 
                 RowBox[{"[", 
                  RowBox[{"First", "[", "#2", "]"}], "]"}], "]"}]}]}], "]"}], 
             "&"}], ",", "b"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "c", "]"}]}]}], "\[IndentingNewLine]", 
       "]"}]}], "]"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.649206144851355*^9, 3.649206148651795*^9}, {
   3.661121352574053*^9, 3.661121387218481*^9}, 3.674430201672263*^9, 
   3.6744681680692673`*^9, 3.686726631590466*^9, {3.8023774606781273`*^9, 
   3.802377472443514*^9}, {3.802377502855513*^9, 3.802377598050089*^9}, {
   3.802384399165329*^9, 3.8023844445581217`*^9}, {3.8023845844312773`*^9, 
   3.802384586152059*^9}, {3.8024325400696173`*^9, 3.802432540271508*^9}, {
   3.802432585964978*^9, 3.802432634315682*^9}, {3.8024327660407953`*^9, 
   3.802432771873838*^9}, {3.82069140747534*^9, 3.820691436183511*^9}, {
   3.820692180431735*^9, 3.8206922189554453`*^9}, {3.820695333801441*^9, 
   3.820695375992999*^9}, 3.820695622162567*^9, {3.820775170429985*^9, 
   3.820775199597658*^9}, {3.8207752367625217`*^9, 3.82077530445872*^9}, {
   3.820775499772159*^9, 3.820775518767933*^9}, {3.820775553266056*^9, 
   3.8207755759941273`*^9}, {3.820775700171309*^9, 3.8207757512020063`*^9}, {
   3.82077582388249*^9, 3.820775837148424*^9}, {3.820775987272436*^9, 
   3.82077600735297*^9}, {3.8207760420952272`*^9, 3.820776050096283*^9}, {
   3.820776081008793*^9, 3.82077611708183*^9}, {3.820776234551551*^9, 
   3.8207762500988092`*^9}, {3.820776291074181*^9, 3.82077631485713*^9}, {
   3.820776391575355*^9, 3.820776411606811*^9}, {3.82077649860636*^9, 
   3.820776521449979*^9}, {3.820776677235483*^9, 3.820776703823592*^9}, 
   3.820777041485921*^9, {3.820777073308807*^9, 3.820777102156268*^9}, {
   3.820777146568554*^9, 3.820777175054722*^9}, {3.820777345587538*^9, 
   3.8207773631595583`*^9}, {3.820777538761446*^9, 3.8207775425699987`*^9}, {
   3.8207780560823927`*^9, 3.82077807272199*^9}, 3.820778590000453*^9},
 CellLabel->"In[57]:=",ExpressionUUID->"939f7989-5312-4ef3-a2d1-92ef4a2573f6"],

Cell["\<\
If total > 1-\[Rho], normalize; else, insert self-allocation. Assumes that \
the self-allocated amount is 0. Output: tactic vector.\
\>", "Text",
 CellChangeTimes->{{3.8204119861377363`*^9, 3.8204120287766647`*^9}, {
  3.820412086098865*^9, 3.820412107864511*^9}, {3.8204127575366077`*^9, 
  3.820412765768725*^9}},ExpressionUUID->"40c1af07-ac82-4199-9868-\
a8ad44b57272"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FixSelfAllocation", "=", 
   RowBox[{"FunctionCompile", "[", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Typed", "[", 
         RowBox[{"tactic", ",", 
          RowBox[{
           RowBox[{"TypeSpecifier", "[", "\"\<PackedArray\>\"", "]"}], "[", 
           RowBox[{"\"\<Real64\>\"", ",", "1"}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Typed", "[", 
         RowBox[{"i", ",", 
          RowBox[{"TypeSpecifier", "[", "\"\<MachineInteger\>\"", "]"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Typed", "[", 
         RowBox[{"\[Rho]", ",", 
          RowBox[{"TypeSpecifier", "[", "\"\<Real64\>\"", "]"}]}], "]"}]}], 
       "\[IndentingNewLine]", "}"}], ",", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"t", "=", 
           RowBox[{"Total", "[", 
            RowBox[{"Abs", "[", "tactic", "]"}], "]"}]}], ",", 
          RowBox[{"r", "=", "tactic"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"t", "\[LessEqual]", " ", 
            RowBox[{"1.", "-", "\[Rho]"}]}], ",", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{"1.", "-", "t"}]}], ",", 
           RowBox[{
            RowBox[{"r", "=", 
             RowBox[{
              RowBox[{"r", " ", "/", " ", "t"}], " ", "*", " ", 
              RowBox[{"(", 
               RowBox[{"1.", "-", "\[Rho]"}], ")"}]}]}], ";", 
            RowBox[{
             RowBox[{"r", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "=", "\[Rho]"}], ";"}]}], "]"}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "r", "]"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}]}], "\[IndentingNewLine]", "]"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.649206144851355*^9, 3.649206148651795*^9}, {
   3.661121352574053*^9, 3.661121387218481*^9}, 3.674430201672263*^9, 
   3.6744681680692673`*^9, 3.686726631590466*^9, {3.8023774606781273`*^9, 
   3.802377472443514*^9}, {3.802377502855513*^9, 3.802377598050089*^9}, {
   3.802384399165329*^9, 3.8023844445581217`*^9}, {3.8023845844312773`*^9, 
   3.802384586152059*^9}, {3.8024325400696173`*^9, 3.802432540271508*^9}, {
   3.802432585964978*^9, 3.802432634315682*^9}, {3.8024327660407953`*^9, 
   3.802432771873838*^9}, {3.82069140747534*^9, 3.820691436183511*^9}, {
   3.820692180431735*^9, 3.8206922189554453`*^9}, {3.820695333801441*^9, 
   3.820695375992999*^9}, 3.820695622162567*^9, {3.8206965939930077`*^9, 
   3.8206966373703003`*^9}, {3.820696714401352*^9, 3.8206967363900146`*^9}, {
   3.8206967793247833`*^9, 3.8206968127444677`*^9}, {3.820697279269178*^9, 
   3.8206973361606607`*^9}, {3.820697401935298*^9, 3.8206975656221743`*^9}, {
   3.8206983113037653`*^9, 3.820698326642881*^9}, {3.820698428365728*^9, 
   3.820698429328849*^9}, {3.820698583472868*^9, 3.820698620618713*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"b2079691-a687-40a9-a503-1fa04e440f89"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Rho]", "=", ".9"}], ";", 
  RowBox[{
   RowBox[{"ReciprocalizeT", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1.", ",", ".3", ",", ".2", ",", ".4"}], "}"}], ",", 
     RowBox[{"N", "[", 
      RowBox[{"(", GridBox[{
         {"0", "1", "1", "1"},
         {"1", "0", "0", "0"},
         {"1", 
          RowBox[{"-", "1"}], "0", "0"},
         {"1", "0", "0", "0"}
        },
        GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}}], ")"}], "]"}]}], "]"}], "//", 
   "Pretty"}]}]], "Input",
 CellChangeTimes->{{3.820408413842256*^9, 3.8204084358706408`*^9}, {
   3.820408524634564*^9, 3.8204085256112967`*^9}, {3.820408571512598*^9, 
   3.820408572867155*^9}, {3.8204110475942917`*^9, 3.820411063069254*^9}, {
   3.82041114345368*^9, 3.8204111872505703`*^9}, {3.820412730759459*^9, 
   3.820412735929891*^9}, {3.820412840619752*^9, 3.8204128495934*^9}, 
   3.820430392265373*^9, {3.820431635404428*^9, 3.820431636744761*^9}, 
   3.820574275814405*^9, {3.8205743623292627`*^9, 3.820574366394829*^9}, {
   3.820574507961142*^9, 3.820574510977558*^9}, {3.820576758429908*^9, 
   3.820576758656877*^9}, {3.820585166512762*^9, 3.8205851702120543`*^9}, 
   3.820695553917025*^9},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[560]:=",ExpressionUUID->"ae291f37-ac1d-4be7-b1fc-641ba94cecc6"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.932`", "0.05`", "0.057`", "0.083`"},
     {"0.015`", "0.9`", 
      RowBox[{"-", "0.043000000000000003`"}], "0.`"},
     {"0.02`", 
      RowBox[{"-", "0.05`"}], "0.9`", "0.`"},
     {"0.033`", "0.`", "0.`", "0.917`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.820408436296319*^9, 3.820408526019753*^9, 3.820408573350094*^9, {
   3.8204110488062897`*^9, 3.820411064372732*^9}, {3.820411129729225*^9, 
   3.820411188327485*^9}, {3.820412727613926*^9, 3.820412736717358*^9}, {
   3.820412841629869*^9, 3.820412850189602*^9}, 3.820430311436966*^9, {
   3.820430378358567*^9, 3.820430393028825*^9}, 3.8204316375048323`*^9, 
   3.8205742764053926`*^9, {3.820574362791829*^9, 3.820574367125224*^9}, 
   3.820574511565703*^9, 3.820576647471929*^9, {3.820576697692881*^9, 
   3.820576709498898*^9}, 3.82057675906565*^9, {3.820585171104814*^9, 
   3.8205851803229*^9}, 3.8206898745731993`*^9, 3.820690892809992*^9, 
   3.820691221243992*^9, 3.8206955583984528`*^9, 3.820695640244109*^9, {
   3.820696567679202*^9, 3.820696573573893*^9}, 3.8206985723397427`*^9, 
   3.820698745649824*^9, 3.820751649116988*^9, 3.820751696404808*^9, 
   3.820778631481636*^9},
 CellLabel->
  "Out[560]//MatrixForm=",ExpressionUUID->"7946d931-1d8f-41db-bfdd-\
97a36f01dae3"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["SymmetrizeT", "Subsubsection",
 CellChangeTimes->{
  3.783008418558445*^9, {3.796942813971567*^9, 3.796942815011319*^9}, 
   3.801089995425584*^9},ExpressionUUID->"a0845bc2-ef2d-479a-8f9a-\
69b7395f39d0"],

Cell["\<\
Given an asymmetric ternary tactic matrix that reflects each agents\
\[CloseCurlyQuote] desired move, find T where the applicable relationship is \
the minimum of each set of pairwise moves.\
\>", "Text",
 CellChangeTimes->{{3.783008230160849*^9, 3.783008313333169*^9}, {
  3.7830108012709703`*^9, 
  3.7830108031633873`*^9}},ExpressionUUID->"a6ee423f-bc98-4d05-b11f-\
01b326cc68ad"],

Cell["Rename: SymmetrizeTernaryT?", "Text",
 CellChangeTimes->{{3.804178254511845*^9, 3.804178259550037*^9}},
 Background->RGBColor[
  1, 0.85, 0.85],ExpressionUUID->"5b1e48e4-00d1-4ddd-972f-40ff1a1f5702"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SymmetrizeT", "=", 
   RowBox[{"FunctionCompile", "[", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"Typed", "[", 
        RowBox[{"T", ",", 
         RowBox[{
          RowBox[{"TypeSpecifier", "[", "\"\<PackedArray\>\"", "]"}], "[", 
          RowBox[{"\"\<Real64\>\"", ",", "2"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", "}"}], ",", 
      RowBox[{"T", "-", 
       RowBox[{"Ramp", "[", 
        RowBox[{"T", "-", 
         RowBox[{"Transpose", "[", "T", "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.649206144851355*^9, 3.649206148651795*^9}, {
   3.661121352574053*^9, 3.661121387218481*^9}, 3.674430201672263*^9, 
   3.6744681680692673`*^9, 3.686726631590466*^9, {3.8023774606781273`*^9, 
   3.802377472443514*^9}, {3.802377502855513*^9, 3.802377598050089*^9}, {
   3.802384399165329*^9, 3.8023844445581217`*^9}, {3.8023845844312773`*^9, 
   3.802384586152059*^9}, {3.8024325400696173`*^9, 3.802432540271508*^9}, {
   3.802432585964978*^9, 3.802432634315682*^9}, {3.8024327660407953`*^9, 
   3.802432771873838*^9}, {3.82069140747534*^9, 3.820691436183511*^9}, {
   3.820692180431735*^9, 3.8206922189554453`*^9}, {3.820692480893714*^9, 
   3.8206924865206337`*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"6d3460e9-70c8-443b-9c49-7103d3041a63"],

Cell["An alternate, non-compiled version (8x slower).", "Text",
 CellChangeTimes->{{3.820692523176937*^9, 
  3.8206925392250977`*^9}},ExpressionUUID->"aead966a-dfe3-493d-a66a-\
d473164ab7fc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SymmetrizeT", "[", "T_List", "]"}], ":=", 
  RowBox[{"MapThread", "[", 
   RowBox[{"Min", ",", 
    RowBox[{"{", 
     RowBox[{"T", ",", 
      RowBox[{"Transpose", "[", "T", "]"}]}], "}"}], ",", "2"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.783008318872797*^9, 3.783008414285879*^9}, 
   3.796942819551909*^9, 3.8010899904339027`*^9, {3.801090079738285*^9, 
   3.801090084698419*^9}, 3.812820528978067*^9, 3.820691478770898*^9},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[75]:=",ExpressionUUID->"3d41713e-d6d5-49e7-aad0-986175c3d018"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SymmetrizeT", "[", 
   RowBox[{"N", "[", 
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", "1", "0", 
         RowBox[{"-", "1"}]},
        {"1", "0", "0", "1"},
        {"1", "0", "0", "0"},
        {"0", 
         RowBox[{"-", "1"}], "0", "0"}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]], "]"}], "]"}], " ", "//", " ", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.783008453802793*^9, 3.7830085197885857`*^9}, 
   3.796942820899831*^9, 3.801089996892137*^9, {3.8206924606167593`*^9, 
   3.820692464541505*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[1467]:=",ExpressionUUID->"00f028fb-fb3f-47eb-87e6-bc9d24149d54"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`", "1.`", "0.`", 
      RowBox[{"-", "1.`"}]},
     {"1.`", "0.`", "0.`", 
      RowBox[{"-", "1.`"}]},
     {"0.`", "0.`", "0.`", "0.`"},
     {
      RowBox[{"-", "1.`"}], 
      RowBox[{"-", "1.`"}], "0.`", "0.`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.783008475885254*^9, 3.783008525705987*^9}, 
   3.7841377477799873`*^9, 3.796942782833535*^9, 3.7969428289898148`*^9, 
   3.801165188935605*^9, 3.820692491338903*^9, 3.8206926024667683`*^9, 
   3.820695196819261*^9},
 CellLabel->
  "Out[1467]//MatrixForm=",ExpressionUUID->"597d9263-8a76-432c-8c91-\
af8601ee04ae"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["TernaryMoveByIndex", "Subsubsection",
 CellChangeTimes->{
  3.821385399128789*^9, {3.822227183575344*^9, 3.822227187242958*^9}, 
   3.822227714629567*^9, 
   3.822246387537244*^9},ExpressionUUID->"4b479416-5c39-4984-ae57-\
0ea2b16b1cfe"],

Cell[TextData[{
 "Generate the tactic associated with the selected integer. This is used to \
decode the ",
 StyleBox["PrinceNet", "Input"],
 " policy vector. Output: rule of the form ",
 StyleBox["i\[Rule]{-1,0,1}", "Input"],
 "."
}], "Text",
 CellChangeTimes->{{3.821037364841516*^9, 3.82103738032795*^9}, {
  3.8211007586035137`*^9, 3.821100763697123*^9}, {3.821438028373945*^9, 
  3.821438078824376*^9}, {3.821438149919795*^9, 3.821438173049489*^9}, {
  3.822228297405933*^9, 3.822228337665728*^9}, {3.822228368834454*^9, 
  3.822228386270352*^9}, {3.8222521119162416`*^9, 
  3.822252114497362*^9}},ExpressionUUID->"12dc004f-b0a7-4433-825e-\
dcdd055fb705"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TernaryMoveByIndex", "[", "index_Integer", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Floor", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"index", "-", "1"}], ")"}], "/", "3."}], "]"}], "+", "1"}], 
   "\[Rule]", " ", 
   RowBox[{
    RowBox[{"Mod", "[", 
     RowBox[{"index", ",", "3"}], "]"}], "-", "1."}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.822227231502943*^9, 3.8222272414112377`*^9}, {
  3.822227449749992*^9, 3.822227563915423*^9}, {3.8222276077586613`*^9, 
  3.8222276270840387`*^9}, {3.822227782781474*^9, 3.8222277927137823`*^9}, {
  3.822227891504718*^9, 3.822227901585205*^9}, {3.822228226146894*^9, 
  3.822228266824327*^9}, {3.8222463816738234`*^9, 3.822246383107452*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"f4bc1baa-6306-4aa1-a977-ad2f5244fe16"]
}, Closed]],

Cell[CellGroupData[{

Cell["ToTernary", "Subsubsection",
 CellChangeTimes->{{3.7474011902558813`*^9, 3.747401192796854*^9}, {
   3.74740123101678*^9, 3.7474012383000793`*^9}, {3.754858324910935*^9, 
   3.754858328390745*^9}, 3.754863283265278*^9, 
   3.8010853385469*^9},ExpressionUUID->"7cbbc220-e8c1-4e71-8e5c-45cbfa77fe18"],

Cell["\<\
Converts a legal tactic matrix to a ternary one. Output: tactic matrix.\
\>", "Text",
 CellChangeTimes->{{3.755800062761688*^9, 
  3.755800080930853*^9}},ExpressionUUID->"640eb7d5-6bf6-4250-8ebc-\
608e05bb4d71"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToTernary", "=", 
   RowBox[{"FunctionCompile", "[", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"Typed", "[", 
        RowBox[{"T", ",", 
         RowBox[{
          RowBox[{"TypeSpecifier", "[", "\"\<PackedArray\>\"", "]"}], "[", 
          RowBox[{"\"\<Real64\>\"", ",", "2"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", "}"}], ",", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"R", "=", 
           RowBox[{"Sign", "[", "T", "]"}]}], ",", "i", ",", 
          RowBox[{"m", "=", 
           RowBox[{"Length", "[", "T", "]"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", 
           RowBox[{"i", "\[LessEqual]", "m"}], ",", 
           RowBox[{"i", "++"}], ",", "  ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"R", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "i"}], "]"}], "]"}], " ", "=", "0"}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"N", "[", "R", "]"}], "]"}], ";"}]}], "\[IndentingNewLine]",
        "]"}]}], "]"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.649206144851355*^9, 3.649206148651795*^9}, {
   3.661121352574053*^9, 3.661121387218481*^9}, 3.674430201672263*^9, 
   3.6744681680692673`*^9, 3.686726631590466*^9, {3.8023774606781273`*^9, 
   3.802377472443514*^9}, {3.802377502855513*^9, 3.802377598050089*^9}, {
   3.802384399165329*^9, 3.8023844445581217`*^9}, {3.8023845844312773`*^9, 
   3.802384586152059*^9}, {3.8024325400696173`*^9, 3.802432540271508*^9}, {
   3.802432585964978*^9, 3.802432634315682*^9}, {3.8024327660407953`*^9, 
   3.802432771873838*^9}, {3.82069140747534*^9, 3.820691436183511*^9}, {
   3.820692180431735*^9, 3.8206922189554453`*^9}, {3.820695333801441*^9, 
   3.820695375992999*^9}, 3.820695622162567*^9, 3.8207016160201597`*^9, {
   3.820701646994657*^9, 3.820701670915607*^9}, 3.820701779048032*^9, 
   3.820701818671968*^9, {3.820701974202572*^9, 3.8207019777433863`*^9}, {
   3.820703062188204*^9, 3.8207031072243757`*^9}, 3.820703160288486*^9, {
   3.820703256051053*^9, 3.820703259569035*^9}, 3.820703483615691*^9, {
   3.8207036963265944`*^9, 3.820703698927473*^9}, {3.820748858292104*^9, 
   3.820748876149776*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"52a7ec57-79df-4787-8639-bc72a96bd6ae"],

Cell["An uncompiled version that\[CloseCurlyQuote]s ~10x slower.", "Text",
 CellChangeTimes->{{3.8207034966693974`*^9, 3.820703510633792*^9}, {
  3.820703632068013*^9, 
  3.82070363419489*^9}},ExpressionUUID->"affa3f24-ae31-4989-a8f0-\
0df6e5ae1037"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToTernary", "[", "T_List", "]"}], ":=", 
  RowBox[{"ReplaceDiagonalReals", "[", 
   RowBox[{
    RowBox[{"N", "[", 
     RowBox[{"Sign", "[", "T", "]"}], "]"}], ",", 
    RowBox[{"Table", "[", 
     RowBox[{"0.", ",", 
      RowBox[{"Length", "[", "T", "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.801170483413291*^9, 3.801170492847189*^9}, {
   3.802264548517062*^9, 3.802264549142095*^9}, {3.808433925003003*^9, 
   3.808433925169754*^9}, 3.808486189504624*^9},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[79]:=",ExpressionUUID->"3142a577-b315-4d47-bbbe-955c9bb78926"],

Cell["\<\
Convert the tactic matrix within a power structure to ternary. Output: power \
structure.\
\>", "Text",
 CellChangeTimes->{{3.755086745005528*^9, 3.755086753323203*^9}, {
  3.7558000874803762`*^9, 
  3.7558000939768667`*^9}},ExpressionUUID->"13f42feb-14e6-463e-bcb0-\
3be3a74d257e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToTernary", "[", "ps_Association", "]"}], ":=", " ", 
  RowBox[{"<|", 
   RowBox[{
    RowBox[{"\"\<s\>\"", "\[Rule]", 
     RowBox[{"ps", "[", "\"\<s\>\"", "]"}]}], ",", 
    RowBox[{"\"\<T\>\"", "\[Rule]", " ", 
     RowBox[{"ToTernary", "[", 
      RowBox[{"ps", "[", "\"\<T\>\"", "]"}], "]"}]}]}], "|>"}]}]], "Input",
 CellChangeTimes->{{3.754763415612995*^9, 3.754763466351345*^9}, 
   3.754763663835092*^9, {3.754863024206099*^9, 3.754863048590912*^9}, 
   3.754863310886097*^9, {3.7549300759946833`*^9, 3.7549301026787252`*^9}, {
   3.755042355285223*^9, 3.755042360317045*^9}, {3.801089966932046*^9, 
   3.801089974506075*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->"In[82]:=",ExpressionUUID->"3bf67af0-533a-48a7-9f63-d908867f37f9"],

Cell["Unit tests:", "Text",
 CellChangeTimes->{{3.755085357688162*^9, 
  3.755085360162019*^9}},ExpressionUUID->"0cf567e5-491b-46da-b946-\
1b91acd9b07f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"unitTests", "[", "\"\<ToTernary\>\"", "]"}], " ", ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ToTernary", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "0.47593052648072004`", ",", "0.38946778511397906`", ",", 
           "0.5887854695349517`"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.36321528609957204`", ",", "0.1477143527714231`", ",", 
           RowBox[{"-", "0.3520164533294082`"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "0.16085418741970775`", ",", "0.4628178621145978`", ",", 
           "0.05919807713564013`"}], "}"}]}], "}"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.", ",", "1.", ",", "1."}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1.", ",", "0.", ",", 
          RowBox[{"-", "1."}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1.", ",", "1.", ",", "0."}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"TestID", "\[Rule]", "\"\<ToTernary1\>\""}]}], 
     "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7550841330433683`*^9, 3.755084135437353*^9}, {
   3.7550841708582687`*^9, 3.755084177444426*^9}, {3.75508488110111*^9, 
   3.755084921944516*^9}, {3.755085004683037*^9, 3.755085019160364*^9}, {
   3.755085236775576*^9, 3.7550852605358467`*^9}, {3.755085299455575*^9, 
   3.7550853362271223`*^9}, 3.755085432033588*^9, {3.755085559417843*^9, 
   3.755085605499104*^9}, {3.755085657127652*^9, 3.755085684055829*^9}, {
   3.7550857227312603`*^9, 3.755085757850277*^9}, {3.755085791385973*^9, 
   3.755085806043363*^9}, {3.755085848538776*^9, 3.7550858726824923`*^9}, {
   3.755085921688486*^9, 3.755085975595923*^9}, {3.755086010930608*^9, 
   3.755086084763026*^9}, {3.7550861278999023`*^9, 3.755086145884115*^9}, {
   3.7550861893032513`*^9, 3.7550863415526657`*^9}, {3.755086381974959*^9, 
   3.755086392501211*^9}, {3.75508644659693*^9, 3.7550864513013277`*^9}, {
   3.75508649799314*^9, 3.7550865090662107`*^9}, {3.755086565163678*^9, 
   3.755086585445758*^9}, {3.755086655240406*^9, 3.755086701383586*^9}, {
   3.755087880167535*^9, 3.755087882246003*^9}, {3.801085345464073*^9, 
   3.8010853493281727`*^9}, {3.808486196480153*^9, 3.808486203137121*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[62]:=",ExpressionUUID->"01beb232-5b70-41be-afd0-e6bc1e33105e"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Nearby Tactics", "Subsection",
 CellChangeTimes->{{3.822477003534873*^9, 3.822477006032333*^9}, {
   3.822477327366248*^9, 3.822477328654498*^9}, 
   3.8224786391351967`*^9},ExpressionUUID->"d05c7ee2-1cd4-4432-aa86-\
dc751a17c080"],

Cell[CellGroupData[{

Cell["AllTernaryTacticsNear", "Subsubsection",
 CellChangeTimes->{
  3.799853387355666*^9, 3.801090012445979*^9, {3.822479960120768*^9, 
   3.822479966525155*^9}, 3.822480583871017*^9, 
   3.8224806184026403`*^9},ExpressionUUID->"7da04c68-dbc5-4661-8c8e-\
a860ea92e723"],

Cell[TextData[{
 "Given a ternary tactic matrix and an agent index ",
 StyleBox["i", "Input"],
 ", list all possible tactic vectors in which a single move is altered, \
within a given Hamming distance. This function will also return the original \
tactic. Output: a list of ternary tactic vectors."
}], "Text",
 CellChangeTimes->{{3.783010123549014*^9, 3.783010209774995*^9}, {
  3.783010737315711*^9, 3.7830107548704844`*^9}, {3.78307057305063*^9, 
  3.78307057596769*^9}, {3.783071450489378*^9, 3.783071457744588*^9}, {
  3.784151817208508*^9, 3.784151827460671*^9}, {3.796943613293871*^9, 
  3.796943616160377*^9}, {3.7998547837560587`*^9, 3.7998548023257923`*^9}, {
  3.801163577190233*^9, 3.80116358556664*^9}, {3.802263053493537*^9, 
  3.802263054397059*^9}, {3.808486301038602*^9, 3.808486301969172*^9}, {
  3.821098384511169*^9, 
  3.821098385268181*^9}},ExpressionUUID->"b8cc3696-a187-4418-870e-\
8b76d7eef9d0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AllTernaryTacticsNear", "[", 
   RowBox[{"T_List", ",", "i_Integer", ",", "dx_Integer"}], "]"}], ":=", 
  RowBox[{"DeleteDuplicates", "[", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Tuples", "[", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{
           RowBox[{"Partition", "[", 
            RowBox[{
             RowBox[{"T", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "i"}], "]"}], "]"}], ",", "1"}], "]"}], 
           ",", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1."}], ",", "0.", ",", "1."}], "}"}]}], "&"}], 
             ",", "#"}], "]"}]}], "]"}], "]"}], "&"}], ",", 
       RowBox[{"Subsets", "[", 
        RowBox[{
         RowBox[{"Delete", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "T", "]"}], "]"}], ",", "i"}], "]"}], ",", 
         
         RowBox[{"{", "dx", "}"}]}], "]"}]}], "]"}], ",", "1"}], "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.799852539580429*^9, 3.799852547302988*^9}, {
   3.7998526388305902`*^9, 3.7998526396310387`*^9}, {3.7998530612907343`*^9, 
   3.799853062866096*^9}, {3.799853160526366*^9, 3.799853220706196*^9}, {
   3.79985332248804*^9, 3.799853327749135*^9}, {3.799854547560976*^9, 
   3.7998545580282097`*^9}, 3.80109001596275*^9, {3.801123939327656*^9, 
   3.8011239415299177`*^9}, {3.80112407320564*^9, 3.801124088791357*^9}, {
   3.8022630155801897`*^9, 3.802263016311317*^9}, {3.802263995800282*^9, 
   3.802264026719736*^9}, {3.80234068681323*^9, 3.8023406933967*^9}, {
   3.802340933823477*^9, 3.802340961723621*^9}, {3.80234121660181*^9, 
   3.802341221352051*^9}, {3.808486283279786*^9, 3.808486313410802*^9}, {
   3.808486359642066*^9, 3.8084863942250013`*^9}, {3.8084864372976503`*^9, 
   3.808486456792691*^9}, {3.808486818197845*^9, 3.808486819074007*^9}, {
   3.822480613675592*^9, 3.822480614044982*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"62257dcf-cc53-418e-a7da-e61e5c8c0974"],

Cell["\<\
A variant for when dx=1. The input tactic is always the first item in the \
output list. Output: a list of ternary tactic vectors.\
\>", "Text",
 CellChangeTimes->{{3.8085139141903973`*^9, 3.808513921686617*^9}, {
  3.808679281720248*^9, 3.808679286743627*^9}, {3.821098345516383*^9, 
  3.8210983888600283`*^9}},ExpressionUUID->"bdfc9f88-f005-440d-a028-\
ccd687e7a63d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AllTernaryTacticsNear", "[", 
   RowBox[{"tactic_List", ",", "i_Integer"}], "]"}], ":=", 
  RowBox[{"DeleteDuplicates", "[", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", "tactic", "}"}], ",", 
     RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"j", "\[Equal]", "i"}], ",", "Nothing", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ReplacePart", "[", 
              RowBox[{"tactic", ",", 
               RowBox[{"j", "\[Rule]", " ", 
                RowBox[{"-", "1."}]}]}], "]"}], ",", 
             RowBox[{"ReplacePart", "[", 
              RowBox[{"tactic", ",", 
               RowBox[{"j", "\[Rule]", " ", "0."}]}], "]"}], ",", 
             RowBox[{"ReplacePart", "[", 
              RowBox[{"tactic", ",", 
               RowBox[{"j", "\[Rule]", " ", "1."}]}], "]"}]}], "}"}]}], "]"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"Length", "[", "tactic", "]"}]}], "}"}]}], "]"}], ",", 
       "1"}], "]"}]}], "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.799852539580429*^9, 3.799852547302988*^9}, {
   3.7998526388305902`*^9, 3.7998526396310387`*^9}, {3.7998530612907343`*^9, 
   3.799853062866096*^9}, {3.799853160526366*^9, 3.799853220706196*^9}, {
   3.79985332248804*^9, 3.799853327749135*^9}, {3.799854547560976*^9, 
   3.7998545580282097`*^9}, 3.80109001596275*^9, {3.801123939327656*^9, 
   3.8011239415299177`*^9}, {3.80112407320564*^9, 3.801124088791357*^9}, {
   3.8022630155801897`*^9, 3.802263016311317*^9}, {3.802263995800282*^9, 
   3.802264026719736*^9}, {3.80234068681323*^9, 3.8023406933967*^9}, {
   3.802340933823477*^9, 3.802340961723621*^9}, {3.80234121660181*^9, 
   3.802341221352051*^9}, {3.808486283279786*^9, 3.808486313410802*^9}, {
   3.808486359642066*^9, 3.8084863942250013`*^9}, {3.8084864372976503`*^9, 
   3.808486456792691*^9}, {3.808486818197845*^9, 3.808486819074007*^9}, {
   3.808512243024604*^9, 3.808512262829709*^9}, {3.808512662612019*^9, 
   3.8085126781358547`*^9}, {3.8085133233342953`*^9, 3.808513357112302*^9}, {
   3.8085135868158817`*^9, 3.808513592896865*^9}, {3.808513640109709*^9, 
   3.808513645993589*^9}, {3.8085137631636343`*^9, 3.80851377259396*^9}, {
   3.8086006577910852`*^9, 3.808600691114481*^9}, 3.808601620098836*^9, {
   3.808601677490198*^9, 3.808601682895425*^9}, {3.808601799924464*^9, 
   3.8086018073028507`*^9}, 3.808601976119866*^9, {3.808602025952829*^9, 
   3.808602118135309*^9}, 3.808678612532426*^9, {3.8210970461165323`*^9, 
   3.8210970539116697`*^9}, 3.82248062136572*^9},
 CellLabel->"In[64]:=",ExpressionUUID->"87178107-1c3f-4f40-925c-2e588e51f747"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AllTernaryTacticsNear", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1.", ",", "1.", ",", "1."}], "}"}], ",", "2"}], "]"}]], "Input",
 CellChangeTimes->{{3.808678656770475*^9, 3.808678673594241*^9}, 
   3.808679291106319*^9, {3.821624411239544*^9, 3.8216244146084747`*^9}, {
   3.822480622828555*^9, 3.822480649399502*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[844]:=",ExpressionUUID->"c7910955-96f0-4802-8213-8c893cbfebe3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1.`", ",", "1.`", ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.`"}], ",", "1.`", ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "1.`", ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.`", ",", "1.`", ",", 
     RowBox[{"-", "1.`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.`", ",", "1.`", ",", "0.`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8086786638222847`*^9, 3.808678685680943*^9}, {
   3.808678717112855*^9, 3.8086787189031773`*^9}, 3.808679291635408*^9, 
   3.8210985035821447`*^9, 3.821624333093288*^9, {3.8216244117645693`*^9, 
   3.821624414981134*^9}, 3.821624462999076*^9, {3.8224806460855017`*^9, 
   3.8224806505300083`*^9}},
 CellLabel->
  "Out[844]=",ExpressionUUID->"cc68ffdd-f2dc-497d-84ab-a894ab89689c"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["AllTernaryTsNear", "Subsubsection",
 CellChangeTimes->{{3.7998572781815367`*^9, 3.799857299829995*^9}, 
   3.801090032029935*^9, {3.80182696025688*^9, 3.801826960410984*^9}, {
   3.805748056663097*^9, 3.805748066624172*^9}, {3.8057487693930273`*^9, 
   3.8057487701925993`*^9}, {3.8224799274234047`*^9, 3.822479932884529*^9}, {
   3.8224805805028067`*^9, 3.822480581128394*^9}, {3.822480629401504*^9, 
   3.8224806302386627`*^9}},ExpressionUUID->"1cb647ee-be6b-4c77-a0a2-\
038532bfe1ab"],

Cell[TextData[{
 "Given a ternary tactic matrix and a focal agent ",
 StyleBox["i", "Input"],
 " whose tactic vector we want to permute, generate all possible tactic \
matrices (not necessarily symmetric) within a given (Hamming) distance. \
Output: list of ternary tactic matrices."
}], "Text",
 CellChangeTimes->{{3.7998525640860023`*^9, 3.799852636977242*^9}, {
  3.7998574166633387`*^9, 3.799857418019527*^9}, {3.801163601947667*^9, 
  3.801163602025497*^9}, {3.8022647500216827`*^9, 3.802264757951075*^9}, {
  3.805748340799841*^9, 
  3.805748349535705*^9}},ExpressionUUID->"9dd06a13-48cb-47d6-acaa-\
0eb6e6bd75dc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AllTernaryTsNear", "[", 
   RowBox[{"TT_List", ",", "i_Integer", ",", "dx_Integer"}], "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ReplaceColumn", "[", 
      RowBox[{"TT", ",", "i", ",", "#"}], "]"}], "&"}], ",", 
    RowBox[{"AllTernaryTacticsNear", "[", 
     RowBox[{"TT", ",", "i", ",", "dx"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7998573049439087`*^9, 3.799857346622654*^9}, {
   3.801090135308238*^9, 3.801090138813466*^9}, {3.8011239505584497`*^9, 
   3.8011239547971373`*^9}, {3.801124058593581*^9, 3.8011240644588614`*^9}, 
   3.801124101910925*^9, {3.8018269319997673`*^9, 3.801826932206004*^9}, 
   3.8022612365194187`*^9, {3.8022612850854692`*^9, 3.802261290614349*^9}, {
   3.805748099067471*^9, 3.8057481207386312`*^9}, {3.8084867182206*^9, 
   3.808486718520639*^9}, {3.808511166088208*^9, 3.8085111719649763`*^9}, {
   3.821624255126548*^9, 3.8216242579069567`*^9}, {3.822480625301833*^9, 
   3.822480627815727*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"4f34c424-c047-4ce7-96ee-c22b4797263d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"AllTernaryTsNear", "[", 
   RowBox[{
    RowBox[{"N", "[", 
     RowBox[{"IdentityMatrix", "[", "3", "]"}], "]"}], ",", "2", ",", "1"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.799857355097082*^9, 3.799857395316153*^9}, {
   3.799857931140505*^9, 3.799857931309794*^9}, 3.8010901506812687`*^9, {
   3.8011652010420237`*^9, 3.801165204790164*^9}, {3.8018269231224127`*^9, 
   3.801826923271126*^9}, 3.8057481225412483`*^9, {3.805748202634809*^9, 
   3.8057482028173513`*^9}, {3.808486774386014*^9, 3.808486776564579*^9}, {
   3.822480635720887*^9, 3.822480636728107*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[846]:=",ExpressionUUID->"98799bae-eed3-417b-b3c7-2abe649569bb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1.`", 
        RowBox[{"-", "1.`"}], "0.`"},
       {"0.`", "1.`", "0.`"},
       {"0.`", "0.`", "1.`"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1.`", "0.`", "0.`"},
       {"0.`", "1.`", "0.`"},
       {"0.`", "0.`", "1.`"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1.`", "1.`", "0.`"},
       {"0.`", "1.`", "0.`"},
       {"0.`", "0.`", "1.`"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1.`", "0.`", "0.`"},
       {"0.`", "1.`", "0.`"},
       {"0.`", 
        RowBox[{"-", "1.`"}], "1.`"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1.`", "0.`", "0.`"},
       {"0.`", "1.`", "0.`"},
       {"0.`", "1.`", "1.`"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "}"}]], "Output",
 CellChangeTimes->{{3.799857360037045*^9, 3.799857395840048*^9}, {
   3.799857928597546*^9, 3.799857931799788*^9}, 3.801165205231244*^9, 
   3.8018269555265217`*^9, 3.802261233385089*^9, 3.802261300899514*^9, {
   3.805748193742777*^9, 3.8057482031263638`*^9}, 3.8057482935626593`*^9, 
   3.808486658243004*^9, 3.8084867248844013`*^9, 3.808486777022194*^9, 
   3.8216242611132107`*^9, 3.821624352837236*^9, 3.821624427830736*^9, 
   3.8216244643302383`*^9, 3.8224806560124493`*^9},
 CellLabel->
  "Out[846]=",ExpressionUUID->"e508c67d-c7a3-4b6e-82d7-630d62efd6a8"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["RandomMoveNear", "Subsubsection",
 CellChangeTimes->{{3.8185380050779457`*^9, 3.8185380070994253`*^9}, 
   3.818625072351674*^9, 
   3.822489977835513*^9},ExpressionUUID->"269f9bb7-fdf4-4d42-be99-\
367418032fe2"],

Cell["\<\
For a given power structure, generate a random move near it, assuming that \
all agents move simultaneously by altering no more than a single \
relationship. After the agents\[CloseCurlyQuote] random moves have been \
selected, the tactic matrix is symmetrized. Output: a power structure.\
\>", "Text",
 CellChangeTimes->{{3.818670754915977*^9, 3.8186708804915857`*^9}, {
   3.8186712126253157`*^9, 3.818671227225119*^9}, {3.81867210562281*^9, 
   3.818672158925013*^9}, {3.8186775720253773`*^9, 3.818677605827879*^9}, {
   3.8186837667129917`*^9, 3.8186837796106863`*^9}, {3.820511235933175*^9, 
   3.820511240038262*^9}, 3.820700706255131*^9, {3.821438956247753*^9, 
   3.8214389619754972`*^9}},ExpressionUUID->"502deb38-3837-4113-a65e-\
13384b0022fc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RandomMoveNear", "[", "ps_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"T", ",", 
      RowBox[{"s", "=", 
       RowBox[{"ps", "[", "\"\<s\>\"", "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"T", "=", 
      RowBox[{"ReciprocalizeT", "[", 
       RowBox[{"s", ",", 
        RowBox[{"RandomTernaryTNear", "[", 
         RowBox[{"ps", "[", "\"\<T\>\"", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"\"\<s\>\"", "\[Rule]", 
        RowBox[{"UpdateS", "[", 
         RowBox[{"s", ",", "T"}], "]"}]}], ",", 
       RowBox[{"\"\<T\>\"", "\[Rule]", "T"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.818536855855773*^9, {3.818536897046197*^9, 3.818536921238926*^9}, {
   3.818537909814047*^9, 3.818537911788422*^9}, {3.8185380124967203`*^9, 
   3.8185380644411983`*^9}, {3.818538387669079*^9, 3.818538404211969*^9}, {
   3.818590196451358*^9, 3.818590197725492*^9}, {3.818590229626727*^9, 
   3.818590233841044*^9}, {3.8185902758290157`*^9, 3.818590323960538*^9}, {
   3.818590456328903*^9, 3.818590459012823*^9}, {3.8185904948367558`*^9, 
   3.81859054169039*^9}, {3.818590613608536*^9, 3.818590626550671*^9}, {
   3.8185907030251217`*^9, 3.818590741449646*^9}, {3.818591018308154*^9, 
   3.818591023131317*^9}, {3.818625066037459*^9, 3.818625067804852*^9}, {
   3.8186256532180443`*^9, 3.818625658042779*^9}, 3.818670060701313*^9, {
   3.818670205518639*^9, 3.818670228555852*^9}, {3.8186703426233883`*^9, 
   3.818670350817478*^9}, {3.818670425673273*^9, 3.8186705071067*^9}, {
   3.818670600009993*^9, 3.818670611035742*^9}, {3.8186776741666403`*^9, 
   3.818677693643955*^9}, 3.818683784339303*^9, {3.818684062842849*^9, 
   3.818684063807966*^9}, {3.818684484132683*^9, 3.818684485388308*^9}, {
   3.818688231637764*^9, 3.818688254342471*^9}, {3.818691339085601*^9, 
   3.8186913429293537`*^9}, {3.818784083504525*^9, 3.818784085029855*^9}, 
   3.8187843675131407`*^9, {3.818784679352841*^9, 3.818784682778112*^9}, {
   3.820328992659973*^9, 3.820328992772949*^9}, {3.820417675584566*^9, 
   3.820417680572126*^9}, {3.820432227523284*^9, 3.8204322488744097`*^9}, 
   3.820510829905929*^9, {3.8207005353713083`*^9, 3.820700561153719*^9}, {
   3.8207538606448507`*^9, 3.820753870726056*^9}, {3.8207578292210407`*^9, 
   3.820757850916202*^9}, 3.8214387136962547`*^9, {3.821438840391732*^9, 
   3.8214388720997868`*^9}, 3.8224899897159777`*^9},
 CellLabel->
  "In[178]:=",ExpressionUUID->"1a56da0b-f91a-4636-8205-4334d777d831"],

Cell["\<\
A version that appends M, a move matrix (\[OpenCurlyDoubleQuote]M\
\[CloseCurlyDoubleQuote]) appended indicating the ternary tactic each agent \
played before symmetrization:\
\>", "Text",
 CellChangeTimes->{{3.82143887604655*^9, 3.8214388806656227`*^9}, {
  3.821438957770753*^9, 
  3.821438958139351*^9}},ExpressionUUID->"cdb2887c-53e3-4e48-b17f-\
aab6381c5565"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RandomMoveNear", "[", "ps_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"M", ",", "T", ",", 
      RowBox[{"s", "=", 
       RowBox[{"ps", "[", "\"\<s\>\"", "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"M", "=", 
      RowBox[{"RandomTernaryTNear", "[", 
       RowBox[{"ps", "[", "\"\<T\>\"", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"T", "=", 
      RowBox[{"ReciprocalizeT", "[", 
       RowBox[{"s", ",", "M"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{"\"\<s\>\"", "\[Rule]", 
        RowBox[{"UpdateS", "[", 
         RowBox[{"s", ",", "T"}], "]"}]}], ",", 
       RowBox[{"\"\<T\>\"", "\[Rule]", "T"}], ",", 
       RowBox[{"\"\<M\>\"", "\[Rule]", "M"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{
  3.818536855855773*^9, {3.818536897046197*^9, 3.818536921238926*^9}, {
   3.818537909814047*^9, 3.818537911788422*^9}, {3.8185380124967203`*^9, 
   3.8185380644411983`*^9}, {3.818538387669079*^9, 3.818538404211969*^9}, {
   3.818590196451358*^9, 3.818590197725492*^9}, {3.818590229626727*^9, 
   3.818590233841044*^9}, {3.8185902758290157`*^9, 3.818590323960538*^9}, {
   3.818590456328903*^9, 3.818590459012823*^9}, {3.8185904948367558`*^9, 
   3.81859054169039*^9}, {3.818590613608536*^9, 3.818590626550671*^9}, {
   3.8185907030251217`*^9, 3.818590741449646*^9}, {3.818591018308154*^9, 
   3.818591023131317*^9}, {3.818625066037459*^9, 3.818625067804852*^9}, {
   3.8186256532180443`*^9, 3.818625658042779*^9}, 3.818670060701313*^9, {
   3.818670205518639*^9, 3.818670228555852*^9}, {3.8186703426233883`*^9, 
   3.818670350817478*^9}, {3.818670425673273*^9, 3.8186705071067*^9}, {
   3.818670600009993*^9, 3.818670611035742*^9}, {3.8186776741666403`*^9, 
   3.818677693643955*^9}, 3.818683784339303*^9, {3.818684062842849*^9, 
   3.818684063807966*^9}, {3.818684484132683*^9, 3.818684485388308*^9}, {
   3.818688231637764*^9, 3.818688254342471*^9}, {3.818691339085601*^9, 
   3.8186913429293537`*^9}, {3.818784083504525*^9, 3.818784085029855*^9}, 
   3.8187843675131407`*^9, {3.818784679352841*^9, 3.818784682778112*^9}, {
   3.820328992659973*^9, 3.820328992772949*^9}, {3.820417675584566*^9, 
   3.820417680572126*^9}, {3.820432227523284*^9, 3.8204322488744097`*^9}, 
   3.820510829905929*^9, {3.8207005353713083`*^9, 3.820700561153719*^9}, {
   3.8207538606448507`*^9, 3.820753870726056*^9}, {3.8207578292210407`*^9, 
   3.820757850916202*^9}, 3.8214387136962547`*^9, 3.821438840391732*^9, 
   3.82248999131955*^9},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"19af98f5-b79b-4ef0-9498-ff3c58fc3a11"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Pretty", "[", 
  RowBox[{"RandomMoveNear", "[", "ps", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8185380710674467`*^9, 3.818538080837606*^9}, {
   3.818538410388216*^9, 3.818538411716549*^9}, {3.81859033657763*^9, 
   3.818590368235209*^9}, 3.818590399500617*^9, {3.818590544972499*^9, 
   3.818590548007082*^9}, {3.8185906310996017`*^9, 3.818590632035192*^9}, 
   3.818625665723916*^9, {3.81867061875346*^9, 3.8186706202127457`*^9}, {
   3.820329432285001*^9, 3.8203294326176653`*^9}, {3.820407739272728*^9, 
   3.820407739398982*^9}, {3.820432373607297*^9, 3.8204323749062157`*^9}, {
   3.8207553765254993`*^9, 3.820755378056365*^9}, 3.821438894794354*^9, 
   3.8224899926421957`*^9},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[180]:=",ExpressionUUID->"abadf106-9f49-4105-8d0d-7b11ab4f1f63"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"s\"\>", "\[Rule]", 
    TagBox[
     RowBox[{"(", "\[NoBreak]", 
      TagBox[GridBox[{
         {"0.986`"},
         {"0.251`"},
         {"0.9530000000000001`"},
         {"0.063`"},
         {"0.661`"}
        },
        GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.5599999999999999]}, 
            Offset[0.27999999999999997`]}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}}],
       Column], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]]}], ",", 
   RowBox[{"\<\"T\"\>", "\[Rule]", 
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0.989`", "0.005`", 
         RowBox[{"-", "0.005`"}], "0.005`", "0.007`"},
        {"0.001`", "0.984`", "0.001`", "0.005`", "0.002`"},
        {
         RowBox[{"-", "0.005`"}], "0.005`", "0.993`", "0.005`", "0.`"},
        {"0.`", "0.001`", "0.`", "0.98`", "0.`"},
        {"0.004`", "0.005`", "0.`", "0.005`", "0.991`"}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.818538071468994*^9, 3.818538081188323*^9}, 
   3.818538413516032*^9, {3.818590329777516*^9, 3.8185903999700413`*^9}, {
   3.818590461798839*^9, 3.8185904629096117`*^9}, {3.818590537117969*^9, 
   3.81859056556178*^9}, {3.8185906288488398`*^9, 3.818590651910853*^9}, {
   3.8185907180923243`*^9, 3.818590753655252*^9}, {3.8185910259520473`*^9, 
   3.81859103051001*^9}, {3.818625667058029*^9, 3.818625674509898*^9}, {
   3.8186257056644*^9, 3.818625719178376*^9}, 3.818625797070415*^9, {
   3.818670052394174*^9, 3.818670055241832*^9}, {3.8186702173042316`*^9, 
   3.818670237646819*^9}, {3.818670354016794*^9, 3.818670363341214*^9}, {
   3.8186704386194897`*^9, 3.8186704761450977`*^9}, {3.8186705101095333`*^9, 
   3.818670620858304*^9}, 3.818677698590873*^9, {3.818688274601082*^9, 
   3.818688284402931*^9}, {3.81878409189253*^9, 3.818784097637333*^9}, {
   3.820328997918873*^9, 3.820329002122196*^9}, {3.820329149099465*^9, 
   3.8203291765410643`*^9}, {3.820329231700625*^9, 3.820329235200597*^9}, {
   3.820329427740779*^9, 3.820329444312517*^9}, 3.82040773988759*^9, {
   3.820416073407899*^9, 3.820416115668153*^9}, {3.8204165720609303`*^9, 
   3.8204165801351748`*^9}, 3.820417686107007*^9, {3.820432208015237*^9, 
   3.820432214181925*^9}, {3.820432256108844*^9, 3.820432262335475*^9}, {
   3.8204323765095263`*^9, 3.82043238302181*^9}, {3.8205112642163553`*^9, 
   3.820511267746295*^9}, {3.820700590098607*^9, 3.82070060606749*^9}, {
   3.820700756889957*^9, 3.820700760921464*^9}, {3.820753874522018*^9, 
   3.820753878163743*^9}, {3.8207550530966177`*^9, 3.820755053922188*^9}, {
   3.820755375167873*^9, 3.820755378689178*^9}, {3.820757855612096*^9, 
   3.82075786540598*^9}, {3.821438718420402*^9, 3.8214387256417513`*^9}, 
   3.8214388962084827`*^9, 3.822490009758699*^9},
 CellLabel->
  "Out[180]=",ExpressionUUID->"0a231f36-c046-46a8-be20-9dc1f2210015"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["RandomTernaryTNear", "Subsubsection",
 CellChangeTimes->{{3.820755842693869*^9, 3.820755843753397*^9}, 
   3.8207570653684072`*^9},ExpressionUUID->"b6ba4c3d-2177-4cc2-a753-\
36e7219ce528"],

Cell["\<\
Given a (non-ternary) tactic matrix, return a ternary tactic matrix in which \
each agent alters a single relationship. Output: ternary tactic matrix.\
\>", "Text",
 CellChangeTimes->{{3.820756991560004*^9, 
  3.820757054568671*^9}},ExpressionUUID->"c8fe195e-a859-465e-90e0-\
fccda36f7d37"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RandomTernaryTNear", "=", 
   RowBox[{"FunctionCompile", "[", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"Typed", "[", 
        RowBox[{"T", ",", 
         RowBox[{
          RowBox[{"TypeSpecifier", "[", "\"\<PackedArray\>\"", "]"}], "[", 
          RowBox[{"\"\<Real64\>\"", ",", "2"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", "}"}], ",", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"R", "=", 
           RowBox[{"Sign", "[", "T", "]"}]}], ",", "i", ",", 
          RowBox[{"m", "=", 
           RowBox[{"Length", "[", "T", "]"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", 
           RowBox[{"i", "\[LessEqual]", "m"}], ",", 
           RowBox[{"i", "++"}], ",", " ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"R", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"RandomInteger", "[", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "m"}], "}"}], "]"}], ",", "i"}], "]"}], 
              "]"}], "=", 
             RowBox[{"RandomInteger", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"R", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "i"}], "]"}], "]"}], " ", "=", "0"}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"N", "[", "R", "]"}], "]"}], ";"}]}], "\[IndentingNewLine]",
        "]"}]}], "]"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.649206144851355*^9, 3.649206148651795*^9}, {
   3.661121352574053*^9, 3.661121387218481*^9}, 3.674430201672263*^9, 
   3.6744681680692673`*^9, 3.686726631590466*^9, {3.8023774606781273`*^9, 
   3.802377472443514*^9}, {3.802377502855513*^9, 3.802377598050089*^9}, {
   3.802384399165329*^9, 3.8023844445581217`*^9}, {3.8023845844312773`*^9, 
   3.802384586152059*^9}, {3.8024325400696173`*^9, 3.802432540271508*^9}, {
   3.802432585964978*^9, 3.802432634315682*^9}, {3.8024327660407953`*^9, 
   3.802432771873838*^9}, {3.82069140747534*^9, 3.820691436183511*^9}, {
   3.820692180431735*^9, 3.8206922189554453`*^9}, {3.820695333801441*^9, 
   3.820695375992999*^9}, 3.820695622162567*^9, 3.8207016160201597`*^9, {
   3.820701646994657*^9, 3.820701670915607*^9}, 3.820701779048032*^9, 
   3.820701818671968*^9, {3.820701974202572*^9, 3.8207019777433863`*^9}, {
   3.820703062188204*^9, 3.8207031072243757`*^9}, 3.820703160288486*^9, {
   3.820703256051053*^9, 3.820703259569035*^9}, 3.820703483615691*^9, {
   3.8207036963265944`*^9, 3.820703698927473*^9}, {3.820748858292104*^9, 
   3.820748876149776*^9}, {3.820755894196917*^9, 3.8207559477826357`*^9}, {
   3.820755979899111*^9, 3.82075599675172*^9}, {3.820756027987644*^9, 
   3.8207560986121264`*^9}, {3.8207561336060266`*^9, 3.820756137664013*^9}, {
   3.820756915074139*^9, 3.82075693777987*^9}, {3.82075698562967*^9, 
   3.820756986028161*^9}, {3.820757460704486*^9, 3.82075751144556*^9}, {
   3.8207575435838537`*^9, 3.820757558280632*^9}, {3.820757808462967*^9, 
   3.820757811563713*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"6afd3391-f0d5-4a73-95c1-af220bb8df4f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"RandomTernaryTNear", "[", 
   RowBox[{"ps", "[", "\"\<T\>\"", "]"}], "]"}], "//", "Pretty"}]], "Input",
 CellChangeTimes->{{3.820757587486938*^9, 3.820757597567649*^9}},
 CellLabel->
  "In[457]:=",ExpressionUUID->"ae2d5cab-ccc2-42b8-9822-1fa20529a628"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", 
      RowBox[{"-", "1"}], "1", "1"},
     {"1", "0", "0", "0", "0"},
     {"1", "0", "0", "1", "1"},
     {"0", "1", "0", "0", "0"},
     {"1", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.820757597892346*^9, 3.820757624123002*^9}, {
  3.820757724622693*^9, 3.8207577800195923`*^9}, {3.820757957329012*^9, 
  3.820757959097722*^9}},
 CellLabel->
  "Out[457]//MatrixForm=",ExpressionUUID->"6a8547fb-81bc-48b2-bea7-\
3cf09cb2bfd6"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["RandomTacticNear", "Subsubsection",
 CellChangeTimes->{{3.7548268815726*^9, 3.7548268843327847`*^9}, {
   3.754855750138294*^9, 3.75485575125803*^9}, 
   3.812808064029758*^9},ExpressionUUID->"2e8e5032-6e89-4f0c-ba6d-\
8d1072eb44fb"],

Cell[TextData[{
 "Given a tactic vector, this function finds another tactic (approximately) \
within a given Euclidean distance ",
 StyleBox["\[Sigma]", "Input"],
 ". It is assumed that agents do not harm themselves. The new tactic is found \
by: (1) starting from a point represented by the original tactic, (2) picking \
a random point on a sphere of radius \[Sigma], centered at the original \
point, (3) ensuring that the self-allocation is nonnegative, and (4) \
normalizing the point on the sphere back to the surface of the n-dimensional \
cross-polytope. Output: tactic vector."
}], "Text",
 CellChangeTimes->{{3.70384203804913*^9, 3.7038420894076543`*^9}, {
   3.703843192211955*^9, 3.7038431944839954`*^9}, {3.7038442838284464`*^9, 
   3.703844284245531*^9}, 3.704287748909136*^9, 3.705350977604426*^9, {
   3.7099277410739517`*^9, 3.709927777296555*^9}, {3.709928072986589*^9, 
   3.709928139843595*^9}, {3.7099281769373093`*^9, 3.709928225633745*^9}, {
   3.710445202966728*^9, 3.71044558867669*^9}, {3.71848880047661*^9, 
   3.71848880156955*^9}, {3.718489333026621*^9, 3.718489489687379*^9}, {
   3.718489667938589*^9, 3.718489711323923*^9}, {3.718492466924802*^9, 
   3.7184924727050343`*^9}, {3.718492505590129*^9, 3.718492507953926*^9}, {
   3.754856115255333*^9, 3.754856124091255*^9}, {3.755799897560751*^9, 
   3.7557999055943537`*^9}},ExpressionUUID->"23d81d5c-290a-47b7-aad3-\
f0e96e291a0c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RandomTacticNear", "[", 
   RowBox[{"tactic_List", ",", " ", "index_Integer", ",", " ", 
    StyleBox["\[Sigma]_Real", "Input"]}], 
   StyleBox["]", "Input"]}], 
  StyleBox[" ", "Input"], 
  StyleBox[":=", "Input"], 
  StyleBox[" ", "Input"], 
  RowBox[{"NormalizeTactic", "[", 
   RowBox[{"MapAt", "[", 
    RowBox[{"Abs", ",", 
     RowBox[{"RandomPoint", "[", 
      RowBox[{"Sphere", "[", 
       RowBox[{"tactic", ",", "\[Sigma]"}], "]"}], "]"}], ",", "index"}], 
    "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.703842102942634*^9, 3.703842131911642*^9}, {
   3.7038424418926644`*^9, 3.703842454180332*^9}, 3.7038424873394756`*^9, {
   3.7038425258047457`*^9, 3.703842572899954*^9}, {3.703842656649554*^9, 
   3.7038427469606276`*^9}, {3.7038435413520737`*^9, 
   3.7038435422665043`*^9}, {3.703843694119802*^9, 3.703843694658259*^9}, {
   3.7038438350394316`*^9, 3.7038438361584067`*^9}, 3.7053510986930857`*^9, {
   3.7099272216267242`*^9, 3.709927237034807*^9}, 3.710441691250341*^9, {
   3.710441724057076*^9, 3.710441724740419*^9}, {3.710444640692466*^9, 
   3.710444645814209*^9}, {3.71848209297692*^9, 3.71848212980656*^9}, {
   3.718482273202216*^9, 3.718482327577717*^9}, {3.7184825217430153`*^9, 
   3.7184825251627407`*^9}, {3.7184825871812677`*^9, 3.718482590495665*^9}, {
   3.718490591807987*^9, 3.718490616041791*^9}, {3.718490745182543*^9, 
   3.718490748079863*^9}, 3.718491584120961*^9, {3.718491976681135*^9, 
   3.718491988443201*^9}, {3.71849206985254*^9, 3.7184920767474203`*^9}, {
   3.754855753866355*^9, 3.754855785937993*^9}, {3.754856275153722*^9, 
   3.754856305380529*^9}, {3.804164233448429*^9, 3.804164250777092*^9}, 
   3.8041645688629*^9, {3.804164604803618*^9, 3.804164610713262*^9}, 
   3.8128080693912573`*^9},
 CellLabel->"In[68]:=",ExpressionUUID->"b6042656-6c9c-467a-98d3-0ba7ae30fe7b"]
}, Closed]],

Cell[CellGroupData[{

Cell["RandomTNear", "Subsubsection",
 CellChangeTimes->{3.8093482838792057`*^9, 
  3.809380495955522*^9},ExpressionUUID->"662463f1-7170-46c1-9b53-\
37344ce01fcc"],

Cell[TextData[{
 "Given a tactic matrix, randomly alter agent i\[CloseCurlyQuote]s \
(continuous) tactic with respect to another randomly selected agent j. The \
resulting tactic is ",
 StyleBox["symmetrical",
  IgnoreSpellCheck->True],
 " in the sense that ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["T", "ij"], TraditionalForm]],ExpressionUUID->
  "8410a6dd-8254-449c-b368-41981209471b"],
 "and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["T", "ji"], TraditionalForm]],ExpressionUUID->
  "6f77e7d3-cc7e-46a9-a870-5d299f389b7e"],
 "have the same polarity, even if they vary in intensity. Only one \
relationship is altered. Output: tactic matrix."
}], "Text",
 CellChangeTimes->{{3.809348288627084*^9, 3.80934830411191*^9}, {
  3.8093484229874973`*^9, 3.809348424258388*^9}, {3.8093558974895153`*^9, 
  3.8093560549460173`*^9}, {3.809380342711279*^9, 3.809380369647003*^9}, {
  3.809380420691145*^9, 3.809380425652679*^9}, {3.8224900696312428`*^9, 
  3.822490070225465*^9}, {3.8224901035693398`*^9, 
  3.822490107666794*^9}},ExpressionUUID->"e2d01c50-3910-46ce-82d4-\
7ff1707cac16"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RandomTNear", "[", 
   RowBox[{"T_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"j", ",", "ti", ",", "tj"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"j", "=", 
      RowBox[{"RandomChoice", "[", 
       RowBox[{"Delete", "[", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "T", "]"}], "]"}], ",", "i"}], "]"}], 
       "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ti", ",", "tj"}], "}"}], "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{"RandomChoice", "[", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "1"}]}], "}"}], "]"}], "*", 
           RowBox[{"(", 
            RowBox[{"1.", "-", "\[Rho]"}], ")"}]}]}], "}"}], ",", "2"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ReplaceColumn", "[", 
      RowBox[{
       RowBox[{"ReplaceColumn", "[", 
        RowBox[{"T", ",", "i", ",", 
         RowBox[{"NormalizeTernaryTactic", "[", 
          RowBox[{
           RowBox[{"ReplacePart", "[", 
            RowBox[{
             RowBox[{"T", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "i"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"j", "\[Rule]", "tj"}], ",", 
               RowBox[{"i", "\[Rule]", "0."}]}], "}"}]}], "]"}], ",", "i"}], 
          "]"}]}], "]"}], ",", "j", ",", 
       RowBox[{"NormalizeTernaryTactic", "[", 
        RowBox[{
         RowBox[{"ReplacePart", "[", 
          RowBox[{
           RowBox[{"T", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "j"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"i", "\[Rule]", "ti"}], ",", 
             RowBox[{"j", "\[Rule]", "0."}]}], "}"}]}], "]"}], ",", "j"}], 
        "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.809348186100111*^9, 3.809348206564253*^9}, {
   3.809356268304846*^9, 3.809356317347002*^9}, {3.809379318407071*^9, 
   3.809379337766436*^9}, {3.8093794398457413`*^9, 3.809379475873549*^9}, {
   3.809379510473003*^9, 3.809379534489093*^9}, {3.809379613290661*^9, 
   3.809379617616509*^9}, {3.809379653161332*^9, 3.8093796660316057`*^9}, {
   3.8093796983536053`*^9, 3.809379698784639*^9}, {3.809379822038639*^9, 
   3.809379825441537*^9}, {3.809379861664835*^9, 3.809379870223064*^9}, {
   3.809380044710018*^9, 3.809380045025011*^9}, 3.809380278029922*^9, 
   3.8093804920076027`*^9},
 CellLabel->"In[69]:=",ExpressionUUID->"cc37af47-d574-47af-a5eb-1882193155b6"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Pad, Trim, and Reorder", "Subsection",
 CellChangeTimes->{{3.8214434885035343`*^9, 3.821443490517625*^9}, {
  3.8221579406536827`*^9, 3.822157941814583*^9}, {3.822158398934939*^9, 
  3.822158402189024*^9}},ExpressionUUID->"fdb12f19-feb0-497e-8983-\
20d8c0826b0f"],

Cell[CellGroupData[{

Cell["Pad", "Subsubsection",
 CellChangeTimes->{{3.736022643675376*^9, 3.7360226551341352`*^9}, {
   3.7360228443411746`*^9, 3.7360228446999702`*^9}, {3.7360233789022207`*^9, 
   3.736023381002967*^9}, {3.754863740312138*^9, 3.754863742237224*^9}, {
   3.754930169091198*^9, 3.754930171973048*^9}, {3.821009398111257*^9, 
   3.821009418341783*^9}, 
   3.8222439269469147`*^9},ExpressionUUID->"9fc15f72-f93e-4d66-8848-\
5337d645e229"],

Cell[TextData[{
 "Given a scenario, these functions reduce it to a smaller n (if possible) or \
pad it to a larger n (if necessary). Convert a scenario with a lower ",
 StyleBox["n", "Input"],
 " to a higher ",
 StyleBox["n", "Input"],
 ". So, for example, a scenario could be defined in ",
 StyleBox["n=3", "Input"],
 " but be run against a neural net of size ",
 StyleBox["n=5", "Input"],
 ". Output: power structure."
}], "Text",
 CellChangeTimes->{{3.736022717769126*^9, 3.736022726062488*^9}, {
  3.736023315948814*^9, 3.7360233545516634`*^9}, {3.743713777170428*^9, 
  3.743713778804428*^9}, {3.75580024440141*^9, 
  3.755800250282675*^9}},ExpressionUUID->"28fe4a80-4ae3-49fc-9eaf-\
29c48056fba9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PadPowerStructure", "[", 
   RowBox[{"ps_Association", ",", "n_Integer"}], "]"}], ":=", " ", 
  RowBox[{"PowerStructure", "[", 
   RowBox[{
    RowBox[{"PadS", "[", 
     RowBox[{
      RowBox[{"ps", "[", "\"\<s\>\"", "]"}], ",", " ", "n"}], "]"}], ",", 
    RowBox[{"PadT", "[", 
     RowBox[{
      RowBox[{"ps", "[", "\"\<T\>\"", "]"}], ",", "n"}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.736022666053115*^9, 3.736022701718543*^9}, {
   3.7360227450250454`*^9, 3.7360227801639957`*^9}, {3.736022835456088*^9, 
   3.7360228384912496`*^9}, {3.748120466043741*^9, 3.748120469753304*^9}, 
   3.754863746267704*^9, {3.754863848528883*^9, 3.754863904464012*^9}, {
   3.754930175099475*^9, 3.754930189947393*^9}, {3.755042453693459*^9, 
   3.755042459237905*^9}, {3.758746545338951*^9, 3.758746553519278*^9}, {
   3.821008724790341*^9, 3.8210087274132137`*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"dbbe6fbf-f417-4c2a-9e3c-ca2f1f244f0c"],

Cell["Pads a size vector. Output: size vector.", "Text",
 CellChangeTimes->{{3.7359837933587093`*^9, 3.7359837972400093`*^9}, {
  3.755800231177699*^9, 
  3.7558002392750587`*^9}},ExpressionUUID->"72491e59-41d2-41ae-9528-\
1b3fc8d533c3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PadS", "[", 
    RowBox[{"s_", ",", " ", "n_"}], "]"}], " ", ":=", " ", 
   RowBox[{"PadRight", "[", 
    RowBox[{"s", ",", "n", ",", "0."}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7359834437780075`*^9, 3.735983504710208*^9}, {
   3.748120424313734*^9, 3.748120425485179*^9}, 3.754863615476639*^9, {
   3.754863834881876*^9, 3.754863838399477*^9}, {3.821008704091062*^9, 
   3.8210087117199707`*^9}, {3.821009351015184*^9, 3.821009351729129*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"c3a5563a-ba63-42d4-b65f-702c6c21cd34"],

Cell["Unit tests:", "Text",
 CellChangeTimes->{{3.755085357688162*^9, 
  3.755085360162019*^9}},ExpressionUUID->"e5dedd0c-1b5d-4cdc-b32a-\
b5e8c1e71dc5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"unitTests", "[", "\"\<PadS\>\"", "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PadS", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1.", ",", "1.", ",", "0.3"}], "}"}], ",", "5"}], "]"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"1.", ",", "1.", ",", "0.3`", ",", "0.", ",", "0."}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"TestID", "\[Rule]", "\"\<PadS1\>\""}]}], "\[IndentingNewLine]",
      "]"}], "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7550841330433683`*^9, 3.755084135437353*^9}, {
   3.7550841708582687`*^9, 3.755084177444426*^9}, {3.75508488110111*^9, 
   3.755084921944516*^9}, {3.755085004683037*^9, 3.755085019160364*^9}, {
   3.755085236775576*^9, 3.7550852605358467`*^9}, {3.755085299455575*^9, 
   3.7550853362271223`*^9}, 3.755085432033588*^9, {3.755085559417843*^9, 
   3.755085605499104*^9}, {3.755085657127652*^9, 3.755085684055829*^9}, {
   3.7550857227312603`*^9, 3.755085757850277*^9}, {3.755085791385973*^9, 
   3.755085806043363*^9}, {3.755085848538776*^9, 3.7550858726824923`*^9}, {
   3.755085921688486*^9, 3.755085975595923*^9}, {3.755086010930608*^9, 
   3.755086084763026*^9}, {3.7550861278999023`*^9, 3.755086145884115*^9}, {
   3.7550861893032513`*^9, 3.7550863415526657`*^9}, {3.755086381974959*^9, 
   3.755086392501211*^9}, {3.75508644659693*^9, 3.7550864513013277`*^9}, {
   3.75508649799314*^9, 3.7550865090662107`*^9}, {3.755086565163678*^9, 
   3.755086585445758*^9}, {3.755086655240406*^9, 3.755086701383586*^9}, {
   3.755086806299365*^9, 3.755086837717898*^9}, {3.755086948783966*^9, 
   3.755087022479724*^9}, {3.7550870816896*^9, 3.755087134007586*^9}, {
   3.755087813471169*^9, 3.7550878182239723`*^9}, 3.821008715302392*^9, {
   3.822158043152725*^9, 3.822158045521517*^9}, {3.8221580973003387`*^9, 
   3.822158101353918*^9}, {3.8221582278531837`*^9, 3.822158229006979*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[72]:=",ExpressionUUID->"84249ab0-5f22-49d5-8195-27632a8de8ae"],

Cell["Pads a tactic matrix. Output: tactic matrix.", "Text",
 CellChangeTimes->{{3.7359838426544094`*^9, 3.7359838495927095`*^9}, {
  3.755800218038527*^9, 
  3.755800225793325*^9}},ExpressionUUID->"a92cdacf-3338-4ffc-a6ac-\
8502d83016bc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PadT", "[", 
   RowBox[{"T_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"pad", "=", 
      RowBox[{"n", "-", 
       RowBox[{"Length", "[", "T", "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ArrayPad", "[", 
     RowBox[{"T", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "pad"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "pad"}], "}"}]}], "}"}], ",", "0."}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.73598385100171*^9, 3.7359838613639097`*^9}, {
   3.736021818773776*^9, 3.7360218306676474`*^9}, 3.7481204176929283`*^9, {
   3.754863594310629*^9, 3.754863599154626*^9}, {3.754863822932178*^9, 
   3.7548638268813057`*^9}, {3.821008678112459*^9, 3.821008692501124*^9}, {
   3.821008876601915*^9, 3.821008877670074*^9}, {3.8210093703147383`*^9, 
   3.821009370884164*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"69afca7f-57be-4585-b1f8-a0509ee751e5"],

Cell["Unit tests:", "Text",
 CellChangeTimes->{{3.755085357688162*^9, 
  3.755085360162019*^9}},ExpressionUUID->"859533bb-c6a8-4302-a776-\
37f66eecd9f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"unitTests", "[", "\"\<PadT\>\"", "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PadT", "[", 
       RowBox[{
        RowBox[{"N", "[", 
         RowBox[{"IdentityMatrix", "[", "3", "]"}], "]"}], ",", "5"}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.`", ",", "1.`", ",", "0.`", ",", "0.`", ",", "0.`"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.`", ",", "0.`", ",", "1.`", ",", "0.`", ",", "0.`"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`"}], 
         "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"TestID", "\[Rule]", "\"\<PadT1\>\""}]}], "\[IndentingNewLine]",
      "]"}], "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7550841330433683`*^9, 3.755084135437353*^9}, {
   3.7550841708582687`*^9, 3.755084177444426*^9}, {3.75508488110111*^9, 
   3.755084921944516*^9}, {3.755085004683037*^9, 3.755085019160364*^9}, {
   3.755085236775576*^9, 3.7550852605358467`*^9}, {3.755085299455575*^9, 
   3.7550853362271223`*^9}, 3.755085432033588*^9, {3.755085559417843*^9, 
   3.755085605499104*^9}, {3.755085657127652*^9, 3.755085684055829*^9}, {
   3.7550857227312603`*^9, 3.755085757850277*^9}, {3.755085791385973*^9, 
   3.755085806043363*^9}, {3.755085848538776*^9, 3.7550858726824923`*^9}, {
   3.755085921688486*^9, 3.755085975595923*^9}, {3.755086010930608*^9, 
   3.755086084763026*^9}, {3.7550861278999023`*^9, 3.755086145884115*^9}, {
   3.7550861893032513`*^9, 3.7550863415526657`*^9}, {3.755086381974959*^9, 
   3.755086392501211*^9}, {3.75508644659693*^9, 3.7550864513013277`*^9}, {
   3.75508649799314*^9, 3.7550865090662107`*^9}, {3.755086565163678*^9, 
   3.755086585445758*^9}, {3.755086655240406*^9, 3.755086701383586*^9}, {
   3.755086806299365*^9, 3.755086837717898*^9}, {3.755086948783966*^9, 
   3.755087022479724*^9}, {3.7550870816896*^9, 3.755087095353322*^9}, {
   3.755087826584361*^9, 3.755087829162261*^9}, 3.821008695983143*^9, {
   3.8221580532582417`*^9, 3.8221580836458883`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[74]:=",ExpressionUUID->"fec55cff-9bb2-49e0-866e-57c7a842a819"]
}, Closed]],

Cell[CellGroupData[{

Cell["Trim", "Subsubsection",
 CellChangeTimes->{{3.75486375175449*^9, 3.7548637535789557`*^9}, {
   3.754930124491167*^9, 3.754930126674519*^9}, 
   3.822243930699101*^9},ExpressionUUID->"505a6011-4d9c-49f0-bda9-\
5caac965471c"],

Cell[TextData[{
 "Converts a scenario with a higher ",
 StyleBox["n", "Input"],
 " to a lower ",
 StyleBox["n", "Input"],
 ". Output: power structure."
}], "Text",
 CellChangeTimes->{{3.736023395648361*^9, 3.7360234048924217`*^9}, {
  3.755800197534239*^9, 
  3.755800211849365*^9}},ExpressionUUID->"d520801a-b954-421d-896c-\
92b512d703ef"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TrimPowerStructure", "[", 
   RowBox[{"ps_", ",", "n_"}], "]"}], ":=", " ", 
  RowBox[{"PowerStructure", "[", 
   RowBox[{
    RowBox[{"TrimS", "[", 
     RowBox[{
      RowBox[{"ps", "[", "\"\<s\>\"", "]"}], ",", " ", "n"}], "]"}], ",", 
    RowBox[{"TrimT", "[", 
     RowBox[{
      RowBox[{"ps", "[", "\"\<T\>\"", "]"}], ",", "n"}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.736022666053115*^9, 3.736022701718543*^9}, {
   3.7360227450250454`*^9, 3.7360227801639957`*^9}, {3.736022835456088*^9, 
   3.7360228384912496`*^9}, {3.736023391043832*^9, 3.7360233914806347`*^9}, {
   3.736023436063322*^9, 3.736023441336156*^9}, {3.748120457350019*^9, 
   3.74812046095932*^9}, {3.754863946551725*^9, 3.754863969001048*^9}, {
   3.7549301436195498`*^9, 3.754930157854226*^9}, {3.7587463633995647`*^9, 
   3.7587463677772284`*^9}, 3.758746401989051*^9, {3.821101400685508*^9, 
   3.8211014037604437`*^9}, {3.821101454756295*^9, 3.8211014666478653`*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"08d5c969-3085-4621-bdc8-1c31b51142f0"],

Cell["Trims a size vector. Output: size vector.", "Text",
 CellChangeTimes->{{3.7359838130404096`*^9, 3.7359838159495096`*^9}, {
  3.755800186764454*^9, 
  3.755800192264361*^9}},ExpressionUUID->"a8217635-b04f-42d7-981c-\
aca4144166a3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TrimS", "[", 
   RowBox[{"s_", ",", "n_"}], "]"}], ":=", " ", 
  RowBox[{"Take", "[", 
   RowBox[{"s", ",", "n"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7359835258452077`*^9, 3.7359835447451077`*^9}, {
   3.7359837302127085`*^9, 3.735983748680709*^9}, {3.7360225765790567`*^9, 
   3.736022586361781*^9}, {3.748120445517269*^9, 3.748120447308358*^9}, 
   3.754863705618772*^9, {3.75486380534802*^9, 3.754863808871564*^9}, 
   3.821101407569681*^9, {3.821101439570013*^9, 3.82110146891177*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"eb2c6180-d27d-46ef-b560-8b4ac6d123d8"],

Cell["Unit tests:", "Text",
 CellChangeTimes->{{3.755085357688162*^9, 
  3.755085360162019*^9}},ExpressionUUID->"8f8ec67c-75e1-43ab-82a9-\
bcafa66d6532"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"unitTests", "[", "\"\<TrimS\>\"", "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TrimS", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "1", ",", ".9", ",", "1", ",", ".5", ",", ".5", ",", "0", ",", "0", 
          ",", "0"}], "}"}], ",", "5"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0.9`", ",", "1", ",", "0.5`", ",", "0.5`"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"TestID", "\[Rule]", "\"\<TrimS1\>\""}]}], 
     "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7550841330433683`*^9, 3.755084135437353*^9}, {
   3.7550841708582687`*^9, 3.755084177444426*^9}, {3.75508488110111*^9, 
   3.755084921944516*^9}, {3.755085004683037*^9, 3.755085019160364*^9}, {
   3.755085236775576*^9, 3.7550852605358467`*^9}, {3.755085299455575*^9, 
   3.7550853362271223`*^9}, 3.755085432033588*^9, {3.755085559417843*^9, 
   3.755085605499104*^9}, {3.755085657127652*^9, 3.755085684055829*^9}, {
   3.7550857227312603`*^9, 3.755085757850277*^9}, {3.755085791385973*^9, 
   3.755085806043363*^9}, {3.755085848538776*^9, 3.7550858726824923`*^9}, {
   3.755085921688486*^9, 3.755085975595923*^9}, {3.755086010930608*^9, 
   3.755086084763026*^9}, {3.7550861278999023`*^9, 3.755086145884115*^9}, {
   3.7550861893032513`*^9, 3.7550863415526657`*^9}, {3.755086381974959*^9, 
   3.755086392501211*^9}, {3.75508644659693*^9, 3.7550864513013277`*^9}, {
   3.75508649799314*^9, 3.7550865090662107`*^9}, {3.755086565163678*^9, 
   3.755086585445758*^9}, {3.755086655240406*^9, 3.755086701383586*^9}, {
   3.755086806299365*^9, 3.755086837717898*^9}, {3.755086948783966*^9, 
   3.755087022479724*^9}, {3.7550878355860147`*^9, 3.755087839846108*^9}, 
   3.8211014108473883`*^9, {3.822158011287754*^9, 3.822158014511901*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[77]:=",ExpressionUUID->"0a6d3b61-8690-4780-a56f-661b4d32328a"],

Cell["Trims a tactic matrix. Output: tactic matrix.", "Text",
 CellChangeTimes->{{3.7359838714578094`*^9, 3.73598390887991*^9}, {
  3.755800176245411*^9, 
  3.755800182040731*^9}},ExpressionUUID->"b30b8039-d44a-4290-a2a6-\
1009fbbfa2e0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TrimT", "[", 
   RowBox[{"T_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"drop", "=", 
      RowBox[{
       RowBox[{"Length", "[", "T", "]"}], "-", "n"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Drop", "[", 
     RowBox[{"T", ",", 
      RowBox[{"-", "drop"}], ",", 
      RowBox[{"-", "drop"}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.73598389548131*^9, 3.73598390597081*^9}, {
   3.7360223947520337`*^9, 3.736022457562235*^9}, {3.748120436950136*^9, 
   3.7481204376524467`*^9}, 3.75486368743329*^9, {3.75486376735376*^9, 
   3.7548637913245068`*^9}, {3.821101414868786*^9, 3.8211014712103863`*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"f54d11ed-ee8a-4f4a-8a9c-cab493023b6e"],

Cell["Unit tests:", "Text",
 CellChangeTimes->{{3.755085357688162*^9, 
  3.755085360162019*^9}},ExpressionUUID->"f74e3dd8-02b9-4bb8-9279-\
bbbdaeb2a7be"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"unitTests", "[", "\"\<TrimT\>\"", "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TrimT", "[", 
       RowBox[{
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"1", "0", "0"},
           {"0", "1", "0"},
           {"0", "0", "0"}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], ",", 
        "3"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"TestID", "\[Rule]", "\"\<TrimT1\>\""}]}], 
     "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7550841330433683`*^9, 3.755084135437353*^9}, {
   3.7550841708582687`*^9, 3.755084177444426*^9}, {3.75508488110111*^9, 
   3.755084921944516*^9}, {3.755085004683037*^9, 3.755085019160364*^9}, {
   3.755085236775576*^9, 3.7550852605358467`*^9}, {3.755085299455575*^9, 
   3.7550853362271223`*^9}, 3.755085432033588*^9, {3.755085559417843*^9, 
   3.755085605499104*^9}, {3.755085657127652*^9, 3.755085684055829*^9}, {
   3.7550857227312603`*^9, 3.755085757850277*^9}, {3.755085791385973*^9, 
   3.755085806043363*^9}, {3.755085848538776*^9, 3.7550858726824923`*^9}, {
   3.755085921688486*^9, 3.755085975595923*^9}, {3.755086010930608*^9, 
   3.755086084763026*^9}, {3.7550861278999023`*^9, 3.755086145884115*^9}, {
   3.7550861893032513`*^9, 3.7550863415526657`*^9}, {3.755086381974959*^9, 
   3.755086392501211*^9}, {3.75508644659693*^9, 3.7550864513013277`*^9}, {
   3.75508649799314*^9, 3.7550865090662107`*^9}, {3.755086565163678*^9, 
   3.755086585445758*^9}, {3.755086655240406*^9, 3.755086701383586*^9}, {
   3.755086806299365*^9, 3.755086837717898*^9}, {3.755086948783966*^9, 
   3.755086977270163*^9}, {3.755087846672309*^9, 3.755087851960744*^9}, 
   3.821101418580769*^9, {3.82215799919201*^9, 3.822158002070413*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[79]:=",ExpressionUUID->"a299ba87-10d2-4541-a404-f0fcdb048977"]
}, Closed]],

Cell[CellGroupData[{

Cell["Reorder", "Subsubsection",
 CellChangeTimes->{{3.820958409826192*^9, 3.8209584131605988`*^9}, 
   3.821185564990141*^9, 
   3.8222439224451523`*^9},ExpressionUUID->"4f8063a5-be1f-497f-a786-\
7dce017b7881"],

Cell[TextData[{
 "Given a tactic matrix ",
 StyleBox["T", "Input"],
 ", generate a new tactic matrix (of size ",
 StyleBox["n", "Input"],
 ") in which the player\[CloseCurlyQuote]s tactic vectors are rearranged \
according to a rule (a list of how player indices in the original matrix map \
to indices in the new matrix, e.g. ",
 StyleBox["{4,1,5}", "Input"],
 "). Output: tactic matrix."
}], "Text",
 CellChangeTimes->{{3.734199566305603*^9, 3.7341995848696036`*^9}, {
   3.7342000649440064`*^9, 3.734200088094407*^9}, 3.734202441657622*^9, {
   3.734208226496008*^9, 3.734208227260408*^9}, {3.734369838420862*^9, 
   3.7343698457086887`*^9}, {3.755802071990765*^9, 3.755802075758215*^9}, 
   3.821185539225175*^9},ExpressionUUID->"5dd4a489-e013-41bd-8372-\
041184bd4215"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReorderT", "=", 
   RowBox[{"FunctionCompile", "[", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Typed", "[", 
         RowBox[{"T", ",", 
          RowBox[{
           RowBox[{"TypeSpecifier", "[", "\"\<PackedArray\>\"", "]"}], "[", 
           RowBox[{"\"\<Real64\>\"", ",", "2"}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Typed", "[", 
         RowBox[{"order", ",", 
          RowBox[{
           RowBox[{"TypeSpecifier", "[", "\"\<PackedArray\>\"", "]"}], "[", 
           RowBox[{"\"\<MachineInteger\>\"", ",", "1"}], "]"}]}], "]"}]}], 
       "\[IndentingNewLine]", "}"}], ",", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", "j", ",", 
          RowBox[{"len", "=", 
           RowBox[{"Length", "[", "T", "]"}]}], ",", 
          RowBox[{"result", "=", "T"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", 
           RowBox[{"i", "\[LessEqual]", "len"}], ",", 
           RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "1"}], ",", 
             RowBox[{"j", "\[LessEqual]", "len"}], ",", 
             RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"result", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"order", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", 
                  RowBox[{"order", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}], " ", "=", 
               " ", 
               RowBox[{"T", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "result", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}]}], "]"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.649206144851355*^9, 3.649206148651795*^9}, {
   3.661121352574053*^9, 3.661121387218481*^9}, 3.674430201672263*^9, 
   3.6744681680692673`*^9, 3.686726631590466*^9, {3.8023774606781273`*^9, 
   3.802377472443514*^9}, {3.802377502855513*^9, 3.802377598050089*^9}, {
   3.802384399165329*^9, 3.8023844445581217`*^9}, {3.8023845844312773`*^9, 
   3.802384586152059*^9}, {3.8024325400696173`*^9, 3.802432540271508*^9}, {
   3.802432585964978*^9, 3.802432634315682*^9}, {3.8024327660407953`*^9, 
   3.802432771873838*^9}, {3.82069140747534*^9, 3.820691436183511*^9}, {
   3.820692180431735*^9, 3.8206922189554453`*^9}, {3.820692480893714*^9, 
   3.8206924865206337`*^9}, {3.821444750247799*^9, 3.8214447532550287`*^9}, {
   3.821444787995833*^9, 3.821444798356938*^9}, {3.8214448825056553`*^9, 
   3.821444893699347*^9}, 3.8214449983785477`*^9},
 CellLabel->"In[80]:=",ExpressionUUID->"f71fa231-d54a-44df-bfeb-489f2ebfa56f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ReorderT", "[", 
   RowBox[{
    RowBox[{"N", "[", 
     RowBox[{"(", GridBox[{
        {"5", "4", "6"},
        {"2", "1", "3"},
        {"8", "7", "9"}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}], ")"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "1", ",", "3"}], "}"}]}], "]"}], "//", 
  "Pretty"}]], "Input",
 CellChangeTimes->{{3.8211818233504963`*^9, 3.821181838156013*^9}, 
   3.821185482645965*^9, {3.821185555152172*^9, 3.821185557757951*^9}, 
   3.821444834684537*^9, {3.821445016061315*^9, 3.8214450204380493`*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[614]:=",ExpressionUUID->"c51859fd-40e5-4a4f-80e2-a46057eb4d9e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "2", "3"},
     {"4", "5", "6"},
     {"7", "8", "9"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.821181839702182*^9, {3.821185552046303*^9, 3.821185558095149*^9}, {
   3.82144499249408*^9, 3.821445021001989*^9}},
 CellLabel->
  "Out[614]//MatrixForm=",ExpressionUUID->"f3ff1d73-1cf0-4cbb-bfe9-\
4d22aa11e5b5"]
}, Open  ]],

Cell["Unit tests:", "Text",
 CellChangeTimes->{{3.755085357688162*^9, 
  3.755085360162019*^9}},ExpressionUUID->"d6f55a41-b3c3-451d-ba9d-\
d176c33fe7b5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"unitTests", "[", "\"\<ReorderT\>\"", "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ReorderT", "[", 
        RowBox[{
         TagBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"1.", "2.", "3."},
             {"4.", "5.", "6."},
             {"7.", "8.", "9."}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"9.", ",", "7.", ",", "8."}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"3.", ",", "1.", ",", "2."}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"6.", ",", "4.", ",", "5."}], "}"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TestID", "\[Rule]", "\"\<ReorderT1\>\""}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ReorderT", "[", 
        RowBox[{
         TagBox[
          TagBox[
           RowBox[{"(", "\[NoBreak]", GridBox[{
              {"11.", "12.", "13."},
              {"21.", "22.", "23."},
              {"31.", "32.", "33."}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.7]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
           Function[BoxForm`e$, 
            MatrixForm[BoxForm`e$]]],
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3", ",", "2"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"11.", ",", "13.", ",", "12."}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"31.", ",", "33.", ",", "32."}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"21.", ",", "23.", ",", "22."}], "}"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TestID", "\[Rule]", "\"\<ReorderT2\>\""}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7550841330433683`*^9, 3.755084135437353*^9}, {
   3.7550841708582687`*^9, 3.755084177444426*^9}, {3.75508488110111*^9, 
   3.755084921944516*^9}, {3.755085004683037*^9, 3.755085019160364*^9}, {
   3.755085236775576*^9, 3.7550852605358467`*^9}, {3.755085299455575*^9, 
   3.7550853362271223`*^9}, 3.755085432033588*^9, {3.755085559417843*^9, 
   3.755085605499104*^9}, {3.755085657127652*^9, 3.755085684055829*^9}, {
   3.7550857227312603`*^9, 3.755085757850277*^9}, {3.755085791385973*^9, 
   3.755085806043363*^9}, {3.755085848538776*^9, 3.7550858726824923`*^9}, {
   3.755085921688486*^9, 3.755085975595923*^9}, {3.755086010930608*^9, 
   3.755086084763026*^9}, {3.7550861278999023`*^9, 3.755086145884115*^9}, {
   3.7550861893032513`*^9, 3.7550863415526657`*^9}, {3.755086381974959*^9, 
   3.755086392501211*^9}, {3.75508644659693*^9, 3.7550864513013277`*^9}, {
   3.75508649799314*^9, 3.7550865090662107`*^9}, {3.755086565163678*^9, 
   3.755086585445758*^9}, {3.755086655240406*^9, 3.755086701383586*^9}, {
   3.755086806299365*^9, 3.755086837717898*^9}, {3.755086948783966*^9, 
   3.755087022479724*^9}, {3.7550870816896*^9, 3.755087134007586*^9}, {
   3.755087422831038*^9, 3.755087427098736*^9}, {3.755087460919154*^9, 
   3.755087557692718*^9}, {3.755087590425846*^9, 3.755087598858591*^9}, {
   3.755089604075595*^9, 3.7550897179572697`*^9}, {3.755089810711412*^9, 
   3.755089819467078*^9}, {3.755089886823806*^9, 3.7550898869428873`*^9}, {
   3.7550899416197844`*^9, 3.755089954353589*^9}, {3.755090019862935*^9, 
   3.755090091719275*^9}, {3.7550901570319777`*^9, 3.755090194482295*^9}, {
   3.755095355432584*^9, 3.755095387486578*^9}, {3.821008516418487*^9, 
   3.8210085200585737`*^9}, {3.821185485076043*^9, 3.8211854865200872`*^9}, {
   3.821445041710648*^9, 3.821445099897233*^9}, {3.822158335009308*^9, 
   3.822158359377223*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[81]:=",ExpressionUUID->"135d47d6-d945-4bba-ad4f-7de5788c69cc"],

Cell[TextData[{
 "Changes the order of the elements in a size vector so that: 1) the size of \
the focal agent is at index position #1, and 2) the other sizes are listed in \
decreasing order. This function also returns a list indicating the original \
index positions of the agents, so the output of the neural net can be mapped \
back to the respective agents. Output: two lists with the form {",
 StyleBox["s,ordering}", "Input"],
 "."
}], "Text",
 CellChangeTimes->{{3.7341995948692036`*^9, 3.734199596632004*^9}, {
  3.7342024326564217`*^9, 3.7342024366812215`*^9}, {3.734369560854645*^9, 
  3.734369700570266*^9}, {3.7558020374446497`*^9, 
  3.75580205081177*^9}},ExpressionUUID->"3cf34b74-42c0-41e7-93ce-\
7c2ef91f31af"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReorderS", "[", 
   RowBox[{"s_", ",", "i_"}], "]"}], ":=", " ", 
  RowBox[{"ReplacePart", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"reorderSizes", "[", 
     RowBox[{"ReplacePart", "[", 
      RowBox[{"s", ",", 
       RowBox[{"i", "\[Rule]", "Infinity"}]}], "]"}], "]"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
     RowBox[{"s", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.728476744245412*^9, 3.72847675113484*^9}, {
   3.728480824500182*^9, 3.728480853388299*^9}, {3.728500904454999*^9, 
   3.72850090673604*^9}, 3.734199538223203*^9, {3.7342023812076216`*^9, 
   3.734202398476822*^9}, {3.734202467023222*^9, 3.734202468146422*^9}, {
   3.7342031754816265`*^9, 3.734203255228827*^9}, {3.734203301982027*^9, 
   3.734203302793227*^9}, 3.755020705612612*^9, {3.755043282012508*^9, 
   3.7550432872327213`*^9}, {3.822243651270789*^9, 3.822243681682702*^9}, {
   3.8222438503958187`*^9, 3.822243862012944*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"f281c59b-f621-4fc7-bfef-cb37142dd2bc"],

Cell["\<\
Given a numeric list, return it sorted from largest to smallest, along with a \
list indicating the initial indexes of each element in the new list. This is \
not intended to be used externally. Output: two lists of integers.\
\>", "Text",
 CellChangeTimes->{{3.734201813947218*^9, 3.734201864410818*^9}, {
  3.755020714847884*^9, 3.7550207242252083`*^9}, {3.755802060622272*^9, 
  3.755802064989602*^9}},ExpressionUUID->"2e1532b5-1aed-4b52-a2b2-\
690523078625"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"reorderSizes", "[", "list_", "]"}], ":=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ReverseSort", "[", "list", "]"}], ",", 
     RowBox[{"Reverse", "[", 
      RowBox[{"Ordering", "[", "list", "]"}], "]"}]}], "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7342017087708173`*^9, 3.734201765554817*^9}, {
   3.73420216996802*^9, 3.73420217285402*^9}, {3.755043296127965*^9, 
   3.755043296855851*^9}, 3.822243684813279*^9, 3.8222438667064447`*^9},
 CellLabel->"In[83]:=",ExpressionUUID->"6d14fe14-6fa7-4de1-ac90-2a03ec1cc9b6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ReorderS", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "3", ",", "5", ",", "4"}], "}"}], ",", "2"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.821967898320434*^9, 3.821967919336205*^9}, {
   3.8219679516010313`*^9, 3.821967953156386*^9}, 3.8222437059884644`*^9, {
   3.822243878158194*^9, 3.8222438783566113`*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[294]:=",ExpressionUUID->"3d64c791-5d75-48b4-b1af-b1a006ccc79b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "5", ",", "4", ",", "3", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4", ",", "5", ",", "3", ",", "1"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.821967919916964*^9, {3.8219679534893513`*^9, 3.821967963505558*^9}, 
   3.822243879658937*^9},
 CellLabel->
  "Out[294]=",ExpressionUUID->"044270f4-6ecb-49b9-91a0-7d85c663c021"]
}, Open  ]],

Cell["Unit tests:", "Text",
 CellChangeTimes->{{3.755085357688162*^9, 
  3.755085360162019*^9}},ExpressionUUID->"ade7da1d-020f-4404-a48c-\
a5476d422a85"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"unitTests", "[", "\"\<ReorderS\>\"", "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ReorderS", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"4", ",", "7", ",", "2", ",", "1", ",", "9"}], "}"}], ",", 
         "2"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"7", ",", "9", ",", "4", ",", "2", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "5", ",", "1", ",", "3", ",", "4"}], "}"}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"TestID", "\[Rule]", "\"\<ReorderS1\>\""}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"reorderSizes", "[", 
        RowBox[{"{", 
         RowBox[{
         "1", ",", "9", ",", "8", ",", "101", ",", "27", ",", "64", ",", 
          "2"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "101", ",", "64", ",", "27", ",", "9", ",", "8", ",", "2", ",", 
           "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "4", ",", "6", ",", "5", ",", "2", ",", "3", ",", "7", ",", "1"}], 
          "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"TestID", "\[Rule]", "\"\<ReorderS2\>\""}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7550841330433683`*^9, 3.755084135437353*^9}, {
   3.7550841708582687`*^9, 3.755084177444426*^9}, {3.75508488110111*^9, 
   3.755084921944516*^9}, {3.755085004683037*^9, 3.755085019160364*^9}, {
   3.755085236775576*^9, 3.7550852605358467`*^9}, {3.755085299455575*^9, 
   3.7550853362271223`*^9}, 3.755085432033588*^9, {3.755085559417843*^9, 
   3.755085605499104*^9}, {3.755085657127652*^9, 3.755085684055829*^9}, {
   3.7550857227312603`*^9, 3.755085757850277*^9}, {3.755085791385973*^9, 
   3.755085806043363*^9}, {3.755085848538776*^9, 3.7550858726824923`*^9}, {
   3.755085921688486*^9, 3.755085975595923*^9}, {3.755086010930608*^9, 
   3.755086084763026*^9}, {3.7550861278999023`*^9, 3.755086145884115*^9}, {
   3.7550861893032513`*^9, 3.7550863415526657`*^9}, {3.755086381974959*^9, 
   3.755086392501211*^9}, {3.75508644659693*^9, 3.7550864513013277`*^9}, {
   3.75508649799314*^9, 3.7550865090662107`*^9}, {3.755086565163678*^9, 
   3.755086585445758*^9}, {3.755086655240406*^9, 3.755086701383586*^9}, {
   3.755086806299365*^9, 3.755086837717898*^9}, {3.755086948783966*^9, 
   3.755087022479724*^9}, {3.7550870816896*^9, 3.755087134007586*^9}, {
   3.755087422831038*^9, 3.755087427098736*^9}, {3.755087460919154*^9, 
   3.755087557692718*^9}, {3.755087590425846*^9, 3.755087598858591*^9}, {
   3.755089604075595*^9, 3.7550897179572697`*^9}, {3.755089810711412*^9, 
   3.755089819467078*^9}, {3.755089886823806*^9, 3.7550898869428873`*^9}, {
   3.7550899416197844`*^9, 3.755089954353589*^9}, {3.755090019862935*^9, 
   3.755090091719275*^9}, {3.8222438150634327`*^9, 3.8222438357362556`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[84]:=",ExpressionUUID->"1ec4eaf7-d20d-43ba-b09f-4258ed451230"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Named Ternary Ts", "Subsection",
 CellChangeTimes->{{3.80989676092568*^9, 3.8098967634019413`*^9}, {
  3.8224773403227167`*^9, 
  3.822477343086776*^9}},ExpressionUUID->"dd949207-8819-46a2-a4a2-\
4dcd9e2e3265"],

Cell[CellGroupData[{

Cell["NamedTHierarchy", "Subsubsection",
 CellChangeTimes->{{3.809896446424603*^9, 3.8098964484711857`*^9}, {
   3.809896486627695*^9, 3.8098964888958473`*^9}, 
   3.809896785119075*^9},ExpressionUUID->"1fc10e31-d241-4350-86a4-\
97b3ea387f4a"],

Cell["\<\
A tactic matrix of variable size representing a hierarchy. Output: tactic \
matrix.\
\>", "Text",
 CellChangeTimes->{{3.809897526688897*^9, 
  3.809897547844308*^9}},ExpressionUUID->"0314c909-5038-4080-946d-\
b6e21bfb4be1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NamedTHierarchy", "[", "n_", "]"}], ":=", 
  RowBox[{"NormalizeTernaryT", "[", 
   RowBox[{"ReplacePart", "[", 
    RowBox[{
     RowBox[{"ReplaceColumn", "[", 
      RowBox[{
       RowBox[{"ReplacePart", "[", 
        RowBox[{
         RowBox[{"ZeroMatrix", "[", "n", "]"}], ",", 
         RowBox[{"1", "\[Rule]", " ", 
          RowBox[{"Table", "[", 
           RowBox[{"1.", ",", "n"}], "]"}]}]}], "]"}], ",", "1", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"1.", ",", "n"}], "]"}]}], "]"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", "0."}]}], "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.809896623504671*^9, 3.80989672445328*^9}, {
  3.80989677472479*^9, 3.8098967779820423`*^9}},
 CellLabel->"In[85]:=",ExpressionUUID->"75831bd9-895f-4687-97fd-286e571ec71e"]
}, Closed]],

Cell[CellGroupData[{

Cell["NamedTComplete", "Subsubsection",
 CellChangeTimes->{{3.809896467895176*^9, 3.8098964836935167`*^9}, 
   3.809896800725322*^9},ExpressionUUID->"34608bf4-bb0f-4696-96cd-\
60c0db220bd8"],

Cell["\<\
A tactic matrix of variable size representing a fully connected graph. \
Output: tactic matrix.\
\>", "Text",
 CellChangeTimes->{{3.809897526688897*^9, 
  3.809897558263953*^9}},ExpressionUUID->"4a4222e7-5c86-4f28-aa4a-\
0e27b95b0a93"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NamedTComplete", "[", "n_", "]"}], ":=", 
  RowBox[{"NormalizeTernaryT", "[", 
   RowBox[{"ReplaceDiagonalReals", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{"1.", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "n"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "n"}], "}"}]}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{"0.", ",", "n"}], "]"}]}], "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.809896471882607*^9, 3.809896606177278*^9}, {
  3.8098967940888453`*^9, 3.809896797070553*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"fa479d0b-9a01-4291-a573-267772555b58"]
}, Closed]],

Cell[CellGroupData[{

Cell["NamedTNull", "Subsubsection",
 CellChangeTimes->{{3.80995589240425*^9, 
  3.809955894795134*^9}},ExpressionUUID->"b37a0b63-0a68-431b-a2ee-\
3476b181468a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NamedTNull", "[", "n_", "]"}], ":=", 
  RowBox[{"NormalizeTernaryT", "[", 
   RowBox[{"ZeroMatrix", "[", "n", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.809896471882607*^9, 3.809896606177278*^9}, {
  3.8098967940888453`*^9, 3.809896797070553*^9}, {3.809955925449192*^9, 
  3.8099559352590523`*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"1c738852-7fdd-44b8-9ae6-bb9b9a804aa3"]
}, Closed]],

Cell[CellGroupData[{

Cell["Focal Agent Symmetric Triads", "Subsubsection",
 CellChangeTimes->{{3.766697017378274*^9, 3.766697024567993*^9}, {
  3.766697064786549*^9, 
  3.766697066331882*^9}},ExpressionUUID->"cc55d909-059d-4e57-9e3a-\
f02763180171"],

Cell["\<\
Generate a symmetrical tactic matrix from a tuple of {-1, 0, 1}\
\[CloseCurlyQuote]s.\
\>", "Text",
 CellChangeTimes->{{3.766251186636016*^9, 
  3.7662512174391165`*^9}},ExpressionUUID->"b3c4a156-035f-4b1b-bc32-\
33b5705f922e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GenerateSymmetricTernaryTacticMatrix", "[", 
   RowBox[{"{", 
    RowBox[{"a_", ",", "b_", ",", "c_"}], "}"}], "]"}], ":=", 
  TagBox[
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0", "a", "c"},
      {"a", "0", "b"},
      {"c", "b", "0"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
   Function[BoxForm`e$, 
    MatrixForm[BoxForm`e$]]]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7662416220964603`*^9, 3.76624163236066*^9}, {
  3.7662416777224603`*^9, 3.7662417127792606`*^9}, {3.766251141785116*^9, 
  3.766251148970416*^9}, {3.766697114522008*^9, 3.766697130202087*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"2811c8c9-88b7-4fd3-9239-02d18deb0403"],

Cell["\<\
Remove tuples that are symmetrical from agent #1\[CloseCurlyQuote]s \
perspective.\
\>", "Text",
 CellChangeTimes->{{3.7662507398214135`*^9, 3.766250763681614*^9}, {
  3.766697080397037*^9, 
  3.766697081173156*^9}},ExpressionUUID->"7ba515a7-956f-4c29-973f-\
741a124f8726"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FocalAgentSymmetricTriads", " ", "=", " ", 
   RowBox[{"Map", "[", 
    RowBox[{"GenerateSymmetricTernaryTacticMatrix", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "0", ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1", ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7662417154518604`*^9, 3.7662417370562606`*^9}, {
   3.7662417755946608`*^9, 3.766241778863061*^9}, {3.766250685936013*^9, 
   3.766250704911713*^9}, 3.766696311023048*^9, 3.766697045240478*^9, {
   3.766697107537435*^9, 3.766697136753504*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"dad76317-a854-4c80-a596-e9a74ac40d01"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Type Testing", "Subsection",
 CellChangeTimes->{{3.754824605213032*^9, 3.7548246074142857`*^9}, {
   3.754825041355345*^9, 3.7548250454715757`*^9}, {3.8010843940146313`*^9, 
   3.801084394972507*^9}, 
   3.822477161828249*^9},ExpressionUUID->"d88ee721-908b-47bb-b969-\
ed0e71e92b4b"],

Cell[CellGroupData[{

Cell["LegalTacticQ", "Subsubsection",
 CellChangeTimes->{{3.720631177329885*^9, 3.7206311891901913`*^9}, {
   3.720631833404027*^9, 3.720631834630166*^9}, {3.754825112649407*^9, 
   3.754825114681192*^9}, 
   3.801084416119522*^9},ExpressionUUID->"f3da0bfa-0224-4f86-a3fc-\
3d17d1996d08"],

Cell["\<\
Determines whether a tactic vector is legal, in the sense that the total of \
the absolute values of all tactics is 1. Output: Boolean.\
\>", "Text",
 CellChangeTimes->{{3.754853928432873*^9, 3.754853956022687*^9}, {
  3.755799937499702*^9, 
  3.755799940905294*^9}},ExpressionUUID->"e0fbb145-3453-4bc4-a42d-\
6c1e298f1a79"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LegalTacticQ", "[", "tactic_List", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Total", "[", 
     RowBox[{"RealAbs", "[", "tactic", "]"}], "]"}], "\[Equal]", "1"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.720624642070486*^9, 3.720624654344563*^9}, {
   3.720624685648876*^9, 3.7206246936131163`*^9}, {3.720631747397036*^9, 
   3.720631749754847*^9}, 3.754853885045845*^9, {3.7548539597282667`*^9, 
   3.754853960209915*^9}, 3.801084125467345*^9, {3.822341158182364*^9, 
   3.8223411587302723`*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"17fa623b-9563-4b2f-b789-d77117caf5b9"],

Cell["Unit tests:", "Text",
 CellChangeTimes->{{3.755085357688162*^9, 
  3.755085360162019*^9}},ExpressionUUID->"e65d337b-2af2-4e4c-b357-\
979b4ca125b7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"unitTests", "[", "\"\<LegalTacticQ\>\"", "]"}], " ", ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LegalTacticQ", "[", 
        RowBox[{"{", 
         RowBox[{".5", ",", "0", ",", "0", ",", 
          RowBox[{"-", ".5"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
       "True", ",", "\[IndentingNewLine]", 
       RowBox[{"TestID", "\[Rule]", "\"\<LegalTacticQ1\>\""}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LegalTacticQ", "[", 
        RowBox[{"{", 
         RowBox[{".5", ",", ".2", ",", "0", ",", 
          RowBox[{"-", ".5"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
       "False", ",", "\[IndentingNewLine]", 
       RowBox[{"TestID", "\[Rule]", "\"\<LegalTacticQ2\>\""}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7550841330433683`*^9, 3.755084135437353*^9}, {
   3.7550841708582687`*^9, 3.755084177444426*^9}, {3.75508488110111*^9, 
   3.755084921944516*^9}, {3.755085004683037*^9, 3.755085019160364*^9}, {
   3.755085236775576*^9, 3.7550852605358467`*^9}, {3.755085299455575*^9, 
   3.7550853362271223`*^9}, 3.755085432033588*^9, {3.755085559417843*^9, 
   3.755085605499104*^9}, {3.755085657127652*^9, 3.755085684055829*^9}, {
   3.7550857227312603`*^9, 3.755085757850277*^9}, {3.755085791385973*^9, 
   3.755085806043363*^9}, {3.755085848538776*^9, 3.7550858726824923`*^9}, {
   3.75508795469186*^9, 3.755087957061941*^9}, {3.801084129785132*^9, 
   3.801084140357876*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[91]:=",ExpressionUUID->"3c6964c3-5c62-424e-93af-bf5a9d10a015"]
}, Closed]],

Cell[CellGroupData[{

Cell["LegalTQ", "Subsubsection",
 CellChangeTimes->{{3.7548251177941217`*^9, 3.754825120858099*^9}, 
   3.801084412775964*^9},ExpressionUUID->"a4fb631c-f0d9-412d-80d8-\
82b4363eece4"],

Cell["\<\
Determines whether a tactic matrix is legal (see above). Output: Boolean.\
\>", "Text",
 CellChangeTimes->{{3.7557999561289053`*^9, 
  3.75579997087599*^9}},ExpressionUUID->"9c97b3f9-3337-4d8f-8e28-\
c415f9cbb2ae"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LegalTQ", "[", 
    RowBox[{"T_List", "?", "MatrixQ"}], "]"}], ":=", " ", 
   RowBox[{"AllTrue", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{"LegalTacticQ", ",", 
       RowBox[{"Transpose", "[", "T", "]"}]}], "]"}], ",", "TrueQ"}], "]"}]}],
   ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.710411563054179*^9, 3.7104116301897717`*^9}, {
   3.710411733778689*^9, 3.710411801492487*^9}, {3.710413063970853*^9, 
   3.710413065452837*^9}, {3.72063125174824*^9, 3.7206312833325777`*^9}, 
   3.720631694434793*^9, {3.720631733002804*^9, 3.720631733005909*^9}, {
   3.720631793351688*^9, 3.720631794390408*^9}, {3.754854114276277*^9, 
   3.7548541247864122`*^9}, 3.75485416552242*^9, 3.754854331034848*^9, {
   3.754854449137514*^9, 3.754854456438126*^9}, {3.754854561272225*^9, 
   3.75485456284907*^9}, {3.801084195743176*^9, 3.8010842046420107`*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"395b6552-019a-4a27-8125-d5b0c7392b3f"],

Cell["Unit tests:", "Text",
 CellChangeTimes->{{3.755085357688162*^9, 
  3.755085360162019*^9}},ExpressionUUID->"374456bc-d141-4fd4-9c39-\
bdd24005f38d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"unitTests", "[", "\"\<LegalTQ\>\"", "]"}], " ", ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LegalTQ", "[", 
        TagBox[
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {"0.5`", "0.3`"},
            {
             RowBox[{"-", "0.5`"}], "0.7`"}
           },
           
           GridBoxAlignment->{
            "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.7]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
         Function[BoxForm`e$, 
          MatrixForm[BoxForm`e$]]], "]"}], ",", "\[IndentingNewLine]", "True",
        ",", "\[IndentingNewLine]", 
       RowBox[{"TestID", "\[Rule]", "\"\<LegalTQ1\>\""}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LegalTQ", "[", 
        TagBox[
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {"0.6`", "0.3`"},
            {
             RowBox[{"-", "0.5`"}], "0.7`"}
           },
           
           GridBoxAlignment->{
            "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.7]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
         Function[BoxForm`e$, 
          MatrixForm[BoxForm`e$]]], "]"}], ",", "\[IndentingNewLine]", 
       "False", ",", "\[IndentingNewLine]", 
       RowBox[{"TestID", "\[Rule]", "\"\<LegalTQ2\>\""}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7550841330433683`*^9, 3.755084135437353*^9}, {
   3.7550841708582687`*^9, 3.755084177444426*^9}, {3.75508488110111*^9, 
   3.755084921944516*^9}, {3.755085004683037*^9, 3.755085019160364*^9}, {
   3.755085236775576*^9, 3.7550852605358467`*^9}, {3.755085299455575*^9, 
   3.7550853362271223`*^9}, 3.755085432033588*^9, {3.755085559417843*^9, 
   3.755085605499104*^9}, {3.755085657127652*^9, 3.755085684055829*^9}, {
   3.7550857227312603`*^9, 3.755085757850277*^9}, {3.755085791385973*^9, 
   3.755085806043363*^9}, {3.755085848538776*^9, 3.7550858726824923`*^9}, {
   3.755085921688486*^9, 3.755085975595923*^9}, {3.755087944867242*^9, 
   3.7550879472224703`*^9}, {3.801084237405308*^9, 3.801084252983861*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[93]:=",ExpressionUUID->"8d9fe989-bc9b-4c29-a8f3-21a82fba0595"]
}, Closed]],

Cell[CellGroupData[{

Cell["TernaryMatrixQ", "Subsubsection",
 CellChangeTimes->{{3.754935321541299*^9, 3.754935324119651*^9}, 
   3.801084421785803*^9, {3.801164471681096*^9, 
   3.801164472765727*^9}},ExpressionUUID->"eb4c6a30-fe09-4db6-813a-\
e04c970108df"],

Cell["\<\
Determines whether a matrix is a ternary matrix (i.e. one composed only of \
-1, 0, or 1s). Output: Boolean.\
\>", "Text",
 CellChangeTimes->{{3.755086767201038*^9, 3.7550868000068607`*^9}, {
  3.7558001209370623`*^9, 
  3.75580012360787*^9}},ExpressionUUID->"af970a27-14cb-4cda-bfb4-\
545c04ad9205"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TernaryMatrixQ", "[", 
   RowBox[{"TT_List", "?", "MatrixQ"}], "]"}], ":=", " ", 
  RowBox[{"ContainsOnly", "[", 
   RowBox[{
    RowBox[{"Flatten", "[", "TT", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1."}], ",", "0.", ",", "1."}], "}"}]}], "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.7549353343744392`*^9, 3.754935377524377*^9}, 
   3.754935441567823*^9, 3.801084428187233*^9, 3.801164476125705*^9, {
   3.8084853349261627`*^9, 3.808485336474045*^9}, {3.8216240495889177`*^9, 
   3.82162405125247*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"55220695-cbf3-4330-ae82-05d660118d44"],

Cell["Unit tests:", "Text",
 CellChangeTimes->{{3.755085357688162*^9, 
  3.755085360162019*^9}},ExpressionUUID->"ceba56ee-151e-4b94-88b3-\
a5e551ea6d89"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"unitTests", "[", "\"\<TernaryMatrixQ\>\"", "]"}], " ", ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"TernaryMatrixQ", "[", 
        RowBox[{"N", "[", 
         RowBox[{"IdentityMatrix", "[", "3", "]"}], "]"}], "]"}], ",", 
       "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
       RowBox[{"TestID", "\[Rule]", "\"\<TernaryMatrixQ1\>\""}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"TernaryMatrixQ", "[", 
        RowBox[{"RandomReal", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
       "\[IndentingNewLine]", "False", ",", "\[IndentingNewLine]", 
       RowBox[{"TestID", "\[Rule]", "\"\<TernaryMatrixQ2\>\""}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7550841330433683`*^9, 3.755084135437353*^9}, {
   3.7550841708582687`*^9, 3.755084177444426*^9}, {3.75508488110111*^9, 
   3.755084921944516*^9}, {3.755085004683037*^9, 3.755085019160364*^9}, {
   3.755085236775576*^9, 3.7550852605358467`*^9}, {3.755085299455575*^9, 
   3.7550853362271223`*^9}, 3.755085432033588*^9, {3.755085559417843*^9, 
   3.755085605499104*^9}, {3.755085657127652*^9, 3.755085684055829*^9}, {
   3.7550857227312603`*^9, 3.755085757850277*^9}, {3.755085791385973*^9, 
   3.755085806043363*^9}, {3.755085848538776*^9, 3.7550858726824923`*^9}, {
   3.755085921688486*^9, 3.755085975595923*^9}, {3.755086010930608*^9, 
   3.755086084763026*^9}, {3.7550861278999023`*^9, 3.755086145884115*^9}, {
   3.7550861893032513`*^9, 3.7550863415526657`*^9}, {3.755086381974959*^9, 
   3.755086392501211*^9}, {3.75508644659693*^9, 3.7550864513013277`*^9}, {
   3.75508649799314*^9, 3.7550865090662107`*^9}, {3.755086565163678*^9, 
   3.755086585445758*^9}, {3.755086655240406*^9, 3.755086701383586*^9}, {
   3.755086806299365*^9, 3.755086837717898*^9}, {3.75508786574509*^9, 
   3.755087868524876*^9}, {3.801084433586298*^9, 3.801084440848103*^9}, {
   3.801164477895351*^9, 3.801164495495634*^9}, 3.801164533507218*^9, {
   3.808485347886509*^9, 3.808485350096436*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->"In[95]:=",ExpressionUUID->"ac312053-2783-4caf-bda1-1093ce464af6"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Simulation Engine", "Section",
 CellChangeTimes->{{3.754824396185905*^9, 3.7548243975398808`*^9}, {
  3.801090830894559*^9, 
  3.8010908324913197`*^9}},ExpressionUUID->"b41532c4-8477-4382-ab10-\
02db2a91dbb3"],

Cell[CellGroupData[{

Cell["Law of Motion", "Subsection",
 CellChangeTimes->{{3.801084936578535*^9, 
  3.801084938271193*^9}},ExpressionUUID->"057eee5c-9c9c-4a5e-940b-\
58eb169c33a4"],

Cell[CellGroupData[{

Cell["UpdateS", "Subsubsection",
 CellChangeTimes->{{3.753828991263839*^9, 3.753828996871323*^9}, 
   3.753909820036879*^9, {3.754828693112978*^9, 3.754828695657708*^9}, 
   3.754865642085903*^9, 
   3.801122093630341*^9},ExpressionUUID->"cca2c86a-d275-4dc6-aeae-\
607c61bfd75e"],

Cell[TextData[{
 "Update the agents\[CloseCurlyQuote] sizes based on their current sizes and \
chosen tactics. The matrix ",
 StyleBox["T", "Input"],
 " is assumed to be composed of normalized tactic vectors emitted by the \
agents. There can be self-allocation within ",
 StyleBox["T", "Input"],
 "; any such values are subject to the decay constant ",
 StyleBox["\[Lambda]", "Input"],
 ". All elements in a ",
 StyleBox["T", "Input"],
 " must be real numbers. Output: size vector."
}], "Text",
 CellChangeTimes->{{3.7290897092760153`*^9, 3.72908979043408*^9}, {
   3.731850085671611*^9, 3.731850184497897*^9}, {3.755800346636673*^9, 
   3.755800351846171*^9}, 3.801122319700988*^9, {3.802432205708227*^9, 
   3.802432214724712*^9}},ExpressionUUID->"357b6f20-14a9-46e6-bc70-\
50e8bb92d6bc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"UpdateS", "[", 
   RowBox[{"s_", ",", "T_"}], "]"}], ":=", 
  RowBox[{"UpdateSCompiled", "[", 
   RowBox[{"s", ",", "T", ",", "\[Beta]", ",", "\[Mu]", ",", "\[Lambda]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.649198363277151*^9, 3.6491984162651463`*^9}, {
   3.649206481414444*^9, 3.649206495714161*^9}, 3.6492068506490192`*^9, {
   3.649271593382017*^9, 3.6492716127378693`*^9}, {3.656077133949854*^9, 
   3.6560771357543707`*^9}, {3.656077302901371*^9, 3.656077306666973*^9}, {
   3.656077438156075*^9, 3.656077441944166*^9}, {3.6560776095904627`*^9, 
   3.656077640490027*^9}, {3.656078129547412*^9, 3.656078131453774*^9}, {
   3.6560782058596973`*^9, 3.656078258508815*^9}, {3.656080653845047*^9, 
   3.656080658536487*^9}, 3.656080766658339*^9, {3.656177643095016*^9, 
   3.656177651691972*^9}, {3.65617773724955*^9, 3.656177753819661*^9}, {
   3.656177910803936*^9, 3.65617792516459*^9}, {3.656179502445065*^9, 
   3.6561795030249977`*^9}, {3.656287359949357*^9, 3.6562873857570467`*^9}, {
   3.656287424875969*^9, 3.656287441316004*^9}, {3.65628750369175*^9, 
   3.656287517092813*^9}, {3.656287673431219*^9, 3.656287679140408*^9}, {
   3.656498414930314*^9, 3.656498424953066*^9}, {3.6565873902255664`*^9, 
   3.656587394662205*^9}, 3.6565877194363766`*^9, {3.656606957973014*^9, 
   3.6566069913448544`*^9}, {3.656607309182287*^9, 3.656607312287788*^9}, {
   3.656608680170924*^9, 3.656608683362707*^9}, {3.656608749341218*^9, 
   3.656608775123317*^9}, {3.656608829060328*^9, 3.656608850585133*^9}, 
   3.65661520629086*^9, {3.6566154516108217`*^9, 3.6566154662614517`*^9}, {
   3.656615498391262*^9, 3.6566155003964977`*^9}, {3.661110145951926*^9, 
   3.6611101607543163`*^9}, {3.661121700395608*^9, 3.661121706620932*^9}, {
   3.661122190042446*^9, 3.661122198522696*^9}, {3.661170994000852*^9, 
   3.661171002920992*^9}, {3.661171050913595*^9, 3.661171055948532*^9}, {
   3.661171139895548*^9, 3.661171140322462*^9}, {3.661351165717534*^9, 
   3.661351236871127*^9}, {3.661351273670596*^9, 3.6613512784133873`*^9}, {
   3.6613514071179247`*^9, 3.661351494463436*^9}, {3.661555798057373*^9, 
   3.6615558261909*^9}, {3.661555856613575*^9, 3.661555871604834*^9}, {
   3.6615559026922913`*^9, 3.6615559194717417`*^9}, {3.661556007597518*^9, 
   3.661556045725984*^9}, {3.661556112376606*^9, 3.661556113075986*^9}, {
   3.6615561510548487`*^9, 3.6615561659522057`*^9}, {3.661556228147161*^9, 
   3.661556230800392*^9}, {3.66155626285905*^9, 3.661556271963739*^9}, {
   3.661556332259712*^9, 3.661556344656807*^9}, {3.661557552179593*^9, 
   3.661557570802569*^9}, {3.661559329984128*^9, 3.661559340531768*^9}, {
   3.6632650741742983`*^9, 3.663265084290515*^9}, {3.6632651147521133`*^9, 
   3.663265115110537*^9}, {3.673039729350103*^9, 3.673039734098569*^9}, {
   3.6733001951095343`*^9, 3.673300196522143*^9}, {3.6733004057178793`*^9, 
   3.673300434450405*^9}, {3.6733005166745872`*^9, 3.67330056567981*^9}, {
   3.673300618368849*^9, 3.6733006241991777`*^9}, {3.673301692832551*^9, 
   3.673301703362836*^9}, 3.673301978346355*^9, {3.6734313909371843`*^9, 
   3.673431394244669*^9}, {3.6734314867694674`*^9, 3.673431539485877*^9}, {
   3.673431591692094*^9, 3.673431606473196*^9}, {3.673431645541505*^9, 
   3.6734316633051367`*^9}, {3.6734316933499937`*^9, 3.673431741862466*^9}, 
   3.673431825670874*^9, {3.6734320372779303`*^9, 3.673432061901512*^9}, {
   3.673774287229416*^9, 3.673774312202571*^9}, {3.673774402555002*^9, 
   3.673774403127335*^9}, {3.6741238627866573`*^9, 3.6741238943454742`*^9}, {
   3.6741243708735857`*^9, 3.674124426709878*^9}, {3.674124630309826*^9, 
   3.674124658390678*^9}, {3.674124707491893*^9, 3.6741248166081*^9}, {
   3.674124894051136*^9, 3.67412493509982*^9}, {3.674125042203856*^9, 
   3.674125060197278*^9}, {3.674125123412019*^9, 3.67412513815838*^9}, {
   3.674125339541545*^9, 3.674125351200227*^9}, {3.6741255440684233`*^9, 
   3.674125558016932*^9}, {3.6741256021117907`*^9, 3.6741256314853163`*^9}, {
   3.674128783482708*^9, 3.674128788834435*^9}, {3.674128876514732*^9, 
   3.674128899937422*^9}, 3.674129177768401*^9, {3.674129777124147*^9, 
   3.674129786212558*^9}, {3.6741304060098343`*^9, 3.67413040712046*^9}, {
   3.674751410438253*^9, 3.6747514144920387`*^9}, {3.674751475144979*^9, 
   3.6747514769518137`*^9}, {3.674751510848196*^9, 3.674751551662765*^9}, {
   3.674751740946333*^9, 3.6747517515915337`*^9}, {3.674751975605337*^9, 
   3.674751986071556*^9}, {3.6747520240467777`*^9, 3.6747520457375097`*^9}, {
   3.6768865944439087`*^9, 3.676886636134362*^9}, {3.676886723306127*^9, 
   3.676886774942033*^9}, {3.676894406442295*^9, 3.67689443173628*^9}, {
   3.677149867715602*^9, 3.677149869840639*^9}, {3.677159679622752*^9, 
   3.6771596803282423`*^9}, {3.6781108505799427`*^9, 3.6781108580685797`*^9}, 
   3.686723989902549*^9, 3.6867271042169743`*^9, {3.686727146822722*^9, 
   3.686727147131205*^9}, {3.802356512326404*^9, 3.802356662031806*^9}, {
   3.8023566930184193`*^9, 3.8023566950128508`*^9}, {3.802356735856989*^9, 
   3.8023567420084057`*^9}, 3.8023598910883913`*^9, 3.8023600000329657`*^9, 
   3.802377794755992*^9, {3.802377837256319*^9, 3.8023778570103083`*^9}, {
   3.8023800255273447`*^9, 3.802380026306477*^9}, {3.802438295324247*^9, 
   3.802438329451254*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"890f0b18-195d-46b4-96de-69779d16a7f1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"UpdateSCompiled", "=", 
   RowBox[{"FunctionCompile", "[", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Typed", "[", 
         RowBox[{"s", ",", 
          RowBox[{
           RowBox[{"TypeSpecifier", "[", "\"\<PackedArray\>\"", "]"}], "[", 
           RowBox[{"\"\<Real64\>\"", ",", "1"}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Typed", "[", 
         RowBox[{"T", ",", 
          RowBox[{
           RowBox[{"TypeSpecifier", "[", "\"\<PackedArray\>\"", "]"}], "[", 
           RowBox[{"\"\<Real64\>\"", ",", "2"}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Typed", "[", 
         RowBox[{"\[Beta]", ",", "\"\<Real64\>\""}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Typed", "[", 
         RowBox[{"\[Mu]", ",", "\"\<Real64\>\""}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Typed", "[", 
         RowBox[{"\[Lambda]", ",", "\"\<Real64\>\""}], "]"}]}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Ramp", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"i", "==", "j"}], ",", 
            RowBox[{
             RowBox[{"T", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", "\[Lambda]"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"T", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], "<", "0"}], ",", 
              RowBox[{
               RowBox[{"T", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", "\[Mu]"}], ",", 
              RowBox[{
               RowBox[{"T", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", "\[Beta]"}]}], 
             "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "T", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}], ".", "s"}], 
       "]"}]}], "\[IndentingNewLine]", "]"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.691680437186426*^9, 3.6916804513125477`*^9}, 
   3.7544984599852533`*^9, 3.7548620765181913`*^9, {3.801164083026101*^9, 
   3.801164086416046*^9}, {3.802378956894918*^9, 3.802378982091714*^9}, {
   3.80237988396819*^9, 3.802379884861409*^9}, {3.802437539426619*^9, 
   3.802437572831341*^9}, {3.802437608199123*^9, 3.8024376339790287`*^9}, {
   3.802437685017303*^9, 3.802437686560375*^9}, 3.802437718324422*^9, {
   3.802437771354405*^9, 3.8024379291794367`*^9}, {3.802438001596094*^9, 
   3.8024380424294453`*^9}, {3.802438096042844*^9, 3.802438106981288*^9}, {
   3.802438145265174*^9, 3.802438145557116*^9}, {3.802438221754702*^9, 
   3.802438225278028*^9}, {3.8024382822338867`*^9, 3.802438284704303*^9}, 
   3.8043486102948513`*^9},
 CellLabel->"In[97]:=",ExpressionUUID->"f573c691-7d69-43d3-8136-e7b9de4259d4"],

Cell["\<\
Computes the size vector after multiple applications of the law of motion. \
Output: size vector.\
\>", "Text",
 CellChangeTimes->{{3.7910560666656723`*^9, 3.7910561788111897`*^9}, {
   3.791056271897455*^9, 3.791056273946423*^9}, 3.7944884490664663`*^9, {
   3.794488500866341*^9, 3.794488527195077*^9}, 
   3.794488688028792*^9},ExpressionUUID->"4565b7c1-d7f2-40aa-b3af-\
89e3cdd6fea1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"UpdateS", "[", 
   RowBox[{"s_List", ",", "T_List", ",", "depth_Integer"}], "]"}], ":=", 
  RowBox[{"Fold", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"UpdateS", "[", 
      RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", "s", ",", 
    RowBox[{"Table", "[", 
     RowBox[{"T", ",", "depth"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.791056014192029*^9, 3.7910560162621183`*^9}, 
   3.791056046959507*^9, {3.791056186741088*^9, 3.7910562487692747`*^9}, {
   3.79105638399893*^9, 3.791056474324587*^9}, {3.791057002194611*^9, 
   3.791057005239126*^9}, {3.791060426456596*^9, 3.791060434154483*^9}, {
   3.7915411013740807`*^9, 3.791541139380555*^9}, {3.791543706053969*^9, 
   3.791543706606966*^9}, {3.791547314441863*^9, 3.7915473181350822`*^9}, {
   3.7915474430980387`*^9, 3.791547444831214*^9}, {3.79214869465679*^9, 
   3.792148732060438*^9}, {3.792148770806653*^9, 3.7921487768084297`*^9}, {
   3.7944884680552607`*^9, 3.7944884904908733`*^9}, {3.801122167375999*^9, 
   3.801122171905632*^9}, 3.8023738383704557`*^9, {3.802374042205924*^9, 
   3.8023740460732603`*^9}, {3.808436832976232*^9, 3.808436833293194*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"64392b69-9608-4797-aa23-a515512b9649"],

Cell["\<\
Same as the above, but with parameters passed in as arguments (for testing). \
Output: size vector.\
\>", "Text",
 CellChangeTimes->{{3.7548660067583227`*^9, 3.7548660270925207`*^9}, {
  3.755800357814199*^9, 
  3.755800358151464*^9}},ExpressionUUID->"4730deec-65ad-4748-b608-\
825aed1dc123"],

Cell[BoxData[
 RowBox[{
  RowBox[{"UpdateS", "[", 
   RowBox[{"s_List", ",", "T_List", ",", 
    RowBox[{"{", 
     RowBox[{"\[Beta]_Real", ",", "\[Mu]_Real", ",", "\[Lambda]_Real"}], 
     "}"}]}], "]"}], ":=", 
  RowBox[{"UpdateSCompiled", "[", 
   RowBox[{
    RowBox[{"N", "[", "s", "]"}], ",", "T", ",", "\[Beta]", ",", "\[Mu]", ",",
     "\[Lambda]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7539089424940243`*^9, 3.753908955958776*^9}, {
   3.7548648689400187`*^9, 3.7548648719544773`*^9}, {3.754865379553236*^9, 
   3.754865383726663*^9}, {3.754865968508848*^9, 3.754865996055646*^9}, {
   3.755088696511406*^9, 3.7550886982075663`*^9}, 3.8011221627714376`*^9, 
   3.8023603960410347`*^9, {3.802431511627084*^9, 3.802431511882753*^9}, 
   3.802431623350376*^9, {3.802438613133678*^9, 3.802438641049919*^9}, {
   3.808436836566317*^9, 3.808436837868081*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"0db361d5-aecf-4865-a24c-3de81a705a0d"],

Cell["Unit tests:", "Text",
 CellChangeTimes->{{3.755085357688162*^9, 
  3.755085360162019*^9}},ExpressionUUID->"553489c5-bb30-448b-adf3-\
3981dd20f501"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"unitTests", "[", "\"\<UpdateS\>\"", "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"UpdateS", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", ".4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.9`", ",", 
             RowBox[{"-", "0.17`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.1`", ",", "0.83`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2.", ",", "3.", ",", "1."}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0.696`", ",", "0.532`"}], "}"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"TestID", "\[Rule]", "\"\<UpdateS1\>\""}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"UpdateS", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1.", ",", ".4"}], "}"}], ",", 
         RowBox[{"N", "[", 
          RowBox[{"IdentityMatrix", "[", "2", "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"2.", ",", "3.", ",", "1."}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"1.`", ",", "0.4`"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"TestID", "\[Rule]", "\"\<UpdateS2\>\""}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"UpdateS", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1.", ",", ".4"}], "}"}], ",", 
         RowBox[{"N", "[", 
          RowBox[{"IdentityMatrix", "[", "2", "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"2.", ",", "3.", ",", ".7"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0.7`", ",", "0.27999999999999997`"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TestID", "\[Rule]", "\"\<UpdateS3\>\""}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"UpdateS", "[", 
        RowBox[{
         RowBox[{"Range", "[", "10", "]"}], ",", 
         RowBox[{"N", "[", 
          RowBox[{"IdentityMatrix", "[", "10", "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"1.2", ",", "2.", ",", ".98"}], "}"}]}], "]"}], " ", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "0.98`", ",", "1.96`", ",", "2.94`", ",", "3.92`", ",", "4.9`", ",", 
         "5.88`", ",", "6.86`", ",", "7.84`", ",", "8.82`", ",", "9.8`"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"TestID", "\[Rule]", "\"\<UpdateS4\>\""}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"UpdateS", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
         RowBox[{"N", "[", 
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"1", "0", "0"},
             {"0", "1", "0"},
             {"0", "0", "1"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"1.2", ",", "3.", ",", "1."}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"1.", ",", "1.", ",", "1."}], "}"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"TestID", "\[Rule]", "\"\<UpdateS5\>\""}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"UpdateS", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"N", "[", 
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"0", "1", "0"},
             {"1", "0", "1"},
             {"0", "0", "0"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"2.", ",", "3.", ",", "1."}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TestID", "\[Rule]", "\"\<UpdateS6\>\""}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"UpdateS", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
         RowBox[{"N", "[", 
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"0", "1", "0"},
             {"1", "0", 
              RowBox[{"-", "1"}]},
             {"0", "0", "0"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"2.", ",", "3.", ",", "1."}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"2.", ",", "0.", ",", "0."}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TestID", "\[Rule]", "\"\<UpdateS7\>\""}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"UpdateS", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1.", ",", "1.", ",", "1."}], "}"}], ",", 
         RowBox[{"N", "[", 
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {".9", "0", "0"},
             {".1", "1", "0"},
             {"0", "0", "1"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"2.", ",", "3.", ",", "1."}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0.9`", ",", "1.2`", ",", "1.`"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TestID", "\[Rule]", "\"\<UpdateS8\>\""}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"UpdateS", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
         RowBox[{"N", "[", 
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {".9", "0", "0"},
             {
              RowBox[{"-", ".1"}], "1", "0"},
             {"0", "0", "1"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"2.", ",", "3.", ",", "1."}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0.9`", ",", "0.7`", ",", "1.`"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TestID", "\[Rule]", "\"\<UpdateS9\>\""}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"UpdateS", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
         RowBox[{"N", "[", 
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {".5", "0", "0"},
             {
              RowBox[{"-", ".5"}], "1", "0"},
             {"0", "0", "1"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"2.", ",", "3.", ",", "1."}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0.5`", ",", "0.`", ",", "1.`"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TestID", "\[Rule]", "\"\<UpdateS10\>\""}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"UpdateS", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
         RowBox[{"N", "[", 
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {".5", "0", "0"},
             {
              RowBox[{"-", ".5"}], "1", "0"},
             {"0", "0", "1"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"2.", ",", "3.", ",", ".9"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0.45`", ",", "0.`", ",", "0.9`"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TestID", "\[Rule]", "\"\<UpdateS11\>\""}]}], 
      "\[IndentingNewLine]", "]"}], " ", ",", "\[IndentingNewLine]", 
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"UpdateS", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
         RowBox[{"N", "[", 
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"0", "0", "0"},
             {"0", "0", "0"},
             {"0", "0", "0"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"1.2", ",", "2.", ",", "1."}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TestID", "\[Rule]", "\"\<UpdateS12\>\""}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"UpdateS", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
         RowBox[{"N", "[", 
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"1", "0", "0"},
             {"0", "1", "0"},
             {"0", "0", "1"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"2.", ",", "3.", ",", "1."}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"1.", ",", "1.", ",", "1."}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TestID", "\[Rule]", "\"\<UpdateS13\>\""}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"UpdateS", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
         RowBox[{"N", "[", 
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {
              RowBox[{"-", "1"}], "0", "0"},
             {"0", 
              RowBox[{"-", "1"}], "0"},
             {"0", "0", 
              RowBox[{"-", "1"}]}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"2.", ",", "3.", ",", "1."}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0.", ",", "0.", ",", "0."}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TestID", "\[Rule]", "\"\<UpdateS14\>\""}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"UpdateS", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
         RowBox[{"N", "[", 
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {".9", ".1", "0"},
             {".1", ".9", "0"},
             {"0", "0", "1"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"2.", ",", "3.", ",", "1."}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"1.1`", ",", "1.1`", ",", "1.`"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TestID", "\[Rule]", "\"\<UpdateS15\>\""}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"UpdateS", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
         RowBox[{"N", "[", 
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {".9", ".1", "0"},
             {".1", ".9", "0"},
             {"0", "0", "1"}
            },
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"2.", ",", "3.", ",", ".8"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "0.9200000000000002`", ",", "0.9200000000000002`", ",", "0.8`"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"TestID", "\[Rule]", "\"\<UpdateS16\>\""}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"UpdateS", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
         RowBox[{"N", "[", 
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {".9", ".1", "0"},
             {".1", ".9", 
              RowBox[{"-", ".2"}]},
             {"0", "0", ".8"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"2.", ",", "3.", ",", "1."}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"1.1`", ",", "0.5`", ",", "0.8`"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TestID", "\[Rule]", "\"\<UpdateS17\>\""}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7550841330433683`*^9, 3.755084135437353*^9}, {
   3.7550841708582687`*^9, 3.755084177444426*^9}, {3.75508488110111*^9, 
   3.755084921944516*^9}, {3.755085004683037*^9, 3.755085019160364*^9}, {
   3.755085236775576*^9, 3.7550852605358467`*^9}, {3.755085299455575*^9, 
   3.7550853362271223`*^9}, 3.755085432033588*^9, {3.755085559417843*^9, 
   3.755085605499104*^9}, {3.755085657127652*^9, 3.755085684055829*^9}, {
   3.7550857227312603`*^9, 3.755085757850277*^9}, {3.755085791385973*^9, 
   3.755085806043363*^9}, {3.755085848538776*^9, 3.7550858726824923`*^9}, {
   3.755085921688486*^9, 3.755085975595923*^9}, {3.755086010930608*^9, 
   3.755086084763026*^9}, {3.7550861278999023`*^9, 3.755086145884115*^9}, {
   3.7550861893032513`*^9, 3.7550863415526657`*^9}, {3.755086381974959*^9, 
   3.755086392501211*^9}, {3.75508644659693*^9, 3.7550864513013277`*^9}, {
   3.75508649799314*^9, 3.7550865090662107`*^9}, {3.755086565163678*^9, 
   3.755086585445758*^9}, {3.755086655240406*^9, 3.755086701383586*^9}, {
   3.755086806299365*^9, 3.755086837717898*^9}, {3.755086948783966*^9, 
   3.755087022479724*^9}, {3.7550870816896*^9, 3.755087134007586*^9}, {
   3.755087422831038*^9, 3.755087427098736*^9}, {3.755087460919154*^9, 
   3.755087557692718*^9}, {3.755087590425846*^9, 3.755087598858591*^9}, {
   3.7550880654352913`*^9, 3.755088082040506*^9}, {3.755088504368958*^9, 
   3.755088513807843*^9}, {3.755088578357264*^9, 3.7550886228558407`*^9}, {
   3.755088655821022*^9, 3.755088668539598*^9}, {3.755088737237715*^9, 
   3.755088762383355*^9}, {3.755095457139708*^9, 3.7550956469953403`*^9}, {
   3.755095783979044*^9, 3.7550959041082697`*^9}, {3.801122175117791*^9, 
   3.801122257296659*^9}, 3.802360482575943*^9, {3.802431551150506*^9, 
   3.802431583732473*^9}, {3.802431698649992*^9, 3.8024318709074993`*^9}, 
   3.802431910031144*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[100]:=",ExpressionUUID->"97f90c39-7743-4bf8-92de-2dcff0b895b0"]
}, Closed]],

Cell[CellGroupData[{

Cell["UpdatePowerStructure", "Subsubsection",
 CellChangeTimes->{{3.754865650459673*^9, 3.75486565289047*^9}, {
   3.7549302019579*^9, 3.754930204176852*^9}, {3.75499833238932*^9, 
   3.7549983345359898`*^9}, {3.755017731093091*^9, 3.755017732020474*^9}, 
   3.801122726093787*^9},ExpressionUUID->"291409ae-96d1-4348-9b21-\
9f622bf73d39"],

Cell[TextData[{
 "Given a power structure and a new tactic matrix, updates the size vector \
and returns a new power structure. This version can be used within a ",
 StyleBox["Fold", "Input"],
 ", which is why it takes an additional tactic matrix as input. Output: power \
structure."
}], "Text",
 CellChangeTimes->{{3.75486653808435*^9, 3.754866558554791*^9}, {
  3.754930369182404*^9, 3.754930375566269*^9}, {3.755017587995083*^9, 
  3.755017598525723*^9}, {3.755017737718236*^9, 3.755017750288447*^9}, {
  3.755800363714363*^9, 
  3.75580036895662*^9}},ExpressionUUID->"3962441d-dc23-4b6d-99d8-\
0012f1e7714b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"UpdatePowerStructure", "[", 
   RowBox[{"ps_", ",", "T_"}], "]"}], ":=", 
  RowBox[{"<|", 
   RowBox[{
    RowBox[{"\"\<s\>\"", "\[Rule]", 
     RowBox[{"UpdateS", "[", 
      RowBox[{
       RowBox[{"ps", "[", "\"\<s\>\"", "]"}], ",", "T"}], "]"}]}], ",", 
    RowBox[{"\"\<T\>\"", "\[Rule]", "T"}]}], "|>"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.649198363277151*^9, 3.6491984162651463`*^9}, {
   3.649206481414444*^9, 3.649206495714161*^9}, 3.6492068506490192`*^9, {
   3.649271593382017*^9, 3.6492716127378693`*^9}, {3.656077133949854*^9, 
   3.6560771357543707`*^9}, {3.656077302901371*^9, 3.656077306666973*^9}, {
   3.656077438156075*^9, 3.656077441944166*^9}, {3.6560776095904627`*^9, 
   3.656077640490027*^9}, {3.656078129547412*^9, 3.656078131453774*^9}, {
   3.6560782058596973`*^9, 3.656078258508815*^9}, {3.656080653845047*^9, 
   3.656080658536487*^9}, 3.656080766658339*^9, {3.656177643095016*^9, 
   3.656177651691972*^9}, {3.65617773724955*^9, 3.656177753819661*^9}, {
   3.656177910803936*^9, 3.65617792516459*^9}, {3.656179502445065*^9, 
   3.6561795030249977`*^9}, {3.656287359949357*^9, 3.6562873857570467`*^9}, {
   3.656287424875969*^9, 3.656287441316004*^9}, {3.65628750369175*^9, 
   3.656287517092813*^9}, {3.656287673431219*^9, 3.656287679140408*^9}, {
   3.656498414930314*^9, 3.656498424953066*^9}, {3.6565873902255664`*^9, 
   3.656587394662205*^9}, 3.6565877194363766`*^9, {3.656606957973014*^9, 
   3.6566069913448544`*^9}, {3.656607309182287*^9, 3.656607312287788*^9}, {
   3.656608680170924*^9, 3.656608683362707*^9}, {3.656608749341218*^9, 
   3.656608775123317*^9}, {3.656608829060328*^9, 3.656608850585133*^9}, 
   3.65661520629086*^9, {3.6566154516108217`*^9, 3.6566154662614517`*^9}, {
   3.656615498391262*^9, 3.6566155003964977`*^9}, {3.661110145951926*^9, 
   3.6611101607543163`*^9}, {3.661121700395608*^9, 3.661121706620932*^9}, {
   3.661122190042446*^9, 3.661122198522696*^9}, {3.661170994000852*^9, 
   3.661171002920992*^9}, {3.661171050913595*^9, 3.661171055948532*^9}, {
   3.661171139895548*^9, 3.661171140322462*^9}, {3.661351165717534*^9, 
   3.661351236871127*^9}, {3.661351273670596*^9, 3.6613512784133873`*^9}, {
   3.6613514071179247`*^9, 3.661351494463436*^9}, {3.661555798057373*^9, 
   3.6615558261909*^9}, {3.661555856613575*^9, 3.661555871604834*^9}, {
   3.6615559026922913`*^9, 3.6615559194717417`*^9}, {3.661556007597518*^9, 
   3.661556045725984*^9}, {3.661556112376606*^9, 3.661556113075986*^9}, {
   3.6615561510548487`*^9, 3.6615561659522057`*^9}, {3.661556228147161*^9, 
   3.661556230800392*^9}, {3.66155626285905*^9, 3.661556271963739*^9}, {
   3.661556332259712*^9, 3.661556344656807*^9}, {3.661557552179593*^9, 
   3.661557570802569*^9}, {3.661559329984128*^9, 3.661559340531768*^9}, {
   3.6632650741742983`*^9, 3.663265084290515*^9}, {3.6632651147521133`*^9, 
   3.663265115110537*^9}, {3.673039729350103*^9, 3.673039734098569*^9}, {
   3.6733001951095343`*^9, 3.673300196522143*^9}, {3.6733004057178793`*^9, 
   3.673300434450405*^9}, {3.6733005166745872`*^9, 3.67330056567981*^9}, {
   3.673300618368849*^9, 3.6733006241991777`*^9}, {3.673301692832551*^9, 
   3.673301703362836*^9}, 3.673301978346355*^9, {3.6734313909371843`*^9, 
   3.673431394244669*^9}, {3.6734314867694674`*^9, 3.673431539485877*^9}, {
   3.673431591692094*^9, 3.673431606473196*^9}, {3.673431645541505*^9, 
   3.6734316633051367`*^9}, {3.6734316933499937`*^9, 3.673431741862466*^9}, 
   3.673431825670874*^9, {3.6734320372779303`*^9, 3.673432061901512*^9}, {
   3.673774287229416*^9, 3.673774312202571*^9}, {3.673774402555002*^9, 
   3.673774403127335*^9}, {3.6741238627866573`*^9, 3.6741238943454742`*^9}, {
   3.6741243708735857`*^9, 3.674124426709878*^9}, {3.674124630309826*^9, 
   3.674124658390678*^9}, {3.674124707491893*^9, 3.6741248166081*^9}, {
   3.674124894051136*^9, 3.67412493509982*^9}, {3.674125042203856*^9, 
   3.674125060197278*^9}, {3.674125123412019*^9, 3.67412513815838*^9}, {
   3.674125339541545*^9, 3.674125351200227*^9}, {3.6741255440684233`*^9, 
   3.674125558016932*^9}, {3.6741256021117907`*^9, 3.6741256314853163`*^9}, {
   3.674128783482708*^9, 3.674128788834435*^9}, {3.674128876514732*^9, 
   3.674128899937422*^9}, 3.674129177768401*^9, {3.674129777124147*^9, 
   3.674129786212558*^9}, {3.6741304060098343`*^9, 3.67413040712046*^9}, {
   3.674751410438253*^9, 3.6747514144920387`*^9}, {3.674751475144979*^9, 
   3.6747514769518137`*^9}, {3.674751510848196*^9, 3.674751551662765*^9}, {
   3.674751740946333*^9, 3.6747517515915337`*^9}, {3.674751975605337*^9, 
   3.674751986071556*^9}, {3.6747520240467777`*^9, 3.6747520457375097`*^9}, {
   3.6768865944439087`*^9, 3.676886636134362*^9}, {3.676886723306127*^9, 
   3.676886774942033*^9}, {3.676894406442295*^9, 3.67689443173628*^9}, {
   3.677149867715602*^9, 3.677149869840639*^9}, {3.677159679622752*^9, 
   3.6771596803282423`*^9}, {3.6781108505799427`*^9, 3.6781108580685797`*^9}, 
   3.686723989902549*^9, 3.6867271042169743`*^9, {3.686727146822722*^9, 
   3.686727147131205*^9}, {3.703180880090208*^9, 3.7031809548590527`*^9}, 
   3.704288075836446*^9, 3.704288178026847*^9, {3.704288237864027*^9, 
   3.70428832298876*^9}, {3.704288399867215*^9, 3.704288409625354*^9}, {
   3.720727986402472*^9, 3.7207279868680353`*^9}, 3.720728149279654*^9, {
   3.720728187341312*^9, 3.720728191158327*^9}, {3.720729681108529*^9, 
   3.72072968701682*^9}, {3.72411128100948*^9, 3.724111282573893*^9}, {
   3.754866219383655*^9, 3.754866246570752*^9}, {3.7548663075905037`*^9, 
   3.754866318278685*^9}, {3.75486636205752*^9, 3.75486636737564*^9}, {
   3.7548664013619013`*^9, 3.754866403112039*^9}, {3.754866910535593*^9, 
   3.754866921205514*^9}, {3.754930220001556*^9, 3.7549302463053417`*^9}, {
   3.755017658634954*^9, 3.7550176587773037`*^9}, {3.755017707061716*^9, 
   3.7550177216860323`*^9}, {3.755722856561997*^9, 3.75572289688465*^9}, {
   3.755723326890297*^9, 3.75572333533298*^9}, {3.755723490203536*^9, 
   3.75572349137556*^9}, {3.8011223862901907`*^9, 3.801122395040803*^9}, {
   3.802355964999875*^9, 3.802355975733992*^9}, 3.802385259681078*^9, {
   3.802385908378385*^9, 3.8023859105422363`*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"09dc131c-d43f-4a1b-b4d9-8d9297fb8a5d"],

Cell["\<\
Same as the above, but this version uses the T within the power structure in \
the determination of the updated size vector. Output: power structure.\
\>", "Text",
 CellChangeTimes->{{3.7550176618551683`*^9, 3.75501769932838*^9}, {
  3.755800373641521*^9, 
  3.755800374604539*^9}},ExpressionUUID->"f7e4b9aa-6559-4f35-af86-\
8263cd71216b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"UpdatePowerStructure", "[", "ps_", "]"}], ":=", 
  RowBox[{"UpdatePowerStructure", "[", 
   RowBox[{"ps", ",", 
    RowBox[{"ps", "[", "\"\<T\>\"", "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.649198363277151*^9, 3.6491984162651463`*^9}, {
   3.649206481414444*^9, 3.649206495714161*^9}, 3.6492068506490192`*^9, {
   3.649271593382017*^9, 3.6492716127378693`*^9}, {3.656077133949854*^9, 
   3.6560771357543707`*^9}, {3.656077302901371*^9, 3.656077306666973*^9}, {
   3.656077438156075*^9, 3.656077441944166*^9}, {3.6560776095904627`*^9, 
   3.656077640490027*^9}, {3.656078129547412*^9, 3.656078131453774*^9}, {
   3.6560782058596973`*^9, 3.656078258508815*^9}, {3.656080653845047*^9, 
   3.656080658536487*^9}, 3.656080766658339*^9, {3.656177643095016*^9, 
   3.656177651691972*^9}, {3.65617773724955*^9, 3.656177753819661*^9}, {
   3.656177910803936*^9, 3.65617792516459*^9}, {3.656179502445065*^9, 
   3.6561795030249977`*^9}, {3.656287359949357*^9, 3.6562873857570467`*^9}, {
   3.656287424875969*^9, 3.656287441316004*^9}, {3.65628750369175*^9, 
   3.656287517092813*^9}, {3.656287673431219*^9, 3.656287679140408*^9}, {
   3.656498414930314*^9, 3.656498424953066*^9}, {3.6565873902255664`*^9, 
   3.656587394662205*^9}, 3.6565877194363766`*^9, {3.656606957973014*^9, 
   3.6566069913448544`*^9}, {3.656607309182287*^9, 3.656607312287788*^9}, {
   3.656608680170924*^9, 3.656608683362707*^9}, {3.656608749341218*^9, 
   3.656608775123317*^9}, {3.656608829060328*^9, 3.656608850585133*^9}, 
   3.65661520629086*^9, {3.6566154516108217`*^9, 3.6566154662614517`*^9}, {
   3.656615498391262*^9, 3.6566155003964977`*^9}, {3.661110145951926*^9, 
   3.6611101607543163`*^9}, {3.661121700395608*^9, 3.661121706620932*^9}, {
   3.661122190042446*^9, 3.661122198522696*^9}, {3.661170994000852*^9, 
   3.661171002920992*^9}, {3.661171050913595*^9, 3.661171055948532*^9}, {
   3.661171139895548*^9, 3.661171140322462*^9}, {3.661351165717534*^9, 
   3.661351236871127*^9}, {3.661351273670596*^9, 3.6613512784133873`*^9}, {
   3.6613514071179247`*^9, 3.661351494463436*^9}, {3.661555798057373*^9, 
   3.6615558261909*^9}, {3.661555856613575*^9, 3.661555871604834*^9}, {
   3.6615559026922913`*^9, 3.6615559194717417`*^9}, {3.661556007597518*^9, 
   3.661556045725984*^9}, {3.661556112376606*^9, 3.661556113075986*^9}, {
   3.6615561510548487`*^9, 3.6615561659522057`*^9}, {3.661556228147161*^9, 
   3.661556230800392*^9}, {3.66155626285905*^9, 3.661556271963739*^9}, {
   3.661556332259712*^9, 3.661556344656807*^9}, {3.661557552179593*^9, 
   3.661557570802569*^9}, {3.661559329984128*^9, 3.661559340531768*^9}, {
   3.6632650741742983`*^9, 3.663265084290515*^9}, {3.6632651147521133`*^9, 
   3.663265115110537*^9}, {3.673039729350103*^9, 3.673039734098569*^9}, {
   3.6733001951095343`*^9, 3.673300196522143*^9}, {3.6733004057178793`*^9, 
   3.673300434450405*^9}, {3.6733005166745872`*^9, 3.67330056567981*^9}, {
   3.673300618368849*^9, 3.6733006241991777`*^9}, {3.673301692832551*^9, 
   3.673301703362836*^9}, 3.673301978346355*^9, {3.6734313909371843`*^9, 
   3.673431394244669*^9}, {3.6734314867694674`*^9, 3.673431539485877*^9}, {
   3.673431591692094*^9, 3.673431606473196*^9}, {3.673431645541505*^9, 
   3.6734316633051367`*^9}, {3.6734316933499937`*^9, 3.673431741862466*^9}, 
   3.673431825670874*^9, {3.6734320372779303`*^9, 3.673432061901512*^9}, {
   3.673774287229416*^9, 3.673774312202571*^9}, {3.673774402555002*^9, 
   3.673774403127335*^9}, {3.6741238627866573`*^9, 3.6741238943454742`*^9}, {
   3.6741243708735857`*^9, 3.674124426709878*^9}, {3.674124630309826*^9, 
   3.674124658390678*^9}, {3.674124707491893*^9, 3.6741248166081*^9}, {
   3.674124894051136*^9, 3.67412493509982*^9}, {3.674125042203856*^9, 
   3.674125060197278*^9}, {3.674125123412019*^9, 3.67412513815838*^9}, {
   3.674125339541545*^9, 3.674125351200227*^9}, {3.6741255440684233`*^9, 
   3.674125558016932*^9}, {3.6741256021117907`*^9, 3.6741256314853163`*^9}, {
   3.674128783482708*^9, 3.674128788834435*^9}, {3.674128876514732*^9, 
   3.674128899937422*^9}, 3.674129177768401*^9, {3.674129777124147*^9, 
   3.674129786212558*^9}, {3.6741304060098343`*^9, 3.67413040712046*^9}, {
   3.674751410438253*^9, 3.6747514144920387`*^9}, {3.674751475144979*^9, 
   3.6747514769518137`*^9}, {3.674751510848196*^9, 3.674751551662765*^9}, {
   3.674751740946333*^9, 3.6747517515915337`*^9}, {3.674751975605337*^9, 
   3.674751986071556*^9}, {3.6747520240467777`*^9, 3.6747520457375097`*^9}, {
   3.6768865944439087`*^9, 3.676886636134362*^9}, {3.676886723306127*^9, 
   3.676886774942033*^9}, {3.676894406442295*^9, 3.67689443173628*^9}, {
   3.677149867715602*^9, 3.677149869840639*^9}, {3.677159679622752*^9, 
   3.6771596803282423`*^9}, {3.6781108505799427`*^9, 3.6781108580685797`*^9}, 
   3.686723989902549*^9, 3.6867271042169743`*^9, {3.686727146822722*^9, 
   3.686727147131205*^9}, {3.703180880090208*^9, 3.7031809548590527`*^9}, 
   3.704288075836446*^9, 3.704288178026847*^9, {3.704288237864027*^9, 
   3.70428832298876*^9}, {3.704288399867215*^9, 3.704288409625354*^9}, {
   3.720727986402472*^9, 3.7207279868680353`*^9}, 3.720728149279654*^9, {
   3.720728187341312*^9, 3.720728191158327*^9}, {3.720729681108529*^9, 
   3.72072968701682*^9}, {3.72411128100948*^9, 3.724111282573893*^9}, {
   3.754866219383655*^9, 3.754866246570752*^9}, {3.7548663075905037`*^9, 
   3.754866318278685*^9}, {3.75486636205752*^9, 3.75486636737564*^9}, {
   3.7548664013619013`*^9, 3.754866403112039*^9}, {3.754866910535593*^9, 
   3.754866921205514*^9}, {3.754930220001556*^9, 3.7549302463053417`*^9}, {
   3.755017658634954*^9, 3.7550176587773037`*^9}, {3.755017707061716*^9, 
   3.7550177216860323`*^9}, {3.755722856561997*^9, 3.75572289688465*^9}, {
   3.755723415504943*^9, 3.755723425444026*^9}, {3.7557234700831413`*^9, 
   3.7557234759004507`*^9}, {3.801122388040627*^9, 3.8011223988672943`*^9}, {
   3.8023559846963053`*^9, 3.8023559889552183`*^9}, {3.8023857626264343`*^9, 
   3.802385772698347*^9}, 3.802385905468156*^9},
 CellLabel->
  "In[102]:=",ExpressionUUID->"72f23bdb-2555-4c8e-9992-fd6b554fab1d"]
}, Closed]],

Cell[CellGroupData[{

Cell["UpdatePowerStructureR", "Subsubsection",
 CellChangeTimes->{{3.8204986040784883`*^9, 3.8204986101090193`*^9}, 
   3.820501027443708*^9, 
   3.822479621203269*^9},ExpressionUUID->"49d564d4-0ed6-4bd4-a946-\
4ac57dac6655"],

Cell["\<\
Reciprocalize a move matrix M and update the size vector accordingly. Output: \
power structure.\
\>", "Text",
 CellChangeTimes->{{3.8205006132733707`*^9, 3.8205006357580767`*^9}, {
  3.820500690212428*^9, 
  3.820500694930037*^9}},ExpressionUUID->"19d86897-d133-44fd-b0df-\
92fb0f4e4cb7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"UpdatePowerStructureR", "[", 
   RowBox[{"s_", ",", "M_"}], "]"}], ":=", " ", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"T", "=", 
      RowBox[{"ReciprocalizeT", "[", 
       RowBox[{"s", ",", "M"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"<|", 
     RowBox[{
      RowBox[{"\"\<s\>\"", "\[Rule]", 
       RowBox[{"UpdateS", "[", 
        RowBox[{"s", ",", "T"}], "]"}]}], ",", 
      RowBox[{"\"\<T\>\"", "\[Rule]", "T"}], ",", 
      RowBox[{"\"\<M\>\"", "\[Rule]", "M"}]}], "|>"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.820500432500852*^9, 3.820500485033463*^9}, {
   3.820500664938386*^9, 3.820500681781345*^9}, {3.820500722679812*^9, 
   3.820500733489828*^9}, {3.8205007691797447`*^9, 3.8205007829491043`*^9}, {
   3.82050081618183*^9, 3.820500818212523*^9}, {3.820750934803125*^9, 
   3.820750941192265*^9}, {3.8223225690876083`*^9, 3.822322573260385*^9}, 
   3.8224796262549067`*^9},
 CellLabel->
  "In[103]:=",ExpressionUUID->"8e5e8b66-4058-45b9-96db-effd06f96fcf"]
}, Closed]],

Cell[CellGroupData[{

Cell["SimulateLawOfMotion", "Subsubsection",
 CellChangeTimes->{{3.75492891418504*^9, 
  3.754928922162866*^9}},ExpressionUUID->"6495795f-4be9-42da-9e60-\
4adf6d3da416"],

Cell["\<\
Generates a simulation (a list of power structures) by repeatedly applying \
the law of motion (game engine) to a power structure. None of the agents \
change their tactics. Output: a simulation (list of power structures).\
\>", "Text",
 CellChangeTimes->{{3.755800383533646*^9, 
  3.755800458001463*^9}},ExpressionUUID->"4993fdf8-eed6-4761-be0f-\
9ae03bb5bcf0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SimulateLawOfMotion", "[", "ps_Association", "]"}], ":=", " ", 
  RowBox[{"SimulateLawOfMotion", "[", 
   RowBox[{"ps", ",", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"ps", "[", "\"\<T\>\"", "]"}], ",", 
      RowBox[{"DeltaToSteps", "[", "\[Delta]", "]"}]}], "]"}]}], "]"}], 
  " "}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.754928926327066*^9, 3.754928983979445*^9}, {
   3.754930298312147*^9, 3.754930303240717*^9}, 3.754999791599217*^9, {
   3.75499982839324*^9, 3.754999828787718*^9}, {3.7550425243309317`*^9, 
   3.755042527239995*^9}, 3.801122800365807*^9, 3.801122880824044*^9},
 CellLabel->
  "In[104]:=",ExpressionUUID->"ded864de-7e55-4a5c-8a6d-9eabda5454e1"],

Cell["\<\
Given a sequence of tactic matrices and an initial power structure, simulate \
the sequence of moves and determine the resulting state at each step. Output: \
a simulation (list of power structures).\
\>", "Text",
 CellChangeTimes->{{3.67688583478159*^9, 3.676885870256967*^9}, {
  3.677844087660995*^9, 3.677844108515728*^9}, {3.677844162380732*^9, 
  3.677844162917028*^9}, {3.6778442020295343`*^9, 3.677844202549564*^9}, {
  3.687209488439939*^9, 3.687209496999339*^9}, {3.687212069204561*^9, 
  3.687212080654071*^9}, {3.709900106058302*^9, 3.709900109905491*^9}, {
  3.7548682645827312`*^9, 3.754868277910754*^9}, {3.754868317574963*^9, 
  3.754868323505372*^9}, {3.754930284113139*^9, 3.754930286346572*^9}, {
  3.754930386415433*^9, 3.754930399547648*^9}, {3.755800444169188*^9, 
  3.755800450363195*^9}},ExpressionUUID->"7ed686b5-0511-4c99-b49f-\
8d317a9573b4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SimulateLawOfMotion", "[", 
   RowBox[{"ps_Association", ",", " ", "tacticMatrixSequence_List"}], "]"}], 
  " ", ":=", " ", 
  RowBox[{"FoldList", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"UpdatePowerStructure", "[", 
      RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", "ps", ",", 
    "tacticMatrixSequence"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6869861757154913`*^9, 3.686986239888172*^9}, {
   3.704289254983355*^9, 3.704289266120922*^9}, {3.70428932493626*^9, 
   3.704289329003169*^9}, {3.7043594626205072`*^9, 3.704359483162403*^9}, {
   3.7043596577710447`*^9, 3.7043596665089893`*^9}, {3.720728340295416*^9, 
   3.7207283406325808`*^9}, {3.72072846678295*^9, 3.720728469192758*^9}, {
   3.7207285980014973`*^9, 3.720728607684515*^9}, {3.720729726103505*^9, 
   3.720729726697566*^9}, {3.75486718174969*^9, 3.75486719561759*^9}, {
   3.754867443617052*^9, 3.754867467927876*^9}, 3.754868000029801*^9, 
   3.7548682476034203`*^9, {3.7549302611624527`*^9, 3.754930271595069*^9}, {
   3.755042535169484*^9, 3.755042536376874*^9}, 3.8011228265187397`*^9, 
   3.8011228692708263`*^9, 3.8011646816346397`*^9},
 CellLabel->
  "In[105]:=",ExpressionUUID->"81473f9b-9e59-49eb-b4a6-711da5c39eb2"],

Cell["Unit tests:", "Text",
 CellChangeTimes->{{3.755085357688162*^9, 
  3.755085360162019*^9}},ExpressionUUID->"f3b3bb51-d8ea-4f7d-bdab-\
fda58a7c1950"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"unitTests", "[", "\"\<SimulateLawOfMotion\>\"", "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"LegalTQ", "[", 
       RowBox[{
        RowBox[{"RandomChoice", "[", "\[IndentingNewLine]", 
         RowBox[{"SimulateLawOfMotion", "[", 
          RowBox[{"RandomTernaryPowerStructure", "[", "6", "]"}], "]"}], 
         "\[IndentingNewLine]", "]"}], "[", "\"\<T\>\"", "]"}], "]"}], ",", 
      "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
      RowBox[{"TestID", "\[Rule]", "\"\<SimulateLawOfMotion1\>\""}]}], 
     "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7550841330433683`*^9, 3.755084135437353*^9}, {
   3.7550841708582687`*^9, 3.755084177444426*^9}, {3.75508488110111*^9, 
   3.755084921944516*^9}, {3.755085004683037*^9, 3.755085019160364*^9}, {
   3.755085236775576*^9, 3.7550852605358467`*^9}, {3.755085299455575*^9, 
   3.7550853362271223`*^9}, 3.755085432033588*^9, {3.755085559417843*^9, 
   3.755085605499104*^9}, {3.755085657127652*^9, 3.755085684055829*^9}, {
   3.7550857227312603`*^9, 3.755085757850277*^9}, {3.755085791385973*^9, 
   3.755085806043363*^9}, {3.755085848538776*^9, 3.7550858726824923`*^9}, {
   3.755085921688486*^9, 3.755085975595923*^9}, {3.755086010930608*^9, 
   3.755086084763026*^9}, {3.7550861278999023`*^9, 3.755086145884115*^9}, {
   3.7550861893032513`*^9, 3.7550863415526657`*^9}, {3.755086381974959*^9, 
   3.755086392501211*^9}, {3.75508644659693*^9, 3.7550864513013277`*^9}, {
   3.75508649799314*^9, 3.7550865090662107`*^9}, {3.755086565163678*^9, 
   3.755086585445758*^9}, {3.755086655240406*^9, 3.755086701383586*^9}, {
   3.755086806299365*^9, 3.755086837717898*^9}, {3.755086948783966*^9, 
   3.755087022479724*^9}, {3.7550870816896*^9, 3.755087134007586*^9}, {
   3.755087422831038*^9, 3.755087427098736*^9}, {3.755087460919154*^9, 
   3.755087557692718*^9}, {3.755087590425846*^9, 3.755087598858591*^9}, {
   3.7550880654352913`*^9, 3.755088082040506*^9}, {3.755088504368958*^9, 
   3.755088513807843*^9}, {3.755088578357264*^9, 3.7550886228558407`*^9}, {
   3.755088655821022*^9, 3.755088668539598*^9}, {3.755088737237715*^9, 
   3.755088762383355*^9}, {3.755088823716557*^9, 3.755088897790244*^9}, {
   3.7550890185207663`*^9, 3.7550890208638763`*^9}, 3.801122808515073*^9, {
   3.801122890727194*^9, 3.801122922250186*^9}, {3.801163858493494*^9, 
   3.80116389286456*^9}, 3.801165746538835*^9},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[106]:=",ExpressionUUID->"fa7c7cd5-d090-4b88-a8a3-62c7a07d692e"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Metrics", "Subsection",
 CellChangeTimes->{{3.801084945305931*^9, 3.801084947137768*^9}, {
  3.8010905867024307`*^9, 
  3.801090587650612*^9}},ExpressionUUID->"596e19ab-ba32-4756-bcbc-\
79d9ad5b7d9f"],

Cell[CellGroupData[{

Cell["Utility", "Subsubsection",
 CellChangeTimes->{{3.661104328187312*^9, 3.661104330167946*^9}, 
   3.753908492638961*^9, {3.754828678798031*^9, 3.754828683021884*^9}, 
   3.754868808458359*^9, 
   3.801085150743132*^9},ExpressionUUID->"4705b7a3-89d9-44c3-95de-\
3c84f01b563b"],

Cell[TextData[{
 "This function determines the ",
 StyleBox["utility",
  FontSlant->"Italic"],
 " of an agent\[CloseCurlyQuote]s game position. Output: utility vector (list \
of ",
 StyleBox["n", "Input"],
 " reals)."
}], "Text",
 CellChangeTimes->{{3.661109957898925*^9, 3.6611099754210033`*^9}, {
   3.6739496364210987`*^9, 3.6739496388180447`*^9}, {3.674134621890402*^9, 
   3.674134628493718*^9}, {3.678110893196328*^9, 3.678110893960451*^9}, {
   3.753909854494605*^9, 3.753909855022457*^9}, {3.755800486618642*^9, 
   3.7558004985414057`*^9}, {3.822064557301881*^9, 3.8220645585354652`*^9}, {
   3.8220646170090218`*^9, 3.8220646378037033`*^9}, {3.822065078731689*^9, 
   3.8220651249315033`*^9}, {3.822073237657981*^9, 3.822073241824193*^9}, 
   3.822073571659375*^9},ExpressionUUID->"cee83901-01f7-4da4-a3e7-\
8443c21f109c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Utility", "[", "s_List", "]"}], " ", ":=", " ", 
  RowBox[{"UtilityCompiled", "[", 
   RowBox[{"s", ",", "\[Alpha]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6565014736763487`*^9, {3.661109904992959*^9, 3.661109907608478*^9}, {
   3.6732996490297832`*^9, 3.673299652237762*^9}, {3.686727220777858*^9, 
   3.686727221505822*^9}, {3.704314425273543*^9, 3.704314426710335*^9}, {
   3.7539081245466347`*^9, 3.753908128926412*^9}, {3.754868799992202*^9, 
   3.754868802871768*^9}, 3.801085154300199*^9, {3.8023845907976713`*^9, 
   3.80238460349885*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"38b74a49-4aec-4baa-bb86-005da1e62ce5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"UtilityCompiled", "=", 
   RowBox[{"FunctionCompile", "[", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Typed", "[", 
         RowBox[{"s", ",", 
          RowBox[{
           RowBox[{"TypeSpecifier", "[", "\"\<PackedArray\>\"", "]"}], "[", 
           RowBox[{"\"\<Real64\>\"", ",", "1"}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Typed", "[", 
         RowBox[{"\[Alpha]", ",", "\"\<Real64\>\""}], "]"}]}], 
       "\[IndentingNewLine]", "}"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Total", "[", "s", "]"}], " ", "\[Equal]", " ", "0"}], ",", 
        "s", ",", 
        RowBox[{
         RowBox[{"s", "^", "\[Alpha]"}], " ", "/", " ", 
         RowBox[{"Total", "[", 
          RowBox[{"s", "^", "2"}], "]"}]}]}], "]"}]}], "]"}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.649206144851355*^9, 3.649206148651795*^9}, {
   3.661121352574053*^9, 3.661121387218481*^9}, 3.674430201672263*^9, 
   3.6744681680692673`*^9, 3.686726631590466*^9, {3.8023774606781273`*^9, 
   3.802377472443514*^9}, {3.802377502855513*^9, 3.802377598050089*^9}, {
   3.802384399165329*^9, 3.8023844445581217`*^9}, {3.8023845844312773`*^9, 
   3.802384586152059*^9}, 3.802384686315621*^9},
 CellLabel->
  "In[108]:=",ExpressionUUID->"52d1f944-396a-409f-a41c-5adc4791bd51"],

Cell[TextData[{
 "A version that takes a power structure as input and allows \[Alpha] to be \
treated either a scalar or a list: if an input power structure contains a key \
for ",
 StyleBox["\[Alpha]", "Input"],
 ", this list will override the global scalar ",
 StyleBox["\[Alpha]", "Input"],
 ". Output: utility vector (list of ",
 StyleBox["n", "Input"],
 " reals)."
}], "Text",
 CellChangeTimes->{{3.822064127116209*^9, 3.822064140707234*^9}, {
   3.822072943484358*^9, 3.822072956806835*^9}, 3.82207356486261*^9, 
   3.822149132140511*^9},ExpressionUUID->"ded35b01-6f4b-4164-99b2-\
9c08a33423c3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Utility", "[", "ps_Association", "]"}], " ", ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"KeyExistsQ", "[", 
     RowBox[{"ps", ",", "\"\<\[Alpha]\>\""}], "]"}], ",", 
    RowBox[{"UtilityCompiled2", "[", 
     RowBox[{
      RowBox[{"ps", "[", "\"\<s\>\"", "]"}], ",", 
      RowBox[{"ps", "[", "\"\<\[Alpha]\>\"", "]"}]}], "]"}], ",", 
    RowBox[{"UtilityCompiled", "[", 
     RowBox[{"ps", "[", "\"\<s\>\"", "]"}], "]"}], ",", "\[Alpha]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6565014736763487`*^9, {3.661109904992959*^9, 3.661109907608478*^9}, {
   3.6732996490297832`*^9, 3.673299652237762*^9}, {3.686727220777858*^9, 
   3.686727221505822*^9}, {3.704314425273543*^9, 3.704314426710335*^9}, {
   3.7539081245466347`*^9, 3.753908128926412*^9}, {3.754868799992202*^9, 
   3.754868802871768*^9}, {3.755042653392675*^9, 3.755042670560419*^9}, {
   3.801085156013751*^9, 3.801085157277979*^9}, {3.822064998044528*^9, 
   3.822065009223868*^9}, {3.822065046654088*^9, 3.8220650563974323`*^9}, {
   3.822073321689288*^9, 3.822073326085452*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"4178276e-2733-4e5b-9563-5ab2770a62ee"],

Cell[BoxData[
 RowBox[{
  RowBox[{"UtilityCompiled2", "=", 
   RowBox[{"FunctionCompile", "[", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Typed", "[", 
         RowBox[{"s", ",", 
          RowBox[{
           RowBox[{"TypeSpecifier", "[", "\"\<PackedArray\>\"", "]"}], "[", 
           RowBox[{"\"\<Real64\>\"", ",", "1"}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Typed", "[", 
         RowBox[{"\[Alpha]", ",", 
          RowBox[{
           RowBox[{"TypeSpecifier", "[", "\"\<PackedArray\>\"", "]"}], "[", 
           RowBox[{"\"\<Real64\>\"", ",", "1"}], "]"}]}], "]"}]}], 
       "\[IndentingNewLine]", "}"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Total", "[", "s", "]"}], " ", "\[Equal]", " ", "0"}], ",", 
        "s", ",", 
        RowBox[{
         RowBox[{"s", "^", "\[Alpha]"}], " ", "/", " ", 
         RowBox[{"Total", "[", 
          RowBox[{"s", "^", "2"}], "]"}]}]}], "]"}]}], "]"}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.649206144851355*^9, 3.649206148651795*^9}, {
   3.661121352574053*^9, 3.661121387218481*^9}, 3.674430201672263*^9, 
   3.6744681680692673`*^9, 3.686726631590466*^9, {3.8023774606781273`*^9, 
   3.802377472443514*^9}, {3.802377502855513*^9, 3.802377598050089*^9}, {
   3.802384399165329*^9, 3.8023844445581217`*^9}, {3.8023845844312773`*^9, 
   3.802384586152059*^9}, 3.802384686315621*^9, {3.822062788005753*^9, 
   3.822062797028729*^9}, {3.822063347784246*^9, 3.822063349347972*^9}, {
   3.822063400121214*^9, 3.822063401107669*^9}, 3.822064147706252*^9, 
   3.822064604102541*^9},
 CellLabel->
  "In[110]:=",ExpressionUUID->"67853d9b-1037-4c2d-8fcf-1793152f4336"],

Cell["A simple, slow version that doesn\[CloseCurlyQuote]t handle edge \
cases.", "Text",
 CellChangeTimes->{{3.802384784036467*^9, 3.8023848047130404`*^9}, {
   3.802384855497211*^9, 3.802384866415914*^9}, 
   3.822064758773369*^9},ExpressionUUID->"d83a7522-12b3-4886-a471-\
2cf244703a46"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Utility", "[", "s_", "]"}], ":=", 
  RowBox[{
   RowBox[{"s", "^", "\[Alpha]"}], "/", 
   RowBox[{"Total", "[", 
    RowBox[{"s", "^", "2"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.796229210727455*^9, 3.796229220056238*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[444]:=",ExpressionUUID->"3b12e47b-db0d-4a5f-80cb-cddf25f2cecb"],

Cell["Unit tests:", "Text",
 CellChangeTimes->{{3.755085357688162*^9, 
  3.755085360162019*^9}},ExpressionUUID->"cd55b7d8-795d-4a58-b1bb-\
d451153b7b4c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"unitTests", "[", "\"\<Utility\>\"", "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"UtilityCompiled", "[", 
        RowBox[{
         RowBox[{"N", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2", ",", "3", ",", "3", ",", "1"}], "}"}], 
          "]"}], ",", "2.5"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "0.041666666666666664`", ",", "0.23570226039551584`", ",", 
         "0.649519052838329`", ",", "0.649519052838329`", ",", 
         "0.041666666666666664`"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"TestID", "\[Rule]", "\"\<Utility1\>\""}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"UtilityCompiled", "[", 
        RowBox[{
         RowBox[{"N", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], "]"}], ",", "2.5"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0.", ",", "0.", ",", "0."}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TestID", "\[Rule]", "\"\<Utility2\>\""}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7550841330433683`*^9, 3.755084135437353*^9}, {
   3.7550841708582687`*^9, 3.755084177444426*^9}, {3.75508488110111*^9, 
   3.755084921944516*^9}, {3.755085004683037*^9, 3.755085019160364*^9}, {
   3.755085236775576*^9, 3.7550852605358467`*^9}, {3.755085299455575*^9, 
   3.7550853362271223`*^9}, 3.755085432033588*^9, {3.755085559417843*^9, 
   3.755085605499104*^9}, {3.755085657127652*^9, 3.755085684055829*^9}, {
   3.7550857227312603`*^9, 3.755085757850277*^9}, {3.755085791385973*^9, 
   3.755085806043363*^9}, {3.755085848538776*^9, 3.7550858726824923`*^9}, {
   3.755085921688486*^9, 3.755085975595923*^9}, {3.755086010930608*^9, 
   3.755086084763026*^9}, {3.7550861278999023`*^9, 3.755086145884115*^9}, {
   3.7550861893032513`*^9, 3.7550863415526657`*^9}, {3.755086381974959*^9, 
   3.755086392501211*^9}, {3.75508644659693*^9, 3.7550864513013277`*^9}, {
   3.75508649799314*^9, 3.7550865090662107`*^9}, {3.755086565163678*^9, 
   3.755086585445758*^9}, {3.755086655240406*^9, 3.755086701383586*^9}, {
   3.755086806299365*^9, 3.755086837717898*^9}, {3.755086948783966*^9, 
   3.755087022479724*^9}, {3.7550870816896*^9, 3.755087134007586*^9}, {
   3.755087422831038*^9, 3.755087427098736*^9}, {3.755087460919154*^9, 
   3.755087557692718*^9}, {3.755087590425846*^9, 3.755087598858591*^9}, {
   3.7550880654352913`*^9, 3.755088082040506*^9}, {3.755088504368958*^9, 
   3.755088513807843*^9}, {3.755088578357264*^9, 3.7550886228558407`*^9}, {
   3.755088655821022*^9, 3.755088668539598*^9}, {3.755088737237715*^9, 
   3.755088762383355*^9}, {3.755088823716557*^9, 3.755088897790244*^9}, {
   3.755088961755447*^9, 3.7550890112250357`*^9}, {3.755089054519545*^9, 
   3.755089070082917*^9}, 3.755089103267687*^9, {3.755089150076614*^9, 
   3.7550891525902033`*^9}, {3.755089243503083*^9, 3.755089251930882*^9}, {
   3.75508928976873*^9, 3.75508930673265*^9}, {3.80108516054848*^9, 
   3.801085169486854*^9}, {3.802384904934548*^9, 3.802384933862864*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[111]:=",ExpressionUUID->"6c554bb8-eb89-48ea-9ff4-9b22c5a34051"]
}, Closed]],

Cell[CellGroupData[{

Cell["PrinceRank", "Subsubsection",
 CellChangeTimes->{{3.724110212146109*^9, 3.724110223641794*^9}, {
   3.725269240712*^9, 3.7252692431095*^9}, 3.753908487475532*^9, {
   3.754828685494142*^9, 3.754828690031996*^9}, {3.754868900385695*^9, 
   3.754868901299271*^9}, 
   3.8010851193131742`*^9},ExpressionUUID->"dcc578af-a0f6-4912-a21f-\
5eff1a77b0e2"],

Cell[TextData[{
 "Given a power structure, returns a vector representing the PrinceRank \
(intertemporal utility) of each agent. PrinceRank is an evaluation of each \
agents\[CloseCurlyQuote] position that assumes that agents don\
\[CloseCurlyQuote]t alter their tactics. Given a list of payoffs for a \
particular player, calculate the intertemporal utility. It is assumed that \
the payoff of the initial state will be omitted from this list (since \
intertemporal utility is based on the cumulative value of future states). \
This implementation is consistent with the requirement that in the first \
future time period (t=0 in the equation for intertemporal utility), the \
payoff at that time period is counted at 100% (\[Delta]^0). The parameter \
\[Alpha] can be treated as either a scalar or a list: if an input power \
structure contains a key for ",
 StyleBox["\[Alpha]", "Input"],
 ", this list will override the global scalar ",
 StyleBox["\[Alpha]", "Input"],
 ". Output: a list of ",
 StyleBox["n", "Input"],
 " reals."
}], "Text",
 CellChangeTimes->{{3.724110351916255*^9, 3.7241103647924213`*^9}, {
  3.724110569525722*^9, 3.7241105737987537`*^9}, {3.7241107311398907`*^9, 
  3.7241108167588673`*^9}, {3.7241116812470083`*^9, 3.7241117005583982`*^9}, {
  3.724258165873702*^9, 3.724258166521988*^9}, {3.753910686182382*^9, 
  3.753910697749279*^9}, {3.754828786422009*^9, 3.7548287941253366`*^9}, {
  3.7548692962213717`*^9, 3.754869296827258*^9}, {3.754930411938933*^9, 
  3.754930413947864*^9}, {3.75493054418432*^9, 3.754930614162615*^9}, {
  3.75493109953939*^9, 3.7549311169059267`*^9}, {3.7558005288966227`*^9, 
  3.755800540149806*^9}, {3.801085211494411*^9, 3.801085216155341*^9}, {
  3.8018367543875313`*^9, 3.801836818971665*^9}, {3.80867967669219*^9, 
  3.808679677885785*^9}, {3.822149115468481*^9, 
  3.822149151051959*^9}},ExpressionUUID->"ec694549-0a99-457e-88f2-\
41a4d1f885b2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PrinceRank", "[", "ps_", "]"}], ":=", 
  RowBox[{"If", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"KeyExistsQ", "[", 
     RowBox[{"ps", ",", "\"\<\[Alpha]\>\""}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", ".", "discountFactors"}], "&"}], ",", 
      RowBox[{"princeRankSimData2", "[", 
       RowBox[{
        RowBox[{"ps", "[", "\"\<s\>\"", "]"}], ",", 
        RowBox[{"ps", "[", "\"\<T\>\"", "]"}], ",", "\[Beta]", ",", "\[Mu]", 
        ",", "\[Lambda]", ",", 
        RowBox[{"ps", "[", "\"\<\[Alpha]\>\"", "]"}]}], "]"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", ".", "discountFactors"}], "&"}], ",", 
      RowBox[{"princeRankSimData", "[", 
       RowBox[{
        RowBox[{"ps", "[", "\"\<s\>\"", "]"}], ",", 
        RowBox[{"ps", "[", "\"\<T\>\"", "]"}], ",", "\[Beta]", ",", "\[Mu]", 
        ",", "\[Lambda]", ",", "\[Alpha]", ",", "k"}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.687169802861462*^9, 3.6871698435721073`*^9}, {
   3.687169876507497*^9, 3.687169948836899*^9}, {3.704320890040744*^9, 
   3.7043209723004017`*^9}, {3.7043210278934593`*^9, 
   3.7043210287251377`*^9}, {3.710436218244775*^9, 3.710436226677124*^9}, {
   3.753908698321719*^9, 3.7539086987172413`*^9}, {3.7539087384976387`*^9, 
   3.753908759642796*^9}, {3.753910187939928*^9, 3.7539102275104923`*^9}, {
   3.753910403729151*^9, 3.7539104130888567`*^9}, 3.753911188430336*^9, 
   3.754868910291749*^9, {3.7548689421866617`*^9, 3.754869005731298*^9}, 
   3.7548691091258917`*^9, {3.754869333909507*^9, 3.754869337074053*^9}, {
   3.75486955323135*^9, 3.754869594825117*^9}, {3.75487052995076*^9, 
   3.754870532664412*^9}, 3.754870566759779*^9, {3.7548706106561213`*^9, 
   3.7548706439103813`*^9}, {3.754870799909548*^9, 3.754870810086899*^9}, {
   3.754931010433*^9, 3.754931012088194*^9}, {3.754999192993325*^9, 
   3.7549992129201097`*^9}, {3.754999246741795*^9, 3.754999265981834*^9}, {
   3.754999770014892*^9, 3.7549997710361643`*^9}, {3.7549998761014853`*^9, 
   3.754999876462042*^9}, {3.755042692232082*^9, 3.755042696391255*^9}, 
   3.796246019269548*^9, 3.801085126789115*^9, 3.80108519597322*^9, 
   3.8011639284968853`*^9, 3.801164697405004*^9, 3.80236825540096*^9, 
   3.8024270852736597`*^9, {3.802427170633264*^9, 3.802427172947308*^9}, {
   3.802427538003647*^9, 3.802427590087237*^9}, {3.802428019950529*^9, 
   3.80242807162827*^9}, 3.802428113577009*^9, {3.802439959523757*^9, 
   3.802439990774458*^9}, {3.802442184729759*^9, 3.802442190246191*^9}, {
   3.802442373178154*^9, 3.802442384120885*^9}, 3.804074235063157*^9, {
   3.808679594018717*^9, 3.808679599030961*^9}, 3.808679857406789*^9, {
   3.822148221256784*^9, 3.822148262017446*^9}, 3.82214881897696*^9, {
   3.822148880871318*^9, 3.822148883736651*^9}, 3.8221491876934547`*^9},
 CellLabel->
  "In[112]:=",ExpressionUUID->"9ffe47c1-91bf-431e-9505-114198ea7a29"],

Cell[BoxData[
 RowBox[{
  RowBox[{"princeRankSimData", "=", 
   RowBox[{"FunctionCompile", "[", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Typed", "[", 
         RowBox[{"s", ",", 
          RowBox[{
           RowBox[{"TypeSpecifier", "[", "\"\<PackedArray\>\"", "]"}], "[", 
           RowBox[{"\"\<Real64\>\"", ",", "1"}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Typed", "[", 
         RowBox[{"T", ",", 
          RowBox[{
           RowBox[{"TypeSpecifier", "[", "\"\<PackedArray\>\"", "]"}], "[", 
           RowBox[{"\"\<Real64\>\"", ",", "2"}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Typed", "[", 
         RowBox[{"\[Beta]", ",", "\"\<Real64\>\""}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Typed", "[", 
         RowBox[{"\[Mu]", ",", "\"\<Real64\>\""}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Typed", "[", 
         RowBox[{"\[Lambda]", ",", "\"\<Real64\>\""}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Typed", "[", 
         RowBox[{"\[Alpha]", ",", "\"\<Real64\>\""}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Typed", "[", 
         RowBox[{"k", ",", "\"\<Integer64\>\""}], "]"}]}], 
       "\[IndentingNewLine]", "}"}], ",", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"updateS", ",", "utility"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"updateS", "=", 
          RowBox[{
           RowBox[{"Ramp", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"i", "==", "j"}], ",", 
                 RowBox[{
                  RowBox[{"T", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", "\[Lambda]"}],
                  ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"T", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "<", "0"}], ",", 
                   RowBox[{
                    RowBox[{"T", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", "\[Mu]"}], 
                   ",", 
                   RowBox[{
                    RowBox[{"T", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", "\[Beta]"}]}],
                   "]"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"Length", "[", "T", "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}], ".", 
             "#"}], "]"}], "&"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"utility", "=", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Total", "[", "#", "]"}], " ", "\[Equal]", " ", "0"}], 
             ",", "#", ",", 
             RowBox[{
              RowBox[{"#", "^", "\[Alpha]"}], " ", "/", " ", 
              RowBox[{"Total", "[", 
               RowBox[{"#", "^", "2."}], "]"}]}]}], "]"}], "&"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Transpose", "[", 
          RowBox[{"Map", "[", 
           RowBox[{"utility", ",", 
            RowBox[{"Rest", "[", 
             RowBox[{"NestList", "[", 
              RowBox[{"updateS", ",", "s", ",", "k"}], "]"}], "]"}]}], "]"}], 
          "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "]"}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.691680437186426*^9, 3.6916804513125477`*^9}, 
   3.7544984599852533`*^9, 3.7548620765181913`*^9, {3.801164083026101*^9, 
   3.801164086416046*^9}, {3.802378956894918*^9, 3.802378982091714*^9}, {
   3.80237988396819*^9, 3.802379884861409*^9}, {3.802437539426619*^9, 
   3.802437572831341*^9}, {3.802437608199123*^9, 3.8024376339790287`*^9}, {
   3.802437685017303*^9, 3.802437686560375*^9}, 3.802437718324422*^9, {
   3.802437771354405*^9, 3.8024379291794367`*^9}, {3.802438001596094*^9, 
   3.8024380424294453`*^9}, {3.802438096042844*^9, 3.802438106981288*^9}, {
   3.802438145265174*^9, 3.802438145557116*^9}, {3.802438221754702*^9, 
   3.802438225278028*^9}, {3.8024382822338867`*^9, 3.802438284704303*^9}, {
   3.80243945699508*^9, 3.802439467535174*^9}, {3.802439506894253*^9, 
   3.8024395395653343`*^9}, 3.802439597717146*^9, {3.8024398264571447`*^9, 
   3.80243986351663*^9}, {3.8024399232536373`*^9, 3.802439930573979*^9}, 
   3.802440068786858*^9, {3.8024410064353333`*^9, 3.8024411286365643`*^9}, 
   3.802441897914198*^9, {3.802442000415618*^9, 3.802442016575335*^9}, {
   3.802442142085249*^9, 3.802442142682086*^9}, 3.802444898759739*^9, {
   3.804074241296455*^9, 3.8040742429805613`*^9}, {3.808604599732559*^9, 
   3.808604644596695*^9}},
 CellLabel->
  "In[113]:=",ExpressionUUID->"a4ed54b8-6333-430f-9d2b-38fd757ca4a7"],

Cell["\<\
A version that takes \[Alpha] as a list. Note that k=10 is hard coded into \
this function.\
\>", "Text",
 CellChangeTimes->{{3.822148154632764*^9, 
  3.822148176086413*^9}},ExpressionUUID->"e7ebeb3b-bf8c-4ac2-a148-\
d17051f456cb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"princeRankSimData2", "=", 
   RowBox[{"FunctionCompile", "[", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Typed", "[", 
         RowBox[{"s", ",", 
          RowBox[{
           RowBox[{"TypeSpecifier", "[", "\"\<PackedArray\>\"", "]"}], "[", 
           RowBox[{"\"\<Real64\>\"", ",", "1"}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Typed", "[", 
         RowBox[{"T", ",", 
          RowBox[{
           RowBox[{"TypeSpecifier", "[", "\"\<PackedArray\>\"", "]"}], "[", 
           RowBox[{"\"\<Real64\>\"", ",", "2"}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Typed", "[", 
         RowBox[{"\[Beta]", ",", "\"\<Real64\>\""}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Typed", "[", 
         RowBox[{"\[Mu]", ",", "\"\<Real64\>\""}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Typed", "[", 
         RowBox[{"\[Lambda]", ",", "\"\<Real64\>\""}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Typed", "[", 
         RowBox[{"\[Alpha]", ",", 
          RowBox[{
           RowBox[{"TypeSpecifier", "[", "\"\<PackedArray\>\"", "]"}], "[", 
           RowBox[{"\"\<Real64\>\"", ",", "1"}], "]"}]}], "]"}]}], 
       "\[IndentingNewLine]", "}"}], ",", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"updateS", ",", "utility"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"updateS", "=", 
          RowBox[{
           RowBox[{"Ramp", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"i", "==", "j"}], ",", 
                 RowBox[{
                  RowBox[{"T", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", "\[Lambda]"}],
                  ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"T", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "<", "0"}], ",", 
                   RowBox[{
                    RowBox[{"T", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", "\[Mu]"}], 
                   ",", 
                   RowBox[{
                    RowBox[{"T", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", "\[Beta]"}]}],
                   "]"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"Length", "[", "T", "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}], ".", 
             "#"}], "]"}], "&"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"utility", "=", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Total", "[", "#", "]"}], " ", "\[Equal]", " ", "0"}], 
             ",", "#", ",", 
             RowBox[{
              RowBox[{"#", "^", "\[Alpha]"}], " ", "/", " ", 
              RowBox[{"Total", "[", 
               RowBox[{"#", "^", "2"}], "]"}]}]}], "]"}], "&"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Transpose", "[", 
          RowBox[{"Map", "[", 
           RowBox[{"utility", ",", 
            RowBox[{"Rest", "[", 
             RowBox[{"NestList", "[", 
              RowBox[{"updateS", ",", "s", ",", "10"}], "]"}], "]"}]}], "]"}],
           "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "]"}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.691680437186426*^9, 3.6916804513125477`*^9}, 
   3.7544984599852533`*^9, 3.7548620765181913`*^9, {3.801164083026101*^9, 
   3.801164086416046*^9}, {3.802378956894918*^9, 3.802378982091714*^9}, {
   3.80237988396819*^9, 3.802379884861409*^9}, {3.802437539426619*^9, 
   3.802437572831341*^9}, {3.802437608199123*^9, 3.8024376339790287`*^9}, {
   3.802437685017303*^9, 3.802437686560375*^9}, 3.802437718324422*^9, {
   3.802437771354405*^9, 3.8024379291794367`*^9}, {3.802438001596094*^9, 
   3.8024380424294453`*^9}, {3.802438096042844*^9, 3.802438106981288*^9}, {
   3.802438145265174*^9, 3.802438145557116*^9}, {3.802438221754702*^9, 
   3.802438225278028*^9}, {3.8024382822338867`*^9, 3.802438284704303*^9}, {
   3.80243945699508*^9, 3.802439467535174*^9}, {3.802439506894253*^9, 
   3.8024395395653343`*^9}, 3.802439597717146*^9, {3.8024398264571447`*^9, 
   3.80243986351663*^9}, {3.8024399232536373`*^9, 3.802439930573979*^9}, 
   3.802440068786858*^9, {3.8024410064353333`*^9, 3.8024411286365643`*^9}, 
   3.802441897914198*^9, {3.802442000415618*^9, 3.802442016575335*^9}, {
   3.802442142085249*^9, 3.802442142682086*^9}, 3.802444898759739*^9, {
   3.804074241296455*^9, 3.8040742429805613`*^9}, {3.808604599732559*^9, 
   3.808604644596695*^9}, {3.822148101424732*^9, 3.822148152282954*^9}, 
   3.822148264250188*^9, 3.822149076285886*^9},
 CellLabel->
  "In[114]:=",ExpressionUUID->"d81194b8-e3d9-4ca2-b2ca-0be9ac05b3a9"],

Cell["A more comprehensible version of what\[CloseCurlyQuote]s happening \
above:", "Text",
 CellChangeTimes->{{3.802440080154351*^9, 
  3.8024400864146423`*^9}},ExpressionUUID->"b0bb8c2a-d5d2-4533-a4c1-\
350b94d105dc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PrinceRank", "[", "ps_", "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#", ".", "discountFactors"}], "&"}], ",", 
    RowBox[{"Transpose", "[", 
     RowBox[{"Map", "[", 
      RowBox[{"Utility", ",", 
       RowBox[{"Rest", "[", 
        RowBox[{"NestList", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"UpdateS", "[", 
            RowBox[{"#", ",", 
             RowBox[{"ps", "[", "\"\<T\>\"", "]"}]}], "]"}], "&"}], ",", 
          RowBox[{"ps", "[", "\"\<s\>\"", "]"}], ",", "k"}], "]"}], "]"}]}], 
      "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.687169802861462*^9, 3.6871698435721073`*^9}, {
   3.687169876507497*^9, 3.687169948836899*^9}, {3.704320890040744*^9, 
   3.7043209723004017`*^9}, {3.7043210278934593`*^9, 
   3.7043210287251377`*^9}, {3.710436218244775*^9, 3.710436226677124*^9}, {
   3.753908698321719*^9, 3.7539086987172413`*^9}, {3.7539087384976387`*^9, 
   3.753908759642796*^9}, {3.753910187939928*^9, 3.7539102275104923`*^9}, {
   3.753910403729151*^9, 3.7539104130888567`*^9}, 3.753911188430336*^9, 
   3.754868910291749*^9, {3.7548689421866617`*^9, 3.754869005731298*^9}, 
   3.7548691091258917`*^9, {3.754869333909507*^9, 3.754869337074053*^9}, {
   3.75486955323135*^9, 3.754869594825117*^9}, {3.75487052995076*^9, 
   3.754870532664412*^9}, 3.754870566759779*^9, {3.7548706106561213`*^9, 
   3.7548706439103813`*^9}, {3.754870799909548*^9, 3.754870810086899*^9}, {
   3.754931010433*^9, 3.754931012088194*^9}, {3.754999192993325*^9, 
   3.7549992129201097`*^9}, {3.754999246741795*^9, 3.754999265981834*^9}, {
   3.754999770014892*^9, 3.7549997710361643`*^9}, {3.7549998761014853`*^9, 
   3.754999876462042*^9}, {3.755042692232082*^9, 3.755042696391255*^9}, 
   3.796246019269548*^9, 3.801085126789115*^9, 3.80108519597322*^9, 
   3.8011639284968853`*^9, 3.801164697405004*^9, 3.80236825540096*^9, 
   3.8024270852736597`*^9, {3.802427170633264*^9, 3.802427172947308*^9}, {
   3.802427538003647*^9, 3.802427590087237*^9}, {3.802428019950529*^9, 
   3.80242807162827*^9}, 3.802428113577009*^9, {3.8024409482218*^9, 
   3.8024409587552433`*^9}, 3.804074250077426*^9, 3.806761135385243*^9, 
   3.806761410800933*^9, 3.808679869692487*^9},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"4f5b5541-c6cb-4c4e-8287-0ee79762a0c0"],

Cell["Unit tests:", "Text",
 CellChangeTimes->{{3.755085357688162*^9, 
  3.755085360162019*^9}},ExpressionUUID->"1a8f92fd-6e48-4ac8-9488-\
d76c64f0cb0f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"unitTests", "[", "\"\<PrinceRank\>\"", "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"PrinceRank", "[", 
        RowBox[{"RandomTernaryPowerStructure", "[", "5", "]"}], "]"}], "]"}], 
      ",", "\[IndentingNewLine]", "5", ",", "\[IndentingNewLine]", 
      RowBox[{"TestID", "\[Rule]", "\"\<PrinceRank1\>\""}]}], 
     "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7550841330433683`*^9, 3.755084135437353*^9}, {
   3.7550841708582687`*^9, 3.755084177444426*^9}, {3.75508488110111*^9, 
   3.755084921944516*^9}, {3.755085004683037*^9, 3.755085019160364*^9}, {
   3.755085236775576*^9, 3.7550852605358467`*^9}, {3.755085299455575*^9, 
   3.7550853362271223`*^9}, 3.755085432033588*^9, {3.755085559417843*^9, 
   3.755085605499104*^9}, {3.755085657127652*^9, 3.755085684055829*^9}, {
   3.7550857227312603`*^9, 3.755085757850277*^9}, {3.755085791385973*^9, 
   3.755085806043363*^9}, {3.755085848538776*^9, 3.7550858726824923`*^9}, {
   3.755085921688486*^9, 3.755085975595923*^9}, {3.755086010930608*^9, 
   3.755086084763026*^9}, {3.7550861278999023`*^9, 3.755086145884115*^9}, {
   3.7550861893032513`*^9, 3.7550863415526657`*^9}, {3.755086381974959*^9, 
   3.755086392501211*^9}, {3.75508644659693*^9, 3.7550864513013277`*^9}, {
   3.75508649799314*^9, 3.7550865090662107`*^9}, {3.755086565163678*^9, 
   3.755086585445758*^9}, {3.755086655240406*^9, 3.755086701383586*^9}, {
   3.755086806299365*^9, 3.755086837717898*^9}, {3.755086948783966*^9, 
   3.755087022479724*^9}, {3.7550870816896*^9, 3.755087134007586*^9}, {
   3.755087422831038*^9, 3.755087427098736*^9}, {3.755087460919154*^9, 
   3.755087557692718*^9}, {3.755087590425846*^9, 3.755087598858591*^9}, {
   3.7550880654352913`*^9, 3.755088082040506*^9}, {3.755088504368958*^9, 
   3.755088513807843*^9}, {3.755088578357264*^9, 3.7550886228558407`*^9}, {
   3.755088655821022*^9, 3.755088668539598*^9}, {3.755088737237715*^9, 
   3.755088762383355*^9}, {3.755088823716557*^9, 3.755088897790244*^9}, {
   3.755088961755447*^9, 3.7550890112250357`*^9}, {3.755089054519545*^9, 
   3.755089070082917*^9}, 3.755089103267687*^9, {3.755089150076614*^9, 
   3.7550891525902033`*^9}, {3.755089243503083*^9, 3.755089251930882*^9}, {
   3.75508928976873*^9, 3.75508930673265*^9}, {3.7550893539343452`*^9, 
   3.7550893966346283`*^9}, {3.7550894328566732`*^9, 3.755089463703785*^9}, {
   3.801085132387951*^9, 3.8010851368249702`*^9}, {3.801163945872445*^9, 
   3.801163948374881*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[115]:=",ExpressionUUID->"4090dcfa-4f69-4900-9818-328d09462365"]
}, Closed]],

Cell[CellGroupData[{

Cell["Polarity", "Subsubsection",
 CellChangeTimes->{{3.7837596947035103`*^9, 
  3.7837596957413616`*^9}},ExpressionUUID->"03b6e0b4-b670-4652-a488-\
eeab291724bc"],

Cell["\<\
Determines the polarity of a power structure. Polarity in international \
relations relates to the number of great powers in the system. For example, a \
unipolar system has one great power; a bipolar one has two. The definition \
here is more subtle: it takes into account not just the distribution of power \
but also the network of interrelationships in the system, effectively \
counting how many hubs exist. The result depends upon the parameter settings, \
and is not always an integer value (one can round the result if desired). \
Output: a real number.\
\>", "Text",
 CellChangeTimes->{{3.783759711417367*^9, 3.7837597962033086`*^9}, {
  3.7837599686907234`*^9, 3.7837600084499164`*^9}, {3.7837631322232113`*^9, 
  3.7837631341971216`*^9}, {3.783763185502371*^9, 3.783763247920865*^9}, {
  3.7837633115030565`*^9, 3.7837633314882936`*^9}, {3.783763370956238*^9, 
  3.7837633807457185`*^9}, {3.783763425794462*^9, 3.783763440684658*^9}, {
  3.7837635866762643`*^9, 
  3.78376361081135*^9}},ExpressionUUID->"89ed911b-b0b0-4a1b-9cc3-\
f7fdf567617d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Polarity", "[", "ps_Association", "]"}], ":=", 
  RowBox[{"Total", "[", 
   RowBox[{
    RowBox[{"NormalizeS", "[", 
     RowBox[{"PrinceRank", "[", "ps", "]"}], "]"}], "^", "2"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.783759561140976*^9, 3.7837595829303956`*^9}, {
   3.783760101809422*^9, 3.7837601107786913`*^9}, {3.783760141223049*^9, 
   3.7837601421459465`*^9}, {3.783760544235426*^9, 3.7837605706586647`*^9}, {
   3.783762402492965*^9, 3.783762417227456*^9}, {3.783762689504386*^9, 
   3.7837626957410164`*^9}, 3.801090542747075*^9},
 CellLabel->
  "In[116]:=",ExpressionUUID->"876cb6d9-5ed3-431d-8cf0-285d2ade627f"],

Cell["\<\
Given a size vector, return each agent\[CloseCurlyQuote]s market share of the \
total power in the system. Output: list of real numbers.\
\>", "Text",
 CellChangeTimes->{{3.8054111133795023`*^9, 3.8054111384415483`*^9}, {
  3.805411227175016*^9, 3.805411231433558*^9}, {3.805463868238311*^9, 
  3.805463874569647*^9}},ExpressionUUID->"d3378058-62b8-4f19-babd-\
996b47b899c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MarketShare", "[", "s_List", "]"}], ":=", " ", 
  RowBox[{"s", "/", 
   RowBox[{"Total", "[", "s", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.805411141311225*^9, 3.805411149370377*^9}, {
  3.805411191291627*^9, 3.805411199787608*^9}},
 CellLabel->
  "In[117]:=",ExpressionUUID->"3e3a4f5b-364c-4afd-8e1d-2b7e7eef15cf"],

Cell["Herfindahl\[Dash]Hirschman Index (HHI). Output: list of reals.", "Text",
 CellChangeTimes->{{3.80549085015259*^9, 3.805490851662491*^9}, {
  3.8054909356761913`*^9, 
  3.805490936708581*^9}},ExpressionUUID->"dd7b8ab8-9ed4-491d-8292-\
c32ebbde114a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HHI", "[", "s_", "]"}], ":=", " ", 
  RowBox[{"Total", "[", 
   RowBox[{
    RowBox[{"MarketShare", "[", "s", "]"}], "^", "2"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.805490611730608*^9, 3.8054906576809998`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"402cd2cf-0b23-4f3f-b3ab-b413018e808e"],

Cell["\<\
A version of HHI in which market shares are normalized such that the largest \
entity always has a size of 1. Output: list of reals.\
\>", "Text",
 CellChangeTimes->{{3.8054908874939938`*^9, 
  3.805490930372994*^9}},ExpressionUUID->"29d0e0b1-71a6-4bb4-8a9d-\
8b1a92fa16ff"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ModifiedHHI", "[", "s_", "]"}], ":=", " ", 
  RowBox[{"Total", "[", 
   RowBox[{"s", "^", "2"}], "]"}]}]], "Input",
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"29544e88-ca9b-439c-ab47-a1d88706bf9d"],

Cell["Singer concentration (1972). Output: list of reals.", "Text",
 CellChangeTimes->{{3.805495866628583*^9, 
  3.8054958826536293`*^9}},ExpressionUUID->"12e40f2c-408a-4412-81f5-\
4d596b69e837"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SingerConcentration", "[", "ps_", "]"}], ":=", 
  RowBox[{"Sqrt", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"MarketShare", "[", 
         RowBox[{"ps", "[", "\"\<s\>\"", "]"}], "]"}], "^", "2"}], "]"}], "-", 
      RowBox[{"1", "/", 
       RowBox[{"n", "[", "ps", "]"}]}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"1", "/", 
       RowBox[{"n", "[", "ps", "]"}]}]}], ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.805474017965345*^9, 3.805474077949277*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[934]:=",ExpressionUUID->"2c6395b9-0081-4421-ad77-17554413189a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Concentration", "[", "ps_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"c", "=", 
      RowBox[{"SingerConcentration", "[", "ps", "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"c", "\[GreaterEqual]", "0.4"}], " ", "&&", " ", 
        RowBox[{"c", "\[LessEqual]", "0.5"}]}], ",", 
       RowBox[{"Return", "[", "\"\<Unipolar\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"c", "\[GreaterEqual]", "0.2"}], " ", "&&", " ", 
        RowBox[{"c", "\[LessEqual]", "0.4"}]}], ",", 
       RowBox[{"Return", "[", "\"\<Bipolar\>\"", "]"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.805474086422174*^9, 3.805474215837455*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[935]:=",ExpressionUUID->"1db70220-a84d-46a3-930b-2bb6cde8b289"]
}, Closed]],

Cell[CellGroupData[{

Cell["Size Instability", "Subsubsection",
 CellChangeTimes->{{3.819525286050687*^9, 
  3.8195252893360443`*^9}},ExpressionUUID->"ae89e43c-7829-464a-943c-\
379406ebe01c"],

Cell["\<\
Determine how different the sizes of the agents will be after they make their \
best moves. Output: real number, with 0 indicating maximum stability.\
\>", "Text",
 CellChangeTimes->{{3.819525354608564*^9, 
  3.819525377226095*^9}},ExpressionUUID->"92f3dc0a-1b98-428c-a86a-\
30c604b38c33"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SizeInstability", "[", "ps_", "]"}], ":=", 
  RowBox[{"Norm", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"MonteCarloBestMove", "[", "ps", "]"}], "[", "\"\<s\>\"", "]"}], 
    "-", 
    RowBox[{"ps", "[", "\"\<s\>\"", "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.819525317768004*^9, 3.819525317774514*^9}, {
  3.819525394424963*^9, 3.819525404076848*^9}},
 CellLabel->
  "In[118]:=",ExpressionUUID->"f99d1c37-d034-49a5-9a7a-6ccf1a2c71be"]
}, Closed]],

Cell[CellGroupData[{

Cell["Relationship Instability", "Subsubsection",
 CellChangeTimes->{{3.819525291396205*^9, 
  3.81952529458243*^9}},ExpressionUUID->"70621a01-e0aa-4adb-9bfa-\
584b98ba4f99"],

Cell["\<\
Determine the change in the tactic matrix (and not the size vector) after \
agents play their best moves. Output: real number, with 0 indicating maximum \
stability.\
\>", "Text",
 CellChangeTimes->{{3.8195254734568987`*^9, 
  3.819525481677022*^9}},ExpressionUUID->"5afbd06c-873e-4e40-b9ef-\
adef1047d3c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RelationshipInstability", "[", "ps_", "]"}], ":=", 
  RowBox[{"Norm", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MonteCarloBestMove", "[", "ps", "]"}], "[", "\"\<T\>\"", "]"}],
      "-", 
     RowBox[{"ps", "[", "\"\<T\>\"", "]"}]}], ",", "\"\<Frobenius\>\""}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.819525387500445*^9, 3.8195253875089493`*^9}, {
  3.819525436156032*^9, 3.8195254565316477`*^9}, {3.819576468300742*^9, 
  3.819576476959395*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"2651f4e5-6bd9-413a-8713-113b3edbd856"]
}, Closed]],

Cell[CellGroupData[{

Cell["Trajectory", "Subsubsection",
 CellChangeTimes->{{3.819525298047003*^9, 
  3.8195252994229107`*^9}},ExpressionUUID->"b7e9ee19-58c0-4737-a726-\
a54eb20289f2"],

Cell["\<\
The trajectory of a power structure is its tendency as a whole to become more \
positive or more negative. It is defined as the growth percentage of a power \
structure, given the agents' best simultaneous moves. Output: real number.\
\>", "Text",
 CellChangeTimes->{{3.8195255550852003`*^9, 
  3.819525579642644*^9}},ExpressionUUID->"5b0e255c-31ad-4b53-b292-\
83750d763ce0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Trajectory", "[", "ps_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Total", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"MonteCarloBestMove", "[", "ps", "]"}], "[", "\"\<s\>\"", "]"}],
      "-", 
     RowBox[{"ps", "[", "\"\<s\>\"", "]"}]}], "]"}], "/", " ", 
   RowBox[{"Total", "[", 
    RowBox[{"ps", "[", "\"\<s\>\"", "]"}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.819525504775318*^9, 3.819525538430347*^9}, 
   3.819527346900289*^9},
 CellLabel->
  "In[120]:=",ExpressionUUID->"b5c45008-4438-4999-a78e-fcadb442507d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Trajectory", "[", "ps", "]"}]], "Input",
 CellChangeTimes->{{3.819527282140267*^9, 3.8195272849167967`*^9}},
 CellLabel->
  "In[218]:=",ExpressionUUID->"7bcb7b0f-fe8c-46e1-a2cc-6be802e3285e"],

Cell[BoxData["0.06519865753512376`"], "Output",
 CellChangeTimes->{3.819527292357107*^9},
 CellLabel->
  "Out[218]=",ExpressionUUID->"8f8c8a66-f77e-4d43-bd7e-b45d22165ceb"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Volatility", "Subsubsection",
 CellChangeTimes->{{3.81952530208416*^9, 
  3.819525303335874*^9}},ExpressionUUID->"4950f28e-fc70-46f6-90c6-\
9ab458b11413"],

Cell["\<\
Determine how violence prone a power structure is, based on the percentage of \
flow emitted that is negative, after agents make their best moves. Output: a \
real number (percentage).\
\>", "Text",
 CellChangeTimes->{{3.819525603787487*^9, 3.819525664163209*^9}, {
  3.8195263317152452`*^9, 
  3.8195263420076838`*^9}},ExpressionUUID->"7bcb26eb-2249-4e58-bb34-\
22cad7f29b97"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Volatility", "[", "ps_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"m", "=", 
      RowBox[{"MonteCarloBestMove", "[", "ps", "]"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"Total", "[", 
      RowBox[{
       RowBox[{"m", "[", "\"\<s\>\"", "]"}], "*", 
       RowBox[{"Total", "[", 
        RowBox[{"Ramp", "[", 
         RowBox[{"-", 
          RowBox[{"m", "[", "\"\<T\>\"", "]"}]}], "]"}], "]"}]}], "]"}], "/", 
     
     RowBox[{"Total", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Rho]"}], ")"}], "*", 
       RowBox[{"m", "[", "\"\<s\>\"", "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.819626020810485*^9, 3.819626037704484*^9}, 
   3.819626081004744*^9},
 CellLabel->
  "In[121]:=",ExpressionUUID->"184d7a7a-91a4-4f6c-acc0-162e5c14e5a1"]
}, Closed]],

Cell[CellGroupData[{

Cell["Metrics", "Subsubsection",
 CellChangeTimes->{{3.819197573297374*^9, 
  3.819197574410294*^9}},ExpressionUUID->"040b2add-4707-47cd-8df7-\
46bdc05700e2"],

Cell["\<\
Show various metrics about a power structure. Output: association.\
\>", "Text",
 CellChangeTimes->{{3.8191256006351547`*^9, 
  3.8191256173110857`*^9}},ExpressionUUID->"c778c4e5-1840-4341-9adb-\
a8c402d4c908"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Metrics", "[", "ps_", "]"}], ":=", " ", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"s", "=", 
       RowBox[{"ps", "[", "\"\<s\>\"", "]"}]}], ",", 
      RowBox[{"m", "=", 
       RowBox[{"MonteCarloBestMove", "[", "ps", "]"}]}], ",", "s1", ",", 
      "T1"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"s1", "=", 
      RowBox[{"m", "[", "\"\<s\>\"", "]"}]}], ";", 
     RowBox[{"T1", "=", 
      RowBox[{"m", "[", "\"\<T\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Pretty", "[", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<s\>\"", "\[Rule]", "s"}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<T\>\"", "\[Rule]", 
         RowBox[{"ps", "[", "\"\<T\>\"", "]"}]}], ",", "\[IndentingNewLine]", 
        
        RowBox[{"\"\<Ternary\>\"", "\[Rule]", 
         RowBox[{"ToTernary", "[", 
          RowBox[{"ps", "[", "\"\<T\>\"", "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<Utility\>\"", "\[Rule]", 
         RowBox[{"Utility", "[", "s", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<PrinceRank\>\"", "\[Rule]", 
         RowBox[{"PrinceRank", "[", "ps", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<MarketShare\>\"", "\[Rule]", 
         RowBox[{"s", "/", 
          RowBox[{"Total", "[", "s", "]"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<SizeStability\>\"", "\[Rule]", 
         RowBox[{"Norm", "[", 
          RowBox[{"s1", "-", "s"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<RelationshipStability\>\"", "\[Rule]", 
         RowBox[{"Norm", "[", 
          RowBox[{"T1", "-", 
           RowBox[{"ps", "[", "\"\<T\>\"", "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<Trajectory\>\"", "\[Rule]", 
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{"s1", "-", "s"}], "]"}], "/", " ", 
          RowBox[{"Total", "[", "s", "]"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<Volatility\>\"", "\[Rule]", 
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{"s1", "*", 
            RowBox[{"Total", "[", 
             RowBox[{"Ramp", "[", 
              RowBox[{"-", "T1"}], "]"}], "]"}]}], "]"}], "/", 
          RowBox[{"Total", "[", 
           RowBox[{"s1", "*", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"Diagonal", "[", "T1", "]"}]}], ")"}]}], "]"}]}]}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"\"\<Polarity\>\"", "\[Rule]", 
         RowBox[{"Polarity", "[", "ps", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<ModifiedHHI\>\"", "\[Rule]", " ", 
         RowBox[{"Total", "[", 
          RowBox[{"s", "^", "2"}], "]"}]}]}], "\[IndentingNewLine]", "|>"}], 
      "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8191251259439163`*^9, 3.819125160524743*^9}, {
   3.819125525618922*^9, 3.8191255918894367`*^9}, {3.819125660706696*^9, 
   3.8191256859810953`*^9}, {3.819125745144494*^9, 3.8191257733497553`*^9}, {
   3.81912598508392*^9, 3.8191260368045597`*^9}, {3.819126075484632*^9, 
   3.8191260770942507`*^9}, {3.819126204524169*^9, 3.819126215156085*^9}, {
   3.8191263534892817`*^9, 3.819126369376327*^9}, {3.819126402045847*^9, 
   3.819126490974231*^9}, {3.819126589064836*^9, 3.8191265921405993`*^9}, 
   3.8191406835462427`*^9, {3.819143437385749*^9, 3.819143445631577*^9}, 
   3.8191437930637217`*^9, {3.819197787059016*^9, 3.8191978287226887`*^9}, {
   3.81931177681212*^9, 3.8193117931778803`*^9}, {3.8193145192083187`*^9, 
   3.819314527882183*^9}, {3.819318648040481*^9, 3.819318648543972*^9}, 
   3.819527823914887*^9, {3.8195279852737703`*^9, 3.8195281770781593`*^9}},
 CellLabel->
  "In[122]:=",ExpressionUUID->"b887c31e-7550-4e01-80fc-130b038e2051"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Monte Carlo Tree Search", "Subsection",
 CellChangeTimes->{{3.818625094752421*^9, 3.8186251034437313`*^9}, 
   3.818874028286398*^9},ExpressionUUID->"479e36ad-8b2e-4930-8fdd-\
11f24799e2c0"],

Cell[CellGroupData[{

Cell["Background", "Subsubsection",
 CellChangeTimes->{{3.818625146459096*^9, 3.8186251473456717`*^9}, {
  3.822491040575918*^9, 
  3.822491041935656*^9}},ExpressionUUID->"8767aa0a-c504-40b4-aad3-\
1c1e143fc099"],

Cell["See https://realpolitik.io/mw19/index.php/Move_Selection.", "Text",
 CellChangeTimes->{{3.822418462877985*^9, 
  3.8224184669572887`*^9}},ExpressionUUID->"a33188f4-e7c4-45f0-8b1b-\
d10eab9e82fe"]
}, Closed]],

Cell[CellGroupData[{

Cell["MonteCarloPlayout", "Subsubsection",
 CellChangeTimes->{3.818335245565156*^9, 3.818672265424447*^9, 
  3.822257667217781*^9},ExpressionUUID->"903247a1-7ae3-40a7-853e-\
09bb6ea939f3"],

Cell[TextData[{
 "Given a power structure, generate a Monte Carlo Tree Search (MCTS) playout \
and return the leaf state. Move search is guided by ",
 StyleBox["PrinceNetJr", "Input"],
 ". Output: power structure."
}], "Text",
 CellChangeTimes->{{3.81827064979364*^9, 3.818270715932568*^9}, {
   3.818670890445881*^9, 3.818670911277117*^9}, {3.818671182698338*^9, 
   3.818671186685555*^9}, {3.820758215885602*^9, 3.820758227800716*^9}, {
   3.822387943697927*^9, 3.822388032500164*^9}, 3.822490017356451*^9, 
   3.822498426255971*^9},ExpressionUUID->"ef2ac7fa-3093-4507-b429-\
e5b973766c83"],

Cell["\<\
This will only work if n=5 (because PrinceRank5 assumes 5 agents).\
\>", "Text",
 CellChangeTimes->{{3.822257502985392*^9, 3.822257522517521*^9}, 
   3.822498429054551*^9},
 Background->RGBColor[
  1, 0.925, 0.925],ExpressionUUID->"b1a57182-368f-4ef7-a4ca-0c837824750c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MonteCarloPlayout", "[", 
   RowBox[{"ps_Association", ",", "depth_Integer"}], "]"}], ":=", 
  RowBox[{"Nest", "[", 
   RowBox[{"NetRandomMoveNear", ",", "ps", ",", "depth"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.818270637719013*^9, 3.818270646380968*^9}, {
   3.8182708438869667`*^9, 3.818270877767302*^9}, 3.818339771488161*^9, {
   3.8185205966046143`*^9, 3.818520611345304*^9}, {3.818590407741935*^9, 
   3.818590421034968*^9}, 3.818625746733704*^9, 3.8186709214357433`*^9, {
   3.81867105026217*^9, 3.8186710511897*^9}, {3.8207582307717733`*^9, 
   3.820758231235029*^9}, {3.822257353797778*^9, 3.822257356492461*^9}, {
   3.8222576541025867`*^9, 3.822257655545924*^9}},
 CellLabel->
  "In[260]:=",ExpressionUUID->"bb4445cb-6934-4d17-bb3c-942bcae76308"],

Cell[TextData[{
 "A version to use for \[OpenCurlyDoubleQuote]pure\[CloseCurlyDoubleQuote] \
MCTS (i.e. without ",
 StyleBox["PrinceNet", "Input"],
 ")."
}], "Text",
 CellChangeTimes->{{3.822498370297738*^9, 
  3.822498415579096*^9}},ExpressionUUID->"569666a1-5e66-4660-ae72-\
667775e2acbc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MonteCarloPlayout", "[", 
   RowBox[{"ps_Association", ",", "depth_Integer"}], "]"}], ":=", 
  RowBox[{"Nest", "[", 
   RowBox[{"RandomMoveNear", ",", "ps", ",", "depth"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.818270637719013*^9, 3.818270646380968*^9}, {
   3.8182708438869667`*^9, 3.818270877767302*^9}, 3.818339771488161*^9, {
   3.8185205966046143`*^9, 3.818520611345304*^9}, {3.818590407741935*^9, 
   3.818590421034968*^9}, 3.818625746733704*^9, 3.8186709214357433`*^9, {
   3.81867105026217*^9, 3.8186710511897*^9}, {3.8207582307717733`*^9, 
   3.820758231235029*^9}, {3.822257353797778*^9, 3.822257356492461*^9}, {
   3.8222576541025867`*^9, 3.822257655545924*^9}, {3.8224983879871397`*^9, 
   3.8224983884457893`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"011af7ec-cf95-4050-984d-294f05dd7598"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MonteCarloPlayout", "[", 
   RowBox[{"ps", ",", "4"}], "]"}], "//", "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.822257593825362*^9, 3.8222575990208178`*^9}, {
  3.8222576655651627`*^9, 3.822257671735258*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[267]:=",ExpressionUUID->"09976b95-377f-4ef1-b2bf-921083aae6aa"]
}, Closed]],

Cell[CellGroupData[{

Cell["MonteCarloGeneratePolicies", "Subsubsection",
 CellChangeTimes->{{3.822252977066215*^9, 
  3.822253000180974*^9}},ExpressionUUID->"8751f837-974d-430b-87cd-\
2253d8a3b7a4"],

Cell[TextData[{
 "Given a size vector and symmetric ternary T, run Monte Carlo Tree Search \
and return the agents\[CloseCurlyQuote] policy vectors. Self-moves are not \
zeroed out, but the ",
 StyleBox["NetDecode", "Input"],
 " functions ignore any probabilities associated with them. Output: list of n \
policy vectors. "
}], "Text",
 CellChangeTimes->{{3.818333425336977*^9, 3.8183334256349573`*^9}, {
  3.818678424279662*^9, 3.8186784799798203`*^9}, {3.8188502988290567`*^9, 
  3.818850308074679*^9}, {3.821109552334078*^9, 3.821109615010003*^9}, {
  3.821112687919029*^9, 3.821112695025165*^9}, {3.8213820138129797`*^9, 
  3.8213820194672413`*^9}, {3.821382127588784*^9, 3.821382142677528*^9}, {
  3.82143781459673*^9, 3.821437816208085*^9}, {3.82225318345162*^9, 
  3.822253219579637*^9}, {3.822324808093149*^9, 3.822324816359359*^9}, {
  3.822325080479375*^9, 
  3.822325133042568*^9}},ExpressionUUID->"35f172a5-d5e3-4461-a0cd-\
84865444d83b"],

Cell["\<\
Consider a parallel implementation that calls this function multiple times \
and then aggregates the results.\
\>", "Text",
 CellChangeTimes->{{3.820783400233457*^9, 3.8207834414501457`*^9}},
 Background->RGBColor[
  1, 0.85, 0.85],ExpressionUUID->"904a17f9-3e85-409b-ab3c-1787e0f5ed34"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MonteCarloGeneratePolicies", "[", 
   RowBox[{"s_", ",", "TT_", ",", " ", "depth_", ",", " ", "playouts_"}], 
   "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "s", "]"}]}], ",", "data", ",", "moves", ",", 
      "M", ",", "T", ",", "pr"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"data", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<weights\>\"", "\[Rule]", 
           RowBox[{"Table", "[", 
            RowBox[{"1.", ",", 
             RowBox[{"3", "n"}]}], "]"}]}], ",", 
          RowBox[{"\"\<count\>\"", "\[Rule]", 
           RowBox[{"Table", "[", 
            RowBox[{"0.", ",", 
             RowBox[{"3", "n"}]}], "]"}]}]}], "|>"}], ",", "n"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"moves", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"NetDecodeRandomMove", "[", 
             RowBox[{"checkZero", "[", "#weights", "]"}], "]"}], "&"}], ",", 
           "data"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"M", "=", 
         RowBox[{"ZeroDiagonalize", "[", 
          RowBox[{"Transpose", "[", 
           RowBox[{"MapIndexed", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ReplacePart", "[", 
               RowBox[{
                RowBox[{"TT", "[", 
                 RowBox[{"[", 
                  RowBox[{"First", "[", "#2", "]"}], "]"}], "]"}], ",", 
                StyleBox[
                 RowBox[{"TernaryMoveByIndex", "[", "#", "]"}], "Input"]}], 
               "]"}], "&"}], ",", "moves"}], "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"T", "=", 
         RowBox[{"ReciprocalizeT", "[", 
          RowBox[{"s", ",", "M"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pr", "=", 
         RowBox[{"PrinceRank", "[", 
          RowBox[{"MonteCarloPlayout", "[", 
           RowBox[{
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<s\>\"", "\[Rule]", 
               RowBox[{"UpdateS", "[", 
                RowBox[{"s", ",", "T"}], "]"}]}], ",", 
              RowBox[{"\"\<T\>\"", "\[Rule]", "T"}]}], "|>"}], ",", 
            RowBox[{"depth", "-", "1"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"MapIndexed", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Block", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "=", 
                RowBox[{"First", "[", "#2", "]"}]}], ",", "pos"}], "}"}], ",", 
             StyleBox["\[IndentingNewLine]",
              Background->RGBColor[1, 1, 0]], 
             RowBox[{
              RowBox[{"pos", "=", 
               RowBox[{"moves", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{
               RowBox[{"data", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "\"\<weights\>\"", ",", "pos"}], "]"}], 
                "]"}], "=", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#weights", "[", 
                    RowBox[{"[", "pos", "]"}], "]"}], "*", 
                   RowBox[{"#count", "[", 
                    RowBox[{"[", "pos", "]"}], "]"}]}], "+", 
                  RowBox[{"pr", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"#count", "[", 
                   RowBox[{"[", "pos", "]"}], "]"}], "+", "1."}], ")"}]}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"data", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "\"\<count\>\"", ",", "pos"}], "]"}], 
                "]"}], "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], "&"}], 
          ",", "data"}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
       "playouts"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Round", "[", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"NormalizePolicy", "[", "#weights", "]"}], "&"}], ",", 
         "data"}], "]"}], ",", ".0001"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.820484312869628*^9, 3.820484332453426*^9}, {
   3.8204843778037977`*^9, 3.8204844532986*^9}, {3.8204845444541492`*^9, 
   3.820484545335225*^9}, {3.820484598368225*^9, 3.8204845997068567`*^9}, {
   3.820498650246725*^9, 3.8204986738045073`*^9}, {3.820498706185892*^9, 
   3.820498799056631*^9}, {3.8204993274891777`*^9, 3.820499341328352*^9}, 
   3.820499793222192*^9, {3.8205000450313177`*^9, 3.82050004642257*^9}, {
   3.82050009134824*^9, 3.820500133009076*^9}, {3.82050036627907*^9, 
   3.820500401138516*^9}, {3.82050085842188*^9, 3.820500905921866*^9}, {
   3.820500954280582*^9, 3.820500968724132*^9}, {3.8205011250830917`*^9, 
   3.820501177590547*^9}, {3.820501300313246*^9, 3.820501338341919*^9}, {
   3.820501395657084*^9, 3.820501399398622*^9}, 3.820501468819631*^9, {
   3.8205015092257347`*^9, 3.820501513781177*^9}, 3.820501645821842*^9, {
   3.820501766256157*^9, 3.820501789421651*^9}, {3.820501850667799*^9, 
   3.8205018509508467`*^9}, {3.82050195382749*^9, 3.820501957371871*^9}, {
   3.8205021670068417`*^9, 3.820502167304017*^9}, {3.820502235708734*^9, 
   3.820502236624208*^9}, {3.8205022771477747`*^9, 3.820502278030785*^9}, {
   3.820502332560452*^9, 3.820502351332568*^9}, {3.8205024204614773`*^9, 
   3.820502421873651*^9}, {3.820502789770132*^9, 3.820502791124536*^9}, 
   3.8205028900154333`*^9, 3.8205029816732893`*^9, 3.820503108423357*^9, 
   3.820503258243367*^9, {3.8205111393073797`*^9, 3.820511143239867*^9}, {
   3.820577639466017*^9, 3.820577642794701*^9}, 3.820701572495816*^9, {
   3.820749152059402*^9, 3.8207491526302843`*^9}, {3.8207493346360817`*^9, 
   3.82074937324238*^9}, {3.820751830161036*^9, 3.820751859894162*^9}, {
   3.820758243216715*^9, 3.820758247389183*^9}, 3.8207588395802917`*^9, {
   3.820758880615376*^9, 3.820758903070107*^9}, {3.8211017284417677`*^9, 
   3.8211017366069527`*^9}, {3.8211095038248034`*^9, 3.821109511387836*^9}, {
   3.821112703585948*^9, 3.821112704841392*^9}, {3.821112772086072*^9, 
   3.821112773119636*^9}, {3.82128151720925*^9, 3.821281545519991*^9}, {
   3.821381996661688*^9, 3.8213820008846684`*^9}, {3.821382032830338*^9, 
   3.821382039428043*^9}, {3.821382078724249*^9, 3.821382088303342*^9}, {
   3.82138610272267*^9, 3.821386109597234*^9}, 3.821437661272173*^9, 
   3.821438395158331*^9, {3.822162611221117*^9, 3.8221626151240673`*^9}, {
   3.822234992525914*^9, 3.822235049080278*^9}, {3.822236791492414*^9, 
   3.822236803506097*^9}, {3.822248650213217*^9, 3.8222486529488287`*^9}, 
   3.8222532370134697`*^9, {3.822254483862533*^9, 3.822254484214386*^9}, {
   3.8222546789474163`*^9, 3.822254682722834*^9}, {3.822254753693928*^9, 
   3.8222547572398167`*^9}, {3.822254799930338*^9, 3.822254839642212*^9}, {
   3.822254975840644*^9, 3.822254984796729*^9}, 3.822256813576144*^9, {
   3.822256845111895*^9, 3.822256852773343*^9}, {3.82225690719517*^9, 
   3.8222569108912983`*^9}, {3.822256965625661*^9, 3.82225700546691*^9}, {
   3.822257057177348*^9, 3.822257073963249*^9}, {3.8222571179348927`*^9, 
   3.822257195907949*^9}, {3.822257277560594*^9, 3.8222572780819883`*^9}, {
   3.822257738129044*^9, 3.822257790449047*^9}, {3.8222586986414757`*^9, 
   3.822258698949162*^9}, {3.822321459882392*^9, 3.8223214633342457`*^9}, {
   3.82232293139254*^9, 3.822322931659788*^9}, {3.822329049554842*^9, 
   3.822329063141711*^9}},
 CellLabel->
  "In[124]:=",ExpressionUUID->"bc79f9b9-9114-443f-b94f-c7600669410e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ps", "=", 
   RowBox[{"RandomTernaryPowerStructure", "[", 
    RowBox[{"5", ",", "7", ",", ".3"}], "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[196]:=",ExpressionUUID->"d26e70b2-0ad5-4d1c-a1c3-070331715191"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"w", "=", 
  RowBox[{"MonteCarloGeneratePolicies", "[", 
   RowBox[{
    RowBox[{"ps", "[", "\"\<s\>\"", "]"}], ",", 
    RowBox[{"ToTernary", "[", 
     RowBox[{"ps", "[", "\"\<T\>\"", "]"}], "]"}], ",", "3", ",", "10"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.821387590044806*^9, 3.821387590219562*^9}, 
   3.82143766993165*^9, {3.822165770130907*^9, 3.8221657755558662`*^9}, {
   3.822166290278962*^9, 3.822166430578712*^9}, 3.8222527520262613`*^9, 
   3.822254564797607*^9, {3.822257077183364*^9, 3.822257078664267*^9}, {
   3.8222572209756813`*^9, 3.822257222704336*^9}, {3.822257549288105*^9, 
   3.8222575543940077`*^9}, {3.8222578077136917`*^9, 3.822257813785318*^9}, 
   3.822257865688624*^9, {3.8222579369255743`*^9, 3.822257956495077*^9}, 
   3.822258325873892*^9, {3.8222583923345423`*^9, 3.822258401430176*^9}, {
   3.822258705787681*^9, 3.822258722034691*^9}, 3.8223214798384438`*^9, {
   3.822322941274884*^9, 3.8223229414602747`*^9}, {3.822329023408722*^9, 
   3.822329024047814*^9}},
 CellLabel->
  "In[231]:=",ExpressionUUID->"451a9ad1-b11e-4953-9463-e17d0c25dee8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.0358`", ",", "0.0367`", ",", "0.1245`", ",", "0.1245`", ",", "0.0391`",
      ",", "0.046200000000000005`", ",", "0.0318`", ",", "0.1245`", ",", 
     "0.0285`", ",", "0.1245`", ",", "0.1245`", ",", "0.04`", ",", "0.0366`", 
     ",", "0.039900000000000005`", ",", "0.0429`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.0145`", ",", "0.018600000000000002`", ",", "0.0085`", ",", 
     "0.019100000000000002`", ",", "0.17170000000000002`", ",", 
     "0.17170000000000002`", ",", "0.012`", ",", "0.0241`", ",", 
     "0.17170000000000002`", ",", "0.0166`", ",", "0.0103`", ",", 
     "0.17170000000000002`", ",", "0.003`", ",", "0.17170000000000002`", ",", 
     "0.0148`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.0067`", ",", "0.1834`", ",", "0.014100000000000001`", ",", 
     "0.0055000000000000005`", ",", "0.0125`", ",", "0.0022`", ",", "0.1834`",
      ",", "0.1834`", ",", "0.0118`", ",", "0.0111`", ",", 
     "0.010400000000000001`", ",", "0.1834`", ",", "0.006900000000000001`", 
     ",", "0.1834`", ",", "0.0017000000000000001`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.0183`", ",", "0.1545`", ",", "0.016900000000000002`", ",", 
     "0.030600000000000002`", ",", "0.025400000000000002`", ",", "0.0239`", 
     ",", "0.027600000000000003`", ",", "0.1545`", ",", 
     "0.012700000000000001`", ",", "0.1545`", ",", "0.018600000000000002`", 
     ",", "0.1545`", ",", "0.1545`", ",", "0.0286`", ",", "0.0251`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
    "0.0212`", ",", "0.013600000000000001`", ",", "0.0229`", ",", 
     "0.013300000000000001`", ",", "0.1668`", ",", "0.020900000000000002`", 
     ",", "0.1668`", ",", "0.0076`", ",", "0.016300000000000002`", ",", 
     "0.1668`", ",", "0.016`", ",", "0.0196`", ",", "0.1668`", ",", "0.0145`",
      ",", "0.1668`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.821387590961113*^9, {3.821437665994501*^9, 3.821437672702209*^9}, {
   3.821437743919551*^9, 3.821437770541888*^9}, {3.821438398111415*^9, 
   3.821438413919264*^9}, 3.821439191636634*^9, 3.8221626191279907`*^9, {
   3.822165770915183*^9, 3.822165776035606*^9}, {3.822166291557899*^9, 
   3.822166309977641*^9}, {3.822166349091196*^9, 3.822166431233347*^9}, {
   3.822252746108605*^9, 3.822252752790681*^9}, 3.822254568791355*^9, 
   3.822256915177597*^9, {3.822256970024747*^9, 3.822257007735406*^9}, {
   3.8222570597106447`*^9, 3.822257079264298*^9}, {3.822257124251769*^9, 
   3.822257242020925*^9}, 3.8222575569633017`*^9, {3.8222578463028097`*^9, 
   3.8222578673474617`*^9}, {3.822257939805531*^9, 3.82225795936521*^9}, 
   3.822258330794541*^9, {3.8222583978413143`*^9, 3.822258406247861*^9}, {
   3.822258712925424*^9, 3.822258728245652*^9}, {3.822321396901471*^9, 
   3.82232139946913*^9}, {3.822321466422784*^9, 3.8223214806963243`*^9}, {
   3.822321515937977*^9, 3.8223215222091618`*^9}, {3.822322934288394*^9, 
   3.8223229428748217`*^9}, {3.822325157261829*^9, 3.8223251672912683`*^9}, 
   3.822328956269107*^9, {3.822328995742091*^9, 3.8223290657737722`*^9}},
 CellLabel->
  "Out[231]=",ExpressionUUID->"47a24781-54bd-4e22-8203-b707b7f3246f"]
}, Open  ]],

Cell["\<\
Normalizes a list of nonnegative reals such that the total is 1. Output: list \
of reals.\
\>", "Text",
 CellChangeTimes->{{3.752235881055134*^9, 3.752235888979707*^9}, {
  3.7558022502665377`*^9, 3.75580227610635*^9}, {3.821386029703762*^9, 
  3.821386042153661*^9}},ExpressionUUID->"99d0a389-c62b-44c4-aa85-\
1a607ab80d65"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NormalizePolicy", "=", 
   RowBox[{"FunctionCompile", "[", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"Typed", "[", 
        RowBox[{"row", ",", 
         RowBox[{
          RowBox[{"TypeSpecifier", "[", "\"\<PackedArray\>\"", "]"}], "[", 
          RowBox[{"\"\<Real64\>\"", ",", "1"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", "}"}], ",", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"tot", "=", 
           RowBox[{"Total", "[", "row", "]"}]}], ",", 
          RowBox[{"len", "=", 
           RowBox[{"Length", "[", "row", "]"}]}]}], "}"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"tot", "\[Equal]", "0"}], ",", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"1.", ",", "len"}], "]"}], "/", "len"}], ",", 
          RowBox[{"row", "/", "tot"}]}], "]"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.649206144851355*^9, 3.649206148651795*^9}, {
   3.661121352574053*^9, 3.661121387218481*^9}, 3.674430201672263*^9, 
   3.6744681680692673`*^9, 3.686726631590466*^9, {3.8023774606781273`*^9, 
   3.802377472443514*^9}, {3.802377502855513*^9, 3.802377598050089*^9}, {
   3.802384399165329*^9, 3.8023844445581217`*^9}, {3.8023845844312773`*^9, 
   3.802384586152059*^9}, {3.8024325400696173`*^9, 3.802432540271508*^9}, {
   3.802432585964978*^9, 3.802432634315682*^9}, {3.8024327660407953`*^9, 
   3.802432771873838*^9}, {3.821385735335742*^9, 3.8213857612593937`*^9}, {
   3.8213859042750263`*^9, 3.821385923573587*^9}, {3.821385989765308*^9, 
   3.821386015311661*^9}, {3.822252721071616*^9, 3.822252721384478*^9}},
 CellLabel->
  "In[125]:=",ExpressionUUID->"19139d35-4aa1-4d40-9c6c-ff1ab515b6f6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"checkZero", "=", 
   RowBox[{"FunctionCompile", "[", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"Typed", "[", 
        RowBox[{"list", ",", 
         RowBox[{
          RowBox[{"TypeSpecifier", "[", "\"\<PackedArray\>\"", "]"}], "[", 
          RowBox[{"\"\<Real64\>\"", ",", "1"}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", "}"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Total", "[", "list", "]"}], "\[Equal]", "0."}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{"1.", ",", 
          RowBox[{"Length", "[", "list", "]"}]}], "]"}], ",", 
        RowBox[{"list", "^", "2"}]}], "]"}]}], "\[IndentingNewLine]", "]"}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.649206144851355*^9, 3.649206148651795*^9}, {
   3.661121352574053*^9, 3.661121387218481*^9}, 3.674430201672263*^9, 
   3.6744681680692673`*^9, 3.686726631590466*^9, {3.8023774606781273`*^9, 
   3.802377472443514*^9}, {3.802377502855513*^9, 3.802377598050089*^9}, {
   3.802384399165329*^9, 3.8023844445581217`*^9}, {3.8023845844312773`*^9, 
   3.802384586152059*^9}, {3.8024325400696173`*^9, 3.802432540271508*^9}, {
   3.802432585964978*^9, 3.802432634315682*^9}, {3.8024327660407953`*^9, 
   3.802432771873838*^9}, {3.82069140747534*^9, 3.820691436183511*^9}, {
   3.820692180431735*^9, 3.8206922189554453`*^9}, {3.820695333801441*^9, 
   3.820695375992999*^9}, 3.820695622162567*^9, 3.8207016160201597`*^9, {
   3.820701646994657*^9, 3.820701670915607*^9}, 3.820701779048032*^9, 
   3.820701818671968*^9, {3.820749142526744*^9, 3.8207491445460463`*^9}},
 CellLabel->
  "In[126]:=",ExpressionUUID->"c9724d4c-45f8-49c1-a718-4c0badd3a368"]
}, Closed]],

Cell[CellGroupData[{

Cell["MonteCarloBestMove", "Subsubsection",
 CellChangeTimes->{{3.822258006638282*^9, 3.822258010462883*^9}, 
   3.8223232166752977`*^9},ExpressionUUID->"c244599d-7dbc-458e-b82f-\
b18713c5a85f"],

Cell["\<\
Given a power structure, run Monte Carlo Tree Search and return the power \
structure representing the agents\[CloseCurlyQuote] best simultaneous moves. \
A move matrix M is appended to the power structure. Output: power structure.\
\>", "Text",
 CellChangeTimes->{{3.818333425336977*^9, 3.8183334256349573`*^9}, {
  3.818678424279662*^9, 3.8186784799798203`*^9}, {3.8188502988290567`*^9, 
  3.818850308074679*^9}, {3.822323031276553*^9, 
  3.822323045098102*^9}},ExpressionUUID->"038b57ec-78cc-4f51-8c8c-\
00fe7d95d45d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MonteCarloBestMove", "[", 
   RowBox[{"ps_", ",", " ", "depth_", ",", " ", "playouts_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"s", "=", 
       RowBox[{"ps", "[", "\"\<s\>\"", "]"}]}], ",", 
      RowBox[{"TT", "=", 
       RowBox[{"ToTernary", "[", 
        RowBox[{"ps", "[", "\"\<T\>\"", "]"}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"UpdatePowerStructureR", "[", 
     RowBox[{"s", ",", 
      RowBox[{"NetDecodeBestM", "[", 
       RowBox[{"TT", ",", 
        RowBox[{"MonteCarloGeneratePolicies", "[", 
         RowBox[{"s", ",", "TT", ",", " ", "depth", ",", " ", "playouts"}], 
         "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.820484312869628*^9, 3.820484332453426*^9}, {
   3.8204843778037977`*^9, 3.8204844532986*^9}, {3.8204845444541492`*^9, 
   3.820484545335225*^9}, {3.820484598368225*^9, 3.8204845997068567`*^9}, {
   3.820498650246725*^9, 3.8204986738045073`*^9}, {3.820498706185892*^9, 
   3.820498799056631*^9}, {3.8204993274891777`*^9, 3.820499341328352*^9}, 
   3.820499793222192*^9, {3.8205000450313177`*^9, 3.82050004642257*^9}, {
   3.82050009134824*^9, 3.820500133009076*^9}, {3.82050036627907*^9, 
   3.820500401138516*^9}, {3.82050085842188*^9, 3.820500905921866*^9}, {
   3.820500954280582*^9, 3.820500968724132*^9}, {3.8205011250830917`*^9, 
   3.820501177590547*^9}, {3.820501300313246*^9, 3.820501338341919*^9}, {
   3.820501395657084*^9, 3.820501399398622*^9}, 3.820501468819631*^9, {
   3.8205015092257347`*^9, 3.820501513781177*^9}, 3.820501645821842*^9, {
   3.820501766256157*^9, 3.820501789421651*^9}, {3.820501850667799*^9, 
   3.8205018509508467`*^9}, {3.82050195382749*^9, 3.820501957371871*^9}, {
   3.8205021670068417`*^9, 3.820502167304017*^9}, {3.820502235708734*^9, 
   3.820502236624208*^9}, {3.8205022771477747`*^9, 3.820502278030785*^9}, {
   3.820502332560452*^9, 3.820502351332568*^9}, {3.8205024204614773`*^9, 
   3.820502421873651*^9}, {3.820502789770132*^9, 3.820502791124536*^9}, 
   3.8205028900154333`*^9, 3.8205029816732893`*^9, 3.820503108423357*^9, 
   3.820503258243367*^9, {3.8205111393073797`*^9, 3.820511143239867*^9}, {
   3.820577639466017*^9, 3.820577642794701*^9}, 3.820701572495816*^9, {
   3.820749152059402*^9, 3.8207491526302843`*^9}, {3.8207493346360817`*^9, 
   3.82074937324238*^9}, {3.820751830161036*^9, 3.820751859894162*^9}, {
   3.820758243216715*^9, 3.820758247389183*^9}, 3.8207588395802917`*^9, {
   3.820758880615376*^9, 3.820758903070107*^9}, 3.821437827421166*^9, 
   3.8214390009572887`*^9, {3.822258020751712*^9, 3.822258042464134*^9}, {
   3.8222581269340677`*^9, 3.822258145525404*^9}, {3.822323018553541*^9, 
   3.82232301927674*^9}, 3.822323214780254*^9, 3.822479627126835*^9},
 CellLabel->
  "In[127]:=",ExpressionUUID->"095de7ad-e8b5-438a-ac07-52ead6dd8c7d"],

Cell["\<\
Same, but with default depth and playout settings. Output: power structure.\
\>", "Text",
 CellChangeTimes->{{3.818333425336977*^9, 3.8183334256349573`*^9}, {
  3.818678424279662*^9, 3.8186784799798203`*^9}, {3.8188502988290567`*^9, 
  3.818850308074679*^9}, {3.819317586792129*^9, 3.819317612157291*^9}, {
  3.822323254642146*^9, 
  3.822323268777288*^9}},ExpressionUUID->"f5b11f98-f01a-4621-aec1-\
43a0e43706ad"],

Cell["Consider using caching here.", "Text",
 CellChangeTimes->{{3.81931724096896*^9, 3.81931724584584*^9}},
 Background->RGBColor[
  1, 0.85, 0.85],ExpressionUUID->"541fa816-a63a-4f14-8bea-3b2596385ba2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MonteCarloBestMove", "[", "ps_Association", "]"}], ":=", 
  RowBox[{"MonteCarloBestMove", "[", 
   RowBox[{"ps", ",", "3", ",", 
    RowBox[{
     RowBox[{"Num", "[", "ps", "]"}], "*", "2500"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8193174469842167`*^9, 3.819317474493432*^9}, 
   3.822323212772813*^9},
 CellLabel->
  "In[128]:=",ExpressionUUID->"bf6c0b18-b8ca-4b85-96f3-a6e4b1a136ea"]
}, Closed]],

Cell[CellGroupData[{

Cell["MonteCarloSimulate", "Subsubsection",
 CellChangeTimes->{{3.818678657284623*^9, 3.8186786638856916`*^9}, 
   3.8186790083961077`*^9, {3.819317738178768*^9, 
   3.819317739616707*^9}},ExpressionUUID->"6ae8b92f-9241-47c9-8434-\
ef36f43945c1"],

Cell[TextData[{
 "Generate ",
 StyleBox["t", "Input"],
 " steps of a Monte Carlo simulation from an initial power structure, to a \
given depth and number of playouts. Output: list of power structures."
}], "Text",
 CellChangeTimes->{{3.819317777698758*^9, 
  3.819317863237051*^9}},ExpressionUUID->"b9072104-adb5-41b9-9d58-\
fbeac40f16f6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MonteCarloSimulate", "[", 
   RowBox[{"ps_", ",", "depth_", ",", "playouts_", ",", "t_"}], "]"}], ":=", 
  " ", 
  RowBox[{"NestList", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NormalizeS", "[", 
      RowBox[{"MonteCarloBestMove", "[", 
       RowBox[{"#", ",", "depth", ",", "playouts"}], "]"}], "]"}], "&"}], ",",
     "ps", ",", "t"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.818678679906158*^9, 3.818678737560157*^9}, 
   3.8186790123077803`*^9, {3.8191227872005587`*^9, 3.819122795741205*^9}, {
   3.8193173408106833`*^9, 3.819317341464562*^9}, 3.819317743335208*^9, 
   3.822388508613531*^9},
 CellLabel->
  "In[129]:=",ExpressionUUID->"1a41b21e-9450-4af2-bee3-ae16bed4ef72"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sim", "=", 
  RowBox[{"MonteCarloSimulate", "[", 
   RowBox[{"ps", ",", "4", ",", "1000", ",", "1"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.818678751075143*^9, 3.818678761094376*^9}, {
   3.818678830140085*^9, 3.81867885555698*^9}, 3.818679013373701*^9, {
   3.8186791255055513`*^9, 3.818679126083975*^9}, 3.819122818594975*^9, 
   3.819317744710485*^9},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[478]:=",ExpressionUUID->"551e758b-f3f8-428b-81da-2289fc45cb75"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"s\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1.`", ",", "0.5`", ",", "0.5`"}], "}"}]}], ",", 
     RowBox[{"\<\"T\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "0.98`", ",", "0.010000000000000009`", ",", 
          "0.010000000000000009`"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0.010000000000000009`", ",", "0.98`", ",", 
          "0.010000000000000009`"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0.010000000000000009`", ",", "0.010000000000000009`", ",", 
          "0.98`"}], "}"}]}], "}"}]}]}], "\[RightAssociation]"}], ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"s\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1.`", ",", "0.5`", ",", "0.5`"}], "}"}]}], ",", 
     RowBox[{"\<\"T\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.`", ",", "1.`", ",", "0.`"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.`", ",", "0.`", ",", "1.`"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"\<\"M\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.`", ",", "0.`", ",", "1.`"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.`", ",", "1.`", ",", "0.`"}], "}"}]}], "}"}]}]}], 
    "\[RightAssociation]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.818699808340952*^9, 3.819122821032946*^9, 
  3.819317756948278*^9, 3.820417838127276*^9},
 CellLabel->
  "Out[478]=",ExpressionUUID->"e51fb85e-755e-44eb-a240-919d9fea3331"]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["PrinceNet", "Section",
 CellChangeTimes->{{3.821367810947728*^9, 3.821367813263475*^9}, {
  3.822242337679758*^9, 
  3.822242339023178*^9}},ExpressionUUID->"21b34e05-4a7d-4379-94ef-\
23649bf47c05"],

Cell[CellGroupData[{

Cell["Background", "Subsection",
 CellChangeTimes->{{3.821367819461252*^9, 
  3.821367820993113*^9}},ExpressionUUID->"be024ea0-c2bc-49fd-ab98-\
03f678d13d2e"],

Cell[TextData[{
 "The functions in this section invoke and train a neural network that, given \
a power structure and focal agent, returns a probability (\
\[OpenCurlyDoubleQuote]policy\[CloseCurlyDoubleQuote]) vector of the agent\
\[CloseCurlyQuote]s next moves. This network, called ",
 StyleBox["PrinceNet", "Input"],
 ", is used to make Monte Carlo Tree Search (MCTS) more efficient by focusing \
the search beam on more plausible lines of play. The theory behind this \
approach derives loosely from the AlphaZero game playing algorithm (Silvers, \
et al 2016)."
}], "Text",
 CellChangeTimes->{{3.821368798558999*^9, 3.821368820863995*^9}, {
  3.8213688546793118`*^9, 3.821368975673378*^9}, {3.821369525511732*^9, 
  3.82136952649971*^9}, {3.821370714018224*^9, 3.821370725419718*^9}, {
  3.822253274094654*^9, 
  3.822253324318961*^9}},ExpressionUUID->"c614f5b2-a839-4db4-946a-\
ee3448ee5318"],

Cell[TextData[{
 StyleBox["Network input. ",
  FontWeight->"Bold"],
 "The input vector to the neural network is composed of: (1) a normalized \
size vector in which the focal agent is first and the other agents are \
reverse sorted; (2) a flattened ternary tactic matrix (also assumed to be \
reordered) with the diagonal removed (because it would always be 0s); and (3) \
the parameter \[Alpha], entered as a list. If needed, the power structure can \
be padded with 0s to have its size match that of the network, for example, if \
the network assumes that n=5 but one wants to apply it to a power structure \
with four agents."
}], "Text",
 CellChangeTimes->{{3.8213689834431267`*^9, 3.821369200303545*^9}, {
   3.821369295078895*^9, 3.821369295623947*^9}, {3.821370761182241*^9, 
   3.821370791739703*^9}, {3.821961160288762*^9, 3.821961281775346*^9}, {
   3.821961313388062*^9, 3.821961342860168*^9}, 3.822156871979416*^9, {
   3.82224337152979*^9, 3.822243386725806*^9}, {3.82232158571465*^9, 
   3.822321587300397*^9}},ExpressionUUID->"c5f9ac04-c6ce-4eda-8783-\
212e0e4ceff3"],

Cell[TextData[{
 StyleBox["Network output.",
  FontWeight->"Bold"],
 " The network outputs a vector indicating the probability or strength of the \
focal agent\[CloseCurlyQuote]s available moves: those ternary moves within a \
Hamming distance of 1. This \[OpenCurlyDoubleQuote]policy\
\[CloseCurlyDoubleQuote] vector is normalized to sum to 1. The policy vector \
has 3n elements that correspond to either ",
 StyleBox["{-1,0,1}", "Input"],
 " for each of the agents, including themselves. Each element in the policy \
vector represents the probability that the current tactic should be changed \
to the tactic corresponding to that element. Elements of the policy vector \
corresponding to the current move follow the same convention. Elements that \
correspond to the self-tactic are set to 0."
}], "Text",
 CellChangeTimes->{{3.821369218936894*^9, 3.821369368120751*^9}, {
   3.821370810304538*^9, 3.821370825577813*^9}, {3.821385500217023*^9, 
   3.821385509528099*^9}, {3.821961399430183*^9, 3.821961533333487*^9}, {
   3.821961588627533*^9, 3.8219616680346537`*^9}, {3.822236993206799*^9, 
   3.822237025763653*^9}, {3.822245227474297*^9, 3.822245227937849*^9}, {
   3.8223216079251003`*^9, 3.822321674517517*^9}, 3.822419057001093*^9, {
   3.822419095582922*^9, 
   3.822419098617831*^9}},ExpressionUUID->"e8f2528e-f00c-452d-811b-\
4aa415d8601d"],

Cell[TextData[{
 StyleBox["Network architecture.",
  FontWeight->"Bold"],
 " The network has a simple feedforward structure with n^2+1 or more inputs \
(depending on the length of \[Alpha]), 3n outputs, and 5-10 hidden layers. \
The network uses ",
 StyleBox["Tanh", "Input"],
 " activation functions, with ",
 StyleBox["Ramp", "Input"],
 " and Softmax used in the final layers."
}], "Text",
 CellChangeTimes->{{3.821369204679596*^9, 3.821369214117147*^9}, {
   3.8213693983479223`*^9, 3.821369499371377*^9}, {3.821443232425661*^9, 
   3.821443253130155*^9}, {3.821961729199092*^9, 3.8219617590769176`*^9}, {
   3.822156685628763*^9, 3.8221567035588007`*^9}, 3.822243443130082*^9, {
   3.82224451671095*^9, 3.822244542550254*^9}, {3.822245244449655*^9, 
   3.822245246666003*^9}, {3.822419151215332*^9, 
   3.822419172310525*^9}},ExpressionUUID->"65655ac2-a27c-4825-95dc-\
756acfa6cfea"],

Cell[TextData[{
 StyleBox["Training.",
  FontWeight->"Bold"],
 " The network is trained on data generated by MCTS runs on random power \
structures. Training uses the Wolfram Language neural network framework. The \
network is inserted into the MCTS search algorithm to select more promising \
paths through the search tree, thus generating yet more training data in an \
iterative cycle called the ",
 StyleBox["training loop",
  FontSlant->"Italic"],
 ". "
}], "Text",
 CellChangeTimes->{{3.821369372776767*^9, 3.821369374488707*^9}, {
  3.8213695121841707`*^9, 3.82136953790606*^9}, {3.82136975561903*^9, 
  3.8213697915712767`*^9}, {3.821370041884454*^9, 3.8213700816030684`*^9}, {
  3.821370111718203*^9, 3.8213701200480223`*^9}, {3.821370223489194*^9, 
  3.821370268658915*^9}, {3.821370856780284*^9, 3.821370885434285*^9}, {
  3.8219617927448263`*^9, 3.8219618346935167`*^9}, {3.822156894780025*^9, 
  3.822156899692586*^9}, {3.822321736980093*^9, 
  3.822321749194532*^9}},ExpressionUUID->"467ffc72-4bdc-461e-930d-\
9b554f572435"],

Cell[TextData[{
 StyleBox["Usage.",
  FontWeight->"Bold"],
 " The network can be used to accelerate MCTS by suggesting best or promising \
moves. A homegrown version called ",
 StyleBox["PrinceNetJr", "Input"],
 ", which uses weights extracted from ",
 StyleBox["PrinceNet", "Input"],
 ", is used for performance reasons. (However, ",
 StyleBox["NetTrain", "Input"],
 " must be called on the ",
 StyleBox["PrinceNet", "Input"],
 " version.)"
}], "Text",
 CellChangeTimes->{{3.8213693816363792`*^9, 3.821369384057045*^9}, {
  3.821370083465466*^9, 3.821370118767722*^9}, {3.821370272452325*^9, 
  3.821370289305331*^9}, {3.821370673991048*^9, 3.8213706922831793`*^9}, {
  3.821370897423547*^9, 3.8213709091997213`*^9}, {3.821961836680334*^9, 
  3.821961840346265*^9}, {3.822321764778734*^9, 
  3.822321854850602*^9}},ExpressionUUID->"19cd687b-954f-4f22-9e62-\
82c7e387f277"],

Cell[TextData[{
 StyleBox["Limitations.",
  FontWeight->"Bold"],
 " One trained, the network has a maximum power structure size that it can \
accommodate. The network also comes to assume the parameter values used when \
the training data was generated, with the exception of those used as network \
inputs."
}], "Text",
 CellChangeTimes->{{3.821369545051404*^9, 3.8213696070059977`*^9}, {
  3.8213696429443417`*^9, 3.821369655511775*^9}, {3.821369706619959*^9, 
  3.821369734308303*^9}, {3.821370923974348*^9, 3.8213709399147873`*^9}, {
  3.821961853190917*^9, 
  3.8219618776827297`*^9}},ExpressionUUID->"9c308bf9-c14f-4c91-984a-\
be20032908fe"]
}, Closed]],

Cell[CellGroupData[{

Cell["Instantiation, Encoding, and Decoding", "Subsection",
 CellChangeTimes->{{3.821367782045849*^9, 3.821367784395735*^9}, 
   3.821367831749222*^9, {3.822157548568573*^9, 
   3.822157554211411*^9}},ExpressionUUID->"4d599acc-12be-4528-9b6e-\
8f1d952b8f73"],

Cell[CellGroupData[{

Cell["NetTopology", "Subsubsection",
 CellChangeTimes->{{3.7513093105207148`*^9, 3.7513093132164145`*^9}, {
   3.7513102538129206`*^9, 3.7513102552712207`*^9}, 3.75495563483311*^9, 
   3.821443556940239*^9, 
   3.822157720624494*^9},ExpressionUUID->"471b4cda-dd77-413b-9af5-\
b07a51476308"],

Cell[TextData[{
 "Defines a network topology in which the input vector\[CloseCurlyQuote]s \
size ",
 StyleBox["in", "Input"],
 " is larger than the output vector\[CloseCurlyQuote]s size ",
 StyleBox["out", "Input"],
 ", and the ",
 StyleBox["h", "Input"],
 " hidden layers become successively smaller. The first element in the list \
is the number of nodes in the input layer; the last element is the number of \
nodes in the output layer. Output: list of integers."
}], "Text",
 CellChangeTimes->{{3.7513091607531137`*^9, 3.751309224693314*^9}, {
   3.7513096165397167`*^9, 3.7513096321106167`*^9}, {3.7513097390106173`*^9, 
   3.7513097463802176`*^9}, 3.7549545937578773`*^9, {3.755801950313837*^9, 
   3.7558019537193727`*^9}},ExpressionUUID->"ec1a188f-18d1-4ac7-83a2-\
3b961743ad91"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NetTopology", "[", 
   RowBox[{"in_Integer", ",", "h_Integer", ",", "out_Integer"}], "]"}], ":=", 
  " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"NetLayerSize", "[", 
     RowBox[{"in", ",", "h", ",", " ", "out", ",", "i"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", 
      RowBox[{"h", "+", "1"}]}], "}"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.751309150620514*^9, 3.7513091564356136`*^9}, {
   3.7513096024577165`*^9, 3.7513096082335167`*^9}, {3.751309670311217*^9, 
   3.7513096708129168`*^9}, {3.7513100275514193`*^9, 
   3.7513100390581193`*^9}, {3.754955604179674*^9, 3.7549556471677227`*^9}, 
   3.82215771892074*^9},
 CellLabel->
  "In[130]:=",ExpressionUUID->"6a54c53a-8e53-486f-9a9c-f90e3bd09226"],

Cell["\<\
Determine how many nodes should be in a particular hidden layer of the neural \
network, the same parameters as above. Output: integer.\
\>", "Text",
 CellChangeTimes->{{3.7288083836230555`*^9, 3.7288084620876455`*^9}, {
  3.7322957167349997`*^9, 3.7322957189960003`*^9}, {3.75131016969112*^9, 
  3.75131017376342*^9}, {3.755801957948102*^9, 
  3.755801960770372*^9}},ExpressionUUID->"b5159c8e-5183-4ab2-8dc6-\
df955629880e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NetLayerSize", "[", 
   RowBox[{
   "in_Integer", ",", "h_Integer", ",", " ", "out_Integer", ",", 
    "layer_Integer"}], "]"}], ":=", " ", 
  RowBox[{"Floor", "[", 
   RowBox[{"in", "-", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"in", "-", "out"}], ")"}], "*", "layer"}], 
     RowBox[{"h", "+", "1"}]]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.742483320571938*^9, 3.742483320989896*^9}, {
  3.7513099045493183`*^9, 3.7513099424672184`*^9}, {3.754955576740552*^9, 
  3.754955577306175*^9}, {3.754955651409923*^9, 3.754955657400228*^9}},
 CellLabel->
  "In[131]:=",ExpressionUUID->"8b8dcf26-f030-46ce-a96d-33cd1ed5b759"],

Cell["\<\
Gets the gene count for a network component, given its topology. Output: \
integer.\
\>", "Text",
 CellChangeTimes->{{3.7513078960979056`*^9, 3.7513079128650055`*^9}, {
  3.751309090316413*^9, 3.751309100764213*^9}, {3.7558019667952633`*^9, 
  3.755801971529614*^9}},ExpressionUUID->"36b69730-bf7e-4e5d-88ef-\
64e9d85611fe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NetWeightCount", "[", "topology_", "]"}], ":=", 
  RowBox[{"Total", "[", 
   RowBox[{"Apply", "[", 
    RowBox[{"Times", ",", 
     RowBox[{"Partition", "[", 
      RowBox[{"topology", ",", "2", ",", "1"}], "]"}], ",", 
     RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.751237445464363*^9, 3.751237465781863*^9}, 
   3.751237664134363*^9, {3.751237697706863*^9, 3.7512376987393627`*^9}, {
   3.751238365391863*^9, 3.7512383694408627`*^9}, {3.751238455151863*^9, 
   3.751238480746863*^9}, {3.7512389254998627`*^9, 3.751238926111863*^9}, {
   3.7513078910678053`*^9, 3.7513078924768057`*^9}, {3.755369814399816*^9, 
   3.755369816521966*^9}, {3.821444579420252*^9, 3.821444580628689*^9}},
 CellLabel->
  "In[132]:=",ExpressionUUID->"75b8a4e8-da11-471c-ab16-73cd06d37052"],

Cell["Unit tests:", "Text",
 CellChangeTimes->{{3.755085357688162*^9, 
  3.755085360162019*^9}},ExpressionUUID->"4d76cd81-4b79-45aa-815e-\
bb10b95b36c4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"unitTests", "[", "\"\<NetTopology\>\"", "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NetTopology", "[", 
        RowBox[{"25", ",", "4", ",", "10"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"25", ",", "22", ",", "19", ",", "16", ",", "13", ",", "10"}],
         "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"TestID", "\[Rule]", "\"\<NetTopology1\>\""}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NetTopology", "[", 
        RowBox[{"12", ",", "6", ",", "2"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "12", ",", "10", ",", "9", ",", "7", ",", "6", ",", "4", ",", "3", 
         ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"TestID", "\[Rule]", "\"\<NetTopology2\>\""}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7550841330433683`*^9, 3.755084135437353*^9}, {
   3.7550841708582687`*^9, 3.755084177444426*^9}, {3.75508488110111*^9, 
   3.755084921944516*^9}, {3.755085004683037*^9, 3.755085019160364*^9}, {
   3.755085236775576*^9, 3.7550852605358467`*^9}, {3.755085299455575*^9, 
   3.7550853362271223`*^9}, 3.755085432033588*^9, {3.755085559417843*^9, 
   3.755085605499104*^9}, {3.755085657127652*^9, 3.755085684055829*^9}, {
   3.7550857227312603`*^9, 3.755085757850277*^9}, {3.755085791385973*^9, 
   3.755085806043363*^9}, {3.755085848538776*^9, 3.7550858726824923`*^9}, {
   3.755085921688486*^9, 3.755085975595923*^9}, {3.755086010930608*^9, 
   3.755086084763026*^9}, {3.7550861278999023`*^9, 3.755086145884115*^9}, {
   3.7550861893032513`*^9, 3.7550863415526657`*^9}, {3.755086381974959*^9, 
   3.755086392501211*^9}, {3.75508644659693*^9, 3.7550864513013277`*^9}, {
   3.75508649799314*^9, 3.7550865090662107`*^9}, {3.755086565163678*^9, 
   3.755086585445758*^9}, {3.755086655240406*^9, 3.755086701383586*^9}, {
   3.755086806299365*^9, 3.755086837717898*^9}, {3.755086948783966*^9, 
   3.755087022479724*^9}, {3.7550870816896*^9, 3.755087134007586*^9}, {
   3.755087422831038*^9, 3.755087427098736*^9}, {3.755087460919154*^9, 
   3.755087557692718*^9}, {3.755087590425846*^9, 3.755087598858591*^9}, {
   3.755089604075595*^9, 3.7550897179572697`*^9}, {3.755089810711412*^9, 
   3.755089819467078*^9}, {3.755089886823806*^9, 3.7550898869428873`*^9}, {
   3.7550899416197844`*^9, 3.755089954353589*^9}, {3.755095236759548*^9, 
   3.7550952596694098`*^9}, {3.822157703777726*^9, 3.822157712235259*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[133]:=",ExpressionUUID->"f2352676-f90f-4feb-ba53-8f248eb2f396"]
}, Closed]],

Cell[CellGroupData[{

Cell["NetConstruct", "Subsubsection",
 CellChangeTimes->{{3.8211936788440943`*^9, 3.8211936837136717`*^9}, {
   3.821203596236931*^9, 3.821203596849172*^9}, {3.821285080374628*^9, 
   3.821285086126519*^9}, {3.821443566311043*^9, 3.821443568088664*^9}, 
   3.8221576522407503`*^9},ExpressionUUID->"89642f05-5c43-4454-a8f6-\
48eb417024d7"],

Cell[TextData[{
 "Instantiate and initialize a ",
 StyleBox["NetChain", "Input"],
 ", given the number of agents ",
 StyleBox["n", "Input"],
 " and the number of hidden layers ",
 StyleBox["h", "Input"],
 ". The network uses ",
 StyleBox["Tanh", "Input"],
 " activation functions, with a ",
 StyleBox["Ramp", "Input"],
 " and ",
 StyleBox["Softmax", "Input"],
 " used in the final layers. Output: ",
 StyleBox["NetChain", "Input"],
 " object."
}], "Text",
 CellChangeTimes->{{3.822156635053545*^9, 3.8221566630059357`*^9}, {
  3.822156719663788*^9, 
  3.8221567419612627`*^9}},ExpressionUUID->"825948bc-f8ea-48e7-89e1-\
2cc64437cd5f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NetConstruct", "[", 
   RowBox[{"n_", ",", "h_"}], "]"}], ":=", " ", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"t", "=", 
      RowBox[{"NetTopology", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"n", "^", "2"}], "+", "1"}], ",", 
        RowBox[{"h", "-", "1"}], ",", 
        RowBox[{"3", "n"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"NetInitialize", "[", 
     RowBox[{"NetChain", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Riffle", "[", 
          RowBox[{
           RowBox[{"Drop", "[", 
            RowBox[{"t", ",", 
             RowBox[{"-", "1"}]}], "]"}], 
           StyleBox[",", "Input"], 
           StyleBox["Tanh", "Input"]}], 
          StyleBox["]", "Input"]}], ",", 
         RowBox[{"{", 
          RowBox[{"Ramp", ",", 
           RowBox[{"Last", "[", "t", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"SoftmaxLayer", "[", 
            RowBox[{"\"\<Input\>\"", "\[Rule]", 
             RowBox[{"Last", "[", "t", "]"}]}], "]"}], ",", 
           RowBox[{"ReshapeLayer", "[", 
            RowBox[{"{", 
             RowBox[{"Last", "[", "t", "]"}], "}"}], "]"}]}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"\"\<Input\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"n", "^", "2"}], "+", "1"}]}]}], "]"}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.822156230044949*^9, 3.822156468785322*^9}, {
   3.8221565221774607`*^9, 3.8221565679678173`*^9}, {3.822156818199849*^9, 
   3.8221568257362423`*^9}, {3.822157020911923*^9, 3.822157021059536*^9}, 
   3.822157649598805*^9, 3.82215769835713*^9, {3.822244980467822*^9, 
   3.82224499031907*^9}},
 CellLabel->
  "In[134]:=",ExpressionUUID->"43aaae6b-79e8-4adc-8599-2fc8c8034c3e"]
}, Closed]],

Cell[CellGroupData[{

Cell["NetEncode", "Subsubsection",
 CellChangeTimes->{{3.821967390928164*^9, 
  3.8219673925623627`*^9}},ExpressionUUID->"f6f0e7fe-d33e-44d7-a724-\
c3a26f751579"],

Cell["\<\
Prepare a power structure to be input into a neural network. The input vector \
is composed of: (1) a normalized size vector in which it is assumed that the \
focal agent is first and the other agents are reverse sorted; (2) a flattened \
ternary tactic matrix (also assumed to be reordered) with the diagonal \
removed (because it would always be 0s); and (3) the parameter \[Alpha], \
entered as a list. Output: list of reals, length \[GreaterEqual] n^2+1.\
\>", "Text",
 CellChangeTimes->{{3.821009247724209*^9, 3.821009294136146*^9}, {
  3.821009661780077*^9, 3.8210096802424927`*^9}, {3.821009901851224*^9, 
  3.821009945194495*^9}, {3.8211881985832148`*^9, 3.821188245778029*^9}, {
  3.821381700360655*^9, 3.821381732280267*^9}, {3.821459974268846*^9, 
  3.821460018169642*^9}, {3.8219675384794617`*^9, 3.82196755705129*^9}, {
  3.821975221793445*^9, 3.821975244976583*^9}, {3.821975290996484*^9, 
  3.82197529151867*^9}, {3.822155634973171*^9, 3.8221556723866167`*^9}, {
  3.822155717614769*^9, 3.822155750271953*^9}, {3.82215589746104*^9, 
  3.822155908291822*^9}, {3.822156031074445*^9, 3.82215603158048*^9}, {
  3.822156065219125*^9, 3.822156065461629*^9}, {3.82224496296802*^9, 
  3.822244963320216*^9}, {3.822245705194851*^9, 
  3.822245711111781*^9}},ExpressionUUID->"9a88b640-ddbf-4bac-acf0-\
1c6968f0e65f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NetEncode", "=", 
   RowBox[{"FunctionCompile", "[", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Typed", "[", 
         RowBox[{"s", ",", 
          RowBox[{
           RowBox[{"TypeSpecifier", "[", "\"\<PackedArray\>\"", "]"}], "[", 
           RowBox[{"\"\<Real64\>\"", ",", "1"}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Typed", "[", 
         RowBox[{"TT", ",", 
          RowBox[{
           RowBox[{"TypeSpecifier", "[", "\"\<PackedArray\>\"", "]"}], "[", 
           RowBox[{"\"\<Real64\>\"", ",", "2"}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Typed", "[", 
         RowBox[{"i", ",", 
          RowBox[{"TypeSpecifier", "[", "\"\<MachineInteger\>\"", "]"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Typed", "[", 
         RowBox[{"\[Alpha]", ",", 
          RowBox[{
           RowBox[{"TypeSpecifier", "[", "\"\<PackedArray\>\"", "]"}], "[", 
           RowBox[{"\"\<Real64\>\"", ",", "1"}], "]"}]}], "]"}]}], 
       "\[IndentingNewLine]", "}"}], ",", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"max", "=", 
          RowBox[{"Max", "[", "s", "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"max", ">", "0"}], ",", 
            RowBox[{"s", "/", "max"}], ",", "s"}], "]"}], ",", 
          RowBox[{"Flatten", "[", 
           RowBox[{"MapIndexed", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Drop", "[", 
               RowBox[{"#", ",", "#2"}], "]"}], "&"}], ",", "TT"}], "]"}], 
           "]"}], ",", 
          RowBox[{"\[Alpha]", "-", "2"}]}], "]"}]}], "\[IndentingNewLine]", 
       "]"}]}], "]"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.649206144851355*^9, 3.649206148651795*^9}, {
   3.661121352574053*^9, 3.661121387218481*^9}, 3.674430201672263*^9, 
   3.6744681680692673`*^9, 3.686726631590466*^9, {3.8023774606781273`*^9, 
   3.802377472443514*^9}, {3.802377502855513*^9, 3.802377598050089*^9}, {
   3.802384399165329*^9, 3.8023844445581217`*^9}, {3.8023845844312773`*^9, 
   3.802384586152059*^9}, {3.8024325400696173`*^9, 3.802432540271508*^9}, {
   3.802432585964978*^9, 3.802432634315682*^9}, {3.8024327660407953`*^9, 
   3.802432771873838*^9}, {3.82069140747534*^9, 3.820691436183511*^9}, {
   3.820692180431735*^9, 3.8206922189554453`*^9}, {3.820692480893714*^9, 
   3.8206924865206337`*^9}, {3.821444750247799*^9, 3.8214447532550287`*^9}, {
   3.821444787995833*^9, 3.821444798356938*^9}, {3.8214448825056553`*^9, 
   3.821444893699347*^9}, 3.8214449983785477`*^9, {3.821458756823485*^9, 
   3.82145878614429*^9}, {3.821458832384314*^9, 3.821458909695261*^9}, {
   3.8214589631764297`*^9, 3.821458980164679*^9}, {3.821459037177622*^9, 
   3.821459050807329*^9}, {3.821459395979765*^9, 3.8214594135085*^9}, {
   3.821459734771324*^9, 3.821459785732008*^9}, {3.821460031008103*^9, 
   3.8214600699866037`*^9}, {3.821974457012301*^9, 3.82197447910393*^9}, {
   3.82197451617354*^9, 3.8219745171215963`*^9}, {3.8221554239593*^9, 
   3.822155429997066*^9}, {3.822155463926187*^9, 3.8221555613513947`*^9}, {
   3.8221556986336*^9, 3.822155703984416*^9}, {3.822155770055276*^9, 
   3.82215579054972*^9}, {3.822161557784083*^9, 3.82216156006765*^9}, {
   3.822244259471756*^9, 3.822244280086348*^9}},
 CellLabel->
  "In[135]:=",ExpressionUUID->"03e93f2d-3c4a-40ff-ab52-ccc138840d78"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NetEncode", "[", 
  RowBox[{
   RowBox[{"ps", "[", "\"\<s\>\"", "]"}], ",", 
   RowBox[{"ToTernary", "[", 
    RowBox[{"ps", "[", "\"\<T\>\"", "]"}], "]"}], ",", "3", ",", 
   RowBox[{"{", "2.35", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.821381187739647*^9, 3.8213812057524977`*^9}, {
   3.821381563976259*^9, 3.821381568568816*^9}, {3.821437338373233*^9, 
   3.821437344951396*^9}, {3.821460089823223*^9, 3.8214601029871397`*^9}, {
   3.821974464994913*^9, 3.821974485303074*^9}, {3.821974694776434*^9, 
   3.821974695102714*^9}, 3.8221554892764874`*^9, {3.822155591232093*^9, 
   3.822155598272661*^9}, 3.822155811641418*^9, {3.822245731325252*^9, 
   3.822245755606275*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[629]:=",ExpressionUUID->"ea1b7dbf-94e1-492a-8d35-6a9c62fc9e39"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.6946777302145182`", ",", "0.8595458339289793`", ",", "1.`", ",", 
   "0.2606919811542394`", ",", "0.4565238461954876`", ",", "0.`", ",", 
   RowBox[{"-", "1.`"}], ",", "0.`", ",", 
   RowBox[{"-", "1.`"}], ",", "0.`", ",", 
   RowBox[{"-", "1.`"}], ",", "0.`", ",", 
   RowBox[{"-", "1.`"}], ",", 
   RowBox[{"-", "1.`"}], ",", 
   RowBox[{"-", "1.`"}], ",", "1.`", ",", 
   RowBox[{"-", "1.`"}], ",", "0.`", ",", "0.`", ",", "1.`", ",", "1.`", ",", 
   
   RowBox[{"-", "1.`"}], ",", 
   RowBox[{"-", "1.`"}], ",", 
   RowBox[{"-", "1.`"}], ",", "1.`", ",", "0.3500000000000001`"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.821974687574235*^9, 3.8219746959252043`*^9}, 
   3.8221556056508827`*^9, {3.822155807214777*^9, 3.8221558128607187`*^9}, 
   3.8222447883971033`*^9, {3.8222457269714193`*^9, 3.822245756694982*^9}, 
   3.822321903774184*^9},
 CellLabel->
  "Out[629]=",ExpressionUUID->"0eef065a-199b-497e-85ce-7ddc8d3fcb0e"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["NetReorderEncode", "Subsubsection",
 CellChangeTimes->{{3.8223385749532824`*^9, 
  3.822338578652543*^9}},ExpressionUUID->"75962e48-0901-418b-b375-\
1f3951cd2992"],

Cell[TextData[{
 "Reorder and encode a power structure. Output: a ",
 StyleBox["PrinceNet", "Input"],
 " input vector of length n^2+1 or more."
}], "Text",
 CellChangeTimes->{{3.822242329443852*^9, 3.822242426884255*^9}, {
  3.8222426648982553`*^9, 3.822242667124318*^9}, {3.822245628342163*^9, 
  3.8222456535291348`*^9}, {3.822338592036518*^9, 
  3.8223386299083347`*^9}},ExpressionUUID->"4df3e3d7-b7a0-45c0-85aa-\
0973240541ae"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NetReorderEncode", "[", 
   RowBox[{"s_", ",", "TT_", ",", "i_"}], "]"}], ":=", " ", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s2", ",", "T2", ",", "order"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"s2", ",", "order"}], "}"}], "=", 
      RowBox[{"ReorderS", "[", 
       RowBox[{"s", ",", "i"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"T2", "=", 
      RowBox[{"ToTernary", "[", 
       RowBox[{"ReorderT", "[", 
        RowBox[{"TT", ",", "order"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NetEncode", "[", 
      RowBox[{"s2", ",", "T2", ",", "i", ",", 
       RowBox[{"{", "\[Alpha]", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.822242304982616*^9, 3.822242326913188*^9}, {
   3.8222424358875847`*^9, 3.8222424799321136`*^9}, {3.8222425124853973`*^9, 
   3.822242518803535*^9}, {3.82224268370158*^9, 3.822242700891304*^9}, {
   3.822242996434596*^9, 3.8222430051171627`*^9}, {3.822243158602316*^9, 
   3.822243163647194*^9}, {3.822243279240446*^9, 3.822243294985504*^9}, {
   3.8222435091334543`*^9, 3.822243513772307*^9}, {3.822244030402707*^9, 
   3.822244117919496*^9}, {3.822244450611559*^9, 3.822244457752871*^9}, {
   3.822244752267374*^9, 3.822244779877625*^9}, {3.822245059720749*^9, 
   3.822245059978867*^9}, {3.822312993983982*^9, 3.8223130077756243`*^9}, {
   3.822313058810512*^9, 3.8223130590431967`*^9}, {3.822323921450782*^9, 
   3.8223239285424557`*^9}, 3.822338583985973*^9, {3.822338637554411*^9, 
   3.82233870442887*^9}, {3.822338872614833*^9, 3.822338895111321*^9}},
 CellLabel->
  "In[136]:=",ExpressionUUID->"a3c381e3-9e0f-493e-a15b-d6cb9edac47c"]
}, Closed]],

Cell[CellGroupData[{

Cell["NetApply", "Subsubsection",
 CellChangeTimes->{{3.822242499481132*^9, 
  3.822242520808022*^9}},ExpressionUUID->"aba8174a-b8f7-4465-b8b2-\
2153b4f9e634"],

Cell[TextData[{
 "Apply ",
 StyleBox["PrinceNet", "Input"],
 " to a given agent. The data structures are reordered before and after the \
net is applied, in order to comply with the assumptions of ",
 StyleBox["NetEncode", "Input"],
 ". Output: a policy vector of length 3n."
}], "Text",
 CellChangeTimes->{{3.822242329443852*^9, 3.822242426884255*^9}, {
  3.8222426648982553`*^9, 3.822242667124318*^9}, {3.822245628342163*^9, 
  3.8222456535291348`*^9}},ExpressionUUID->"b64a53a4-eab3-4c16-9855-\
09adc1501cd6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NetApply", "[", 
   RowBox[{"ps_", ",", "i_"}], "]"}], ":=", " ", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s", ",", "T", ",", "order", ",", "p"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"s", ",", "order"}], "}"}], "=", 
      RowBox[{"ReorderS", "[", 
       RowBox[{
        RowBox[{"ps", "[", "\"\<s\>\"", "]"}], ",", "i"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"T", "=", 
      RowBox[{"ToTernary", "[", 
       RowBox[{"ReorderT", "[", 
        RowBox[{
         RowBox[{"ps", "[", "\"\<T\>\"", "]"}], ",", "order"}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"p", "=", 
      RowBox[{"PrinceNetJr", "[", 
       RowBox[{"NetEncode", "[", 
        RowBox[{"s", ",", "T", ",", "i", ",", 
         RowBox[{"{", "\[Alpha]", "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Partition", "[", 
        RowBox[{"p", ",", "3"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"Ordering", "[", "order", "]"}], "]"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.822242304982616*^9, 3.822242326913188*^9}, {
  3.8222424358875847`*^9, 3.8222424799321136`*^9}, {3.8222425124853973`*^9, 
  3.822242518803535*^9}, {3.82224268370158*^9, 3.822242700891304*^9}, {
  3.822242996434596*^9, 3.8222430051171627`*^9}, {3.822243158602316*^9, 
  3.822243163647194*^9}, {3.822243279240446*^9, 3.822243294985504*^9}, {
  3.8222435091334543`*^9, 3.822243513772307*^9}, {3.822244030402707*^9, 
  3.822244117919496*^9}, {3.822244450611559*^9, 3.822244457752871*^9}, {
  3.822244752267374*^9, 3.822244779877625*^9}, {3.822245059720749*^9, 
  3.822245059978867*^9}, {3.822312993983982*^9, 3.8223130077756243`*^9}, {
  3.822313058810512*^9, 3.8223130590431967`*^9}, {3.822323921450782*^9, 
  3.8223239285424557`*^9}},
 CellLabel->
  "In[137]:=",ExpressionUUID->"59fd9498-47ee-46b3-8f24-11bb04408983"],

Cell[TextData[{
 "Apply ",
 StyleBox["PrinceNet", "Input"],
 " to all agents. Output: n policy vectors of length 3n each."
}], "Text",
 CellChangeTimes->{{3.822242527589881*^9, 
  3.822242549387601*^9}},ExpressionUUID->"eb7d0140-e933-4004-925f-\
1262ec150b00"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NetApply", "[", "ps_", "]"}], ":=", " ", 
  RowBox[{"Array", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NetApply", "[", 
      RowBox[{"ps", ",", "#"}], "]"}], "&"}], ",", 
    RowBox[{"Num", "[", "ps", "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8222425539930077`*^9, 3.822242625979005*^9}},
 CellLabel->
  "In[138]:=",ExpressionUUID->"5bb2f2e8-1651-47be-b96d-a2eee72963d0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ps", "=", 
   RowBox[{"RandomTernaryPowerStructure", "[", 
    RowBox[{"5", ",", "6", ",", ".4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"NetApply", "[", "ps", "]"}]}], "Input",
 CellChangeTimes->{{3.822244566632135*^9, 3.822244575997266*^9}, 
   3.822245855967095*^9, {3.822313170499873*^9, 3.822313173758546*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[744]:=",ExpressionUUID->"3c89492e-dd73-4f17-842e-fe95edb9d195"]
}, Closed]],

Cell[CellGroupData[{

Cell["NetDecode", "Subsubsection",
 CellChangeTimes->{{3.8222460983165407`*^9, 3.822246100045916*^9}, {
   3.8222462098811827`*^9, 3.822246212114987*^9}, {3.8222469926942167`*^9, 
   3.8222469939121437`*^9}, 
   3.822251533959016*^9},ExpressionUUID->"623a5ec0-1539-4d5c-8793-\
af552aa8e232"],

Cell[TextData[{
 "Given a policy vector, return the move with the highest probability of \
success. Output: integer to be used an argument to ",
 StyleBox["TernaryMoveByIndex", "Input"],
 "."
}], "Text",
 CellChangeTimes->{{3.822246762045292*^9, 3.8222468110646143`*^9}, {
  3.822247119157524*^9, 
  3.822247212944105*^9}},ExpressionUUID->"07613b52-96aa-48cf-9fcf-\
e7d906265653"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NetDecodeBestMove", "[", "p_List", "]"}], ":=", 
  RowBox[{"PositionLargest", "[", "p", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.822246102216552*^9, 3.822246109702281*^9}, {
   3.822246245739923*^9, 3.822246276631877*^9}, {3.822246391591303*^9, 
   3.822246402945763*^9}, {3.822246698372843*^9, 3.822246704732407*^9}, 
   3.822246997790704*^9, {3.822247179525734*^9, 3.822247180019719*^9}},
 CellLabel->
  "In[139]:=",ExpressionUUID->"b01086fc-2729-4a9d-bc79-cf372d74ac0b"],

Cell[TextData[{
 "Given a policy vector, return a random move selected in proportion to its \
probability of success. Output: integer to be used an argument to ",
 StyleBox["TernaryMoveByIndex", "Input"],
 "."
}], "Text",
 CellChangeTimes->{{3.822246762045292*^9, 3.822246848144964*^9}, 
   3.822247218661252*^9},ExpressionUUID->"4850f262-f4f3-410e-8ec0-\
706854fe7cc0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NetDecodeRandomMove", "[", "p_List", "]"}], ":=", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{"p", "\[Rule]", " ", 
    RowBox[{"Range", "[", 
     RowBox[{"Length", "[", "p", "]"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.822246102216552*^9, 3.822246109702281*^9}, {
  3.822246245739923*^9, 3.822246276631877*^9}, {3.822246391591303*^9, 
  3.822246402945763*^9}, {3.8222470288056927`*^9, 3.822247035437922*^9}, {
  3.822247238139889*^9, 3.822247238578855*^9}},
 CellLabel->
  "In[140]:=",ExpressionUUID->"bf42e51e-b9e3-4198-a31e-7295d7f806eb"],

Cell["\<\
Given a symmetric ternary tactic matrix and a list of n policy vectors, \
return the move matrix representing the agents\[CloseCurlyQuote] best moves. \
Output: ternary move matrix.\
\>", "Text",
 CellChangeTimes->{{3.822247441935573*^9, 3.8222475122003717`*^9}, {
  3.822247542741961*^9, 
  3.822247544233204*^9}},ExpressionUUID->"f10d4c58-4769-4e36-b4f3-\
9ada0afc75a3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NetDecodeBestM", "[", 
   RowBox[{"TT_", ",", "policies_"}], "]"}], ":=", " ", 
  RowBox[{"ZeroDiagonalize", "[", 
   RowBox[{"Transpose", "[", 
    RowBox[{"MapIndexed", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ReplacePart", "[", 
        RowBox[{
         RowBox[{"TT", "[", 
          RowBox[{"[", 
           RowBox[{"First", "[", "#2", "]"}], "]"}], "]"}], ",", 
         StyleBox[
          RowBox[{"TernaryMoveByIndex", "[", 
           RowBox[{"NetDecodeBestMove", "[", "#", "]"}], "]"}], "Input"]}], 
        "]"}], "&"}], ",", "policies"}], "]"}], "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.822247326185614*^9, 3.8222474396158323`*^9}, 
   3.82224751835012*^9, {3.8222475602383537`*^9, 3.8222476136238403`*^9}, {
   3.822248832942466*^9, 3.822248839049831*^9}},
 CellLabel->
  "In[141]:=",ExpressionUUID->"426cfff8-9e9f-4779-8c44-58d6d0781f40"],

Cell["\<\
Given a symmetric ternary tactic matrix and a list of n policy vectors, \
return a random move matrix based on policy probabilities. Output: ternary \
move matrix.\
\>", "Text",
 CellChangeTimes->{{3.822247441935573*^9, 3.8222475122003717`*^9}, {
  3.822247542741961*^9, 3.822247544233204*^9}, {3.822248476727995*^9, 
  3.822248499911714*^9}},ExpressionUUID->"0608228a-b6c3-4cbd-8e5e-\
4d9dd7548d0e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NetDecodeRandomM", "[", 
   RowBox[{"TT_", ",", "policies_"}], "]"}], ":=", " ", 
  RowBox[{"ZeroDiagonalize", "[", 
   RowBox[{"Transpose", "[", 
    RowBox[{"MapIndexed", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ReplacePart", "[", 
        RowBox[{
         RowBox[{"TT", "[", 
          RowBox[{"[", 
           RowBox[{"First", "[", "#2", "]"}], "]"}], "]"}], ",", 
         StyleBox[
          RowBox[{"TernaryMoveByIndex", "[", 
           RowBox[{"NetDecodeRandomMove", "[", "#", "]"}], "]"}], "Input"]}], 
        "]"}], "&"}], ",", "policies"}], "]"}], "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.822247326185614*^9, 3.8222474396158323`*^9}, 
   3.82224751835012*^9, {3.8222475602383537`*^9, 3.8222476136238403`*^9}, {
   3.8222485076334257`*^9, 3.822248512729951*^9}, {3.822248859778339*^9, 
   3.822248864011031*^9}},
 CellLabel->
  "In[142]:=",ExpressionUUID->"4f0f0f75-3a94-4869-bf28-fd9ae860571b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TT", "=", 
   RowBox[{"ToTernary", "[", 
    RowBox[{"ps", "[", "\"\<T\>\"", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NetDecodeRandomM", "[", 
   RowBox[{"TT", ",", "pp"}], "]"}], "//", "Pretty"}]}], "Input",
 CellChangeTimes->{{3.822248521166443*^9, 3.822248522347376*^9}, {
  3.822388895519446*^9, 3.822388896553279*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"c7cae5d5-1aab-4cb2-9253-7a1b3dceb90e"]
}, Closed]],

Cell[CellGroupData[{

Cell["NetRandomMoveNear", "Subsubsection",
 CellChangeTimes->{{3.8185380050779457`*^9, 3.8185380070994253`*^9}, 
   3.818625072351674*^9, {3.822157287050606*^9, 3.8221573077972097`*^9}, {
   3.8221616907077637`*^9, 3.822161697338409*^9}, {3.8221617590464153`*^9, 
   3.822161768427175*^9}, 3.82225772629008*^9, 
   3.822259009991158*^9},ExpressionUUID->"25b9cc34-4ca9-45e3-8d3b-\
1dce392ad221"],

Cell[TextData[{
 "Given a node (power structure) in a game tree, identify a plausible \
candidate next move for tree search, assuming that all agents move \
simultaneously by altering no more than a single relationship. This function \
uses a global neural network, ",
 StyleBox["PrinceNet", "Input"],
 ", to find strong moves. After the agents\[CloseCurlyQuote] random moves \
have been selected, the tactic matrix is reciprocalized. Output: power \
structure."
}], "Text",
 CellChangeTimes->{{3.821181707985228*^9, 3.821181786869795*^9}, 
   3.821450192935012*^9, 3.821450225342896*^9, {3.8214568120145693`*^9, 
   3.8214568178068657`*^9}, 
   3.822161652999177*^9},ExpressionUUID->"1f548dd5-8f81-47f4-a4c6-\
707b74ef4620"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NetRandomMoveNear", "[", "ps_", "]"}], ":=", 
  RowBox[{"UpdatePowerStructureR", "[", 
   RowBox[{
    RowBox[{"ps", "[", "\"\<s\>\"", "]"}], ",", 
    RowBox[{"NetDecodeRandomM", "[", 
     RowBox[{
      RowBox[{"ToTernary", "[", 
       RowBox[{"ps", "[", "\"\<T\>\"", "]"}], "]"}], ",", 
      RowBox[{"NetApply", "[", "ps", "]"}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.821113385941214*^9, 3.821113391387302*^9}, {
   3.821113442595167*^9, 3.821113445348778*^9}, {3.8211135428390427`*^9, 
   3.821113570284906*^9}, {3.8211136559092627`*^9, 3.8211136740151243`*^9}, {
   3.82111373562648*^9, 3.821113736383445*^9}, {3.821117041955289*^9, 
   3.821117053823206*^9}, {3.821117193058413*^9, 3.8211172127554197`*^9}, {
   3.8211176172947083`*^9, 3.821117677508174*^9}, {3.821117824069146*^9, 
   3.8211178513601303`*^9}, {3.821118067917975*^9, 3.8211180734705353`*^9}, {
   3.821118641312129*^9, 3.821118646531466*^9}, {3.82111890126413*^9, 
   3.8211189348901854`*^9}, {3.821181627761689*^9, 3.821181642527917*^9}, {
   3.8211816831944532`*^9, 3.821181700510923*^9}, {3.821181774458764*^9, 
   3.821181775933025*^9}, {3.821181950835134*^9, 3.821181972922184*^9}, {
   3.821182036717896*^9, 3.821182055882649*^9}, {3.821182142369586*^9, 
   3.821182143561397*^9}, {3.821182180040907*^9, 3.821182200641724*^9}, {
   3.821182364060729*^9, 3.821182364410713*^9}, {3.821182462900889*^9, 
   3.821182532218408*^9}, {3.821182927907526*^9, 3.8211829513465977`*^9}, {
   3.8211830351707287`*^9, 3.821183062222351*^9}, {3.821183190011387*^9, 
   3.821183190690812*^9}, {3.821185211710086*^9, 3.8211852122895947`*^9}, {
   3.821185577515646*^9, 3.8211855793502073`*^9}, {3.821185657713771*^9, 
   3.821185683376925*^9}, {3.8211859889856567`*^9, 3.821185993033341*^9}, {
   3.821186100542199*^9, 3.821186126403119*^9}, {3.821186297865582*^9, 
   3.821186302614059*^9}, {3.821188270919796*^9, 3.821188299345117*^9}, {
   3.821188335806795*^9, 3.8211883456114597`*^9}, {3.821188382820065*^9, 
   3.821188383249017*^9}, 3.821188418515295*^9, {3.821188464793536*^9, 
   3.8211884685254297`*^9}, {3.821188554591816*^9, 3.821188558470092*^9}, 
   3.8211888000947237`*^9, {3.821188837588111*^9, 3.821188870579935*^9}, {
   3.821189413094576*^9, 3.8211894162535067`*^9}, {3.821190760605475*^9, 
   3.8211907614504337`*^9}, {3.821293438976428*^9, 3.821293440207034*^9}, {
   3.821293477750826*^9, 3.8212935022932253`*^9}, {3.821293561123086*^9, 
   3.821293629347105*^9}, {3.821445195129087*^9, 3.821445197257169*^9}, {
   3.821449988333235*^9, 3.82145000551171*^9}, 3.821450280201335*^9, {
   3.821456116157577*^9, 3.821456118105657*^9}, {3.821456193283359*^9, 
   3.8214562142215023`*^9}, {3.821456292833139*^9, 3.821456307969491*^9}, {
   3.821456392250803*^9, 3.821456400923272*^9}, {3.8214564508486567`*^9, 
   3.821456453719159*^9}, {3.821456955160343*^9, 3.821456959027996*^9}, {
   3.82145724654189*^9, 3.8214572545737467`*^9}, {3.821457813262541*^9, 
   3.821457814345544*^9}, 3.82216148748566*^9, {3.822161525675408*^9, 
   3.822161527294838*^9}, 3.822161577959242*^9, {3.822161639256167*^9, 
   3.822161640840651*^9}, 3.822161712498886*^9, {3.822161892217031*^9, 
   3.822161896476775*^9}, {3.822251605784081*^9, 3.8222516142402687`*^9}, {
   3.822251659686759*^9, 3.822251843097691*^9}, {3.822322180759918*^9, 
   3.822322184311405*^9}, {3.822322478585144*^9, 3.8223225049964733`*^9}, 
   3.822479628414106*^9},
 CellLabel->
  "In[143]:=",ExpressionUUID->"97c7cc27-0992-473f-9aa3-64d4c00d8cd6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ps", "=", 
   RowBox[{"RandomTernaryPowerStructure", "[", 
    RowBox[{"5", ",", "4", ",", ".3"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.82216185639751*^9, 3.822161857474646*^9}, {
   3.822161915065995*^9, 3.822161924467681*^9}, 3.8221619575986423`*^9, 
   3.822322382624288*^9},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[706]:=",ExpressionUUID->"d74264dd-90a4-4a93-8010-dda3cbf477ae"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"NetRandomMoveNear", "[", "ps", "]"}], "//", 
  "RepeatedTiming"}]], "Input",
 CellChangeTimes->{{3.8185380710674467`*^9, 3.818538080837606*^9}, {
   3.818538410388216*^9, 3.818538411716549*^9}, {3.81859033657763*^9, 
   3.818590368235209*^9}, 3.818590399500617*^9, {3.818590544972499*^9, 
   3.818590548007082*^9}, {3.8185906310996017`*^9, 3.818590632035192*^9}, 
   3.818625665723916*^9, {3.81867061875346*^9, 3.8186706202127457`*^9}, {
   3.820329432285001*^9, 3.8203294326176653`*^9}, {3.820407739272728*^9, 
   3.820407739398982*^9}, {3.820432373607297*^9, 3.8204323749062157`*^9}, {
   3.8207553765254993`*^9, 3.820755378056365*^9}, 3.821438894794354*^9, 
   3.822161715930304*^9, {3.822161901434155*^9, 3.822161902603417*^9}, {
   3.822257680015636*^9, 3.8222576808226347`*^9}, {3.822322602328238*^9, 
   3.8223226051649446`*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[690]:=",ExpressionUUID->"93883a28-a2c4-4131-8df6-0f88e1d70180"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0003385585714285714`3.", ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"s\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "0.877172697098256`", ",", "0.3609843068835304`", ",", 
        "0.431771094048433`", ",", "1.0042330499416514`", ",", 
        "0.9324486128107148`"}], "}"}]}], ",", 
     RowBox[{"\<\"T\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "0.9908486292480903`", ",", "0.010000000000000009`", ",", 
          "0.01000000000000001`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0.00428141964056065`", ",", "0.98`", ",", "0.`", ",", "0.`", ",", 
          RowBox[{"-", "0.0039283774104563775`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0.004869951111349065`", ",", "0.`", ",", "0.98`", ",", 
          "0.004233049941651308`", ",", "0.`"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0.`", ",", "0.`", ",", "0.01000000000000001`", ",", 
          "0.9957669500583487`", ",", "0.`"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.`", ",", 
          RowBox[{"-", "0.010000000000000009`"}], ",", "0.`", ",", "0.`", ",",
           "0.9960716225895436`"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"\<\"M\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.`", ",", "1.`", ",", "1.`", ",", "0.`", ",", "1.`"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1.`", ",", "0.`", ",", "0.`", ",", "1.`", ",", "0.`"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.`", ",", "0.`", ",", "1.`", ",", "0.`", ",", "0.`"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.`", ",", 
          RowBox[{"-", "1.`"}], ",", "0.`", ",", "0.`", ",", "0.`"}], "}"}]}],
        "}"}]}]}], "\[RightAssociation]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.822322606245921*^9, 3.822322626631049*^9}},
 CellLabel->
  "Out[690]=",ExpressionUUID->"6e85ac10-b3cc-45c3-ac0f-13e61fc46218"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ShowPowerStructure", "[", 
  RowBox[{"ps", ",", 
   RowBox[{"<|", 
    RowBox[{"\"\<circular\>\"", "\[Rule]", "True"}], "|>"}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.822322287414921*^9, 3.822322304504265*^9}},
 CellLabel->
  "In[707]:=",ExpressionUUID->"5b396cef-e724-464c-bdf7-bad3271e9e80"],

Cell[BoxData[
 TagBox[
  TooltipBox[
   GraphicsBox[
    NamespaceBox[{
      {GrayLevel[0], Opacity[0.7], 
       {Dashing[{Small, Small}], 
        LineBox[{
         DynamicLocation["VertexID$1", Automatic, Center], DynamicLocation[
          "VertexID$5", Automatic, Center]}]}, 
       LineBox[{
        DynamicLocation["VertexID$3", Automatic, Center], DynamicLocation[
         "VertexID$4", Automatic, Center]}], 
       LineBox[{
        DynamicLocation["VertexID$3", Automatic, Center], DynamicLocation[
         "VertexID$5", Automatic, Center]}], 
       LineBox[{
        DynamicLocation["VertexID$4", Automatic, Center], DynamicLocation[
         "VertexID$5", Automatic, Center]}]}, 
      {GrayLevel[0], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
       TagBox[
        {RGBColor[0.3101380085007097, 0.7483693252554914, 0.481380959919307], 
         DiskBox[{-1., 0.}, 0.1958861880597314]},
        "DynamicName",
        BoxID -> "VertexID$1"], 
       TagBox[
        {RGBColor[
         0.12034596948973977`, 0.021495277426829336`, 0.4034164519694177], 
         DiskBox[{-0.30901699437494745, 0.9510565162951535}, 
          0.06779379608212874]},
        "DynamicName",
        BoxID -> "VertexID$2"], 
       TagBox[
        {RGBColor[0.8434532227163855, 0.8856696639099637, 0.3626070580488296],
          DiskBox[{0.8090169943749475, 0.5877852522924731}, 
          0.19592841743082434]},
        "DynamicName",
        BoxID -> "VertexID$3"], 
       TagBox[
        {RGBColor[
         0.25716209335235335`, 0.710556411057668, 0.49992024290709686`], 
         DiskBox[{0.8090169943749475, -0.5877852522924731}, 
          0.17061623522604902]},
        "DynamicName",
        BoxID -> "VertexID$4"], 
       TagBox[
        {RGBColor[0.1455703259328242, 0.5929671589889401, 0.5360636593952715],
          DiskBox[{-0.30901699437494745, -0.9510565162951535}, 
          0.1820427038573514]},
        "DynamicName",
        BoxID -> "VertexID$5"]}}],
    BaseStyle->GrayLevel[0],
    FormatType->TraditionalForm,
    FrameTicks->None,
    ImageSize->50],
   RowBox[{"\[LeftAssociation]", 
     RowBox[{
       RowBox[{"\"s\"", "\[Rule]", 
         TagBox[
          RowBox[{"(", "\[NoBreak]", 
            TagBox[
             
             GridBox[{{"1.`"}, {"0.12`"}, {"1.`"}, {"0.758`"}, {"0.863`"}}, 
              ColumnAlignments -> Center, RowSpacings -> 1, ColumnAlignments -> 
              Left], Column], "\[NoBreak]", ")"}], 
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]]}], ",", 
       RowBox[{"\"T\"", "\[Rule]", 
         TagBox[
          RowBox[{"(", "\[NoBreak]", 
            GridBox[{{"0.98`", "0.`", "0.`", "0.`", 
               RowBox[{"-", "0.007`"}]}, {
              "0.`", "1.`", "0.`", "0.`", "0.`"}, {
              "0.`", "0.`", "0.98`", "0.01`", "0.007`"}, {
              "0.`", "0.`", "0.01`", "0.98`", "0.007`"}, {
               RowBox[{"-", "0.02`"}], "0.`", "0.01`", "0.01`", "0.98`"}}, 
             RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> Baseline,
              ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]]}]}], "\[RightAssociation]"}]],
  Annotation[#, 
   Association[
   "s" -> MatrixForm[{1., 0.12, 1., 0.758, 0.863}], "T" -> 
    MatrixForm[{{0.98, 0., 0., 0., -0.007}, {0., 1., 0., 0., 0.}, {0., 0., 
      0.98, 0.01, 0.007}, {0., 0., 0.01, 0.98, 0.007}, {-0.02, 0., 0.01, 0.01,
       0.98}}]], "Tooltip"]& ]], "Output",
 CellChangeTimes->{{3.822322291617085*^9, 3.822322305137458*^9}, {
  3.822322376214073*^9, 3.822322384663274*^9}, {3.822322679683806*^9, 
  3.822322706703596*^9}},
 CellLabel->
  "Out[707]=",ExpressionUUID->"cd2abecd-479c-4a6a-bc73-7afbb06da635"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ShowPowerStructure", "[", 
  RowBox[{
   RowBox[{"NetRandomMoveNear", "[", "ps", "]"}], ",", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<circular\>\"", "\[Rule]", "True"}], ",", 
     RowBox[{"\"\<size\>\"", "\[Rule]", "150"}]}], "|>"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.8223223156944838`*^9, {3.822322651656967*^9, 3.822322672964321*^9}},
 CellLabel->
  "In[727]:=",ExpressionUUID->"c7005e6a-d724-4a1b-8ae5-09244f330731"],

Cell[BoxData[
 TagBox[
  TooltipBox[
   GraphicsBox[
    NamespaceBox[{
      {GrayLevel[0], Opacity[0.7], 
       LineBox[{
        DynamicLocation["VertexID$1", Automatic, Center], DynamicLocation[
         "VertexID$4", Automatic, Center]}], 
       {Dashing[{Small, Small}], 
        LineBox[{
         DynamicLocation["VertexID$1", Automatic, Center], DynamicLocation[
          "VertexID$5", Automatic, Center]}]}, 
       {Dashing[{Small, Small}], 
        LineBox[{
         DynamicLocation["VertexID$2", Automatic, Center], DynamicLocation[
          "VertexID$4", Automatic, Center]}]}, 
       LineBox[{
        DynamicLocation["VertexID$3", Automatic, Center], DynamicLocation[
         "VertexID$4", Automatic, Center]}], 
       LineBox[{
        DynamicLocation["VertexID$3", Automatic, Center], DynamicLocation[
         "VertexID$5", Automatic, Center]}], 
       LineBox[{
        DynamicLocation["VertexID$4", Automatic, Center], DynamicLocation[
         "VertexID$5", Automatic, Center]}]}, 
      {GrayLevel[0], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
       TagBox[
        {RGBColor[0.3067360821644137, 0.7459411133350095, 0.4825714872537681],
          DiskBox[{-1., 0.}, 0.19280450863569873]},
        "DynamicName",
        BoxID -> "VertexID$1"], 
       TagBox[
        {RGBColor[
         0.12140466992185778`, 0.013977130058147987`, 0.4003094268515615], 
         DiskBox[{-0.30901699437494745, 0.9510565162951535}, 
          0.06531401367787505]},
        "DynamicName",
        BoxID -> "VertexID$2"], 
       TagBox[
        {RGBColor[
         0.8936809218815631, 0.8941188740098348, 0.35419183111083175`], 
         DiskBox[{0.8090169943749475, 0.5877852522924731}, 
          0.19665915685377297]},
        "DynamicName",
        BoxID -> "VertexID$3"], 
       TagBox[
        {RGBColor[0.2116484063531805, 0.6780698530339562, 0.5158480682355006],
          DiskBox[{0.8090169943749475, -0.5877852522924731}, 
          0.17131925749203727]},
        "DynamicName",
        BoxID -> "VertexID$4"], 
       TagBox[
        {RGBColor[0.161611429920525, 0.6247452770458004, 0.5320086461018557], 
         DiskBox[{-0.30901699437494745, -0.9510565162951535}, 
          0.17917221230338176]},
        "DynamicName",
        BoxID -> "VertexID$5"]}}],
    BaseStyle->GrayLevel[0],
    FormatType->TraditionalForm,
    FrameTicks->None,
    ImageSize->150],
   RowBox[{"\[LeftAssociation]", 
     RowBox[{
       RowBox[{"\"s\"", "\[Rule]", 
         TagBox[
          RowBox[{"(", "\[NoBreak]", 
            TagBox[
             
             GridBox[{{"0.968`"}, {"0.111`"}, {"1.0070000000000001`"}, {
               "0.765`"}, {"0.836`"}}, ColumnAlignments -> Center, 
              RowSpacings -> 1, ColumnAlignments -> Left], Column], 
            "\[NoBreak]", ")"}], 
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]]}], ",", 
       RowBox[{"\"T\"", "\[Rule]", 
         TagBox[
          RowBox[{"(", "\[NoBreak]", 
            GridBox[{{"0.985`", "0.`", "0.`", "0.006`", 
               RowBox[{"-", "0.01`"}]}, {"0.`", "0.98`", "0.`", 
               RowBox[{"-", "0.003`"}], "0.`"}, {
              "0.`", "0.`", "0.989`", "0.006`", "0.006`"}, {"0.005`", 
               RowBox[{"-", "0.02`"}], "0.005`", "0.98`", "0.005`"}, {
               RowBox[{"-", "0.01`"}], "0.`", "0.006`", "0.006`", "0.98`"}}, 
             RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> Baseline,
              ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]]}], ",", 
       RowBox[{"\"M\"", "\[Rule]", 
         TagBox[
          RowBox[{"(", "\[NoBreak]", 
            GridBox[{{"0", "0", "0", "1", 
               RowBox[{"-", "1"}]}, {"0", "0", "1", "0", "0"}, {
              "0", "0", "0", "1", "1"}, {"1", 
               RowBox[{"-", "1"}], "1", "0", "1"}, {
               RowBox[{"-", "1"}], "0", "1", "1", "0"}}, RowSpacings -> 1, 
             ColumnSpacings -> 1, RowAlignments -> Baseline, ColumnAlignments -> 
             Center], "\[NoBreak]", ")"}], 
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]]}]}], "\[RightAssociation]"}]],
  Annotation[#, 
   Association[
   "s" -> MatrixForm[{0.968, 0.111, 1.0070000000000001`, 0.765, 0.836}], "T" -> 
    MatrixForm[{{0.985, 0., 0., 0.006, -0.01}, {0., 0.98, 0., -0.003, 0.}, {
      0., 0., 0.989, 0.006, 0.006}, {0.005, -0.02, 0.005, 0.98, 
      0.005}, {-0.01, 0., 0.006, 0.006, 0.98}}], "M" -> 
    MatrixForm[{{0, 0, 0, 1, -1}, {0, 0, 1, 0, 0}, {0, 0, 0, 1, 1}, {1, -1, 1,
       0, 1}, {-1, 0, 1, 1, 0}}]], "Tooltip"]& ]], "Output",
 CellChangeTimes->{{3.822322316570252*^9, 3.8223224040094633`*^9}, {
  3.822322519697753*^9, 3.822322532400938*^9}, {3.822322586991761*^9, 
  3.822322588504344*^9}, {3.822322647913886*^9, 3.822322752869176*^9}},
 CellLabel->
  "Out[727]=",ExpressionUUID->"e2122c9a-eee3-4668-a952-0d2250f241b5"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["NetBestMoveNear", "Subsubsection",
 CellChangeTimes->{{3.8185380050779457`*^9, 3.8185380070994253`*^9}, 
   3.818625072351674*^9, {3.822157287050606*^9, 3.8221573077972097`*^9}, {
   3.8221616907077637`*^9, 3.822161697338409*^9}, {3.8221617590464153`*^9, 
   3.822161768427175*^9}, 3.82225772629008*^9, 3.822259009991158*^9, {
   3.822389068544898*^9, 
   3.8223890692970743`*^9}},ExpressionUUID->"1155692a-59b4-45e3-8f22-\
e256a7c65747"],

Cell[TextData[{
 "Given a node (power structure) in a game tree, identify the best move \
recommended by ",
 StyleBox["PrinceNet", "Input"],
 ", assuming that all agents move simultaneously by altering no more than a \
single relationship. The tactic matrix is reciprocalized. Output: power \
structure."
}], "Text",
 CellChangeTimes->{{3.821181707985228*^9, 3.821181786869795*^9}, 
   3.821450192935012*^9, 3.821450225342896*^9, {3.8214568120145693`*^9, 
   3.8214568178068657`*^9}, 3.822161652999177*^9, {3.822389080413748*^9, 
   3.822389107998822*^9}},ExpressionUUID->"652cc703-18e5-490a-882a-\
9058dd87c040"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NetBestMoveNear", "[", "ps_", "]"}], ":=", 
  RowBox[{"UpdatePowerStructureR", "[", 
   RowBox[{
    RowBox[{"ps", "[", "\"\<s\>\"", "]"}], ",", 
    RowBox[{"NetDecodeBestM", "[", 
     RowBox[{
      RowBox[{"ToTernary", "[", 
       RowBox[{"ps", "[", "\"\<T\>\"", "]"}], "]"}], ",", 
      RowBox[{"NetApply", "[", "ps", "]"}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.821113385941214*^9, 3.821113391387302*^9}, {
   3.821113442595167*^9, 3.821113445348778*^9}, {3.8211135428390427`*^9, 
   3.821113570284906*^9}, {3.8211136559092627`*^9, 3.8211136740151243`*^9}, {
   3.82111373562648*^9, 3.821113736383445*^9}, {3.821117041955289*^9, 
   3.821117053823206*^9}, {3.821117193058413*^9, 3.8211172127554197`*^9}, {
   3.8211176172947083`*^9, 3.821117677508174*^9}, {3.821117824069146*^9, 
   3.8211178513601303`*^9}, {3.821118067917975*^9, 3.8211180734705353`*^9}, {
   3.821118641312129*^9, 3.821118646531466*^9}, {3.82111890126413*^9, 
   3.8211189348901854`*^9}, {3.821181627761689*^9, 3.821181642527917*^9}, {
   3.8211816831944532`*^9, 3.821181700510923*^9}, {3.821181774458764*^9, 
   3.821181775933025*^9}, {3.821181950835134*^9, 3.821181972922184*^9}, {
   3.821182036717896*^9, 3.821182055882649*^9}, {3.821182142369586*^9, 
   3.821182143561397*^9}, {3.821182180040907*^9, 3.821182200641724*^9}, {
   3.821182364060729*^9, 3.821182364410713*^9}, {3.821182462900889*^9, 
   3.821182532218408*^9}, {3.821182927907526*^9, 3.8211829513465977`*^9}, {
   3.8211830351707287`*^9, 3.821183062222351*^9}, {3.821183190011387*^9, 
   3.821183190690812*^9}, {3.821185211710086*^9, 3.8211852122895947`*^9}, {
   3.821185577515646*^9, 3.8211855793502073`*^9}, {3.821185657713771*^9, 
   3.821185683376925*^9}, {3.8211859889856567`*^9, 3.821185993033341*^9}, {
   3.821186100542199*^9, 3.821186126403119*^9}, {3.821186297865582*^9, 
   3.821186302614059*^9}, {3.821188270919796*^9, 3.821188299345117*^9}, {
   3.821188335806795*^9, 3.8211883456114597`*^9}, {3.821188382820065*^9, 
   3.821188383249017*^9}, 3.821188418515295*^9, {3.821188464793536*^9, 
   3.8211884685254297`*^9}, {3.821188554591816*^9, 3.821188558470092*^9}, 
   3.8211888000947237`*^9, {3.821188837588111*^9, 3.821188870579935*^9}, {
   3.821189413094576*^9, 3.8211894162535067`*^9}, {3.821190760605475*^9, 
   3.8211907614504337`*^9}, {3.821293438976428*^9, 3.821293440207034*^9}, {
   3.821293477750826*^9, 3.8212935022932253`*^9}, {3.821293561123086*^9, 
   3.821293629347105*^9}, {3.821445195129087*^9, 3.821445197257169*^9}, {
   3.821449988333235*^9, 3.82145000551171*^9}, 3.821450280201335*^9, {
   3.821456116157577*^9, 3.821456118105657*^9}, {3.821456193283359*^9, 
   3.8214562142215023`*^9}, {3.821456292833139*^9, 3.821456307969491*^9}, {
   3.821456392250803*^9, 3.821456400923272*^9}, {3.8214564508486567`*^9, 
   3.821456453719159*^9}, {3.821456955160343*^9, 3.821456959027996*^9}, {
   3.82145724654189*^9, 3.8214572545737467`*^9}, {3.821457813262541*^9, 
   3.821457814345544*^9}, 3.82216148748566*^9, {3.822161525675408*^9, 
   3.822161527294838*^9}, 3.822161577959242*^9, {3.822161639256167*^9, 
   3.822161640840651*^9}, 3.822161712498886*^9, {3.822161892217031*^9, 
   3.822161896476775*^9}, {3.822251605784081*^9, 3.8222516142402687`*^9}, {
   3.822251659686759*^9, 3.822251843097691*^9}, {3.822322180759918*^9, 
   3.822322184311405*^9}, {3.822322478585144*^9, 3.8223225049964733`*^9}, {
   3.8223891401728363`*^9, 3.822389144630781*^9}, 3.8224796295824614`*^9},
 CellLabel->
  "In[144]:=",ExpressionUUID->"7499faef-fc55-4d23-8485-276700a2aeef"]
}, Closed]],

Cell[CellGroupData[{

Cell["NetImport/Export", "Subsubsection",
 CellChangeTimes->{{3.821272509940856*^9, 3.821272513612884*^9}, {
  3.822252340985237*^9, 
  3.822252343364295*^9}},ExpressionUUID->"0cdfa22c-b9e7-48dd-9b64-\
d642096ec40b"],

Cell["Export/import the neural network", "Text",
 CellChangeTimes->{{3.8212842307123137`*^9, 3.821284231916404*^9}, {
  3.822252501235701*^9, 
  3.822252517808463*^9}},ExpressionUUID->"b69752cc-3c9c-4ecd-b497-\
ec263278b244"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "NetPath", "=", 
   "\"\</Users/mpoulshock/Documents/Github/\
AMathematicalTheoryOfPowerStruggles/Data/PrinceNet/PrinceNet5a.wlnet\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8212826154612627`*^9, 3.821282621889002*^9}, {
   3.821283075787943*^9, 3.8212830761055813`*^9}, 3.821283455677474*^9, 
   3.82128403104615*^9, {3.821300775301383*^9, 3.821300836342393*^9}, {
   3.8213550364830093`*^9, 3.821355060884197*^9}, 3.821355127639758*^9, 
   3.821355263778138*^9, {3.821355440333247*^9, 3.821355441258066*^9}, {
   3.8213890451509247`*^9, 3.821389046668635*^9}, {3.821465320191485*^9, 
   3.821465326017153*^9}, {3.821465488513503*^9, 3.821465495816083*^9}, {
   3.8214745483285227`*^9, 3.821474585653833*^9}, {3.821474820783978*^9, 
   3.821474822838337*^9}, {3.822252347433365*^9, 3.8222523632734013`*^9}, {
   3.822252432311886*^9, 3.822252445462419*^9}},
 CellLabel->
  "In[263]:=",ExpressionUUID->"1632f534-ffeb-41fe-a93f-909dbd41ec89"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"NetPath", ",", "PrinceNet"}], "]"}]], "Input",
 CellChangeTimes->{{3.8212052789388533`*^9, 3.8212052828334293`*^9}, {
   3.8212053603409023`*^9, 3.821205374534277*^9}, 3.821285128113241*^9, {
   3.82225245226099*^9, 3.822252459414874*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[251]:=",ExpressionUUID->"b3159bf6-eeba-49aa-a16f-d5673fd5772c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PrinceNet", "=", 
   RowBox[{"Import", "[", "NetPath", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.822252530194223*^9, 3.822252550736391*^9}, 
   3.822252581350319*^9, 3.822498536852704*^9},
 CellLabel->
  "In[264]:=",ExpressionUUID->"a1346d9c-a5fb-4619-a2d6-eab09f07c5ed"],

Cell["Export/import training data", "Text",
 CellChangeTimes->{{3.821284156647064*^9, 3.8212841589469233`*^9}, {
  3.82225240751346*^9, 
  3.822252414674202*^9}},ExpressionUUID->"8d774837-dc33-4fb2-9f05-\
826bef59ddce"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"path", ",", 
    RowBox[{"Compress", "[", "data", "]"}], ",", "\"\<String\>\""}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.821284038078828*^9, 3.8212840461800413`*^9}, {
   3.8213008573960114`*^9, 3.821300871961246*^9}, {3.821355068889393*^9, 
   3.821355078243449*^9}, 3.821465506414384*^9},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[961]:=",ExpressionUUID->"345c0935-6362-4799-b43b-8eae18fb09be"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vData", "=", 
   RowBox[{"Uncompress", "[", 
    RowBox[{"Import", "[", 
     RowBox[{"path", ",", "\"\<String\>\""}], "]"}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.8212840962864943`*^9, 3.821284104471051*^9}, {
  3.821284172609364*^9, 3.821284198540957*^9}, {3.821474574724633*^9, 
  3.821474576196368*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[859]:=",ExpressionUUID->"75fa5566-430b-4cd1-a425-c388a477a961"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["PrinceNet", "Subsection",
 CellChangeTimes->{{3.822312832672297*^9, 
  3.822312834847443*^9}},ExpressionUUID->"4d41d13e-24ff-41e6-a12a-\
6f2b1e41d9e9"],

Cell[CellGroupData[{

Cell["PrinceNet", "Subsubsection",
 CellChangeTimes->{{3.8223128372971478`*^9, 
  3.822312838759841*^9}},ExpressionUUID->"c4e3a627-0db6-42f9-9b1a-\
c2d380ce6977"],

Cell[TextData[{
 "Instantiates the neural network. Used for training. Output: ",
 StyleBox["NetChain", "Input"],
 " object."
}], "Text",
 CellChangeTimes->{{3.8223128684335546`*^9, 
  3.822312917538394*^9}},ExpressionUUID->"17ccfd99-d22f-487a-bd01-\
53f6e0d301ab"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PrinceNet", "=", 
  RowBox[{"NetConstruct", "[", 
   RowBox[{"5", ",", "5"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.82215645454114*^9, 3.8221564791068907`*^9}, 
   3.822156545978507*^9, {3.822156757643195*^9, 3.822156758051195*^9}, 
   3.822157650897942*^9, {3.822161469992125*^9, 3.82216147332378*^9}, {
   3.822246592015284*^9, 3.822246593044238*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[184]:=",ExpressionUUID->"ef4b114b-a0d7-4913-bf42-f5317521f641"],

Cell[BoxData[
 TagBox[
  TemplateBox[{
    RowBox[{
      StyleBox[
       TagBox["NetChain", "SummaryHead"], "NonInterpretableSummary"], 
      StyleBox["[", "NonInterpretableSummary"], 
      DynamicModuleBox[{Typeset`open = False}, 
       PanelBox[
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquarePlusIconMedium"]], 
                ButtonFunction :> (Typeset`open = True), Appearance -> None, 
                Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> {Automatic, 24}], 
              StyleBox[
               GraphicsBox[{
                 Thickness[0.014925373134328358`], {
                  RGBColor[0.729, 0.729, 0.729], 
                  Thickness[0.018686567164179105`], 
                  Opacity[1.], 
                  JoinForm[{"Miter", 10.}], 
                  
                  JoinedCurveBox[{{{0, 2, 0}}}, {{{23., 91.5}, {30., 91.5}}}, 
                   CurveClosed -> {0}]}, {
                  RGBColor[0.729, 0.729, 0.729], 
                  Thickness[0.018686567164179105`], 
                  Opacity[1.], 
                  JoinForm[{"Miter", 10.}], 
                  
                  JoinedCurveBox[{{{0, 2, 0}}}, {{{37., 91.5}, {44., 91.5}}}, 
                   CurveClosed -> {0}]}, {
                  FaceForm[{
                    RGBColor[0.631, 0.8160000000000001, 0.498], 
                    Opacity[1.]}], 
                  
                  FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{15.5,
                    103.5}, {23.5, 103.5}, {23.5, 79.5}, {15.5, 79.5}}}]}, {
                  FaceForm[{
                    RGBColor[0.40800000000000003`, 0.627, 0.196], 
                    Opacity[1.]}], 
                  
                  FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 
                   0}, {0, 1, 0}, {0, 1, 0}}}, {{{24., 104.}, {15., 104.}, {
                   15., 79.}, {24., 79.}}, {{23., 80.}, {16., 80.}, {16., 
                   103.}, {23., 103.}}}]}, {
                  FaceForm[{
                    RGBColor[0.38, 0.753, 0.89], 
                    Opacity[1.]}], 
                  
                  FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{29.5,
                    103.5}, {37.5, 103.5}, {37.5, 79.5}, {29.5, 79.5}}}]}, {
                  FaceForm[{
                    RGBColor[0.24300000000000002`, 0.608, 0.71], 
                    Opacity[1.]}], 
                  
                  FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 
                   0}, {0, 1, 0}, {0, 1, 0}}}, {{{38., 104.}, {29., 104.}, {
                   29., 79.}, {38., 79.}}, {{37., 80.}, {30., 80.}, {30., 
                   103.}, {37., 103.}}}]}, {
                  FaceForm[{
                    RGBColor[0.584, 0.51, 0.8390000000000001], 
                    Opacity[1.]}], 
                  
                  FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{43.5,
                    103.5}, {51.5, 103.5}, {51.5, 79.5}, {43.5, 79.5}}}]}, {
                  FaceForm[{
                    RGBColor[0.4, 0.396, 0.659], 
                    Opacity[1.]}], 
                  
                  FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 
                   0}, {0, 1, 0}, {0, 1, 0}}}, {{{52., 104.}, {43., 104.}, {
                   43., 79.}, {52., 79.}}, {{51., 80.}, {44., 80.}, {44., 
                   103.}, {51., 103.}}}]}, {
                  FaceForm[{
                    RGBColor[0.549, 0.549, 0.549], 
                    Opacity[1.]}], 
                  
                  FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}}}, {{{28., 91.5}, {
                   25., 95.}, {25., 88.}}}], 
                  
                  FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}}}, {{{42., 91.5}, {
                   39., 95.}, {39., 88.}}}]}}, ImageMargins -> 0, 
                ImageSize -> {36, Automatic}, PlotRangePadding -> 0], 
               CacheGraphics -> False], 
              GridBox[{{
                 StyleBox[
                  TemplateBox[{
                    TemplateBox[{
                    StyleBox["\"Input\"", 
                    GrayLevel[0], StripOnInput -> False], "\" \"", 
                    "\"port\""}, "RowDefault"], "\":\""}, "RowDefault"], 
                  "SummaryItemAnnotation"], 
                 StyleBox[
                  TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", "\":\"", 
                    "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"26\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                  "SummaryItem"]}, {
                 StyleBox[
                  TemplateBox[{
                    TemplateBox[{
                    StyleBox["\"Output\"", 
                    GrayLevel[0], StripOnInput -> False], "\" \"", 
                    "\"port\""}, "RowDefault"], "\":\""}, "RowDefault"], 
                  "SummaryItemAnnotation"], 
                 StyleBox[
                  TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{
                    "\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", "\":\"", 
                    "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"15\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                  "SummaryItem"]}}, BaselinePosition -> Automatic, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, 
               GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            GridFrameMargins -> {{0, 0}, {0, 0}}, BaselinePosition -> {1, 3}],
           True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquareMinusIconMedium"]], 
                ButtonFunction :> (Typeset`open = False), Appearance -> None, 
                Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> {Automatic, 24}], 
              StyleBox[
               GraphicsBox[{
                 Thickness[0.014925373134328358`], {
                  RGBColor[0.729, 0.729, 0.729], 
                  Thickness[0.018686567164179105`], 
                  Opacity[1.], 
                  JoinForm[{"Miter", 10.}], 
                  
                  JoinedCurveBox[{{{0, 2, 0}}}, {{{23., 91.5}, {30., 91.5}}}, 
                   CurveClosed -> {0}]}, {
                  RGBColor[0.729, 0.729, 0.729], 
                  Thickness[0.018686567164179105`], 
                  Opacity[1.], 
                  JoinForm[{"Miter", 10.}], 
                  
                  JoinedCurveBox[{{{0, 2, 0}}}, {{{37., 91.5}, {44., 91.5}}}, 
                   CurveClosed -> {0}]}, {
                  FaceForm[{
                    RGBColor[0.631, 0.8160000000000001, 0.498], 
                    Opacity[1.]}], 
                  
                  FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{15.5,
                    103.5}, {23.5, 103.5}, {23.5, 79.5}, {15.5, 79.5}}}]}, {
                  FaceForm[{
                    RGBColor[0.40800000000000003`, 0.627, 0.196], 
                    Opacity[1.]}], 
                  
                  FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 
                   0}, {0, 1, 0}, {0, 1, 0}}}, {{{24., 104.}, {15., 104.}, {
                   15., 79.}, {24., 79.}}, {{23., 80.}, {16., 80.}, {16., 
                   103.}, {23., 103.}}}]}, {
                  FaceForm[{
                    RGBColor[0.38, 0.753, 0.89], 
                    Opacity[1.]}], 
                  
                  FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{29.5,
                    103.5}, {37.5, 103.5}, {37.5, 79.5}, {29.5, 79.5}}}]}, {
                  FaceForm[{
                    RGBColor[0.24300000000000002`, 0.608, 0.71], 
                    Opacity[1.]}], 
                  FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 
                   0}, {0, 1, 0}, {0, 1, 0}}}, {{{38., 104.}, {29., 104.}, {
                   29., 79.}, {38., 79.}}, {{37., 80.}, {30., 80.}, {30., 
                   103.}, {37., 103.}}}]}, {
                  FaceForm[{
                    RGBColor[0.584, 0.51, 0.8390000000000001], 
                    Opacity[1.]}], 
                  
                  FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{43.5,
                    103.5}, {51.5, 103.5}, {51.5, 79.5}, {43.5, 79.5}}}]}, {
                  FaceForm[{
                    RGBColor[0.4, 0.396, 0.659], 
                    Opacity[1.]}], 
                  
                  FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 
                   0}, {0, 1, 0}, {0, 1, 0}}}, {{{52., 104.}, {43., 104.}, {
                   43., 79.}, {52., 79.}}, {{51., 80.}, {44., 80.}, {44., 
                   103.}, {51., 103.}}}]}, {
                  FaceForm[{
                    RGBColor[0.549, 0.549, 0.549], 
                    Opacity[1.]}], 
                  
                  FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}}}, {{{28., 91.5}, {
                   25., 95.}, {25., 88.}}}], 
                  
                  FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}}}, {{{42., 91.5}, {
                   39., 95.}, {39., 88.}}}]}}, ImageMargins -> 0, 
                ImageSize -> {36, Automatic}, PlotRangePadding -> 0], 
               CacheGraphics -> False], 
              GridBox[{{
                 
                 DynamicModuleBox[{
                  NeuralNetworks`Private`NetChain`assoc3 = 
                   Association[
                    "Type" -> "Chain", "Nodes" -> 
                    Association[
                    "1" -> Association[
                    "Type" -> "Linear", "Arrays" -> 
                    Association[
                    "Weights" -> NeuralNetworks`Private`DummyArray[{26, 26}], 
                    "Biases" -> NeuralNetworks`Private`DummyArray[{26}]], 
                    "Parameters" -> 
                    Association[
                    "OutputDimensions" -> {26}, "$OutputSize" -> 26, 
                    "$InputSize" -> 26, "$InputDimensions" -> {26}], "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{26}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{26}, NeuralNetworks`RealT]]], "2" -> 
                    Association[
                    "Type" -> "Elementwise", "Arrays" -> Association[], 
                    "Parameters" -> 
                    Association[
                    "Function" -> NeuralNetworks`ValidatedParameter[Tanh], 
                    "$Dimensions" -> {26}], "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{26}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{26}, NeuralNetworks`RealT]]], "3" -> 
                    Association[
                    "Type" -> "Linear", "Arrays" -> 
                    Association[
                    "Weights" -> NeuralNetworks`Private`DummyArray[{23, 26}], 
                    "Biases" -> NeuralNetworks`Private`DummyArray[{23}]], 
                    "Parameters" -> 
                    Association[
                    "OutputDimensions" -> {23}, "$OutputSize" -> 23, 
                    "$InputSize" -> 26, "$InputDimensions" -> {26}], "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{26}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{23}, NeuralNetworks`RealT]]], "4" -> 
                    Association[
                    "Type" -> "Elementwise", "Arrays" -> Association[], 
                    "Parameters" -> 
                    Association[
                    "Function" -> NeuralNetworks`ValidatedParameter[Tanh], 
                    "$Dimensions" -> {23}], "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{23}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{23}, NeuralNetworks`RealT]]], "5" -> 
                    Association[
                    "Type" -> "Linear", "Arrays" -> 
                    Association[
                    "Weights" -> NeuralNetworks`Private`DummyArray[{21, 23}], 
                    "Biases" -> NeuralNetworks`Private`DummyArray[{21}]], 
                    "Parameters" -> 
                    Association[
                    "OutputDimensions" -> {21}, "$OutputSize" -> 21, 
                    "$InputSize" -> 23, "$InputDimensions" -> {23}], "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{23}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{21}, NeuralNetworks`RealT]]], "6" -> 
                    Association[
                    "Type" -> "Elementwise", "Arrays" -> Association[], 
                    "Parameters" -> 
                    Association[
                    "Function" -> NeuralNetworks`ValidatedParameter[Tanh], 
                    "$Dimensions" -> {21}], "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{21}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{21}, NeuralNetworks`RealT]]], "7" -> 
                    Association[
                    "Type" -> "Linear", "Arrays" -> 
                    Association[
                    "Weights" -> NeuralNetworks`Private`DummyArray[{19, 21}], 
                    "Biases" -> NeuralNetworks`Private`DummyArray[{19}]], 
                    "Parameters" -> 
                    Association[
                    "OutputDimensions" -> {19}, "$OutputSize" -> 19, 
                    "$InputSize" -> 21, "$InputDimensions" -> {21}], "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{21}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{19}, NeuralNetworks`RealT]]], "8" -> 
                    Association[
                    "Type" -> "Elementwise", "Arrays" -> Association[], 
                    "Parameters" -> 
                    Association[
                    "Function" -> NeuralNetworks`ValidatedParameter[Tanh], 
                    "$Dimensions" -> {19}], "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{19}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{19}, NeuralNetworks`RealT]]], "9" -> 
                    Association[
                    "Type" -> "Linear", "Arrays" -> 
                    Association[
                    "Weights" -> NeuralNetworks`Private`DummyArray[{17, 19}], 
                    "Biases" -> NeuralNetworks`Private`DummyArray[{17}]], 
                    "Parameters" -> 
                    Association[
                    "OutputDimensions" -> {17}, "$OutputSize" -> 17, 
                    "$InputSize" -> 19, "$InputDimensions" -> {19}], "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{19}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{17}, NeuralNetworks`RealT]]], 
                    "10" -> Association[
                    "Type" -> "Elementwise", "Arrays" -> Association[], 
                    "Parameters" -> 
                    Association[
                    "Function" -> NeuralNetworks`ValidatedParameter[Ramp], 
                    "$Dimensions" -> {17}], "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{17}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{17}, NeuralNetworks`RealT]]], 
                    "11" -> Association[
                    "Type" -> "Linear", "Arrays" -> 
                    Association[
                    "Weights" -> NeuralNetworks`Private`DummyArray[{15, 17}], 
                    "Biases" -> NeuralNetworks`Private`DummyArray[{15}]], 
                    "Parameters" -> 
                    Association[
                    "OutputDimensions" -> {15}, "$OutputSize" -> 15, 
                    "$InputSize" -> 17, "$InputDimensions" -> {17}], "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{17}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{15}, NeuralNetworks`RealT]]], 
                    "12" -> Association[
                    "Type" -> "Softmax", "Arrays" -> Association[], 
                    "Parameters" -> Association["Level" -> -1], "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{15}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{15}, NeuralNetworks`RealT]]], 
                    "13" -> Association[
                    "Type" -> "Reshape", "Arrays" -> Association[], 
                    "Parameters" -> 
                    Association[
                    "Dimensions" -> NeuralNetworks`ValidatedParameter[{15}]], 
                    "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{15}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{15}, NeuralNetworks`RealT]]]], 
                    "Edges" -> {
                    NeuralNetworks`NetPath["Nodes", "1", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath["Inputs", "Input"], 
                    NeuralNetworks`NetPath["Nodes", "2", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath["Nodes", "1", "Outputs", "Output"],
                     NeuralNetworks`NetPath["Nodes", "3", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath["Nodes", "2", "Outputs", "Output"],
                     NeuralNetworks`NetPath["Nodes", "4", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath["Nodes", "3", "Outputs", "Output"],
                     NeuralNetworks`NetPath["Nodes", "5", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath["Nodes", "4", "Outputs", "Output"],
                     NeuralNetworks`NetPath["Nodes", "6", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath["Nodes", "5", "Outputs", "Output"],
                     NeuralNetworks`NetPath["Nodes", "7", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath["Nodes", "6", "Outputs", "Output"],
                     NeuralNetworks`NetPath["Nodes", "8", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath["Nodes", "7", "Outputs", "Output"],
                     NeuralNetworks`NetPath["Nodes", "9", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath["Nodes", "8", "Outputs", "Output"],
                     NeuralNetworks`NetPath["Nodes", "10", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath["Nodes", "9", "Outputs", "Output"],
                     NeuralNetworks`NetPath["Nodes", "11", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath[
                    "Nodes", "10", "Outputs", "Output"], 
                    NeuralNetworks`NetPath["Nodes", "12", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath[
                    "Nodes", "11", "Outputs", "Output"], 
                    NeuralNetworks`NetPath["Nodes", "13", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath[
                    "Nodes", "12", "Outputs", "Output"], 
                    NeuralNetworks`NetPath["Outputs", "Output"] -> 
                    NeuralNetworks`NetPath[
                    "Nodes", "13", "Outputs", "Output"]}, "Inputs" -> 
                    Association[
                    "Input" -> 
                    NeuralNetworks`TensorT[{26}, NeuralNetworks`RealT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{15}, NeuralNetworks`RealT]]], 
                   NeuralNetworks`Private`NetChain`opart, 
                   NeuralNetworks`Private`NetChain`part, 
                   NeuralNetworks`Private`NetChain`selected = Null}, 
                  DynamicBox[
                   GridBox[{{
                    TagBox[
                    TagBox[
                    GridBox[{{
                    TagBox[
                    TagBox[
                    "\"\"", Annotation[#, {"Inputs", "Input"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    "\"Input\"", 
                    Annotation[#, {"Inputs", "Input"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{"\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", 
                    "\":\"", "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"26\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Inputs", "Input"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    StyleBox["\"1\"", 
                    GrayLevel[0.5], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "1"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    StyleBox["LinearLayer", 
                    GrayLevel[0], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "1"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{"\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", 
                    "\":\"", "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"26\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Nodes", "1"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    StyleBox["\"2\"", 
                    GrayLevel[0.5], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "2"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    StyleBox["Tanh", 
                    GrayLevel[0], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "2"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{"\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", 
                    "\":\"", "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"26\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Nodes", "2"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    StyleBox["\"3\"", 
                    GrayLevel[0.5], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "3"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    StyleBox["LinearLayer", 
                    GrayLevel[0], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "3"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{"\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", 
                    "\":\"", "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"23\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Nodes", "3"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    StyleBox["\"4\"", 
                    GrayLevel[0.5], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "4"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    StyleBox["Tanh", 
                    GrayLevel[0], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "4"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{"\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", 
                    "\":\"", "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"23\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Nodes", "4"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    StyleBox["\"5\"", 
                    GrayLevel[0.5], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "5"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    StyleBox["LinearLayer", 
                    GrayLevel[0], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "5"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{"\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", 
                    "\":\"", "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"21\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Nodes", "5"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    StyleBox["\"6\"", 
                    GrayLevel[0.5], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "6"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    StyleBox["Tanh", 
                    GrayLevel[0], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "6"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{"\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", 
                    "\":\"", "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"21\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Nodes", "6"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    StyleBox["\"7\"", 
                    GrayLevel[0.5], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "7"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    StyleBox["LinearLayer", 
                    GrayLevel[0], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "7"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{"\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", 
                    "\":\"", "\" \"", 
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"19\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Nodes", "7"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    StyleBox["\"8\"", 
                    GrayLevel[0.5], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "8"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    StyleBox["Tanh", 
                    GrayLevel[0], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "8"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{"\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", 
                    "\":\"", "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"19\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Nodes", "8"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    StyleBox["\"9\"", 
                    GrayLevel[0.5], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "9"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    StyleBox["LinearLayer", 
                    GrayLevel[0], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "9"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{"\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", 
                    "\":\"", "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"17\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Nodes", "9"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    StyleBox["\"10\"", 
                    GrayLevel[0.5], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "10"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    StyleBox["Ramp", 
                    GrayLevel[0], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "10"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{"\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", 
                    "\":\"", "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"17\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Nodes", "10"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    StyleBox["\"11\"", 
                    GrayLevel[0.5], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "11"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    StyleBox["LinearLayer", 
                    GrayLevel[0], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "11"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{"\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", 
                    "\":\"", "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"15\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Nodes", "11"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    StyleBox["\"12\"", 
                    GrayLevel[0.5], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "12"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    StyleBox["SoftmaxLayer", 
                    GrayLevel[0], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "12"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{"\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", 
                    "\":\"", "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"15\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Nodes", "12"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    StyleBox["\"13\"", 
                    GrayLevel[0.5], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "13"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    StyleBox["ReshapeLayer", 
                    GrayLevel[0], StripOnInput -> False], 
                    Annotation[#, {"Nodes", "13"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{"\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", 
                    "\":\"", "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"15\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Nodes", "13"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}, {
                    TagBox[
                    TagBox[
                    "\"\"", Annotation[#, {"Outputs", "Output"}, "Mouse"]& ], 
                    
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    "\"Output\"", 
                    Annotation[#, {"Outputs", "Output"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]], 
                    TagBox[
                    TagBox[
                    TemplateBox[{"\"vector\"", "\" \"", 
                    StyleBox[
                    
                    TemplateBox[{"\"(\"", "\"\[VeryThinSpace]\"", "\"size\"", 
                    "\":\"", "\" \"", 
                    
                    TemplateBox[{"\[Times]", "\"\[Times]\"", "\"15\""}, 
                    "RowWithSeparators"], "\"\[VeryThinSpace]\"", "\")\""}, 
                    "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}, "RowDefault"], 
                    Annotation[#, {"Outputs", "Output"}, "Mouse"]& ], 
                    MouseAppearanceTag["LinkHand"]]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, AutoDelete -> 
                    False, GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                    GridBoxSpacings -> {"Columns" -> {{1.1}}}], "Grid"], 
                    EventHandlerTag[{"MouseClicked" :> If[
                    ListQ[
                    NeuralNetworks`Private`NetChain`part = MouseAnnotation[]],
                     If[NeuralNetworks`Private`NetChain`opart === 
                    NeuralNetworks`Private`NetChain`part, 
                    NeuralNetworks`Private`NetChain`selected = Null; 
                    NeuralNetworks`Private`NetChain`opart = Null, 
                    NeuralNetworks`Private`NetChain`selected = 
                    Part[NeuralNetworks`Private`NetChain`assoc3, 
                    Apply[Sequence, NeuralNetworks`Private`NetChain`part]]; 
                    NeuralNetworks`Private`NetChain`opart = 
                    NeuralNetworks`Private`NetChain`part; Null]; Null], 
                    Method -> "Preemptive", PassEventsDown -> Automatic, 
                    PassEventsUp -> True}]]}, 
                    NeuralNetworks`FormatSelectedParameterChain[
                    NeuralNetworks`Private`NetChain`selected, 
                    NeuralNetworks`Private`NetChain`part, 
                    Association[], {}]}, 
                    GridBoxSpacings -> {"Columns" -> {{1}}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    GridFrameMargins -> {{0, 0}, {0, 0}}], 
                   TrackedSymbols :> {
                    NeuralNetworks`Private`NetChain`selected}], 
                  Initialization :> {NetChain}]}}, BaselinePosition -> 
               Automatic, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, 
               GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            GridFrameMargins -> {{0, 0}, {0, 0}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open], ImageSize -> Automatic], BaselinePosition -> 
        Baseline, 
        BaseStyle -> {
         ShowStringCharacters -> False, NumberMarks -> False, PrintPrecision -> 
          3, ShowSyntaxStyles -> False}]], 
      StyleBox["]", "NonInterpretableSummary"]}]},
   "CopyTag",
   DisplayFunction->(#& ),
   InterpretationFunction->("NetChain[<>]"& )],
  False,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{{3.822156457541978*^9, 3.8221564794831047`*^9}, {
   3.822156546716453*^9, 3.822156571021022*^9}, 3.822156766087867*^9, 
   3.822156828717476*^9, 3.822157023421567*^9, 3.822157657938936*^9, 
   3.8221614805075493`*^9, 3.822244998947475*^9, 3.8222465952451344`*^9, 
   3.82232281548032*^9, 3.822328476045082*^9},
 CellLabel->
  "Out[184]=",ExpressionUUID->"f2b6af18-18a0-4f8e-8cff-66ccaf228cfe"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["PrinceNetJr", "Subsubsection",
 CellChangeTimes->{{3.82230762776013*^9, 
  3.8223076381783524`*^9}},ExpressionUUID->"e1ae09a1-be02-457c-b44e-\
1cc01f366e51"],

Cell[TextData[{
 "A homegrown implementation of ",
 StyleBox["PrinceNet", "Input"],
 ". ",
 StyleBox["PrinceNetJr", "Input"],
 " is accurate to 8 decimal places and ~1500x faster. Used in MCTS. Output: \
\[OpenCurlyDoubleQuote]policy\[CloseCurlyDoubleQuote] vector."
}], "Text",
 CellChangeTimes->{{3.822307478603853*^9, 3.8223074971459627`*^9}, {
   3.822307539357288*^9, 3.8223075484785547`*^9}, 3.822307594345942*^9, {
   3.822312439547443*^9, 3.822312486071486*^9}, 3.822312755387609*^9, {
   3.8223129239248447`*^9, 3.822312928055954*^9}, {3.822313122782845*^9, 
   3.8223131247923*^9}},ExpressionUUID->"00d2e047-7dbf-4f62-afaa-\
0e5018967849"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PrinceNetJr", "[", "in_", "]"}], ":=", 
  RowBox[{"Softmax", "[", 
   RowBox[{
    RowBox[{"Last", "[", "weights", "]"}], ".", 
    RowBox[{"Ramp", "[", 
     RowBox[{"NetApplyComponent", "[", 
      RowBox[{
       RowBox[{"Drop", "[", 
        RowBox[{"weights", ",", 
         RowBox[{"-", "1"}]}], "]"}], ",", "in", ",", "Tanh"}], "]"}], 
     "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.822312174697402*^9, 3.8223121806228724`*^9}, {
  3.822312242542735*^9, 3.8223122577452908`*^9}},
 CellLabel->
  "In[145]:=",ExpressionUUID->"d33f8577-1c42-4f45-be6a-3ae61edda93c"],

Cell[TextData[{
 "A global variable containing ",
 StyleBox["PrinceNet", "Input"],
 "\[CloseCurlyQuote]s current weights. Output: list of matrices."
}], "Text",
 CellChangeTimes->{{3.822312269965889*^9, 3.822312291467189*^9}, 
   3.822312346461191*^9},ExpressionUUID->"1124fdd8-4edc-43cb-a6c5-\
a9b265759bb5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"weights", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Normal", "[", 
       RowBox[{"NetExtract", "[", 
        RowBox[{"PrinceNet", ",", 
         RowBox[{"{", 
          RowBox[{"#", ",", "\"\<Weights\>\""}], "}"}]}], "]"}], "]"}], "&"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3", ",", "5", ",", "7", ",", "9", ",", "11"}], 
      "}"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8223063687426853`*^9, 3.82230639873897*^9}, {
  3.8223064301854353`*^9, 3.822306530875791*^9}, {3.8223065821626377`*^9, 
  3.822306584900117*^9}, {3.822306639234404*^9, 3.822306649210148*^9}, {
  3.822312193631826*^9, 3.822312194454359*^9}},
 CellLabel->
  "In[265]:=",ExpressionUUID->"5bb402b8-b46a-4d06-97ec-5587ec203387"],

Cell["\<\
Apply the homegrown neural network to an input vector, to get an output \
representing the agent\[CloseCurlyQuote]s move. Output: list of reals.\
\>", "Text",
 CellChangeTimes->{{3.729794726776013*^9, 3.729794752187079*^9}, {
   3.732288749137*^9, 3.7322888096029997`*^9}, {3.732820570432321*^9, 
   3.732820592703768*^9}, {3.734368844758637*^9, 3.734368857046324*^9}, {
   3.7423060787239*^9, 3.7423060886194*^9}, {3.751558817335339*^9, 
   3.751558832595385*^9}, {3.755802137590914*^9, 3.755802153499015*^9}, {
   3.822328648138742*^9, 3.822328650091168*^9}, 
   3.8223286942755213`*^9},ExpressionUUID->"0fa35c12-6a00-4184-b687-\
f744ddda7df0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NetApplyComponent", "[", 
   RowBox[{"net_List", ",", "input_List", ",", "activationFcn_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Last", "[", "net", "]"}], ".", 
   RowBox[{"Fold", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"activationFcn", "[", 
       RowBox[{"Dot", "[", 
        RowBox[{"#2", ",", "#1"}], "]"}], "]"}], "&"}], ",", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", "input", "}"}], ",", 
       RowBox[{"Take", "[", 
        RowBox[{"net", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"-", "2"}]}], "}"}]}], "]"}]}], "]"}]}], 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.729718161631417*^9, 3.729718171925417*^9}, {
   3.7297187566914167`*^9, 3.7297188828634167`*^9}, {3.7297191082474165`*^9, 
   3.729719121525417*^9}, {3.729719421427417*^9, 3.7297194326604166`*^9}, {
   3.729719510734417*^9, 3.7297195829884167`*^9}, {3.73228833779*^9, 
   3.732288357512*^9}, 3.732288402582*^9, {3.73228845131*^9, 
   3.732288464703*^9}, 3.732288694602*^9, {3.7322890890880003`*^9, 
   3.732289090527*^9}, {3.732655023628414*^9, 3.732655026062627*^9}, {
   3.732698583587517*^9, 3.732698584150949*^9}, 3.734368794633659*^9, {
   3.751558780955863*^9, 3.751558794938697*^9}, 3.75495537606015*^9, {
   3.758910895938095*^9, 3.758910898654722*^9}, 3.822328653807417*^9, {
   3.822328720569861*^9, 3.8223287213321447`*^9}},
 CellLabel->
  "In[146]:=",ExpressionUUID->"71ed09ab-0d8a-4da4-9700-6e6978cff92c"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Training Loop", "Subsection",
 CellChangeTimes->{{3.822157077056559*^9, 3.8221570803500137`*^9}, {
  3.82232287940936*^9, 3.822322880299963*^9}, {3.822340135197055*^9, 
  3.822340135973187*^9}},ExpressionUUID->"a6121053-dcf1-4e4a-872b-\
ab5f3ce72a31"],

Cell[CellGroupData[{

Cell["NetTrainingLoop", "Subsubsection",
 CellChangeTimes->{{3.822253943304371*^9, 
  3.822253945734766*^9}},ExpressionUUID->"1d512065-66a2-4e9a-a810-\
0dd9dee0f5ff"],

Cell[TextData[{
 "Orchestrates a loop in which: (1) training data is generated through MCTS \
runs; (2) ",
 StyleBox["PrinceNet", "Input"],
 " is trained on the data; (3) the new ",
 StyleBox["PrinceNet", "Input"],
 " is saved to disk; (4) weights are extracted for ",
 StyleBox["PrinceNetJr", "Input"],
 ", and (4) the cycle repeats. Output: none, but ",
 StyleBox["PrinceNet", "Input"],
 " is progressively updated as a side effect."
}], "Text",
 CellChangeTimes->{{3.822339780227128*^9, 
  3.8223399076485863`*^9}},ExpressionUUID->"4e97f219-90ff-4a5e-a49e-\
5dbfc525a4c9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetParameters", "[", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\"\<\[Beta]\>\"", "\[Rule]", "2"}], ",", 
     RowBox[{"\"\<\[Mu]\>\"", "\[Rule]", "3"}], ",", 
     RowBox[{"\"\<\[Lambda]\>\"", "\[Rule]", "1"}], ",", 
     RowBox[{"\"\<\[Alpha]\>\"", "\[Rule]", "2.25"}], ",", " ", 
     RowBox[{"\"\<\[Rho]\>\"", "\[Rule]", "0.98"}]}], "\[RightAssociation]"}],
    "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"data", "=", 
      RowBox[{"NetTrainingData", "[", 
       RowBox[{"5000", ",", "3", ",", "1000"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PrinceNet", "=", 
      RowBox[{"NetTrain", "[", 
       RowBox[{"PrinceNet", ",", "data", ",", 
        RowBox[{"ValidationSet", "\[Rule]", 
         RowBox[{"Scaled", "[", "0.1", "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"NetPath", ",", "PrinceNet"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"weights", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Normal", "[", 
          RowBox[{"NetExtract", "[", 
           RowBox[{"PrinceNet", ",", 
            RowBox[{"{", 
             RowBox[{"#", ",", "\"\<Weights\>\""}], "}"}]}], "]"}], "]"}], 
         "&"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "3", ",", "5", ",", "7", ",", "9", ",", "11"}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Training round \>\"", "<>", 
       RowBox[{"ToString", "[", "n", "]"}], "<>", "\"\< complete.\>\""}], 
      "]"}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "4"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", "Now"}], "Input",
 CellChangeTimes->{{3.8212060550832*^9, 3.821206063696767*^9}, {
   3.821206097681635*^9, 3.821206106180792*^9}, {3.82120679499671*^9, 
   3.821206827955933*^9}, {3.821206940083501*^9, 3.8212069692056437`*^9}, {
   3.821207814137632*^9, 3.821207814308249*^9}, {3.82127236315237*^9, 
   3.821272382121348*^9}, {3.821291856285108*^9, 3.82129186079652*^9}, {
   3.821300888894597*^9, 3.821300915320603*^9}, {3.821474598065566*^9, 
   3.8214746183100357`*^9}, {3.8222540247173634`*^9, 3.822254055333494*^9}, 
   3.82225414280352*^9, {3.822324267974874*^9, 3.822324268222425*^9}, {
   3.82233924741378*^9, 3.822339300460269*^9}, {3.8223393317168627`*^9, 
   3.8223393579637823`*^9}, {3.822339452679305*^9, 3.822339483070365*^9}, {
   3.822339519149638*^9, 3.822339560220286*^9}, {3.822339924226449*^9, 
   3.8223399271156063`*^9}, {3.822340945369309*^9, 3.822340953089926*^9}, {
   3.822341772769175*^9, 3.822341773373489*^9}, {3.822343099953596*^9, 
   3.822343110269895*^9}},
 Background->RGBColor[0.87, 0.94, 1],
 CellLabel->
  "In[326]:=",ExpressionUUID->"1fd6af80-3155-4fd5-89ca-50c82dd71c75"]
}, Closed]],

Cell[CellGroupData[{

Cell["NetTrainingData", "Subsubsection",
 CellChangeTimes->{{3.821205583146435*^9, 3.821205587188088*^9}, 
   3.822253888623785*^9},ExpressionUUID->"d891cf13-b78d-421e-afb7-\
612da0332b22"],

Cell["\<\
Generate a list of input\[Rule]output pairs that can be used to train the \
neural network. Experiments suggest that 1000-2500 playouts per iteration \
should suffice. Output: list of rules.\
\>", "Text",
 CellChangeTimes->{{3.8212853386320066`*^9, 3.821285382401731*^9}, {
  3.821388763702455*^9, 
  3.8213888244271917`*^9}},ExpressionUUID->"73286031-2b67-42ef-ac12-\
abd5f8c898bf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NetTrainingData", "[", 
   RowBox[{"runs_", ",", "depth_", ",", "playouts_"}], "]"}], ":=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    InterpretationBox[
     TagBox[
      DynamicModuleBox[{Typeset`open = False}, 
       FrameBox[
        PaneSelectorBox[{False->GridBox[{
           {
            PaneBox[GridBox[{
               {
                StyleBox[
                 StyleBox[
                  AdjustmentBox["\<\"[\[FilledSmallSquare]]\"\>",
                   BoxBaselineShift->-0.25,
                   BoxMargins->{{0, 0}, {-1, -1}}], "ResourceFunctionIcon",
                  
                  FontColor->RGBColor[
                   0.8745098039215686, 0.2784313725490196, 
                    0.03137254901960784]],
                 ShowStringCharacters->False,
                 FontFamily->"Source Sans Pro Black",
                 FontSize->0.6538461538461539 Inherited,
                 FontWeight->"Heavy",
                 PrivateFontOptions->{"OperatorSubstitution"->False}], 
                StyleBox[
                 RowBox[{
                  StyleBox["DynamicMap", "ResourceFunctionLabel"], " "}],
                 ShowAutoStyles->False,
                 ShowStringCharacters->False,
                 FontSize->Rational[12, 13] Inherited,
                 FontColor->GrayLevel[0.1]]}
              },
              GridBoxSpacings->{"Columns" -> {{0.25}}}],
             Alignment->Left,
             BaseStyle->{LineSpacing -> {0, 0}, LineBreakWithin -> False},
             BaselinePosition->Baseline,
             FrameMargins->{{3, 0}, {0, 0}}], 
            ItemBox[
             PaneBox[
              TogglerBox[Dynamic[Typeset`open], {True->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "IconizeCloser"],
                ImageSizeCache->{14., {2., 12.}}], False->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "IconizeOpener"],
                ImageSizeCache->{14., {2., 12.}}]},
               Appearance->None,
               BaselinePosition->Baseline,
               ContentPadding->False,
               FrameMargins->0],
              Alignment->Left,
              BaselinePosition->Baseline,
              FrameMargins->{{1, 1}, {0, 0}}],
             Frame->{{
                RGBColor[
                0.8313725490196079, 0.8470588235294118, 0.8509803921568627, 
                 0.5], False}, {False, False}}]}
          },
          BaselinePosition->{1, 1},
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {{0}}, "Rows" -> {{0}}}], True->
         GridBox[{
           {GridBox[{
              {
               PaneBox[GridBox[{
                  {
                   StyleBox[
                    StyleBox[
                    AdjustmentBox["\<\"[\[FilledSmallSquare]]\"\>",
                    BoxBaselineShift->-0.25,
                    BoxMargins->{{0, 0}, {-1, -1}}], "ResourceFunctionIcon",
                    
                    FontColor->RGBColor[
                    0.8745098039215686, 0.2784313725490196, 
                    0.03137254901960784]],
                    ShowStringCharacters->False,
                    FontFamily->"Source Sans Pro Black",
                    FontSize->0.6538461538461539 Inherited,
                    FontWeight->"Heavy",
                    PrivateFontOptions->{"OperatorSubstitution"->False}], 
                   StyleBox[
                    RowBox[{
                    StyleBox["DynamicMap", "ResourceFunctionLabel"], " "}],
                    ShowAutoStyles->False,
                    ShowStringCharacters->False,
                    FontSize->Rational[12, 13] Inherited,
                    FontColor->GrayLevel[0.1]]}
                 },
                 GridBoxSpacings->{"Columns" -> {{0.25}}}],
                Alignment->Left,
                BaseStyle->{LineSpacing -> {0, 0}, LineBreakWithin -> False},
                BaselinePosition->Baseline,
                FrameMargins->{{3, 0}, {0, 0}}], 
               ItemBox[
                PaneBox[
                 TogglerBox[Dynamic[Typeset`open], {True->
                  
                  DynamicBox[FEPrivate`FrontEndResource[
                   "FEBitmaps", "IconizeCloser"],
                   ImageSizeCache->{14., {2., 12.}}], False->
                  
                  DynamicBox[FEPrivate`FrontEndResource[
                   "FEBitmaps", "IconizeOpener"],
                   ImageSizeCache->{14., {2., 12.}}]},
                  Appearance->None,
                  BaselinePosition->Baseline,
                  ContentPadding->False,
                  FrameMargins->0],
                 Alignment->Left,
                 BaselinePosition->Baseline,
                 FrameMargins->{{1, 1}, {0, 0}}],
                Frame->{{
                   RGBColor[
                   0.8313725490196079, 0.8470588235294118, 0.8509803921568627,
                     0.5], False}, {False, False}}]}
             },
             BaselinePosition->{1, 1},
             GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
             GridBoxSpacings->{"Columns" -> {{0}}, "Rows" -> {{0}}}]},
           {
            StyleBox[
             PaneBox[GridBox[{
                {
                 RowBox[{
                  TagBox["\<\"Version (latest): \"\>",
                   "IconizedLabel"], " ", 
                  TagBox["\<\"4.0.0\"\>",
                   "IconizedItem"]}]},
                {
                 TagBox[
                  
                  TemplateBox[{
                   "\"Documentation \[RightGuillemet]\"", 
                    "https://resources.wolframcloud.com/FunctionRepository/\
resources/DynamicMap"},
                   "HyperlinkURL"],
                  "IconizedItem"]}
               },
               DefaultBaseStyle->"Column",
               GridBoxAlignment->{"Columns" -> {{Left}}},
               
               GridBoxItemSize->{
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
              Alignment->Left,
              BaselinePosition->Baseline,
              FrameMargins->{{5, 4}, {0, 4}}], "DialogStyle",
             FontFamily->"Roboto",
             FontSize->11]}
          },
          BaselinePosition->{1, 1},
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          GridBoxDividers->{"Columns" -> {{None}}, "Rows" -> {False, {
               GrayLevel[0.8]}, False}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}]}, Dynamic[
         Typeset`open],
         BaselinePosition->Baseline,
         ImageSize->Automatic],
        Background->RGBColor[
         0.9686274509803922, 0.9764705882352941, 0.984313725490196],
        BaselinePosition->Baseline,
        DefaultBaseStyle->{},
        FrameMargins->{{0, 0}, {1, 0}},
        FrameStyle->RGBColor[
         0.8313725490196079, 0.8470588235294118, 0.8509803921568627],
        RoundingRadius->4]],
      {"FunctionResourceBox", 
       RGBColor[0.8745098039215686, 0.2784313725490196, 0.03137254901960784], 
       "DynamicMap"},
      TagBoxNote->"FunctionResourceBox"],
     ResourceFunction[
      ResourceObject[
       Association[
       "Name" -> "DynamicMap", "ShortName" -> "DynamicMap", "UUID" -> 
        "962b5001-b624-4bc4-9b1e-401e550f4f2b", "ResourceType" -> "Function", 
        "Version" -> "4.0.0", "Description" -> 
        "Map functions over lists while showing dynamic progress", 
        "RepositoryLocation" -> 
        URL["https://www.wolframcloud.com/objects/resourcesystem/api/1.0"], 
        "SymbolName" -> 
        "FunctionRepository`$f51668a7ac6041a9b46390842a7243d8`DynamicMap", 
        "FunctionLocation" -> 
        CloudObject[
         "https://www.wolframcloud.com/obj/9d55b90e-e3c6-4d27-bdcf-\
8c3ebb4fe19a"]], ResourceSystemBase -> Automatic]],
     Selectable->False], "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"s", ",", "TT", ",", "policies"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Alpha]", "=", 
          RowBox[{"RandomReal", "[", 
           RowBox[{"{", 
            RowBox[{"2", ",", "3"}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"s", "=", 
          RowBox[{"RandomS", "[", "5", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"TT", "=", 
          RowBox[{"RandomTernaryT", "[", 
           RowBox[{"5", ",", 
            RowBox[{"RandomInteger", "[", 
             RowBox[{"{", 
              RowBox[{"0", ",", "8"}], "}"}], "]"}], ",", ".2"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"policies", "=", 
          RowBox[{"MonteCarloGeneratePolicies", "[", 
           RowBox[{"s", ",", "TT", ",", " ", "depth", ",", "playouts"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"MapIndexed", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"NetReorderEncode", "[", 
              RowBox[{"s", ",", "TT", ",", 
               RowBox[{"First", "[", "#2", "]"}]}], "]"}], "\[Rule]", "#"}], 
            "&"}], ",", "policies"}], "]"}]}]}], "\[IndentingNewLine]", "]"}],
       "&"}], ",", 
     RowBox[{"Range", "[", "runs", "]"}]}], "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8222537407164717`*^9, 3.822253753109811*^9}, {
   3.822253795006516*^9, 3.822253862013548*^9}, {3.822253911496931*^9, 
   3.82225391881892*^9}, {3.82232811822477*^9, 3.8223281308904867`*^9}, {
   3.8223294607737923`*^9, 3.822329461827602*^9}, {3.822329609798209*^9, 
   3.822329649841955*^9}, 3.82233878211408*^9},
 CellLabel->
  "In[147]:=",ExpressionUUID->"28ebbbcd-9642-4a69-bcce-4673b5e46714"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"NetTrainingData", "[", 
    RowBox[{"10", ",", "3", ",", "10"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"RandomChoice", "[", "data", "]"}]}], "Input",
 CellChangeTimes->{{3.821380146929057*^9, 3.821380158048254*^9}, 
   3.821382404413759*^9, {3.8213851909656973`*^9, 3.8213852217248487`*^9}, {
   3.8213852591106977`*^9, 3.821385309454344*^9}, {3.822254430043256*^9, 
   3.822254437596808*^9}, {3.822328180529868*^9, 3.822328181329615*^9}, 
   3.82232874553861*^9, {3.822329113477899*^9, 3.8223291199589376`*^9}, {
   3.8223292095846453`*^9, 3.822329211322238*^9}, {3.822329677513802*^9, 
   3.82232968781566*^9}, {3.822339140803215*^9, 3.822339144703964*^9}, 
   3.822339182294142*^9, {3.822339362345343*^9, 3.822339362804523*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[301]:=",ExpressionUUID->"f9a640a5-94bc-4dff-af4c-8f211f08daac"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Extensions", "Section",
 CellChangeTimes->{{3.822498192021235*^9, 
  3.822498202815332*^9}},ExpressionUUID->"3cf65aaf-64e8-4a93-b75e-\
1013cf8fb93a"],

Cell[CellGroupData[{

Cell["Institutional Constraints", "Subsection",
 CellChangeTimes->{{3.8224903194656553`*^9, 3.822490323121049*^9}, {
  3.822490915462049*^9, 
  3.8224909220990562`*^9}},ExpressionUUID->"aa775d16-e53a-40a2-9907-\
bd326a5d37f0"],

Cell[CellGroupData[{

Cell["Background", "Subsubsection",
 CellChangeTimes->{{3.822491056061665*^9, 
  3.822491057465159*^9}},ExpressionUUID->"a0105012-d790-4998-9809-\
50751ce2fa29"],

Cell[TextData[{
 "The functions in this section allow you to assert the existence of certain \
relationship patterns or ",
 StyleBox["institutional constraints",
  FontSlant->"Italic"],
 ". These can take the form of either fixed relationships (such as a group of \
agents that all cooperate with each other) or defensive alliances (where an \
attack on one member triggers a counterattack by all). After a move matrix M \
is generated by MCTS/",
 StyleBox["PrinceNet", "Input"],
 ", these predefined constraints are applied to it, effectively hard-coding \
certain behaviors into a simulation."
}], "Text",
 CellChangeTimes->{{3.822490966520584*^9, 3.822491007131488*^9}, {
  3.82249109092056*^9, 3.822491091189*^9}, {3.822492089175538*^9, 
  3.8224920894557533`*^9}, {3.822496012154467*^9, 3.822496112135453*^9}, {
  3.8224961523618937`*^9, 3.822496207918728*^9}, {3.8224962524555273`*^9, 
  3.822496292292493*^9}, {3.822496782205958*^9, 
  3.822496839914584*^9}},ExpressionUUID->"afd22ac9-c4fa-401d-85db-\
cd2f6d653917"]
}, Closed]],

Cell[CellGroupData[{

Cell["ApplyConstraints", "Subsubsection",
 CellChangeTimes->{{3.8224903338851748`*^9, 
  3.822490336831012*^9}},ExpressionUUID->"d1fc2745-f10d-4268-98a7-\
b0ad95909326"],

Cell[TextData[{
 "Defines constraints that are to be applied to a move matrix M. By default, \
this function doesn\[CloseCurlyQuote]t apply any constraints. Constraints \
should not be applied when training ",
 StyleBox["PrinceNet", "Input"],
 ". Otherwise, it can be used as a wrapper around ",
 StyleBox["NetDecodeBestM", "Input"],
 ". Output: move matrix."
}], "Text",
 CellChangeTimes->{{3.822490350784074*^9, 3.822490368105002*^9}, {
  3.822491403727953*^9, 3.8224914128129787`*^9}, {3.82249259783004*^9, 
  3.8224926005345993`*^9}, {3.822492636231102*^9, 3.82249266655934*^9}, {
  3.8224983094583263`*^9, 
  3.822498318080388*^9}},ExpressionUUID->"727b2616-b7a5-400d-ae81-\
2adc65b34ce1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ApplyConstraints", "[", "M_", "]"}], ":=", " ", "M"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.822490338462227*^9, 3.822490344933693*^9}, {
  3.822490376577319*^9, 3.822490396660317*^9}, {3.822490609488727*^9, 
  3.822490639782798*^9}},
 CellLabel->
  "In[185]:=",ExpressionUUID->"79fffc9a-dda9-46fe-8d40-28aea1919b2e"],

Cell["An example of how to define constraints:", "Text",
 CellChangeTimes->{{3.822491419809183*^9, 
  3.8224914275345583`*^9}},ExpressionUUID->"65ddafd7-b025-4e48-9dbd-\
6256c191c259"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ApplyConstraints", "[", "M_", "]"}], ":=", " ", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"R", "=", "M"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"R", "=", 
      RowBox[{"ConstraintFixed", "[", 
       RowBox[{"R", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}], ",", 
        RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"R", "=", 
      RowBox[{"ConstraintHub", "[", 
       RowBox[{"R", ",", "3", ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", "5"}], "}"}], ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"R", "=", 
      RowBox[{"ConstraintAllianceD", "[", 
       RowBox[{"M", ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "4", ",", "5"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"N", "[", "R", "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.822490338462227*^9, 3.822490344933693*^9}, {
  3.822490376577319*^9, 3.822490396660317*^9}, {3.822490594432433*^9, 
  3.8224905980735807`*^9}, {3.822490877320903*^9, 3.822490890217269*^9}, {
  3.822491178908976*^9, 3.822491180827221*^9}, {3.8224918156928253`*^9, 
  3.8224918392945147`*^9}, {3.82249312566053*^9, 3.8224931433047447`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"2ff5f6a4-d8d5-486c-9a78-1bc7885e8f59"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{"ZeroMatrix", "[", "5", "]"}]}], ";", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"M", "//", "Pretty"}], ",", 
    RowBox[{
     RowBox[{"ApplyConstraints", "[", "M", "]"}], "//", "Pretty"}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{
  3.822490635888187*^9, {3.8224906661135178`*^9, 3.8224906680637817`*^9}, {
   3.822491067399501*^9, 3.8224910753100348`*^9}, {3.822491876860496*^9, 
   3.82249187825679*^9}, 3.822495986877903*^9},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[259]:=",ExpressionUUID->"0bd133a3-3dda-401b-bc3b-265a53e47fc5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", 
        RowBox[{"-", "1"}], "0", "0", "0"},
       {
        RowBox[{"-", "1"}], "0", "0", "0", "0"},
       {"0", "0", "0", "1", "1"},
       {"0", "0", "1", "0", "0"},
       {"0", "0", "1", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "}"}]], "Output",
 CellChangeTimes->{{3.8224906231876373`*^9, 3.8224906684475813`*^9}, 
   3.822490896550433*^9, 3.822491075674061*^9, 3.82249118576429*^9, {
   3.8224918598623867`*^9, 3.822491887556046*^9}, 3.822495998398582*^9},
 CellLabel->
  "Out[259]=",ExpressionUUID->"88f6ad3d-0a52-4823-8ba2-f069b7eb8f47"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["ConstraintFixed", "Subsubsection",
 CellChangeTimes->{{3.822490422697213*^9, 
  3.8224904359696083`*^9}},ExpressionUUID->"ff982f35-8d53-43ae-804b-\
1f69512691a7"],

Cell[TextData[{
 "Define fixed relationships with a value of either ",
 StyleBox["{-1,0,1}", "Input"],
 " among a group of agents. This function can be used to establish a \
bilateral or multilateral alliance, a neutrality pact, or an assumed \
conflict. Output: ternary tactic matrix."
}], "Text",
 CellChangeTimes->{{3.822491115509631*^9, 3.822491152449215*^9}, {
  3.822491273716413*^9, 3.822491286403224*^9}, {3.8224921157707253`*^9, 
  3.822492143883246*^9}},ExpressionUUID->"e68e9754-2563-4f63-9bae-\
0ad23ba0ecf5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConstraintFixed", "[", 
   RowBox[{"M_", ",", "agents_List", ",", "val_Integer"}], "]"}], ":=", 
  RowBox[{"ReplacePart", "[", 
   RowBox[{"M", ",", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "\[Rule]", "val"}], "&"}], ",", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{"Tuples", "[", 
         RowBox[{"agents", ",", "2"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i_", ",", "i_"}], "}"}]}], "]"}]}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8224904874313803`*^9, 3.822490513499398*^9}},
 CellLabel->
  "In[190]:=",ExpressionUUID->"617685f5-7605-46c0-81a0-efa22d5cf30e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ConstraintFixed", "[", 
   RowBox[{
    RowBox[{"ZeroMatrix", "[", "4", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}], ",", 
    RowBox[{"-", "1"}]}], "]"}], "//", "Pretty"}]], "Input",
 CellChangeTimes->{{3.8224907180316772`*^9, 3.822490786428104*^9}, {
  3.822491787504057*^9, 3.822491787636579*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[215]:=",ExpressionUUID->"e58cfe68-cee0-45b9-bb57-bd3f5cdf797d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      RowBox[{"-", "1"}], "0", "0"},
     {
      RowBox[{"-", "1"}], "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8224907348654203`*^9, 3.822490786832427*^9}, 
   3.822491788188258*^9},
 CellLabel->
  "Out[215]//MatrixForm=",ExpressionUUID->"d41bb5a4-0361-4087-a371-\
b6fd8b6788b8"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["ConstraintHub", "Subsubsection",
 CellChangeTimes->{{3.822490442688594*^9, 
  3.822490445416959*^9}},ExpressionUUID->"384ecfbd-b5aa-4733-b041-\
423f59e2f903"],

Cell["\<\
Define a hub-and-spoke relationship structure among a group of agents. This \
constraint can be used to define a fixed hierarchy or a fixed attack on a \
central agent. Output: ternary tactic matrix.\
\>", "Text",
 CellChangeTimes->{{3.822491115509631*^9, 3.822491152449215*^9}, {
  3.8224911984533243`*^9, 3.822491205866857*^9}, {3.822491739016078*^9, 
  3.822491766262249*^9}},ExpressionUUID->"35055ffb-d8d4-4a6a-9908-\
f51dc6b06d62"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConstraintHub", "[", 
   RowBox[{"M_", ",", "hub_Integer", ",", "spokes_List", ",", "val_Integer"}],
    "]"}], ":=", 
  RowBox[{"ReplacePart", "[", 
   RowBox[{"M", ",", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"hub", ",", "#"}], "}"}], "\[Rule]", "val"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#", ",", "hub"}], "}"}], "\[Rule]", "val"}]}], "}"}], 
        "&"}], ",", "spokes"}], "]"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8224904874313803`*^9, 3.822490513499398*^9}, {
  3.822491214367629*^9, 3.822491238463022*^9}, {3.822491476625705*^9, 
  3.82249153961075*^9}, {3.822491580096949*^9, 3.822491622144684*^9}, {
  3.822491658735955*^9, 3.822491685251527*^9}},
 CellLabel->
  "In[209]:=",ExpressionUUID->"96e92e9c-8d35-4599-bab7-1fbaba399d30"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ConstraintHub", "[", 
   RowBox[{
    RowBox[{"ZeroMatrix", "[", "4", "]"}], ",", "2", ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "3", ",", "4"}], "}"}], ",", "1"}], "]"}], "//", 
  "Pretty"}]], "Input",
 CellChangeTimes->{{3.822491638238065*^9, 3.822491653659925*^9}, {
  3.8224916885129642`*^9, 3.822491719372509*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[214]:=",ExpressionUUID->"bfa2ca4b-2aae-4ee9-9894-bdb7c6aced6f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0"},
     {"1", "0", "1", "1"},
     {"0", "1", "0", "0"},
     {"0", "1", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.822491654566998*^9, 3.822491719780209*^9}},
 CellLabel->
  "Out[214]//MatrixForm=",ExpressionUUID->"65e1638c-1e0f-4f35-8a60-\
7bc3322c24cc"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["ConstraintAllianceD", "Subsubsection",
 CellChangeTimes->{{3.822490447140414*^9, 
  3.8224904562236433`*^9}},ExpressionUUID->"7ab02aba-1472-4c7f-8c10-\
9d4fde782876"],

Cell["\<\
Define a defensive alliance among a group of agents. If any one of them is \
attacked, all of them will counterattack. Note that this occurs even if the \
attacker is a member of the alliance. The alliance can be either bilateral or \
multilateral. Output: ternary tactic matrix.\
\>", "Text",
 CellChangeTimes->{{3.822428614175519*^9, 3.822428643477466*^9}, {
   3.822492164412431*^9, 3.8224921836357117`*^9}, 3.8224947909128113`*^9, {
   3.822495785164589*^9, 
   3.82249581223564*^9}},ExpressionUUID->"76135476-a6c8-4ffc-8002-\
9b726039fe7c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConstraintAllianceD", "[", 
   RowBox[{"M_", ",", "agents_List"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "attackers", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"attackers", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "&"}], ",", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"M", ",", 
            RowBox[{"-", "1"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"agents", ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}]}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Fold", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ConstraintHub", "[", 
         RowBox[{"#1", ",", "#2", ",", "agents", ",", 
          RowBox[{"-", "1"}]}], "]"}], "&"}], ",", "M", ",", "attackers"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.822427471791822*^9, 3.8224274789707937`*^9}, {
   3.8224275864923286`*^9, 3.8224275877824163`*^9}, {3.822427636362214*^9, 
   3.822427651073682*^9}, {3.822427713001129*^9, 3.8224277998868504`*^9}, {
   3.8224282701504717`*^9, 3.822428292700323*^9}, {3.8224285937141323`*^9, 
   3.822428597976602*^9}, 3.822491942571937*^9, {3.8224919751156187`*^9, 
   3.822491977684578*^9}, {3.822494209704155*^9, 3.8224942580715723`*^9}},
 CellLabel->
  "In[254]:=",ExpressionUUID->"69511289-74ef-4a4f-9090-3900555292d8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ConstraintAllianceD", "[", 
   RowBox[{
    RowBox[{"(", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", 
        RowBox[{"-", "1"}], "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], ")"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "3"}], "}"}]}], "]"}], " ", "//", " ", 
  "Pretty"}]], "Input",
 CellChangeTimes->{{3.8224958327574797`*^9, 3.822495894904138*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[258]:=",ExpressionUUID->"109a931f-2a95-4764-ab89-d4bd3c04b262"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      RowBox[{"-", "1"}], "0", "0"},
     {
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], "0"},
     {"0", 
      RowBox[{"-", "1"}], "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.822495866749836*^9, 3.822495895495593*^9}},
 CellLabel->
  "Out[258]//MatrixForm=",ExpressionUUID->"3e4740f3-04b0-4bed-8cd8-\
2fc82a65ef3a"]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Visualization", "Section",
 CellChangeTimes->{{3.754825938717525*^9, 
  3.754825940384823*^9}},ExpressionUUID->"829e4991-385b-429e-b662-\
a7f0da1ad933"],

Cell[CellGroupData[{

Cell["Display a Power Structure", "Subsection",
 CellChangeTimes->{{3.7548291464*^9, 3.7548291635461893`*^9}, {
  3.754829199429248*^9, 3.7548292006753683`*^9}, {3.754934995987999*^9, 
  3.7549349987619143`*^9}, {3.754941770388583*^9, 3.754941771484968*^9}, {
  3.754945659851624*^9, 
  3.754945660850668*^9}},ExpressionUUID->"7f2ae6de-2ee4-4d78-8d60-\
791c88b355b5"],

Cell[CellGroupData[{

Cell["ShowPowerStructure", "Subsubsection",
 CellChangeTimes->{
  3.800702602604507*^9, 3.8011233051772327`*^9, {3.801123434348948*^9, 
   3.801123436344762*^9}},ExpressionUUID->"1f9d3445-7e55-4cad-9096-\
1c35022ccd70"],

Cell[TextData[{
 "Displays a power structure as a graph. Nodes represent agents, with larger \
nodes indicating those with more power. Solid edges indicate the transfer of \
constructive power; dashed edges indicate destructive power. This function \
has the following options:\n  -- ",
 StyleBox["focal", "Input"],
 " (list, default={}) -- Highlights the focal agent(s) in red\n  -- ",
 StyleBox["ternary", "Input"],
 " (Boolean, default=True) -- Displays tactics in ternary form (symmetrized), \
with edges merged\n  -- ",
 StyleBox["labels", "Input"],
 " (Boolean, default=False) -- Shows agent index numbers\n  -- ",
 StyleBox["names", "Input"],
 " (list of rules, default=none) -- Specific names for agents\n  -- ",
 StyleBox["size", "Input"],
 " (pair of reals, WL default) -- Graph size\n  -- ",
 StyleBox["circular", "Input"],
 " (Boolean, default=False) -- Displays agents clockwise in a circle, with \
agent #1 placed in the 9 o\[CloseCurlyQuote]clock position\n  -- ",
 StyleBox["placement", "Input"],
 " (list of coordinate pairs, default=non) -- Specific locations for each \
agent\n  -- ",
 StyleBox["color", "Input"],
 " (pair of reals, default={0,.25}) -- Skews the PrinceRank color spectrum; \
for triads {.1, .3} is a better setting.\nOutput: Graph."
}], "Text",
 CellChangeTimes->{{3.7549420981459713`*^9, 3.754942172755986*^9}, {
   3.754944761195858*^9, 3.754944766541424*^9}, {3.754944867556746*^9, 
   3.75494488534385*^9}, {3.754944985816012*^9, 3.754945103411489*^9}, {
   3.754945162818572*^9, 3.7549452503495092`*^9}, {3.754945291693029*^9, 
   3.754945325098445*^9}, {3.7549454529420967`*^9, 3.754945499095193*^9}, {
   3.755800683408217*^9, 3.7558006981717167`*^9}, {3.7562259382756357`*^9, 
   3.756225938993236*^9}, 3.803896771701736*^9, 3.80389691185165*^9, {
   3.8038969422511187`*^9, 3.803896948517592*^9}, {3.803937635942862*^9, 
   3.8039377117408543`*^9}, {3.803937741984027*^9, 3.803937834085634*^9}, {
   3.803937878680517*^9, 3.803937886135614*^9}, {3.8039379894273443`*^9, 
   3.80393800714678*^9}, {3.811279044316998*^9, 3.8112791010132732`*^9}, {
   3.811279528455887*^9, 3.811279561808382*^9}, {3.811280607647223*^9, 
   3.8112806202171583`*^9}, {3.821786617300353*^9, 3.821786646430686*^9}, {
   3.8220534185871696`*^9, 
   3.822053469998073*^9}},ExpressionUUID->"f0037c55-934e-4672-b5cd-\
d9ed16098b49"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ShowPowerStructure", "[", "ps_Association", "]"}], ":=", 
  RowBox[{"ShowPowerStructure", "[", 
   RowBox[{"ps", ",", " ", 
    RowBox[{"<|", "|>"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7440484364962597`*^9, 3.7440484764780073`*^9}, {
   3.7510636733617067`*^9, 3.751063682043768*^9}, {3.754940777197976*^9, 
   3.754940778772295*^9}, {3.755042783592684*^9, 3.7550427888730583`*^9}, {
   3.766759815069559*^9, 3.7667598188245707`*^9}, {3.770417792562031*^9, 
   3.770417798145323*^9}, {3.80116618378911*^9, 3.801166186732689*^9}, {
   3.801239260369665*^9, 3.801239262294012*^9}, 3.803937487765477*^9},
 CellLabel->
  "In[148]:=",ExpressionUUID->"08273472-420f-47a2-8c86-34b266f74104"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ShowPowerStructure", "[", 
   RowBox[{"ps_Association", ",", "options_Association"}], "]"}], ":=", " ", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"theT", ",", 
      RowBox[{"s", "=", 
       RowBox[{"ps", "[", "\"\<s\>\"", "]"}]}], ",", 
      RowBox[{"T", "=", 
       RowBox[{"ps", "[", "\"\<T\>\"", "]"}]}], ",", 
      RowBox[{"m", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"ps", "[", "\"\<s\>\"", "]"}], "]"}]}], ",", "showAsTernary", 
      ",", "edges", ",", "properEdges", ",", "vCoord", ",", "vLabel", ",", 
      "vSize", ",", "vStyle", ",", "g", ",", "size"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"theT", "=", 
      RowBox[{"Sign", "[", 
       RowBox[{"SymmetrizeT", "[", 
        RowBox[{"ToTernary", "[", "T", "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"size", "=", 
      RowBox[{"Lookup", "[", 
       RowBox[{"options", ",", "\"\<size\>\"", ",", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"m", "\[Equal]", "2"}], ",", 
          RowBox[{"m", "*", "15"}], ",", 
          RowBox[{"m", "\[LessEqual]", "4"}], ",", 
          RowBox[{"m", "*", "12"}], ",", "True", ",", 
          RowBox[{"m", "*", "10"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"T", "=", 
      RowBox[{"ZeroDiagonalize", "[", 
       RowBox[{"ps", "[", "\"\<T\>\"", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"showAsTernary", "=", 
      RowBox[{"Lookup", "[", 
       RowBox[{"options", ",", "\"\<ternary\>\"", ",", "True"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"T", "=", 
      RowBox[{"If", "[", 
       RowBox[{"showAsTernary", ",", 
        RowBox[{"ToTernary", "[", "T", "]"}], ",", "T"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"edges", " ", "=", " ", 
      RowBox[{"EdgeList", "[", 
       RowBox[{"WeightedAdjacencyGraph", "[", 
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", "T", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"0", "\[Rule]", " ", "Infinity"}], ",", 
            RowBox[{"0.", "\[Rule]", " ", "Infinity"}]}], "}"}], ",", "2"}], 
         "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"properEdges", " ", "=", " ", 
      RowBox[{"replaceDirectedEdges", "[", 
       RowBox[{"edges", ",", 
        RowBox[{"undirectedEdges", "[", "T", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"vCoord", " ", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Lookup", "[", 
         RowBox[{"options", ",", "\"\<circular\>\"", ",", "False"}], "]"}], 
        ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"a", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"Pi", " ", "-", " ", 
               RowBox[{"(", 
                RowBox[{"2", "Pi", " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"a", "-", "1"}], ")"}], " ", "/", " ", "m"}]}], 
                ")"}]}], "]"}], ",", 
             RowBox[{"Sin", "[", 
              RowBox[{"Pi", " ", "-", " ", 
               RowBox[{"(", 
                RowBox[{"2", "Pi", " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"a", "-", "1"}], ")"}], " ", "/", " ", "m"}]}], 
                ")"}]}], "]"}]}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "1", ",", "m"}], "}"}]}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Lookup", "[", 
            RowBox[{"options", ",", "\"\<placement\>\"", ",", 
             RowBox[{"{", "}"}]}], "]"}], "!=", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"Lookup", "[", 
           RowBox[{"options", ",", "\"\<placement\>\""}], "]"}], ",", 
          "Automatic"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vLabel", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Lookup", "[", 
         RowBox[{"options", ",", "\"\<labels\>\"", ",", "False"}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Lookup", "[", 
            RowBox[{"options", ",", "\"\<names\>\"", ",", 
             RowBox[{"{", "}"}]}], "]"}], "\[NotEqual]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"MapIndexed", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"First", "[", "#2", "]"}], "\[Rule]", "#"}], "&"}], ",", 
            RowBox[{"Lookup", "[", 
             RowBox[{"options", ",", "\"\<names\>\""}], "]"}]}], "]"}], ",", 
          "\"\<Name\>\""}], "]"}], ",", "None"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vSize", "=", 
      RowBox[{"MapIndexed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"First", "[", "#2", "]"}], "\[Rule]", " ", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Sqrt", "[", "#", "]"}], "/", "3"}], ",", ".01"}], 
           "]"}]}], "&"}], ",", "s"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"vStyle", " ", "=", 
      RowBox[{"MapIndexed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"First", "[", "#2", "]"}], "\[Rule]", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Lookup", "[", 
               RowBox[{"options", ",", "\"\<focal\>\"", ",", 
                RowBox[{"{", "}"}]}], "]"}], ",", 
              RowBox[{"First", "[", "#2", "]"}]}], "]"}], ",", 
            RowBox[{"Directive", "[", 
             RowBox[{"#", ",", 
              RowBox[{"EdgeForm", "[", 
               RowBox[{"{", 
                RowBox[{"Thick", ",", "Red"}], "}"}], "]"}]}], "]"}], ",", 
            "#"}], "]"}]}], "&"}], ",", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ColorData", "[", "\"\<BlueGreenYellow\>\"", "]"}], "[", 
            RowBox[{"Rescale", "[", 
             RowBox[{"#", ",", 
              RowBox[{"Lookup", "[", 
               RowBox[{"options", ",", "\"\<color\>\"", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", ".25"}], "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "]"}], "&"}], ",", 
          RowBox[{"PrinceRank", "[", "ps", "]"}]}], "]"}]}], "]"}]}], ";", 
     " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"g", "=", 
      RowBox[{"If", "[", 
       RowBox[{"showAsTernary", ",", "\[IndentingNewLine]", 
        RowBox[{"AdjacencyGraph", "[", 
         RowBox[{
          RowBox[{"Abs", "[", "theT", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"BaseStyle", "\[Rule]", "Black"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"EdgeStyle", "\[Rule]", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "\[UndirectedEdge]", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "\[Rule]", 
               RowBox[{"{", "Dashed", "}"}]}], "&"}], ",", 
             RowBox[{"Position", "[", 
              RowBox[{
               RowBox[{"UpperTriangularize", "[", "theT", "]"}], ",", 
               RowBox[{"-", "1"}]}], "]"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"VertexCoordinates", "\[Rule]", "vCoord"}], ",", 
          RowBox[{"VertexLabels", "\[Rule]", "vLabel"}], ",", 
          RowBox[{"VertexSize", " ", "\[Rule]", " ", "vSize"}], ",", 
          RowBox[{"VertexStyle", "\[Rule]", " ", "vStyle"}], ",", 
          RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Quality\>\""}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Graph", "[", 
         RowBox[{"properEdges", ",", "\[IndentingNewLine]", 
          RowBox[{"EdgeStyle", "\[Rule]", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", " ", "\[Rule]", " ", 
               RowBox[{"edgeStyleFunction", "[", 
                RowBox[{
                 RowBox[{"T", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
                 RowBox[{"s", "[", 
                  RowBox[{"[", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
                 "showAsTernary"}], "]"}]}], "&"}], ",", "properEdges"}], 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"VertexCoordinates", "\[Rule]", "vCoord"}], ",", 
          RowBox[{"VertexLabels", "\[Rule]", "vLabel"}], ",", 
          RowBox[{"VertexSize", " ", "\[Rule]", " ", "vSize"}], ",", 
          RowBox[{"VertexStyle", "\[Rule]", " ", "vStyle"}], ",", 
          RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Quality\>\""}]}], 
         "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"Return", "[", 
      RowBox[{"Tooltip", "[", 
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"g", ",", 
          RowBox[{"ImageSize", "\[Rule]", "size"}]}], "]"}], ",", 
        RowBox[{"Pretty", "[", "ps", "]"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"Show", "[", 
       RowBox[{"g", ",", 
        RowBox[{"ImageSize", "\[Rule]", "size"}]}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.796852042270659*^9, 3.7968520445400887`*^9}, {
   3.796852143773417*^9, 3.7968521454870367`*^9}, {3.796852463201281*^9, 
   3.796852485181507*^9}, {3.7968525479756403`*^9, 3.7968525622327547`*^9}, {
   3.7968644482778482`*^9, 3.796864527661289*^9}, {3.7968645798068333`*^9, 
   3.796864584158977*^9}, {3.796864669103356*^9, 3.796864695448263*^9}, {
   3.796864778322927*^9, 3.796864906187169*^9}, {3.796865269117258*^9, 
   3.7968653532170687`*^9}, {3.796906542075687*^9, 3.7969065591060667`*^9}, {
   3.796906624117817*^9, 3.7969066301917953`*^9}, {3.796906667376197*^9, 
   3.796906667568365*^9}, {3.796906705747436*^9, 3.796906718768433*^9}, {
   3.796907000789274*^9, 3.796907038587927*^9}, {3.796907104964447*^9, 
   3.796907110030671*^9}, {3.796907155108832*^9, 3.7969071553882637`*^9}, {
   3.797373369030848*^9, 3.797373374480433*^9}, {3.79737340650381*^9, 
   3.797373413190652*^9}, {3.7973734508187*^9, 3.7973734693373547`*^9}, {
   3.797373559910263*^9, 3.797373560077615*^9}, {3.797376148295977*^9, 
   3.797376164457925*^9}, {3.7976288188355207`*^9, 3.797628842289892*^9}, {
   3.7976288791957397`*^9, 3.7976288891071157`*^9}, {3.798022064007619*^9, 
   3.7980220683088703`*^9}, {3.8011648186672297`*^9, 
   3.8011648229601517`*^9}, {3.801166573732377*^9, 3.801166582653184*^9}, {
   3.803898239172698*^9, 3.8038982444507732`*^9}, {3.803898313290806*^9, 
   3.8038983134664173`*^9}, 3.8038988324554462`*^9, {3.803898909269683*^9, 
   3.8038989435244827`*^9}, {3.8038989923922253`*^9, 3.803899015141181*^9}, {
   3.8038990772357063`*^9, 3.803899077720986*^9}, 3.803899306779318*^9, {
   3.8038993801414957`*^9, 3.803899405368935*^9}, {3.8038994610996532`*^9, 
   3.803899466793159*^9}, {3.803899517868985*^9, 3.803899518534854*^9}, {
   3.8038995497508383`*^9, 3.803899584361478*^9}, {3.80389980288538*^9, 
   3.8038998298674793`*^9}, 3.803900196675877*^9, {3.803900446552528*^9, 
   3.803900521633407*^9}, {3.80390881428967*^9, 3.803908820223166*^9}, 
   3.80390897738795*^9, {3.80390913021602*^9, 3.803909132134952*^9}, {
   3.803909198834306*^9, 3.8039092235692387`*^9}, 3.803909899142177*^9, {
   3.803910119854465*^9, 3.80391013278229*^9}, {3.803910187614058*^9, 
   3.803910193020915*^9}, 3.803910230593335*^9, {3.803910324629483*^9, 
   3.803910329013782*^9}, {3.8039103871313477`*^9, 3.803910517527892*^9}, {
   3.803910551966074*^9, 3.8039106437240334`*^9}, {3.803910694419981*^9, 
   3.8039107222346287`*^9}, {3.8039107692869987`*^9, 
   3.8039107846903353`*^9}, {3.8039113025939503`*^9, 3.803911303286784*^9}, {
   3.803911512683405*^9, 3.803911534847809*^9}, {3.803911791244066*^9, 
   3.803911805731386*^9}, {3.803911864467224*^9, 3.803911878860331*^9}, {
   3.803921460617975*^9, 3.803921464392806*^9}, {3.803921495037187*^9, 
   3.803921496746657*^9}, {3.803921531944728*^9, 3.803921569674911*^9}, {
   3.8039217730081463`*^9, 3.803921800567399*^9}, {3.803936475793211*^9, 
   3.803936499681902*^9}, {3.803936652862341*^9, 3.8039366719012833`*^9}, {
   3.803936722441945*^9, 3.80393672368344*^9}, {3.803936868371166*^9, 
   3.8039369199851017`*^9}, {3.803937011922758*^9, 3.80393701241385*^9}, 
   3.803937423363967*^9, {3.803988965546754*^9, 3.803988965939082*^9}, {
   3.803989060577496*^9, 3.803989090303656*^9}, {3.803989184228833*^9, 
   3.8039891843326674`*^9}, {3.803989382430478*^9, 3.8039893932971277`*^9}, 
   3.804288193840282*^9, 3.804534534298674*^9, 3.804534573623088*^9, 
   3.804534693133028*^9, {3.804630838826021*^9, 3.804630856042858*^9}, {
   3.805845584315855*^9, 3.805845585170216*^9}, {3.8058456196672983`*^9, 
   3.8058456203797626`*^9}, {3.808779126731242*^9, 3.808779129964575*^9}, {
   3.808942383864058*^9, 3.808942402239546*^9}, {3.8097281993451443`*^9, 
   3.80972819987271*^9}, {3.810127663355732*^9, 3.81012766986755*^9}, {
   3.810226099886306*^9, 3.810226201854916*^9}, 3.8108223985800867`*^9, {
   3.8108224329751472`*^9, 3.810822514669333*^9}, {3.811278380379611*^9, 
   3.811278432199954*^9}, {3.8112784630505753`*^9, 3.8112785633727922`*^9}, {
   3.811278633482284*^9, 3.811278745323349*^9}, {3.8112788393709517`*^9, 
   3.811278839796315*^9}, {3.81127888706186*^9, 3.811278914852247*^9}, {
   3.811278969823571*^9, 3.8112789782887163`*^9}, 3.811279210204846*^9, {
   3.811279335582327*^9, 3.8112793842312613`*^9}, 3.811280521808688*^9, {
   3.818685019422645*^9, 3.8186850492544107`*^9}, {3.821786840485148*^9, 
   3.8217868635530653`*^9}, 3.821786922563648*^9, {3.821787004786977*^9, 
   3.8217870456807404`*^9}, {3.821787117291025*^9, 3.821787143783712*^9}, {
   3.82205072386605*^9, 3.822050724480085*^9}, {3.822050787364078*^9, 
   3.822050805576076*^9}, 3.822051250954102*^9, {3.822052978336013*^9, 
   3.822052978603997*^9}, 3.8220530184879847`*^9, {3.822053055024109*^9, 
   3.822053066693886*^9}, {3.822053356992598*^9, 3.822053363419052*^9}},
 CellLabel->
  "In[149]:=",ExpressionUUID->"51a2e6e0-74d7-4012-8502-008ec23de29b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ps", "=", 
   RowBox[{"PowerStructure", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1.", ",", "1.", ",", "1."}], "}"}], ",", 
     RowBox[{"Symmetric3s", "[", 
      RowBox[{"[", "27", "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"SpacedRow", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ShowPowerStructure", "[", 
      RowBox[{"ps", ",", 
       RowBox[{"<|", 
        RowBox[{"\"\<focal\>\"", "\[Rule]", 
         RowBox[{"{", "2", "}"}]}], "|>"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ShowPowerStructure", "[", 
      RowBox[{
       RowBox[{"RandomTernaryPowerStructure", "[", 
        RowBox[{"7", ",", "8", ",", "0.1"}], "]"}], ",", 
       RowBox[{"<|", 
        RowBox[{"\"\<labels\>\"", "\[Rule]", "True"}], "|>"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ShowPowerStructure", "[", 
      RowBox[{
       RowBox[{"RandomTernaryPowerStructure", "[", 
        RowBox[{"7", ",", "5", ",", "0.1"}], "]"}], ",", 
       RowBox[{"<|", 
        RowBox[{"\"\<circular\>\"", "\[Rule]", "True"}], "|>"}]}], "]"}], ",", 
     RowBox[{"ShowPowerStructure", "[", 
      RowBox[{
       RowBox[{"RandomTernaryPowerStructure", "[", 
        RowBox[{"10", ",", "10", ",", "0.1"}], "]"}], ",", 
       RowBox[{"<|", 
        RowBox[{"\"\<focal\>\"", "\[Rule]", "2"}], "|>"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ShowPowerStructure", "[", 
      RowBox[{
       RowBox[{"RandomTernaryPowerStructure", "[", 
        RowBox[{"7", ",", "5", ",", "0.1"}], "]"}], ",", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<ternary\>\"", "\[Rule]", "False"}], ",", 
         RowBox[{"\"\<circular\>\"", "\[Rule]", "True"}]}], "|>"}]}], "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"ShowPowerStructure", "[", 
      RowBox[{"ps", ",", 
       RowBox[{"<|", 
        RowBox[{"\"\<size\>\"", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"30", ",", "30"}], "}"}]}], "|>"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ShowPowerStructure", "[", 
      RowBox[{"RandomTernaryPowerStructure", "[", 
       RowBox[{"14", ",", "18", ",", "0.1"}], "]"}], "]"}]}], 
    "\[IndentingNewLine]", "}"}], ",", "25"}], "]"}]}], "Input",
 CellChangeTimes->{{3.803895458531843*^9, 3.803895461649844*^9}, {
   3.8038956514707813`*^9, 3.803895651535768*^9}, {3.803897023355372*^9, 
   3.8038970316972513`*^9}, {3.803897263740842*^9, 3.803897271350667*^9}, 
   3.803898853230318*^9, {3.8038989551907053`*^9, 3.803898964939913*^9}, {
   3.803899862850975*^9, 3.8038998790191593`*^9}, {3.8038999207625437`*^9, 
   3.8038999256401978`*^9}, {3.80390006468972*^9, 3.803900085497466*^9}, {
   3.80390025315974*^9, 3.803900276447383*^9}, {3.803908405658478*^9, 
   3.803908411479896*^9}, {3.803908476802395*^9, 3.803908512243181*^9}, {
   3.803908555489098*^9, 3.803908556233383*^9}, {3.803908603246807*^9, 
   3.80390860605068*^9}, 3.803908685017457*^9, {3.8039088661796293`*^9, 
   3.803908907386861*^9}, {3.803908944591701*^9, 3.803908957689588*^9}, {
   3.8039090179534197`*^9, 3.803909020977038*^9}, {3.8039092311040154`*^9, 
   3.803909245892109*^9}, {3.803909311473029*^9, 3.803909320333591*^9}, {
   3.8039094024763403`*^9, 3.8039094268265667`*^9}, {3.803909495182828*^9, 
   3.803909496109539*^9}, {3.8039095837456217`*^9, 3.8039096040777073`*^9}, 
   3.803910147803582*^9, {3.803910671109282*^9, 3.803910679149518*^9}, {
   3.803921060429912*^9, 3.8039210696482897`*^9}, 3.803921111772084*^9, {
   3.80392131360674*^9, 3.8039213138255463`*^9}, 3.803921376737117*^9, {
   3.80392170953615*^9, 3.803921725046103*^9}, {3.803921812329864*^9, 
   3.803921817789174*^9}, {3.803936393153*^9, 3.803936434622262*^9}, {
   3.803936712386747*^9, 3.8039367446818666`*^9}, {3.803936860806779*^9, 
   3.803936862075721*^9}, {3.803936959639592*^9, 3.803936983213122*^9}, {
   3.80393744745682*^9, 3.803937452642728*^9}, 3.803937922374592*^9, {
   3.811280631704834*^9, 3.811280632399867*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[2218]:=",ExpressionUUID->"8bbdc926-e44f-458c-b864-f12d4b6ac5ce"],

Cell[BoxData[
 TemplateBox[{
   TagBox[
    TooltipBox[
     GraphicsBox[
      NamespaceBox[{{
         Directive[
          Opacity[0.7], 
          Hue[0.6, 0.7, 0.5]], 
         Directive[
          GrayLevel[0]], 
         LineBox[{{
            DynamicLocation["VertexID$1", Automatic, Center], 
            DynamicLocation["VertexID$2", Automatic, Center]}, {
            DynamicLocation["VertexID$1", Automatic, Center], 
            DynamicLocation["VertexID$3", Automatic, Center]}, {
            DynamicLocation["VertexID$2", Automatic, Center], 
            DynamicLocation["VertexID$3", Automatic, Center]}}]}, {
         Directive[
          Hue[0.6, 0.2, 0.8], 
          EdgeForm[
           Directive[
            GrayLevel[0], 
            Opacity[0.7]]]], 
         Directive[
          GrayLevel[0]], 
         TagBox[
          StyleBox[
           
           DiskBox[{-0.8660254037844384, -0.4999999999999994}, 
            0.28867513459481275`], {
            RGBColor[
            0.0935001466004595, 0.21213546854430457`, 0.4822023327493515]}, 
           StripOnInput -> False], "DynamicName", BoxID -> "VertexID$1"], 
         TagBox[
          StyleBox[
           DiskBox[{1.8369701987210297`*^-16, 1.}, 0.28867513459481275`], {
            Directive[
             RGBColor[
             0.0935001466004595, 0.21213546854430457`, 0.4822023327493515], 
             EdgeForm[{
               Thickness[Large], 
               RGBColor[1, 0, 0]}]]}, StripOnInput -> False], "DynamicName", 
          BoxID -> "VertexID$2"], 
         TagBox[
          StyleBox[
           
           DiskBox[{0.8660254037844389, -0.5000000000000012}, 
            0.28867513459481275`], {
            RGBColor[
            0.0935001466004595, 0.21213546854430457`, 0.4822023327493515]}, 
           StripOnInput -> False], "DynamicName", BoxID -> "VertexID$3"]}}], {
      ImageSize -> 36, BaseStyle -> GrayLevel[0], FormatType -> 
       TraditionalForm, FrameTicks -> None}], 
     RowBox[{"\[LeftAssociation]", 
       RowBox[{
         RowBox[{"\"s\"", "\[Rule]", 
           TagBox[
            RowBox[{"(", "\[NoBreak]", 
              TagBox[
               
               GridBox[{{"1"}, {"1"}, {"1"}}, ColumnAlignments -> Center, 
                RowSpacings -> 1, ColumnAlignments -> Left], Column], 
              "\[NoBreak]", ")"}], 
            Function[BoxForm`e$, 
             MatrixForm[BoxForm`e$]]]}], ",", 
         RowBox[{"\"T\"", "\[Rule]", 
           TagBox[
            RowBox[{"(", "\[NoBreak]", 
              
              GridBox[{{"0.98`", "0.01`", "0.01`"}, {
                "0.01`", "0.98`", "0.01`"}, {"0.01`", "0.01`", "0.98`"}}, 
               RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> 
               Baseline, ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
            Function[BoxForm`e$, 
             MatrixForm[BoxForm`e$]]]}]}], "\[RightAssociation]"}]], 
    Annotation[#, 
     Association[
     "s" -> MatrixForm[{1, 1, 1}], "T" -> 
      MatrixForm[{{0.98, 0.01, 0.01}, {0.01, 0.98, 0.01}, {0.01, 0.01, 
        0.98}}]], "Tooltip"]& ], 
   TemplateBox[{25}, "Spacer1"], 
   TagBox[
    TooltipBox[
     GraphicsBox[
      NamespaceBox[{{
         Directive[
          Opacity[0.7], 
          Hue[0.6, 0.7, 0.5]], 
         Directive[
          GrayLevel[0]], 
         LineBox[{
           DynamicLocation["VertexID$1", Automatic, Center], 
           DynamicLocation["VertexID$2", Automatic, Center]}], 
         LineBox[{
           DynamicLocation["VertexID$1", Automatic, Center], 
           DynamicLocation["VertexID$3", Automatic, Center]}], 
         LineBox[{
           DynamicLocation["VertexID$1", Automatic, Center], 
           DynamicLocation["VertexID$5", Automatic, Center]}], 
         StyleBox[
          LineBox[{
            DynamicLocation["VertexID$1", Automatic, Center], 
            DynamicLocation["VertexID$7", Automatic, Center]}], {{
            Dashing[{Small, Small}]}}, StripOnInput -> False], 
         LineBox[{
           DynamicLocation["VertexID$2", Automatic, Center], 
           DynamicLocation["VertexID$4", Automatic, Center]}], 
         LineBox[{
           DynamicLocation["VertexID$3", Automatic, Center], 
           DynamicLocation["VertexID$4", Automatic, Center]}], 
         LineBox[{
           DynamicLocation["VertexID$3", Automatic, Center], 
           DynamicLocation["VertexID$7", Automatic, Center]}], 
         LineBox[{
           DynamicLocation["VertexID$4", Automatic, Center], 
           DynamicLocation["VertexID$6", Automatic, Center]}]}, {
         Directive[
          Hue[0.6, 0.2, 0.8], 
          EdgeForm[
           Directive[
            GrayLevel[0], 
            Opacity[0.7]]]], 
         Directive[
          GrayLevel[0]], 
         TagBox[{
           TagBox[
            StyleBox[
             
             DiskBox[{2.832617501246366, 0.8908662278622124}, 
              0.1180557221585253], {
              RGBColor[
              0.11261832235799696`, 0.07637160333271613, 0.4260951937663025]},
              StripOnInput -> False], "DynamicName", BoxID -> "VertexID$1"], 
           InsetBox[
            FormBox[
             StyleBox["1", {
               GrayLevel[0]}, StripOnInput -> False], TraditionalForm], 
            Offset[{2, 2}, 
             DynamicLocation["VertexID$1", Automatic, {Right, Top}]], 
            ImageScaled[{0, 0}], BaseStyle -> "Graphics"]}, "DynamicName", 
          BoxID -> "VertexLabelID$1"], 
         TagBox[{
           TagBox[
            StyleBox[
             
             DiskBox[{1.8832234271502875`, 1.3584577438512961`}, 
              0.13570168435922714`], {
              RGBColor[
              0.10792633119075067`, 0.10969083130104607`, 
               0.4398650326811967]}, StripOnInput -> False], "DynamicName", 
            BoxID -> "VertexID$2"], 
           InsetBox[
            FormBox[
             StyleBox["2", {
               GrayLevel[0]}, StripOnInput -> False], TraditionalForm], 
            Offset[{2, 2}, 
             DynamicLocation["VertexID$2", Automatic, {Right, Top}]], 
            ImageScaled[{0, 0}], BaseStyle -> "Graphics"]}, "DynamicName", 
          BoxID -> "VertexLabelID$2"], 
         TagBox[{
           TagBox[
            StyleBox[
             
             DiskBox[{2.0368362845920402`, 0.3715082083925249}, 
              0.1289403141864022], {
              RGBColor[
              0.11032610795313366`, 0.09264930113425615, 
               0.43282227870493256`]}, StripOnInput -> False], "DynamicName", 
            BoxID -> "VertexID$3"], 
           InsetBox[
            FormBox[
             StyleBox["3", {
               GrayLevel[0]}, StripOnInput -> False], TraditionalForm], 
            Offset[{2, 2}, 
             DynamicLocation["VertexID$3", Automatic, {Right, Top}]], 
            ImageScaled[{0, 0}], BaseStyle -> "Graphics"]}, "DynamicName", 
          BoxID -> "VertexLabelID$3"], 
         TagBox[{
           TagBox[
            StyleBox[
             
             DiskBox[{1.0465551778266344`, 0.8514385115278176}, 
              0.13842649827973633`], {
              RGBColor[
              0.1042581645005905, 0.13573957645395127`, 0.450630198819847]}, 
             StripOnInput -> False], "DynamicName", BoxID -> "VertexID$4"], 
           InsetBox[
            FormBox[
             StyleBox["4", {
               GrayLevel[0]}, StripOnInput -> False], TraditionalForm], 
            Offset[{2, 2}, 
             DynamicLocation["VertexID$4", Automatic, {Right, Top}]], 
            ImageScaled[{0, 0}], BaseStyle -> "Graphics"]}, "DynamicName", 
          BoxID -> "VertexLabelID$4"], 
         TagBox[{
           TagBox[
            StyleBox[
             
             DiskBox[{3.833596647720317, 1.2866894638683741`}, 
              0.13320323890010072`], {
              RGBColor[
              0.10948679447684304`, 0.09860951633002155, 0.4352854571201648]},
              StripOnInput -> False], "DynamicName", BoxID -> "VertexID$5"], 
           InsetBox[
            FormBox[
             StyleBox["5", {
               GrayLevel[0]}, StripOnInput -> False], TraditionalForm], 
            Offset[{2, 2}, 
             DynamicLocation["VertexID$5", Automatic, {Right, Top}]], 
            ImageScaled[{0, 0}], BaseStyle -> "Graphics"]}, "DynamicName", 
          BoxID -> "VertexLabelID$5"], 
         TagBox[{
           TagBox[
            StyleBox[
             DiskBox[{0., 0.8872798913208457}, 0.1453010238117476], {
              RGBColor[
              0.10385559605908229`, 0.13859833496336665`, 
               0.4518116380839455]}, StripOnInput -> False], "DynamicName", 
            BoxID -> "VertexID$6"], 
           InsetBox[
            FormBox[
             StyleBox["6", {
               GrayLevel[0]}, StripOnInput -> False], TraditionalForm], 
            Offset[{2, 2}, 
             DynamicLocation["VertexID$6", Automatic, {Right, Top}]], 
            ImageScaled[{0, 0}], BaseStyle -> "Graphics"]}, "DynamicName", 
          BoxID -> "VertexLabelID$6"], 
         TagBox[{
           TagBox[
            StyleBox[
             DiskBox[{2.8255235495099478`, 0.}, 0.07093152498393396], {
              RGBColor[
              0.1211682437152877, 0.015656063030014367`, 
               0.40100327956007803`]}, StripOnInput -> False], "DynamicName", 
            BoxID -> "VertexID$7"], 
           InsetBox[
            FormBox[
             StyleBox["7", {
               GrayLevel[0]}, StripOnInput -> False], TraditionalForm], 
            Offset[{2, 2}, 
             DynamicLocation["VertexID$7", Automatic, {Right, Top}]], 
            ImageScaled[{0, 0}], BaseStyle -> "Graphics"]}, "DynamicName", 
          BoxID -> "VertexLabelID$7"]}}], {
      ImageSize -> 70, BaseStyle -> GrayLevel[0], FormatType -> 
       TraditionalForm, FrameTicks -> None}], 
     RowBox[{"\[LeftAssociation]", 
       RowBox[{
         RowBox[{"\"s\"", "\[Rule]", 
           TagBox[
            RowBox[{"(", "\[NoBreak]", 
              TagBox[
               
               GridBox[{{"0.66`"}, {"0.872`"}, {"0.787`"}, {"0.908`"}, {
                 "0.84`"}, {"1.`"}, {"0.23800000000000002`"}}, 
                ColumnAlignments -> Center, RowSpacings -> 1, 
                ColumnAlignments -> Left], Column], "\[NoBreak]", ")"}], 
            Function[BoxForm`e$, 
             MatrixForm[BoxForm`e$]]]}], ",", 
         RowBox[{"\"T\"", "\[Rule]", 
           TagBox[
            RowBox[{"(", "\[NoBreak]", 
              GridBox[{{"0.98`", "0.01`", "0.007`", "0.`", "0.02`", "0.`", 
                 RowBox[{"-", "0.01`"}]}, {
                "0.005`", "0.98`", "0.`", "0.007`", "0.`", "0.`", "0.`"}, {
                "0.005`", "0.`", "0.98`", "0.007`", "0.`", "0.`", "0.01`"}, {
                "0.`", "0.01`", "0.007`", "0.98`", "0.`", "0.02`", "0.`"}, {
                "0.005`", "0.`", "0.`", "0.`", "0.98`", "0.`", "0.`"}, {
                "0.`", "0.`", "0.`", "0.007`", "0.`", "0.98`", "0.`"}, {
                 RowBox[{"-", "0.005`"}], "0.`", "0.007`", "0.`", "0.`", 
                 "0.`", "0.98`"}}, RowSpacings -> 1, ColumnSpacings -> 1, 
               RowAlignments -> Baseline, ColumnAlignments -> Center], 
              "\[NoBreak]", ")"}], 
            Function[BoxForm`e$, 
             MatrixForm[BoxForm`e$]]]}]}], "\[RightAssociation]"}]], 
    Annotation[#, 
     Association[
     "s" -> MatrixForm[{0.66, 0.872, 0.787, 0.908, 0.84, 1., 
        0.23800000000000002`}], "T" -> MatrixForm[CompressedData["
1:eJxTTMoPSmViYGBgh+KY/kNfNWLe21eLrHN/WNViX/lSzZBjTY09AxRAxKeg
8Vv2Q+gSe5h+mDy6fnQA0wfjw/Tj0gdzFzofph7dfuzuLcHpHnT9hAC6O7Hb
X7Ifl3pc9gMAFOFYKg==
        "]]], "Tooltip"]& ], 
   TemplateBox[{25}, "Spacer1"], 
   TagBox[
    TooltipBox[
     GraphicsBox[
      NamespaceBox[{{
         Directive[
          Opacity[0.7], 
          Hue[0.6, 0.7, 0.5]], 
         Directive[
          GrayLevel[0]], 
         StyleBox[
          LineBox[{
            DynamicLocation["VertexID$1", Automatic, Center], 
            DynamicLocation["VertexID$5", Automatic, Center]}], {{
            Dashing[{Small, Small}]}}, StripOnInput -> False], 
         LineBox[{
           DynamicLocation["VertexID$2", Automatic, Center], 
           DynamicLocation["VertexID$4", Automatic, Center]}], 
         LineBox[{
           DynamicLocation["VertexID$2", Automatic, Center], 
           DynamicLocation["VertexID$7", Automatic, Center]}], 
         LineBox[{
           DynamicLocation["VertexID$4", Automatic, Center], 
           DynamicLocation["VertexID$7", Automatic, Center]}], 
         LineBox[{
           DynamicLocation["VertexID$6", Automatic, Center], 
           DynamicLocation["VertexID$7", Automatic, Center]}]}, {
         Directive[
          Hue[0.6, 0.2, 0.8], 
          EdgeForm[
           Directive[
            GrayLevel[0], 
            Opacity[0.7]]]], 
         Directive[
          GrayLevel[0]], 
         TagBox[
          StyleBox[
           DiskBox[{-1., 0.}, 0.12530592937422275`], {
            RGBColor[
            0.1113254017275027, 0.08555301815146522, 0.42988959750174216`]}, 
           StripOnInput -> False], "DynamicName", BoxID -> "VertexID$1"], 
         TagBox[
          StyleBox[
           
           DiskBox[{-0.6234898018587335, 0.7818314824680298}, 
            0.0653919954629424], {
            RGBColor[
            0.12093062432023582`, 0.017343469188981355`, 
             0.40170063398302747`]}, StripOnInput -> False], "DynamicName", 
          BoxID -> "VertexID$2"], 
         TagBox[
          StyleBox[
           
           DiskBox[{0.2225209339563144, 0.9749279121818236}, 
            0.11149308522936496`], {
            RGBColor[
            0.1133275163328023, 0.07133540550581925, 0.42401388405270934`]}, 
           StripOnInput -> False], "DynamicName", BoxID -> "VertexID$3"], 
         TagBox[
          StyleBox[
           
           DiskBox[{0.9009688679024191, 0.4338837391175581}, 
            0.06729522918507955], {
            RGBColor[
            0.12080475387139104`, 0.018237312768400696`, 
             0.40207003276127695`]}, StripOnInput -> False], "DynamicName", 
          BoxID -> "VertexID$4"], 
         TagBox[
          StyleBox[
           DiskBox[{0.9009688679024191, -0.4338837391175581}, 
            0.13555392335009836`], {
            RGBColor[
            0.10629879487377145`, 0.12124845185897078`, 0.4446414510746049]}, 
           StripOnInput -> False], "DynamicName", BoxID -> "VertexID$5"], 
         TagBox[
          StyleBox[
           
           DiskBox[{0.2225209339563144, -0.9749279121818236}, 
            0.14462791303918604`], {
            RGBColor[
            0.09718684342324711, 0.18595513539575112`, 0.4713827852335296]}, 
           StripOnInput -> False], "DynamicName", BoxID -> "VertexID$6"], 
         TagBox[
          StyleBox[
           
           DiskBox[{-0.6234898018587335, -0.7818314824680298}, 
            0.13611071044864437`], {
            RGBColor[
            0.10008429449659095`, 0.16537947158935806`, 0.4628794796812416]}, 
           StripOnInput -> False], "DynamicName", BoxID -> "VertexID$7"]}}], {
      ImageSize -> 70, BaseStyle -> GrayLevel[0], FormatType -> 
       TraditionalForm, FrameTicks -> None}], 
     RowBox[{"\[LeftAssociation]", 
       RowBox[{
         RowBox[{"\"s\"", "\[Rule]", 
           TagBox[
            RowBox[{"(", "\[NoBreak]", 
              TagBox[
               
               GridBox[{{"0.751`"}, {"0.20400000000000001`"}, {"0.594`"}, {
                 "0.217`"}, {"0.878`"}, {"1.`"}, {"0.886`"}}, 
                ColumnAlignments -> Center, RowSpacings -> 1, 
                ColumnAlignments -> Left], Column], "\[NoBreak]", ")"}], 
            Function[BoxForm`e$, 
             MatrixForm[BoxForm`e$]]]}], ",", 
         RowBox[{"\"T\"", "\[Rule]", 
           TagBox[
            RowBox[{"(", "\[NoBreak]", 
              GridBox[{{"0.98`", "0.`", "0.`", "0.`", 
                 RowBox[{"-", "0.02`"}], "0.`", "0.`"}, {
                "0.`", "0.98`", "0.`", "0.01`", "0.`", "0.`", "0.007`"}, {
                "0.`", "0.`", "1.`", "0.`", "0.`", "0.`", "0.`"}, {
                "0.`", "0.01`", "0.`", "0.98`", "0.`", "0.`", "0.007`"}, {
                 RowBox[{"-", "0.02`"}], "0.`", "0.`", "0.`", "0.98`", "0.`", 
                 "0.`"}, {
                "0.`", "0.`", "0.`", "0.`", "0.`", "0.98`", "0.007`"}, {
                "0.`", "0.01`", "0.`", "0.01`", "0.`", "0.02`", "0.98`"}}, 
               RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> 
               Baseline, ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
            Function[BoxForm`e$, 
             MatrixForm[BoxForm`e$]]]}]}], "\[RightAssociation]"}]], 
    Annotation[#, 
     Association[
     "s" -> MatrixForm[{0.751, 0.20400000000000001`, 0.594, 0.217, 0.878, 1., 
        0.886}], "T" -> MatrixForm[CompressedData["
1:eJxTTMoPSmViYGBgh+KY/kNfNWLe2zPgANUi69wfVk3Zj0seXT9EfQuGeZUv
1Qw51tTgsOcDTvuxuwdhPi73w+wj1f2kAph+dP+huxM7f4o9TD8AUvRA9w==

        "]]], "Tooltip"]& ], 
   TemplateBox[{25}, "Spacer1"], 
   TagBox[
    TooltipBox[
     GraphicsBox[
      NamespaceBox[{{
         Directive[
          Opacity[0.7], 
          Hue[0.6, 0.7, 0.5]], 
         Directive[
          GrayLevel[0]], 
         LineBox[{
           DynamicLocation["VertexID$1", Automatic, Center], 
           DynamicLocation["VertexID$8", Automatic, Center]}], 
         LineBox[{
           DynamicLocation["VertexID$2", Automatic, Center], 
           DynamicLocation["VertexID$4", Automatic, Center]}], 
         StyleBox[
          LineBox[{
            DynamicLocation["VertexID$4", Automatic, Center], 
            DynamicLocation["VertexID$5", Automatic, Center]}], {{
            Dashing[{Small, Small}]}}, StripOnInput -> False], 
         StyleBox[
          LineBox[{
            DynamicLocation["VertexID$4", Automatic, Center], 
            DynamicLocation["VertexID$7", Automatic, Center]}], {{
            Dashing[{Small, Small}]}}, StripOnInput -> False], 
         LineBox[{
           DynamicLocation["VertexID$5", Automatic, Center], 
           DynamicLocation["VertexID$10", Automatic, Center]}], 
         LineBox[{
           DynamicLocation["VertexID$6", Automatic, Center], 
           DynamicLocation["VertexID$7", Automatic, Center]}], 
         StyleBox[
          LineBox[{
            DynamicLocation["VertexID$6", Automatic, Center], 
            DynamicLocation["VertexID$8", Automatic, Center]}], {{
            Dashing[{Small, Small}]}}, StripOnInput -> False], 
         LineBox[{
           DynamicLocation["VertexID$6", Automatic, Center], 
           DynamicLocation["VertexID$10", Automatic, Center]}], 
         LineBox[{
           DynamicLocation["VertexID$7", Automatic, Center], 
           DynamicLocation["VertexID$8", Automatic, Center]}], 
         LineBox[{
           DynamicLocation["VertexID$8", Automatic, Center], 
           DynamicLocation["VertexID$9", Automatic, Center]}]}, {
         Directive[
          Hue[0.6, 0.2, 0.8], 
          EdgeForm[
           Directive[
            GrayLevel[0], 
            Opacity[0.7]]]], 
         Directive[
          GrayLevel[0]], 
         TagBox[
          StyleBox[
           
           DiskBox[{0.3728663376770758, -1.0975121725697567`}, 
            0.06599831920610398], {
            RGBColor[
            0.12067413638854053`, 0.019164866451392794`, 0.4024533629156208]},
            StripOnInput -> False], "DynamicName", BoxID -> "VertexID$1"], 
         TagBox[
          StyleBox[
           
           DiskBox[{4.446553666143984, -2.2648804120433783`}, 
            0.12846824077655705`], {
            RGBColor[
            0.10163819841518515`, 0.1543447366422955, 0.45831915424891073`]}, 
           StripOnInput -> False], "DynamicName", BoxID -> "VertexID$2"], 
         TagBox[
          StyleBox[
           
           DiskBox[{0.3728663376770757, -3.01061308739753}, 
            0.09589104750864863], {
            RGBColor[
            0.11575232510710434`, 0.05411611556031125, 0.4168976672843054]}, 
           StripOnInput -> False], "DynamicName", BoxID -> "VertexID$3"], 
         TagBox[
          StyleBox[
           
           DiskBox[{3.6215570158536097`, -1.712434779474677}, 
            0.11102357534244875`], {
            RGBColor[
            0.1101788212786135, 0.09369522771640583, 0.43325452883289756`]}, 
           StripOnInput -> False], "DynamicName", BoxID -> "VertexID$4"], 
         TagBox[
          StyleBox[
           
           DiskBox[{3.7793463057962793`, -0.7942387555940287}, 
            0.09192165417912801], {
            RGBColor[
            0.11728460570710728`, 0.0432349342445095, 0.4124008009684123]}, 
           StripOnInput -> False], "DynamicName", BoxID -> "VertexID$5"], 
         TagBox[
          StyleBox[
           
           DiskBox[{2.1257960230895083`, -0.9004374384297522}, 
            0.11280729606009532`], {
            RGBColor[
            0.1106301549365809, 0.09049017286792835, 0.43192997566441227`]}, 
           StripOnInput -> False], "DynamicName", BoxID -> "VertexID$6"], 
         TagBox[
          StyleBox[
           
           DiskBox[{2.425245132868373, -1.610703184913904}, 
            0.044884900784788795`], {
            RGBColor[
            0.12180947854554933`, 0.011102463347246884`, 0.3991214132042843]},
            StripOnInput -> False], "DynamicName", BoxID -> "VertexID$7"], 
         TagBox[
          StyleBox[
           
           DiskBox[{1.3031569335483284`, -1.4733650528238464`}, 
            0.12063834966685265`], {
            RGBColor[
            0.10556813445281273`, 0.12643708931918304`, 
             0.44678575952265237`]}, StripOnInput -> False], "DynamicName", 
          BoxID -> "VertexID$8"], 
         TagBox[
          StyleBox[
           
           DiskBox[{0.5780755347778777, -2.1578344516975005`}, 
            0.1019890546964709], {
            RGBColor[
            0.11406411469575566`, 0.06610460094939351, 0.42185214920681974`]},
            StripOnInput -> False], "DynamicName", BoxID -> "VertexID$9"], 
         TagBox[
          StyleBox[
           
           DiskBox[{2.9954190213886926`, -0.3728663376770758}, 
            0.07841002231467878], {
            RGBColor[
            0.11902806330438113`, 0.030854122118902413`, 
             0.40728418215697937`]}, StripOnInput -> False], "DynamicName", 
          BoxID -> "VertexID$10"]}}], {
      ImageSize -> 100, BaseStyle -> GrayLevel[0], FormatType -> 
       TraditionalForm, FrameTicks -> None}], 
     RowBox[{"\[LeftAssociation]", 
       RowBox[{
         RowBox[{"\"s\"", "\[Rule]", 
           TagBox[
            RowBox[{"(", "\[NoBreak]", 
              TagBox[
               
               GridBox[{{"0.264`"}, {"1.`"}, {"0.557`"}, {"0.747`"}, {
                 "0.512`"}, {"0.771`"}, {"0.122`"}, {"0.882`"}, {"0.63`"}, {
                 "0.373`"}}, ColumnAlignments -> Center, RowSpacings -> 1, 
                ColumnAlignments -> Left], Column], "\[NoBreak]", ")"}], 
            Function[BoxForm`e$, 
             MatrixForm[BoxForm`e$]]]}], ",", 
         RowBox[{"\"T\"", "\[Rule]", 
           TagBox[
            RowBox[{"(", "\[NoBreak]", 
              
              GridBox[{{
                "0.98`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.005`", 
                 "0.`", "0.`"}, {
                "0.`", "0.98`", "0.`", "0.007`", "0.`", "0.`", "0.`", "0.`", 
                 "0.`", "0.`"}, {
                "0.`", "0.`", "1.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`",
                  "0.`"}, {"0.`", "0.02`", "0.`", "0.98`", 
                 RowBox[{"-", "0.01`"}], "0.`", 
                 RowBox[{"-", "0.007`"}], "0.`", "0.`", "0.`"}, {
                "0.`", "0.`", "0.`", 
                 RowBox[{"-", "0.007`"}], "0.98`", "0.`", "0.`", "0.`", "0.`",
                  "0.01`"}, {
                "0.`", "0.`", "0.`", "0.`", "0.`", "0.98`", "0.007`", 
                 RowBox[{"-", "0.005`"}], "0.`", "0.01`"}, {
                "0.`", "0.`", "0.`", 
                 RowBox[{"-", "0.007`"}], "0.`", "0.007`", "0.98`", "0.005`", 
                 "0.`", "0.`"}, {"0.02`", "0.`", "0.`", "0.`", "0.`", 
                 RowBox[{"-", "0.007`"}], "0.007`", "0.98`", "0.02`", 
                 "0.`"}, {
                "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.005`", 
                 "0.98`", "0.`"}, {
                "0.`", "0.`", "0.`", "0.`", "0.01`", "0.007`", "0.`", "0.`", 
                 "0.`", "0.98`"}}, RowSpacings -> 1, ColumnSpacings -> 1, 
               RowAlignments -> Baseline, ColumnAlignments -> Center], 
              "\[NoBreak]", ")"}], 
            Function[BoxForm`e$, 
             MatrixForm[BoxForm`e$]]]}]}], "\[RightAssociation]"}]], 
    Annotation[#, 
     Association[
     "s" -> MatrixForm[{0.264, 1., 0.557, 0.747, 0.512, 0.771, 0.122, 0.882, 
        0.63, 0.373}], "T" -> MatrixForm[CompressedData["
1:eJxTTMoPSmViYGDgguKY/kNfNWLe2zOQCKpF1rk/rCrBqQ/d3MqXaoYca2pI
tgc7+ECxORD3T4GbA3MvRLxlP0wc6u792E3BDWD6iA1fqL1E+wtmLixcofEB
dych89D9BTMHNRww4xc93AiZj91cwvoJAZj7SE2/sHAhlB5h5gIAc+5xMQ==

        "]]], "Tooltip"]& ], 
   TemplateBox[{25}, "Spacer1"], 
   TagBox[
    TooltipBox[
     GraphicsBox[
      NamespaceBox[{{
         Arrowheads[Medium], 
         Directive[
          Opacity[0.7], 
          Hue[0.6, 0.7, 0.5]], 
         StyleBox[
          LineBox[{
            DynamicLocation["VertexID$1", Automatic, Center], 
            DynamicLocation["VertexID$3", Automatic, Center]}], {{
            Thickness[0.002], {
             GrayLevel[1], 
             Opacity[0]}, 
            Arrowheads[0.06]}}, StripOnInput -> False], 
         StyleBox[
          LineBox[{
            DynamicLocation["VertexID$1", Automatic, Center], 
            DynamicLocation["VertexID$4", Automatic, Center]}], {{
            Thickness[0.002], {
             GrayLevel[1], 
             Opacity[0]}, 
            Arrowheads[0.06]}}, StripOnInput -> False], 
         StyleBox[
          LineBox[{
            DynamicLocation["VertexID$1", Automatic, Center], 
            DynamicLocation["VertexID$5", Automatic, Center]}], {{
            Thickness[0.002], {
             GrayLevel[1], 
             Opacity[0]}, 
            Arrowheads[0.06]}}, StripOnInput -> False], 
         StyleBox[
          LineBox[{
            DynamicLocation["VertexID$1", Automatic, Center], 
            DynamicLocation["VertexID$6", Automatic, Center]}], {{
            Thickness[0.002], 
            GrayLevel[0], 
            Arrowheads[0.06]}}, StripOnInput -> False], 
         StyleBox[
          LineBox[{
            DynamicLocation["VertexID$1", Automatic, Center], 
            DynamicLocation["VertexID$7", Automatic, Center]}], {{
            Thickness[0.002], {
             GrayLevel[1], 
             Opacity[0]}, 
            Arrowheads[0.06]}}, StripOnInput -> False], 
         StyleBox[
          ArrowBox[
           BezierCurveBox[{
             DynamicLocation[
             "VertexID$1", Automatic, Center], {-0.23223735513173455`, 
             1.0174983348472917`}, 
             DynamicLocation["VertexID$2", Automatic, Center]}]], {{
            Thickness[0.002], 
            GrayLevel[0], 
            Arrowheads[0.06]}}, StripOnInput -> False], 
         StyleBox[
          LineBox[{
            DynamicLocation["VertexID$2", Automatic, Center], 
            DynamicLocation["VertexID$3", Automatic, Center]}], {{
            Thickness[0.002], {
             GrayLevel[1], 
             Opacity[0]}, 
            Arrowheads[0.06]}}, StripOnInput -> False], 
         StyleBox[
          LineBox[{
            DynamicLocation["VertexID$2", Automatic, Center], 
            DynamicLocation["VertexID$4", Automatic, Center]}], {{
            Thickness[0.002], {
             GrayLevel[1], 
             Opacity[0]}, 
            Arrowheads[0.06]}}, StripOnInput -> False], 
         StyleBox[
          LineBox[{
            DynamicLocation["VertexID$2", Automatic, Center], 
            DynamicLocation["VertexID$5", Automatic, Center]}], {{
            Thickness[0.002], {
             GrayLevel[1], 
             Opacity[0]}, 
            Arrowheads[0.06]}}, StripOnInput -> False], 
         StyleBox[
          LineBox[{
            DynamicLocation["VertexID$2", Automatic, Center], 
            DynamicLocation["VertexID$6", Automatic, Center]}], {{
            Thickness[0.002], {
             GrayLevel[1], 
             Opacity[0]}, 
            Arrowheads[0.06]}}, StripOnInput -> False], 
         StyleBox[
          LineBox[{
            DynamicLocation["VertexID$2", Automatic, Center], 
            DynamicLocation["VertexID$7", Automatic, Center]}], {{
            Thickness[0.002], {
             GrayLevel[1], 
             Opacity[0]}, 
            Arrowheads[0.06]}}, StripOnInput -> False], 
         StyleBox[
          ArrowBox[
           BezierCurveBox[{
             DynamicLocation[
             "VertexID$2", Automatic, Center], {-0.16873151277068338`, 
             0.7392610598025617}, 
             DynamicLocation["VertexID$1", Automatic, Center]}]], {{
            Thickness[0.002], 
            GrayLevel[0], 
            Arrowheads[0.06]}}, StripOnInput -> False], 
         StyleBox[
          LineBox[{
            DynamicLocation["VertexID$3", Automatic, Center], 
            DynamicLocation["VertexID$5", Automatic, Center]}], {{
            Thickness[0.002], 
            GrayLevel[0], 
            Arrowheads[0.06]}}, StripOnInput -> False], 
         StyleBox[
          LineBox[{
            DynamicLocation["VertexID$3", Automatic, Center], 
            DynamicLocation["VertexID$6", Automatic, Center]}], {{
            Thickness[0.002], {
             GrayLevel[1], 
             Opacity[0]}, 
            Arrowheads[0.06]}}, StripOnInput -> False], 
         StyleBox[
          LineBox[{
            DynamicLocation["VertexID$3", Automatic, Center], 
            DynamicLocation["VertexID$7", Automatic, Center]}], {{
            Thickness[0.002], {
             GrayLevel[1], 
             Opacity[0]}, 
            Arrowheads[0.06]}}, StripOnInput -> False], 
         StyleBox[
          ArrowBox[
           BezierCurveBox[{
             DynamicLocation["VertexID$3", Automatic, Center], {
             0.33865265242126374`, -0.4246569943805402}, 
             DynamicLocation["VertexID$4", Automatic, Center]}]], {{
            Thickness[0.0020000000000000018`], 
            GrayLevel[0], 
            Arrowheads[0.06]}}, StripOnInput -> False], 
         StyleBox[
          LineBox[{
            DynamicLocation["VertexID$4", Automatic, Center], 
            DynamicLocation["VertexID$5", Automatic, Center]}], {{
            Thickness[0.002], {
             GrayLevel[1], 
             Opacity[0]}, 
            Arrowheads[0.06]}}, StripOnInput -> False], 
         StyleBox[
          LineBox[{
            DynamicLocation["VertexID$4", Automatic, Center], 
            DynamicLocation["VertexID$6", Automatic, Center]}], {{
            Thickness[0.002], {
             GrayLevel[1], 
             Opacity[0]}, 
            Arrowheads[0.06]}}, StripOnInput -> False], 
         StyleBox[
          LineBox[{
            DynamicLocation["VertexID$4", Automatic, Center], 
            DynamicLocation["VertexID$7", Automatic, Center]}], {{
            Thickness[0.002], {
             GrayLevel[1], 
             Opacity[0]}, 
            Arrowheads[0.06]}}, StripOnInput -> False], 
         StyleBox[
          ArrowBox[
           BezierCurveBox[{
             DynamicLocation[
             "VertexID$4", Automatic, Center], {-0.06117358637757645, 
             0.07670925103006905}, 
             DynamicLocation["VertexID$3", Automatic, Center]}]], {{
            Thickness[0.002], 
            GrayLevel[0], 
            Arrowheads[0.06]}}, StripOnInput -> False], 
         StyleBox[
          LineBox[{
            DynamicLocation["VertexID$5", Automatic, Center], 
            DynamicLocation["VertexID$6", Automatic, Center]}], {{
            Thickness[0.002], 
            GrayLevel[0], 
            Arrowheads[0.06]}}, StripOnInput -> False], 
         StyleBox[
          LineBox[{
            DynamicLocation["VertexID$5", Automatic, Center], 
            DynamicLocation["VertexID$7", Automatic, Center]}], {{
            Thickness[0.002], {
             GrayLevel[1], 
             Opacity[0]}, 
            Arrowheads[0.06]}}, StripOnInput -> False], 
         StyleBox[
          LineBox[{
            DynamicLocation["VertexID$6", Automatic, Center], 
            DynamicLocation["VertexID$7", Automatic, Center]}], {{
            Thickness[0.002], {
             GrayLevel[1], 
             Opacity[0]}, 
            Arrowheads[0.06]}}, StripOnInput -> False]}, {
         Directive[
          Hue[0.6, 0.2, 0.8], 
          EdgeForm[
           Directive[
            GrayLevel[0], 
            Opacity[0.7]]]], 
         TagBox[
          StyleBox[
           
           DiskBox[{-0.6234898018587335, 0.7818314824680298}, 
            0.12179908740991086`], {
            RGBColor[
            0.1079394317121749, 0.10959780059312714`, 0.43982658587614465`]}, 
           StripOnInput -> False], "DynamicName", BoxID -> "VertexID$1"], 
         TagBox[
          StyleBox[
           
           DiskBox[{0.2225209339563144, 0.9749279121818236}, 
            0.053030569223050356`], {
            RGBColor[
            0.12153230466461866`, 0.013070757701691737`, 
             0.39993485030503473`]}, StripOnInput -> False], "DynamicName", 
          BoxID -> "VertexID$2"], 
         TagBox[
          StyleBox[
           
           DiskBox[{0.9009688679024191, 0.4338837391175581}, 
            0.14462791303918604`], {
            RGBColor[
            0.09485906838896713, 0.20248535982745675`, 0.4782142318645256]}, 
           StripOnInput -> False], "DynamicName", BoxID -> "VertexID$3"], 
         TagBox[
          StyleBox[
           
           DiskBox[{-0.6234898018587335, -0.7818314824680298}, 
            0.04694533910106327], {
            RGBColor[
            0.12167470689701412`, 0.01205951699912915, 0.39951693481216355`]},
            StripOnInput -> False], "DynamicName", BoxID -> "VertexID$4"], 
         TagBox[
          StyleBox[
           DiskBox[{-1., 0.}, 0.11426944518774367`], {
            RGBColor[
            0.11031103383015099`, 0.09275634697517506, 0.4328665175446609]}, 
           StripOnInput -> False], "DynamicName", BoxID -> "VertexID$5"], 
         TagBox[
          StyleBox[
           
           DiskBox[{0.9009688679024191, -0.4338837391175581}, 
            0.14058982811912213`], {
            RGBColor[
            0.09703611519092199, 0.18702550150580743`, 0.471825135486346]}, 
           StripOnInput -> False], "DynamicName", BoxID -> "VertexID$6"], 
         TagBox[
          StyleBox[
           
           DiskBox[{0.2225209339563144, -0.9749279121818236}, 
            0.09797930820684884], {
            RGBColor[
            0.1165420258513829, 0.04850821516419445, 0.41458009002295054`]}, 
           StripOnInput -> False], "DynamicName", BoxID -> "VertexID$7"]}}], {
      ImageSize -> 70, FormatType -> TraditionalForm, FrameTicks -> None}], 
     RowBox[{"\[LeftAssociation]", 
       RowBox[{
         RowBox[{"\"s\"", "\[Rule]", 
           TagBox[
            RowBox[{"(", "\[NoBreak]", 
              TagBox[
               
               GridBox[{{"0.624`"}, {"0.709`"}, {"0.134`"}, {"1.`"}, {
                 "0.9450000000000001`"}, {"0.459`"}, {"0.105`"}}, 
                ColumnAlignments -> Center, RowSpacings -> 1, 
                ColumnAlignments -> Left], Column], "\[NoBreak]", ")"}], 
            Function[BoxForm`e$, 
             MatrixForm[BoxForm`e$]]]}], ",", 
         RowBox[{"\"T\"", "\[Rule]", 
           TagBox[
            RowBox[{"(", "\[NoBreak]", 
              
              GridBox[{{
                "0.98`", "0.`", "0.`", "0.01`", "0.01`", "0.`", "0.`"}, {
                "0.`", "0.98`", "0.02`", "0.`", "0.01`", "0.`", "0.`"}, {
                "0.`", "0.01`", "0.98`", "0.`", "0.`", "0.`", "0.`"}, {
                "0.01`", "0.`", "0.`", "0.98`", "0.`", "0.`", "0.02`"}, {
                "0.01`", "0.01`", "0.`", "0.`", "0.98`", "0.`", "0.`"}, {
                "0.`", "0.`", "0.`", "0.`", "0.`", "1.`", "0.`"}, {
                "0.`", "0.`", "0.`", "0.01`", "0.`", "0.`", "0.98`"}}, 
               RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> 
               Baseline, ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
            Function[BoxForm`e$, 
             MatrixForm[BoxForm`e$]]]}]}], "\[RightAssociation]"}]], 
    Annotation[#, 
     Association[
     "s" -> MatrixForm[{0.624, 0.709, 0.134, 1., 0.9450000000000001, 0.459, 
        0.105}], "T" -> MatrixForm[CompressedData["
1:eJxTTMoPSmViYGBgh+KY/kNfNWLe2zOggWqRde4Pq1rsYTS6PAzA9EPUTbFH
149LH0wel/241OOyH7v6KfaE/EGs/fjBB4rdDwCbo0FV
        "]]], "Tooltip"]& ], 
   TemplateBox[{25}, "Spacer1"], 
   TagBox[
    TooltipBox[
     GraphicsBox[
      NamespaceBox[{{
         Directive[
          Opacity[0.7], 
          Hue[0.6, 0.7, 0.5]], 
         Directive[
          GrayLevel[0]], 
         LineBox[{{
            DynamicLocation["VertexID$1", Automatic, Center], 
            DynamicLocation["VertexID$2", Automatic, Center]}, {
            DynamicLocation["VertexID$1", Automatic, Center], 
            DynamicLocation["VertexID$3", Automatic, Center]}, {
            DynamicLocation["VertexID$2", Automatic, Center], 
            DynamicLocation["VertexID$3", Automatic, Center]}}]}, {
         Directive[
          Hue[0.6, 0.2, 0.8], 
          EdgeForm[
           Directive[
            GrayLevel[0], 
            Opacity[0.7]]]], 
         Directive[
          GrayLevel[0]], 
         TagBox[
          StyleBox[
           
           DiskBox[{-0.8660254037844384, -0.4999999999999994}, 
            0.28867513459481275`], {
            RGBColor[
            0.0935001466004595, 0.21213546854430457`, 0.4822023327493515]}, 
           StripOnInput -> False], "DynamicName", BoxID -> "VertexID$1"], 
         TagBox[
          StyleBox[
           DiskBox[{1.8369701987210297`*^-16, 1.}, 0.28867513459481275`], {
            RGBColor[
            0.0935001466004595, 0.21213546854430457`, 0.4822023327493515]}, 
           StripOnInput -> False], "DynamicName", BoxID -> "VertexID$2"], 
         TagBox[
          StyleBox[
           
           DiskBox[{0.8660254037844389, -0.5000000000000012}, 
            0.28867513459481275`], {
            RGBColor[
            0.0935001466004595, 0.21213546854430457`, 0.4822023327493515]}, 
           StripOnInput -> False], "DynamicName", BoxID -> "VertexID$3"]}}], {
      ImageSize -> {30, 30}, BaseStyle -> GrayLevel[0], FormatType -> 
       TraditionalForm, FrameTicks -> None}], 
     RowBox[{"\[LeftAssociation]", 
       RowBox[{
         RowBox[{"\"s\"", "\[Rule]", 
           TagBox[
            RowBox[{"(", "\[NoBreak]", 
              TagBox[
               
               GridBox[{{"1"}, {"1"}, {"1"}}, ColumnAlignments -> Center, 
                RowSpacings -> 1, ColumnAlignments -> Left], Column], 
              "\[NoBreak]", ")"}], 
            Function[BoxForm`e$, 
             MatrixForm[BoxForm`e$]]]}], ",", 
         RowBox[{"\"T\"", "\[Rule]", 
           TagBox[
            RowBox[{"(", "\[NoBreak]", 
              
              GridBox[{{"0.98`", "0.01`", "0.01`"}, {
                "0.01`", "0.98`", "0.01`"}, {"0.01`", "0.01`", "0.98`"}}, 
               RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> 
               Baseline, ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
            Function[BoxForm`e$, 
             MatrixForm[BoxForm`e$]]]}]}], "\[RightAssociation]"}]], 
    Annotation[#, 
     Association[
     "s" -> MatrixForm[{1, 1, 1}], "T" -> 
      MatrixForm[{{0.98, 0.01, 0.01}, {0.01, 0.98, 0.01}, {0.01, 0.01, 
        0.98}}]], "Tooltip"]& ], 
   TemplateBox[{25}, "Spacer1"], 
   TagBox[
    TooltipBox[
     GraphicsBox[
      NamespaceBox[{{
         Directive[
          Opacity[0.7], 
          Hue[0.6, 0.7, 0.5]], 
         Directive[
          GrayLevel[0]], 
         LineBox[{
           DynamicLocation["VertexID$1", Automatic, Center], 
           DynamicLocation["VertexID$7", Automatic, Center]}], 
         LineBox[{
           DynamicLocation["VertexID$1", Automatic, Center], 
           DynamicLocation["VertexID$8", Automatic, Center]}], 
         LineBox[{
           DynamicLocation["VertexID$1", Automatic, Center], 
           DynamicLocation["VertexID$12", Automatic, Center]}], 
         LineBox[{
           DynamicLocation["VertexID$2", Automatic, Center], 
           DynamicLocation["VertexID$8", Automatic, Center]}], 
         LineBox[{
           DynamicLocation["VertexID$2", Automatic, Center], 
           DynamicLocation["VertexID$10", Automatic, Center]}], 
         StyleBox[
          LineBox[{
            DynamicLocation["VertexID$3", Automatic, Center], 
            DynamicLocation["VertexID$5", Automatic, Center]}], {{
            Dashing[{Small, Small}]}}, StripOnInput -> False], 
         LineBox[{
           DynamicLocation["VertexID$3", Automatic, Center], 
           DynamicLocation["VertexID$9", Automatic, Center]}], 
         LineBox[{
           DynamicLocation["VertexID$4", Automatic, Center], 
           DynamicLocation["VertexID$13", Automatic, Center]}], 
         LineBox[{
           DynamicLocation["VertexID$5", Automatic, Center], 
           DynamicLocation["VertexID$7", Automatic, Center]}], 
         LineBox[{
           DynamicLocation["VertexID$5", Automatic, Center], 
           DynamicLocation["VertexID$10", Automatic, Center]}], 
         LineBox[{
           DynamicLocation["VertexID$5", Automatic, Center], 
           DynamicLocation["VertexID$11", Automatic, Center]}], 
         LineBox[{
           DynamicLocation["VertexID$6", Automatic, Center], 
           DynamicLocation["VertexID$9", Automatic, Center]}], 
         LineBox[{
           DynamicLocation["VertexID$6", Automatic, Center], 
           DynamicLocation["VertexID$14", Automatic, Center]}], 
         LineBox[{
           DynamicLocation["VertexID$7", Automatic, Center], 
           DynamicLocation["VertexID$11", Automatic, Center]}], 
         LineBox[{
           DynamicLocation["VertexID$7", Automatic, Center], 
           DynamicLocation["VertexID$13", Automatic, Center]}], 
         LineBox[{
           DynamicLocation["VertexID$9", Automatic, Center], 
           DynamicLocation["VertexID$10", Automatic, Center]}], 
         LineBox[{
           DynamicLocation["VertexID$10", Automatic, Center], 
           DynamicLocation["VertexID$11", Automatic, Center]}], 
         LineBox[{
           DynamicLocation["VertexID$10", Automatic, Center], 
           DynamicLocation["VertexID$12", Automatic, Center]}]}, {
         Directive[
          Hue[0.6, 0.2, 0.8], 
          EdgeForm[
           Directive[
            GrayLevel[0], 
            Opacity[0.7]]]], 
         Directive[
          GrayLevel[0]], 
         TagBox[
          StyleBox[
           
           DiskBox[{4.843397786640701, 0.8670294282911862}, 
            0.0657303207730606], {
            RGBColor[
            0.11290861031360047`, 0.07431018202469385, 0.4252432700850522]}, 
           StripOnInput -> False], "DynamicName", BoxID -> "VertexID$1"], 
         TagBox[
          StyleBox[
           
           DiskBox[{3.585139962413188, 0.2987176140284402}, 
            0.03248485855407924], {
            RGBColor[
            0.121411691285608, 0.013927269261078429`, 0.40028882087760354`]}, 
           StripOnInput -> False], "DynamicName", BoxID -> "VertexID$2"], 
         TagBox[
          StyleBox[
           
           DiskBox[{2.760301737136417, 2.4497484314631155`}, 
            0.049537969824153816`], {
            RGBColor[
            0.11954553789639627`, 0.02717938078103878, 0.4057655216308597]}, 
           StripOnInput -> False], "DynamicName", BoxID -> "VertexID$3"], 
         TagBox[
          StyleBox[
           
           DiskBox[{6.895097574642707, 2.9306821244879813`}, 
            0.06013454084300205], {
            RGBColor[
            0.11614671393054239`, 0.051315442957168694`, 0.4157402331854335]},
            StripOnInput -> False], "DynamicName", BoxID -> "VertexID$4"], 
         TagBox[
          StyleBox[
           
           DiskBox[{3.7455070624263795`, 2.1934612259404767`}, 
            0.033579763852403716`], {
            RGBColor[
            0.12151304210764252`, 0.013207546860976797`, 0.3999913811673479]},
            StripOnInput -> False], "DynamicName", BoxID -> "VertexID$5"], 
         TagBox[
          StyleBox[
           
           DiskBox[{0.9085803171008524, 2.0897240122537526`}, 
            0.03806569591640272], {
            RGBColor[
            0.12078448580844907`, 0.01838124232529212, 0.4021295145360459]}, 
           StripOnInput -> False], "DynamicName", BoxID -> "VertexID$6"], 
         TagBox[
          StyleBox[
           
           DiskBox[{4.931571098786885, 1.9819844308135515`}, 
            0.06265031236989492], {
            RGBColor[
            0.11455821538601077`, 0.06259584465572351, 0.42040208532774725`]},
            StripOnInput -> False], "DynamicName", BoxID -> "VertexID$7"], 
         TagBox[
          StyleBox[
           DiskBox[{4.44511899696497, 0.}, 0.07354483245801513], {
            RGBColor[
            0.10861100333166442`, 0.10482877032660942`, 
             0.43785568851283774`]}, StripOnInput -> False], "DynamicName", 
          BoxID -> "VertexID$8"], 
         TagBox[
          StyleBox[
           
           DiskBox[{2.100582122670264, 1.9113503311660018`}, 
            0.03594042609717933], {
            RGBColor[
            0.12118508309740765`, 0.015536481557735213`, 
             0.40095386011938583`]}, StripOnInput -> False], "DynamicName", 
          BoxID -> "VertexID$9"], 
         TagBox[
          StyleBox[
           
           DiskBox[{3.314385930124817, 1.3938176564329068`}, 
            0.08243136609180894], {
            RGBColor[
            0.10046018532346367`, 0.1627101587741068, 0.4617763326481108]}, 
           StripOnInput -> False], "DynamicName", BoxID -> "VertexID$10"], 
         TagBox[
          StyleBox[
           
           DiskBox[{4.1448370294374, 1.901651250760732}, 
            0.04626621597321869], {
            RGBColor[
            0.11987628260854234`, 0.024830663984587033`, 
             0.40479486732954795`]}, StripOnInput -> False], "DynamicName", 
          BoxID -> "VertexID$11"], 
         TagBox[
          StyleBox[
           
           DiskBox[{4.068487141104344, 0.8958048843031706}, 
            0.03956302470250005], {
            RGBColor[
            0.12085431388352227`, 0.01788537234834175, 0.4019245863272702]}, 
           StripOnInput -> False], "DynamicName", BoxID -> "VertexID$12"], 
         TagBox[
          StyleBox[
           
           DiskBox[{6.04881537033852, 2.5263619874937437`}, 
            0.05581021925664895], {
            RGBColor[
            0.11716300411511896`, 0.044098463398838376`, 0.412757671702774]}, 
           StripOnInput -> False], "DynamicName", BoxID -> "VertexID$13"], 
         TagBox[
          StyleBox[
           DiskBox[{0., 2.2312418678088197`}, 0.07135751992670399], {
            RGBColor[
            0.1104885360297787, 0.0914958509419426, 0.43234559228952074`]}, 
           StripOnInput -> False], "DynamicName", BoxID -> 
          "VertexID$14"]}}], {
      ImageSize -> 140, BaseStyle -> GrayLevel[0], FormatType -> 
       TraditionalForm, FrameTicks -> None}], 
     RowBox[{"\[LeftAssociation]", 
       RowBox[{
         RowBox[{"\"s\"", "\[Rule]", 
           TagBox[
            RowBox[{"(", "\[NoBreak]", 
              TagBox[
               
               GridBox[{{"0.636`"}, {"0.155`"}, {"0.361`"}, {"0.532`"}, {
                 "0.166`"}, {"0.213`"}, {"0.578`"}, {"0.796`"}, {"0.19`"}, {
                 "1.`"}, {"0.315`"}, {"0.23`"}, {"0.458`"}, {"0.749`"}}, 
                ColumnAlignments -> Center, RowSpacings -> 1, 
                ColumnAlignments -> Left], Column], "\[NoBreak]", ")"}], 
            Function[BoxForm`e$, 
             MatrixForm[BoxForm`e$]]]}], ",", 
         RowBox[{"\"T\"", "\[Rule]", 
           TagBox[
            RowBox[{"(", "\[NoBreak]", 
              
              GridBox[{{
                "0.98`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.005`", "0.01`",
                  "0.`", "0.`", "0.`", "0.01`", "0.`", "0.`"}, {
                "0.`", "0.98`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.01`", 
                 "0.`", "0.004`", "0.`", "0.`", "0.`", "0.`"}, {
                "0.`", "0.`", "0.98`", "0.`", 
                 RowBox[{"-", "0.005`"}], "0.`", "0.`", "0.`", "0.007`", 
                 "0.`", "0.`", "0.`", "0.`", "0.`"}, {
                "0.`", "0.`", "0.`", "0.98`", "0.`", "0.`", "0.`", "0.`", 
                 "0.`", "0.`", "0.`", "0.`", "0.01`", "0.`"}, {"0.`", "0.`", 
                 RowBox[{"-", "0.01`"}], "0.`", "0.98`", "0.`", "0.005`", 
                 "0.`", "0.`", "0.004`", "0.007`", "0.`", "0.`", "0.`"}, {
                "0.`", "0.`", "0.`", "0.`", "0.`", "0.98`", "0.`", "0.`", 
                 "0.007`", "0.`", "0.`", "0.`", "0.`", "0.02`"}, {
                "0.007`", "0.`", "0.`", "0.`", "0.005`", "0.`", "0.98`", 
                 "0.`", "0.`", "0.`", "0.007`", "0.`", "0.01`", "0.`"}, {
                "0.007`", "0.01`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.98`",
                  "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"}, {
                "0.`", "0.`", "0.01`", "0.`", "0.`", "0.01`", "0.`", "0.`", 
                 "0.98`", "0.004`", "0.`", "0.`", "0.`", "0.`"}, {
                "0.`", "0.01`", "0.`", "0.`", "0.005`", "0.`", "0.`", "0.`", 
                 "0.007`", "0.98`", "0.007`", "0.01`", "0.`", "0.`"}, {
                "0.`", "0.`", "0.`", "0.`", "0.005`", "0.`", "0.005`", "0.`", 
                 "0.`", "0.004`", "0.98`", "0.`", "0.`", "0.`"}, {
                "0.007`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
                 "0.`", "0.004`", "0.`", "0.98`", "0.`", "0.`"}, {
                "0.`", "0.`", "0.`", "0.02`", "0.`", "0.`", "0.005`", "0.`", 
                 "0.`", "0.`", "0.`", "0.`", "0.98`", "0.`"}, {
                "0.`", "0.`", "0.`", "0.`", "0.`", "0.01`", "0.`", "0.`", 
                 "0.`", "0.`", "0.`", "0.`", "0.`", "0.98`"}}, RowSpacings -> 
               1, ColumnSpacings -> 1, RowAlignments -> Baseline, 
               ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
            Function[BoxForm`e$, 
             MatrixForm[BoxForm`e$]]]}]}], "\[RightAssociation]"}]], 
    Annotation[#, 
     Association[
     "s" -> MatrixForm[{0.636, 0.155, 0.361, 0.532, 0.166, 0.213, 0.578, 
        0.796, 0.19, 1., 0.315, 0.23, 0.458, 0.749}], "T" -> 
      MatrixForm[CompressedData["
1:eJxTTMoPSmViYGDgg+KY/kNfNWLe2zMQCapF1rk/rCqxh9AtOPURkifPXoR5
f1Z+vOSbVEC0flz2Qv2zH5f6ypdqhhxraki2h5C95AIiwx3uHxz+xdAPC09a
+5dY8yHunELQPej+IRTO6OahhydMnlA4owNaxy8ucZi9pOYH/PZgpg8YgIUP
zF5ywwuXfYTSJ6nxSy5AD0/yyqspJIcvOiA3XZEbH+j2AgBz5MMy
        "]]], 
     "Tooltip"]& ]},
  "RowDefault"]], "Output",
 CellChangeTimes->{
  3.803937614926486*^9, 3.80393792341249*^9, 3.811280633026896*^9, {
   3.818685036804944*^9, 3.8186850526464787`*^9}},
 CellLabel->
  "Out[2219]=",ExpressionUUID->"232df647-b7eb-46cc-9d5a-253b435b5085"]
}, Open  ]],

Cell[TextData[{
 "Defines the style for a particular edge, given one agent\[CloseCurlyQuote]s \
tactic towards another, as well as the allocating agent\[CloseCurlyQuote]s \
size. Here ",
 StyleBox["tactic", "Input"],
 " and ",
 StyleBox["size", "Input"],
 " are scalars, not vectors. This one is used when displaying as a ternary \
graph."
}], "Text",
 CellChangeTimes->{{3.7562247467008286`*^9, 3.756224796636429*^9}, {
  3.75622496235523*^9, 3.75622497333763*^9}, {3.7562265124180393`*^9, 
  3.7562265326668396`*^9}},ExpressionUUID->"78e729f4-14ab-4681-997b-\
98f6f49bd9a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"edgeStyleFunction", "[", 
   RowBox[{"tactic_", ",", "size_", ",", "True"}], "]"}], ":=", 
  RowBox[{"Which", "[", 
   RowBox[{
    RowBox[{"tactic", "<", "0"}], ",", 
    RowBox[{"{", 
     RowBox[{"Dashed", ",", "Black"}], "}"}], ",", 
    RowBox[{"tactic", ">", "0"}], ",", "Black", ",", "True", ",", 
    RowBox[{"{", 
     RowBox[{"White", ",", 
      RowBox[{"Opacity", "[", "0", "]"}]}], "}"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.746650581794941*^9, 3.746650681421661*^9}, {
  3.747340310312997*^9, 3.747340324129971*^9}, {3.7511069074986153`*^9, 
  3.751106914046315*^9}, {3.7549403525115957`*^9, 3.754940373370707*^9}, {
  3.754940474090798*^9, 3.7549405003852043`*^9}, {3.754942257232909*^9, 
  3.754942272524972*^9}, {3.7562248012852287`*^9, 3.7562248134376287`*^9}, {
  3.75622494834643*^9, 3.7562249520280294`*^9}, {3.756226355450839*^9, 
  3.756226356121639*^9}},
 CellLabel->
  "In[150]:=",ExpressionUUID->"f7554b2f-ea76-4a0e-a0cb-66e68b20977f"],

Cell["Same as the above, but used when varying edge thickness.", "Text",
 CellChangeTimes->{{3.716923266629446*^9, 3.716923288652687*^9}, {
  3.754944726199697*^9, 3.754944746994322*^9}, {3.75622653772124*^9, 
  3.7562265550840397`*^9}},ExpressionUUID->"6d501bbf-982a-466a-9f6e-\
240bbd2e603d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"edgeStyleFunction", "[", 
   RowBox[{"tactic_", ",", "size_", ",", "False"}], "]"}], ":=", " ", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"vol", "=", 
      RowBox[{"Abs", "[", 
       RowBox[{"tactic", "*", "size"}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Thickness", "[", 
       RowBox[{"Clip", "[", 
        RowBox[{
         RowBox[{"vol", "/", "5"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.002", ",", ".8"}], "}"}]}], "]"}], "]"}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"tactic", "<", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"Dashed", ",", "Black"}], "}"}], ",", 
        RowBox[{"tactic", ">", "0"}], ",", "Black", ",", "True", ",", 
        RowBox[{"{", 
         RowBox[{"White", ",", 
          RowBox[{"Opacity", "[", "0", "]"}]}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Arrowheads", "[", 
       RowBox[{"Clip", "[", 
        RowBox[{
         RowBox[{"vol", "*", "2"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.06", ",", "0.15"}], "}"}]}], "]"}], "]"}]}], 
     "\[IndentingNewLine]", "}"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.716923147343947*^9, 3.716923169781116*^9}, {
   3.71692321288971*^9, 3.7169232525843353`*^9}, {3.716923438654599*^9, 
   3.71692345797791*^9}, {3.716923489160409*^9, 3.7169236722201014`*^9}, {
   3.716923797136457*^9, 3.716923812959585*^9}, {3.716923870855946*^9, 
   3.716924006703927*^9}, {3.716924067623349*^9, 3.716924120032201*^9}, {
   3.71692422970194*^9, 3.7169242953508043`*^9}, {3.716924330985549*^9, 
   3.716924331133192*^9}, {3.7169244088793707`*^9, 3.716924485320723*^9}, {
   3.716924527022168*^9, 3.716924582961298*^9}, {3.716929994068391*^9, 
   3.716930069574678*^9}, {3.71693010092288*^9, 3.7169302381358433`*^9}, {
   3.716930269198737*^9, 3.716930287154171*^9}, {3.716930847136232*^9, 
   3.716930847465679*^9}, {3.7169309708715277`*^9, 3.716930971234663*^9}, {
   3.7169310552547083`*^9, 3.716931055537146*^9}, {3.7169311211675177`*^9, 
   3.7169311350542507`*^9}, {3.71693125743611*^9, 3.716931396571262*^9}, {
   3.716931442738512*^9, 3.716931470949102*^9}, {3.716931504301957*^9, 
   3.716931550982871*^9}, {3.716931600633882*^9, 3.716931600789197*^9}, {
   3.716931671564687*^9, 3.716931700022024*^9}, {3.716931815402563*^9, 
   3.716931815558833*^9}, 3.716931919342551*^9, {3.716975821915708*^9, 
   3.716975854630155*^9}, {3.716975893800713*^9, 3.716976051920814*^9}, {
   3.75622499544283*^9, 3.7562250019636297`*^9}, {3.7562250718672304`*^9, 
   3.7562251001968307`*^9}, {3.756225136295231*^9, 3.756225190520831*^9}, {
   3.7562261675488377`*^9, 3.756226175707638*^9}, {3.756226364389639*^9, 
   3.756226366199239*^9}, {3.7562264608288393`*^9, 3.7562264802508397`*^9}, {
   3.7564120798877277`*^9, 3.7564120807700787`*^9}, {3.756412157099125*^9, 
   3.7564121591939707`*^9}, {3.768551678950035*^9, 3.768551679323523*^9}, {
   3.768551730703576*^9, 3.7685517320832767`*^9}},
 CellLabel->
  "In[151]:=",ExpressionUUID->"e0a4decf-238c-420b-9996-beb7cf9e1db1"],

Cell["\<\
Identifies redundant edges (one of each pair where both directions have the \
same polarity):\
\>", "Text",
 CellChangeTimes->{{3.746226103310092*^9, 3.746226134768736*^9}, {
  3.746226516748818*^9, 3.7462265305329447`*^9}, {3.746226678565061*^9, 
  3.7462266986960163`*^9}},ExpressionUUID->"2bddc41a-62bf-4c27-a8df-\
24ba63570251"],

Cell[BoxData[
 RowBox[{
  RowBox[{"undirectedEdges", "[", 
   RowBox[{"T_List", "?", "MatrixQ"}], "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "\[UndirectedEdge]", 
      RowBox[{"#", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "&"}], ",", 
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{"UpperTriangularize", "[", 
       RowBox[{
        RowBox[{"MapThread", "[", 
         RowBox[{"Equal", ",", 
          RowBox[{"{", 
           RowBox[{"T", ",", 
            RowBox[{"Transpose", "[", "T", "]"}]}], "}"}], ",", "2"}], "]"}], 
        ",", "1"}], "]"}], ",", "True"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.746226076063884*^9, 3.746226100021727*^9}, {
   3.7462263015983047`*^9, 3.746226367267682*^9}, {3.746226500620233*^9, 
   3.7462265009337378`*^9}, {3.746226647971548*^9, 3.746226661177525*^9}, {
   3.7462272986565723`*^9, 3.746227300471485*^9}, {3.7464648623184443`*^9, 
   3.746464863843083*^9}, 3.746464909701222*^9, 3.7466457202227583`*^9, {
   3.746650532862883*^9, 3.7466505335029373`*^9}, 3.755042828293043*^9},
 CellLabel->
  "In[152]:=",ExpressionUUID->"ad45c2dd-8226-4172-ac38-41c672da19ac"],

Cell["Replaces directed edges with undirected edges.", "Text",
 CellChangeTimes->{{3.7550898385508347`*^9, 
  3.755089851891972*^9}},ExpressionUUID->"0f966cff-3409-4ea8-af3e-\
113904302d59"],

Cell[BoxData[
 RowBox[{
  RowBox[{"replaceDirectedEdges", "[", 
   RowBox[{"edges_List", ",", "undirectedEdges_List"}], "]"}], ":=", " ", 
  RowBox[{"Union", "[", 
   RowBox[{
    RowBox[{"Complement", "[", 
     RowBox[{"edges", ",", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[DirectedEdge]", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "\[DirectedEdge]", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], "&"}], ",", 
         "undirectedEdges"}], "]"}], "]"}]}], "]"}], ",", "undirectedEdges"}],
    "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7464649304961977`*^9, 3.746464953478259*^9}, 
   3.746465457519433*^9, {3.7464655969390497`*^9, 3.7464656381332293`*^9}, {
   3.746465820313281*^9, 3.746465822914628*^9}, {3.755042841698165*^9, 
   3.7550428470998583`*^9}},
 CellLabel->
  "In[153]:=",ExpressionUUID->"4fb3890f-072e-4ff7-96aa-8a08d6e56e32"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ShowPowerStructure", "[", 
  RowBox[{"PowerStructure", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
    RowBox[{"Symmetric3s", "[", 
     RowBox[{"[", "19", "]"}], "]"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.801238367682001*^9, 3.801238446086315*^9}, 
   3.8012391681970263`*^9, 3.8012391985254593`*^9, 3.8012392450577803`*^9, {
   3.801239400970354*^9, 3.801239421265238*^9}, {3.8012395674415092`*^9, 
   3.801239575645833*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[183]:=",ExpressionUUID->"9b88bfb6-c6e6-4342-8dfa-b80ff2219133"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{1, 2, 3}, {Null, {{1, 2}, {1, 3}, {2, 3}}}, {
      EdgeStyle -> {
        UndirectedEdge[1, 2] -> GrayLevel[0], UndirectedEdge[2, 3] -> {
           Dashing[{Small, Small}], 
           GrayLevel[0]}, UndirectedEdge[1, 3] -> {
           Dashing[{Small, Small}], 
           GrayLevel[0]}}, PerformanceGoal -> "Quality", 
       VertexCoordinates -> {{-1, 0}, {
          Rational[1, 2], Rational[1, 2] 3^Rational[1, 2]}, {
          Rational[1, 2], Rational[-1, 2] 3^Rational[1, 2]}}, 
       VertexSize -> {3 -> 0.25, 2 -> 0.25, 1 -> 0.25}, 
       VertexStyle -> {
        1 -> RGBColor[
          0.16699124102927076`, 0.6354029146166567, 0.5306486894817406], 2 -> 
         RGBColor[
          0.16699124102927076`, 0.6354029146166567, 0.5306486894817406], 3 -> 
         RGBColor[
          0.11646955389123893`, 0.04902286015717843, 0.4147927773834885]}}]], 
    Typeset`boxes, Typeset`boxes$s2d = GraphicsGroupBox[{{
       Directive[
        Opacity[0.7], 
        Hue[0.6, 0.7, 0.5]], 
       StyleBox[
        LineBox[{
          DynamicLocation["VertexID$1", Automatic, Center], 
          DynamicLocation["VertexID$2", Automatic, Center]}], 
        GrayLevel[0], StripOnInput -> False], 
       StyleBox[
        LineBox[{
          DynamicLocation["VertexID$1", Automatic, Center], 
          DynamicLocation["VertexID$3", Automatic, Center]}], {
         Dashing[{Small, Small}], 
         GrayLevel[0]}, StripOnInput -> False], 
       StyleBox[
        LineBox[{
          DynamicLocation["VertexID$2", Automatic, Center], 
          DynamicLocation["VertexID$3", Automatic, Center]}], {
         Dashing[{Small, Small}], 
         GrayLevel[0]}, StripOnInput -> False]}, {
       Directive[
        Hue[0.6, 0.2, 0.8], 
        EdgeForm[
         Directive[
          GrayLevel[0], 
          Opacity[0.7]]]], 
       TagBox[
        StyleBox[
         DiskBox[{-1., 0.}, 0.21650635094610965`], 
         RGBColor[
         0.16699124102927076`, 0.6354029146166567, 0.5306486894817406], 
         StripOnInput -> False], "DynamicName", BoxID -> "VertexID$1"], 
       TagBox[
        StyleBox[
         DiskBox[{0.5, 0.8660254037844386}, 0.21650635094610965`], 
         RGBColor[
         0.16699124102927076`, 0.6354029146166567, 0.5306486894817406], 
         StripOnInput -> False], "DynamicName", BoxID -> "VertexID$2"], 
       TagBox[
        StyleBox[
         DiskBox[{0.5, -0.8660254037844386}, 0.21650635094610965`], 
         RGBColor[
         0.11646955389123893`, 0.04902286015717843, 0.4147927773834885], 
         StripOnInput -> False], "DynamicName", BoxID -> 
        "VertexID$3"]}}], $CellContext`flag}, 
    TagBox[
     DynamicBox[GraphComputation`NetworkGraphicsBox[
      3, Typeset`graph, Typeset`boxes, $CellContext`flag], {
      CachedValue :> Typeset`boxes, SingleEvaluation -> True, 
       SynchronousUpdating -> False, TrackedSymbols :> {$CellContext`flag}},
      ImageSizeCache->{{3.242434784440018, 
       58.25756521556001}, {-34.93969739137761, 26.439697391377592`}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False,
    UnsavedVariables:>{$CellContext`flag}]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None,
  ImageSize->{50, 50}]], "Output",
 CellChangeTimes->{{3.801239568348304*^9, 3.801239576017556*^9}, 
   3.803895424915984*^9, 3.803897236335108*^9},
 CellLabel->
  "Out[183]=",ExpressionUUID->"ebf7f486-2ba9-4e8d-8b33-959424ed0d9e"]
}, Open  ]],

Cell["With special labels and geographic coordinates", "Text",
 CellChangeTimes->{{3.811280018603409*^9, 
  3.8112800266431637`*^9}},ExpressionUUID->"8a0fca8e-27f9-42f2-a422-\
e41c125e8565"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ShowPowerStructure", "[", 
  RowBox[{
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\"\<s\>\"", "\[Rule]", 
      RowBox[{"Table", "[", 
       RowBox[{"1.", ",", "8"}], "]"}]}], ",", 
     RowBox[{"\"\<T\>\"", "\[Rule]", 
      RowBox[{"NamedTNull", "[", "8", "]"}]}], ",", 
     RowBox[{"\"\<i\>\"", "\[Rule]", 
      RowBox[{"{", "}"}]}]}], "\[RightAssociation]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<size\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"200", ",", "200"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<labels\>\"", "\[Rule]", "True"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<names\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "\[Rule]", "\"\<SU\>\""}], ",", 
        RowBox[{"2", "\[Rule]", "\"\<GER\>\""}], ",", 
        RowBox[{"3", "\[Rule]", "\"\<BE\>\""}], ",", 
        RowBox[{"4", "\[Rule]", "\"\<ITL\>\""}], ",", 
        RowBox[{"5", "\[Rule]", "\"\<FRA\>\""}], ",", 
        RowBox[{"6", "\[Rule]", "\"\<US\>\""}], ",", 
        RowBox[{"7", "\[Rule]", "\"\<CHN\>\""}], ",", 
        RowBox[{"8", "\[Rule]", "\"\<JPN\>\""}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<circular\>\"", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<placement\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}]}], ",", 
        RowBox[{"2", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2"}], ",", 
           RowBox[{"-", "1"}]}], "}"}]}], ",", 
        RowBox[{"3", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3"}], ",", "1"}], "}"}]}], ",", 
        RowBox[{"4", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2"}], ",", 
           RowBox[{"-", "3"}]}], "}"}]}], ",", 
        RowBox[{"5", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "4"}], ",", 
           RowBox[{"-", "1"}]}], "}"}]}], ",", 
        RowBox[{"6", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "4"}], "}"}]}], ",", 
        RowBox[{"7", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"3", ",", 
           RowBox[{"-", "2"}]}], "}"}]}], ",", 
        RowBox[{"8", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"4", ",", "1"}], "}"}]}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "|>"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.811278163021839*^9, 3.811278193702395*^9}, {
   3.811278245408568*^9, 3.811278283688889*^9}, {3.8112784001073236`*^9, 
   3.811278400947825*^9}, {3.8112785679309673`*^9, 3.8112786129648542`*^9}, {
   3.811278757660933*^9, 3.811278761633181*^9}, {3.811278922008791*^9, 
   3.811278939563632*^9}, 3.811279022914708*^9, 3.811279076539558*^9, {
   3.8112793919637623`*^9, 3.8112794695831137`*^9}, {3.8112795065744047`*^9, 
   3.811279517307879*^9}, {3.811279588527897*^9, 3.811279629703576*^9}, {
   3.811279690570135*^9, 3.811279908475183*^9}, {3.811279939994664*^9, 
   3.811279976875708*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[408]:=",ExpressionUUID->"2d18a1b3-adaf-433a-b895-1622396c7aa5"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox[{{}, 
    {GrayLevel[0], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
     TagBox[{
       TagBox[
        {RGBColor[
         0.10363056783187007`, 0.14019632748605798`, 0.4524720405292116], 
         DiskBox[{1., 1.}, 0.3333333333333333]},
        "DynamicName",
        BoxID -> "VertexID$1"], InsetBox[
        StyleBox["\<\"SU\"\>",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontColor->GrayLevel[0]], 
        Offset[{2, 2}, DynamicLocation[
         "VertexID$1", Automatic, {Right, Top}]], ImageScaled[{0, 0}],
        BaseStyle->"Graphics"]},
      "DynamicName",
      BoxID -> "VertexLabelID$1"], 
     TagBox[{
       TagBox[
        {RGBColor[
         0.10363056783187007`, 0.14019632748605798`, 0.4524720405292116], 
         DiskBox[{-2., -1.}, 0.3333333333333333]},
        "DynamicName",
        BoxID -> "VertexID$2"], InsetBox[
        StyleBox["\<\"GER\"\>",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontColor->GrayLevel[0]], 
        Offset[{2, 2}, DynamicLocation[
         "VertexID$2", Automatic, {Right, Top}]], ImageScaled[{0, 0}],
        BaseStyle->"Graphics"]},
      "DynamicName",
      BoxID -> "VertexLabelID$2"], 
     TagBox[{
       TagBox[
        {RGBColor[
         0.10363056783187007`, 0.14019632748605798`, 0.4524720405292116], 
         DiskBox[{-3., 1.}, 0.3333333333333333]},
        "DynamicName",
        BoxID -> "VertexID$3"], InsetBox[
        StyleBox["\<\"BE\"\>",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontColor->GrayLevel[0]], 
        Offset[{2, 2}, DynamicLocation[
         "VertexID$3", Automatic, {Right, Top}]], ImageScaled[{0, 0}],
        BaseStyle->"Graphics"]},
      "DynamicName",
      BoxID -> "VertexLabelID$3"], 
     TagBox[{
       TagBox[
        {RGBColor[
         0.10363056783187007`, 0.14019632748605798`, 0.4524720405292116], 
         DiskBox[{-2., -3.}, 0.3333333333333333]},
        "DynamicName",
        BoxID -> "VertexID$4"], InsetBox[
        StyleBox["\<\"ITL\"\>",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontColor->GrayLevel[0]], 
        Offset[{2, 2}, DynamicLocation[
         "VertexID$4", Automatic, {Right, Top}]], ImageScaled[{0, 0}],
        BaseStyle->"Graphics"]},
      "DynamicName",
      BoxID -> "VertexLabelID$4"], 
     TagBox[{
       TagBox[
        {RGBColor[
         0.10363056783187007`, 0.14019632748605798`, 0.4524720405292116], 
         DiskBox[{-4., -1.}, 0.3333333333333333]},
        "DynamicName",
        BoxID -> "VertexID$5"], InsetBox[
        StyleBox["\<\"FRA\"\>",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontColor->GrayLevel[0]], 
        Offset[{2, 2}, DynamicLocation[
         "VertexID$5", Automatic, {Right, Top}]], ImageScaled[{0, 0}],
        BaseStyle->"Graphics"]},
      "DynamicName",
      BoxID -> "VertexLabelID$5"], 
     TagBox[{
       TagBox[
        {RGBColor[
         0.10363056783187007`, 0.14019632748605798`, 0.4524720405292116], 
         DiskBox[{-1., 4.}, 0.3333333333333333]},
        "DynamicName",
        BoxID -> "VertexID$6"], InsetBox[
        StyleBox["\<\"US\"\>",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontColor->GrayLevel[0]], 
        Offset[{2, 2}, DynamicLocation[
         "VertexID$6", Automatic, {Right, Top}]], ImageScaled[{0, 0}],
        BaseStyle->"Graphics"]},
      "DynamicName",
      BoxID -> "VertexLabelID$6"], 
     TagBox[{
       TagBox[
        {RGBColor[
         0.10363056783187007`, 0.14019632748605798`, 0.4524720405292116], 
         DiskBox[{3., -2.}, 0.3333333333333333]},
        "DynamicName",
        BoxID -> "VertexID$7"], InsetBox[
        StyleBox["\<\"CHN\"\>",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontColor->GrayLevel[0]], 
        Offset[{2, 2}, DynamicLocation[
         "VertexID$7", Automatic, {Right, Top}]], ImageScaled[{0, 0}],
        BaseStyle->"Graphics"]},
      "DynamicName",
      BoxID -> "VertexLabelID$7"], 
     TagBox[{
       TagBox[
        {RGBColor[
         0.10363056783187007`, 0.14019632748605798`, 0.4524720405292116], 
         DiskBox[{4., 1.}, 0.3333333333333333]},
        "DynamicName",
        BoxID -> "VertexID$8"], InsetBox[
        StyleBox["\<\"JPN\"\>",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontColor->GrayLevel[0]], 
        Offset[{2, 2}, DynamicLocation[
         "VertexID$8", Automatic, {Right, Top}]], ImageScaled[{0, 0}],
        BaseStyle->"Graphics"]},
      "DynamicName",
      BoxID -> "VertexLabelID$8"]}}],
  BaseStyle->GrayLevel[0],
  FormatType->TraditionalForm,
  FrameTicks->None,
  ImageMargins->0.,
  ImageSize->{200, 200}]], "Output",
 CellChangeTimes->{{3.811278758948608*^9, 3.811278761934065*^9}, {
   3.811278920161989*^9, 3.811278940164813*^9}, 3.811278982511251*^9, 
   3.8112790235404873`*^9, 3.811279077459457*^9, {3.811279388108636*^9, 
   3.811279396027688*^9}, {3.81127943377911*^9, 3.811279437693768*^9}, 
   3.811279471177217*^9, {3.811279507367098*^9, 3.811279517648553*^9}, {
   3.8112795957005663`*^9, 3.811279630074991*^9}, {3.8112797175014553`*^9, 
   3.8112798201951637`*^9}, 3.811279909041191*^9, {3.8112799418955173`*^9, 
   3.8112799776054773`*^9}},
 CellLabel->
  "Out[408]=",ExpressionUUID->"802d9096-37ff-4cb6-a8e1-15c5cf9aea71"]
}, Open  ]],

Cell["Unit tests:", "Text",
 CellChangeTimes->{{3.755085357688162*^9, 
  3.755085360162019*^9}},ExpressionUUID->"fabbcc12-af12-490c-b6e3-\
06b85aea0427"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"unitTests", "[", "\"\<ShowPowerStructure\>\"", "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"undirectedEdges", "[", 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0", "1", "1"},
           {"0", "0", 
            RowBox[{"-", "1"}]},
           {
            RowBox[{"-", "1"}], 
            RowBox[{"-", "1"}], "0"}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], "]"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"2", "\[UndirectedEdge]", "3"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TestID", "\[Rule]", "\"\<ShowPowerStructure1\>\""}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"undirectedEdges", "[", 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0", "1", 
            RowBox[{"-", "1"}]},
           {"0", "0", 
            RowBox[{"-", "1"}]},
           {
            RowBox[{"-", "1"}], 
            RowBox[{"-", "1"}], "0"}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], "]"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "\[UndirectedEdge]", "3"}], ",", 
         RowBox[{"2", "\[UndirectedEdge]", "3"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TestID", "\[Rule]", "\"\<ShowPowerStructure2\>\""}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"undirectedEdges", "[", 
        TagBox[
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {"0", "1", "0"},
            {"1", "0", 
             RowBox[{"-", "1"}]},
            {"0", 
             RowBox[{"-", "1"}], "0"}
           },
           
           GridBoxAlignment->{
            "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.7]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
         Function[BoxForm`e$, 
          MatrixForm[BoxForm`e$]]], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "\[UndirectedEdge]", "2"}], ",", 
         RowBox[{"1", "\[UndirectedEdge]", "3"}], ",", 
         RowBox[{"2", "\[UndirectedEdge]", "3"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TestID", "\[Rule]", "\"\<ShowPowerStructure3\>\""}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"undirectedEdges", "[", 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0", "0"},
           {"0", "0"}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], "]"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"1", "\[UndirectedEdge]", "2"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TestID", "\[Rule]", "\"\<ShowPowerStructure4\>\""}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"replaceDirectedEdges", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "\[DirectedEdge]", "2"}], ",", 
           RowBox[{"1", "\[DirectedEdge]", "3"}], ",", 
           RowBox[{"2", "\[DirectedEdge]", "3"}], ",", 
           RowBox[{"3", "\[DirectedEdge]", "1"}], ",", 
           RowBox[{"3", "\[DirectedEdge]", "2"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", "\[UndirectedEdge]", "3"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "\[DirectedEdge]", "2"}], ",", 
         RowBox[{"1", "\[DirectedEdge]", "3"}], ",", 
         RowBox[{"3", "\[DirectedEdge]", "1"}], ",", 
         RowBox[{"2", "\[UndirectedEdge]", "3"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TestID", "\[Rule]", "\"\<ShowPowerStructure5\>\""}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7550841330433683`*^9, 3.755084135437353*^9}, {
   3.7550841708582687`*^9, 3.755084177444426*^9}, {3.75508488110111*^9, 
   3.755084921944516*^9}, {3.755085004683037*^9, 3.755085019160364*^9}, {
   3.755085236775576*^9, 3.7550852605358467`*^9}, {3.755085299455575*^9, 
   3.7550853362271223`*^9}, 3.755085432033588*^9, {3.755085559417843*^9, 
   3.755085605499104*^9}, {3.755085657127652*^9, 3.755085684055829*^9}, {
   3.7550857227312603`*^9, 3.755085757850277*^9}, {3.755085791385973*^9, 
   3.755085806043363*^9}, {3.755085848538776*^9, 3.7550858726824923`*^9}, {
   3.755085921688486*^9, 3.755085975595923*^9}, {3.755086010930608*^9, 
   3.755086084763026*^9}, {3.7550861278999023`*^9, 3.755086145884115*^9}, {
   3.7550861893032513`*^9, 3.7550863415526657`*^9}, {3.755086381974959*^9, 
   3.755086392501211*^9}, {3.75508644659693*^9, 3.7550864513013277`*^9}, {
   3.75508649799314*^9, 3.7550865090662107`*^9}, {3.755086565163678*^9, 
   3.755086585445758*^9}, {3.755086655240406*^9, 3.755086701383586*^9}, {
   3.755086806299365*^9, 3.755086837717898*^9}, {3.755086948783966*^9, 
   3.755087022479724*^9}, {3.7550870816896*^9, 3.755087134007586*^9}, {
   3.755087422831038*^9, 3.755087427098736*^9}, {3.755087460919154*^9, 
   3.755087557692718*^9}, {3.755087590425846*^9, 3.755087598858591*^9}, {
   3.755089604075595*^9, 3.7550897179572697`*^9}, {3.755089810711412*^9, 
   3.755089819467078*^9}},
 Background->RGBColor[0.94, 0.91, 0.88],
 CellLabel->
  "In[154]:=",ExpressionUUID->"4c379d5c-804c-41c8-88fa-2fee59e10c58"]
}, Closed]],

Cell[CellGroupData[{

Cell["AddFrame", "Subsubsection",
 CellChangeTimes->{{3.76667298695149*^9, 
  3.766672988803884*^9}},ExpressionUUID->"d60cca53-b090-46d9-b7a1-\
58015253484b"],

Cell[TextData[{
 "Adds a frame of a given size around a ",
 StyleBox["Graph", "Input"],
 " object."
}], "Text",
 CellChangeTimes->{{3.766673095626069*^9, 
  3.7666731065782747`*^9}},ExpressionUUID->"37d03a58-be64-4643-88ca-\
4027f9f1f6de"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AddFrame", "[", 
   RowBox[{"graph_", ",", " ", "size_"}], "]"}], ":=", 
  RowBox[{"AddFrame", "[", 
   RowBox[{"graph", ",", " ", 
    RowBox[{"{", 
     RowBox[{"size", ",", "size"}], "}"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.766672421805271*^9, 3.766672429657277*^9}, {
  3.7666730243876266`*^9, 3.766673048570778*^9}, {3.766675794863727*^9, 
  3.7666758954528418`*^9}, {3.773686795139645*^9, 3.7736868035156803`*^9}, {
  3.7770607092771683`*^9, 3.777060709802977*^9}},
 CellLabel->
  "In[155]:=",ExpressionUUID->"3ccffaad-fa8f-4843-9ed1-fbbf1595571a"],

Cell["Same, but where x and y vary.", "Text",
 CellChangeTimes->{{3.773686720439234*^9, 
  3.773686727336561*^9}},ExpressionUUID->"be054b80-586f-47f8-90ac-\
dec24d866727"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AddFrame", "[", 
   RowBox[{"graph_", ",", " ", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Framed", "[", 
   RowBox[{
    RowBox[{"Show", "[", 
     RowBox[{"graph", ",", 
      RowBox[{"ImageSize", "->", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}]}]}], "]"}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Thickness", "[", "1", "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.766672421805271*^9, 3.766672429657277*^9}, {
  3.7666730243876266`*^9, 3.766673048570778*^9}, {3.766675794863727*^9, 
  3.7666758954528418`*^9}, {3.773686736936957*^9, 3.773686744537334*^9}},
 CellLabel->
  "In[156]:=",ExpressionUUID->"2adb373b-c672-4ba6-9cca-2baf14fb4a46"]
}, Closed]],

Cell[CellGroupData[{

Cell["AddCaption", "Subsubsection",
 CellChangeTimes->{{3.76667669213415*^9, 
  3.766676693450122*^9}},ExpressionUUID->"90bcb38f-70cf-4be8-8449-\
83acfeb82181"],

Cell["Adds a caption below an image.", "Text",
 CellChangeTimes->{{3.76667669755908*^9, 3.766676705026216*^9}, 
   3.8054925905959463`*^9},ExpressionUUID->"dd14fea3-10d2-4f88-8f22-\
63ecae2ad7e9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AddCaption", "[", 
   RowBox[{"img_", ",", "text_"}], "]"}], ":=", 
  RowBox[{"Column", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"img", ",", 
      RowBox[{"Caption", "[", "text", "]"}]}], "}"}], ",", 
    RowBox[{"Alignment", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "Center", "}"}], ",", 
       RowBox[{"{", "Center", "}"}]}], "}"}]}], ",", 
    RowBox[{"Spacings", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", ".75"}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.766675972211932*^9, 3.7666760235752373`*^9}, {
   3.766676066906213*^9, 3.7666760911008577`*^9}, {3.805280365702148*^9, 
   3.805280387591859*^9}, {3.8052804368779707`*^9, 3.805280462909152*^9}, {
   3.805280518269538*^9, 3.805280666172447*^9}, {3.805280812370611*^9, 
   3.80528081724537*^9}, {3.805281319414123*^9, 3.8052813201999197`*^9}, 
   3.8052813623347187`*^9},
 CellLabel->
  "In[157]:=",ExpressionUUID->"38c42cc5-ebb6-4f45-81b1-ee54244f5309"],

Cell["Formats text in a preset style.", "Text",
 CellChangeTimes->{{3.805492556181006*^9, 
  3.805492588423753*^9}},ExpressionUUID->"fda0b89a-c41a-4f2b-8589-\
c01579ad2775"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Caption", "[", "text_", "]"}], ":=", 
  RowBox[{"Text", "[", 
   RowBox[{"Style", "[", 
    RowBox[{"text", ",", "11", ",", 
     RowBox[{"FontFamily", "\[Rule]", " ", "\"\<Source Serif Pro\>\""}]}], 
    "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.805280779817066*^9, 3.8052807978936167`*^9}},
 CellLabel->
  "In[158]:=",ExpressionUUID->"98af0ad6-1629-4ef6-b0dc-1c5f6f93cdd5"]
}, Closed]],

Cell[CellGroupData[{

Cell["SpacedRow", "Subsubsection",
 CellChangeTimes->{{3.766672920756475*^9, 
  3.7666729231063223`*^9}},ExpressionUUID->"d9f91487-718a-40ef-8036-\
79d7911e4c94"],

Cell["Display a list of images in a spaced row.", "Text",
 CellChangeTimes->{{3.7666730817640753`*^9, 
  3.766673092271719*^9}},ExpressionUUID->"20bf1fd8-5359-4564-8b6c-\
4d34171bc9fc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SpacedRow", "[", 
   RowBox[{"content_List", ",", " ", "spacing_"}], "]"}], ":=", " ", 
  RowBox[{"Row", "[", 
   RowBox[{"Riffle", "[", 
    RowBox[{"content", ",", 
     RowBox[{"Spacer", "[", "spacing", "]"}]}], "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.76667272670459*^9, 3.766672738913701*^9}, {
  3.766672800310781*^9, 3.766672842822378*^9}, {3.766673063230494*^9, 
  3.766673068521143*^9}},
 CellLabel->
  "In[159]:=",ExpressionUUID->"8ec8f4e2-cfa8-468d-a986-5742140e8b4d"]
}, Closed]],

Cell[CellGroupData[{

Cell["SizePlot", "Subsubsection",
 CellChangeTimes->{{3.706129941954547*^9, 3.7061299442945466`*^9}, {
  3.754948422396337*^9, 
  3.7549484227773733`*^9}},ExpressionUUID->"40ffe6ae-a766-46ed-b5a1-\
e44b3f704714"],

Cell["\<\
Generates a line plot indicating how each agent\[CloseCurlyQuote]s power \
changes over time. Output: line plot.\
\>", "Text",
 CellChangeTimes->{{3.7558009585212307`*^9, 
  3.755800978506811*^9}},ExpressionUUID->"e64ebea9-de97-4030-bc9b-\
963784dec83f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SizePlot", "[", "sim_List", "]"}], " ", ":=", " ", 
  RowBox[{"ListLinePlot", "[", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{"#s", "&"}], ",", "sim"}], "]"}], "]"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "All"}], "}"}], ",", "All"}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"150", ",", "100"}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8042425743007812`*^9, 3.804242578072294*^9}, {
   3.804242676713188*^9, 3.8042426783043003`*^9}, {3.8042427623694563`*^9, 
   3.804242771209951*^9}, {3.8051463588562403`*^9, 3.805146362089016*^9}, {
   3.805146394190875*^9, 3.805146420537184*^9}, 3.805146475980268*^9},
 CellLabel->
  "In[160]:=",ExpressionUUID->"f44766c6-eb0f-433d-bf4b-ac5ddc0925a1"],

Cell["A version that hides the ", "Text",
 CellChangeTimes->{{3.80428924231476*^9, 
  3.804289247492668*^9}},ExpressionUUID->"b5c6486a-4dd6-4d68-a572-\
17c548dbf766"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SizePlotQuiet", "[", "sim_List", "]"}], " ", ":=", " ", 
  RowBox[{"ListLinePlot", "[", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{"#s", "&"}], ",", "sim"}], "]"}], "]"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "All"}], "}"}], ",", "All"}], "}"}]}], ",", 
    RowBox[{"Ticks", "\[Rule]", "None"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"120", ",", "80"}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8042425743007812`*^9, 3.804242578072294*^9}, {
  3.804242676713188*^9, 3.8042426783043003`*^9}, {3.8042427623694563`*^9, 
  3.804242771209951*^9}, {3.804289232852249*^9, 3.8042892578113947`*^9}, {
  3.8042894588591127`*^9, 3.804289460997259*^9}, {3.80514649667482*^9, 
  3.805146508230411*^9}},
 CellLabel->
  "In[161]:=",ExpressionUUID->"ccefcca1-53fe-4673-8408-f4c24956614e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SetParameters", "[", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\"\<\[Beta]\>\"", "\[Rule]", "2"}], ",", 
     RowBox[{"\"\<\[Mu]\>\"", "\[Rule]", "3"}], ",", 
     RowBox[{"\"\<\[Lambda]\>\"", "\[Rule]", "1"}], ",", 
     RowBox[{"\"\<\[Rho]\>\"", "\[Rule]", "0.9"}], ",", 
     RowBox[{"\"\<\[Delta]\>\"", "\[Rule]", "0.85"}]}], 
    "\[RightAssociation]"}], "]"}], ";", 
  RowBox[{"SizePlot", "[", 
   RowBox[{"SimulateLawOfMotion", "[", 
    RowBox[{"RandomPowerStructure", "[", "5", "]"}], "]"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.7061300938130465`*^9, 3.7061300996080465`*^9}, {
  3.754947975748362*^9, 3.754947982540061*^9}, {3.8042891555455313`*^9, 
  3.804289196851474*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[173]:=",ExpressionUUID->"e98f4ecb-aac0-4f7c-b2b8-c50c7177f865"],

Cell[BoxData[
 GraphicsBox[{{}, {{{}, {}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
       NCache[
        Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQEf7Iuefju09tNVe6iAQ7ZVwZZAZxifw+HoFtbw
ibOuQPkCDuev8Vtq/bgM5Ys43Elh33gnGsaXcOAtPbYv++glKF/GYdoG5Xdz
TGB8BYeNCTesLFZehPKVHE5NXPSVXRnGV3FwcJi66sbCC1C+moOwcidHpSqM
r+Hg3eo0uTj6PJSv5ZBuuc7ydsk5KF/HYbErq+KlaWehfD2HrrNLf7McPAPl
GzgITIh8pfz5NJRv6HD6/qmwRzowvpHDuT1zz3/LPQXlGzsEF0s9k9p2Eso3
cfiyr15emOWkPQCiAFxm
       "]]}, 
     {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
       NCache[
        Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQEf7L/psSV2C9+2hwo4NF3n1tr39QaUz+Gg/r66
JfrNNShfwGFPCHPqnG9XoHwRB5XFAj0HhS9D+RIOn7+sMRV2vgjlyzhUr3OY
eZD9PJSv4HDnf40j4+rTUL6Sw6x9xQ7z805A+SoOl/R2qicFHoXy1Rw4ewX2
yAQdgvI1HAqnVH+Mur8PytdyWP3pgf6fwJ1Qvo5D0WklB7Zfm6F8PYdZBb+u
vV21Fso3cJiyiP/k/iOLoXxDh6XR/z9Nr54C5Rs5zPjx25NHIxHKN3ZgQAEm
cD4AdKhUBw==
       "]]}, 
     {RGBColor[0.560181, 0.691569, 0.194885], PointSize[
       NCache[
        Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQEf7FFpBodwmxVbHq54B+VzOPiemnztR8xbKF/A
wc69L+OO9BsoX8ThYoVIpPrTV1C+hMPphUuiK3a8hPJlHJoUpx8unPoCyldw
uJGbn7Cz+jmUr+RgoDgt+kfWMyhfxcGwIlf8dtJTKF/NYa3ZJn7B5CdQvobD
vXrp3T7Zj6F8LYdre3TynKsfQfk6DlNMdO3XTnoI5es5MNdYvnbZ+ADKN3C4
fuhYRf/a+1C+ocPfu6sevmK9B+UbOfxWve+qkH0Hyjd2SLmyNGXHnVtQvolD
8M3LFQrRN+0BWzxbcQ==
       "]]}, 
     {RGBColor[0.922526, 0.385626, 0.209179], PointSize[
       NCache[
        Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQEf7NekZKVqXN5kDxVwiL+cwrDWFMbncDBprp/C
PXsjlC/gwGxx+H8oM4wv4vArUGrm7LwNUL6Eg8WBSTsv7VwP5cs4nDc+oDNl
zjooX8HhsFKnQG/rWihfyUGv/qPi6ZI1UL6KQ9mzwjkRWauhfDUHLleFGpu0
VVC+hsO56N+7qzJWQvlaDkH1vRNECldA+ToOhh4S8zkalkP5eg4KORWGwVOX
QfkGDrrT3qW927AUyjd02H3xe+KlS0ugfCOHU19ii7/+WgzlGzvoZS1z8tGE
8U0c8lw0LFJSF9kDAGyXVWI=
       "]]}, 
     {RGBColor[0.528488, 0.470624, 0.701351], PointSize[
       NCache[
        Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAQAWIQDQEf7L8npNoanXtpDxVwKA/5Gfbm3Qson8Ph7dkv
Ue/EYXwBh99nv0x46fEcyhdxcN623WFS4zMoX8JhwwS5KfMPPoXyZRxmbkis
Os0B4ys4PBPN6bkU9gTKV3IIbQz8VLz6MZSv4iC+6rJnIRuMr+awueF1b1/6
Iyhfw6Hioff/ieceQvlaDppdl3ldrGF8HQf5yU+c8tc+gPL1HL4Lz9B5oALj
Gzhw/++cfMrpPpRv6PDWefHbua73oHwjh/18/dvuBd6F8o0ddl5w3mCSfgfK
N3Go//2wa3rLbXsA2IBi7Q==
       "]]}}, {
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
       NCache[
        Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[1.6]}, 
     {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
       NCache[
        Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[1.6]}, 
     {RGBColor[0.560181, 0.691569, 0.194885], PointSize[
       NCache[
        Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[1.6]}, 
     {RGBColor[0.922526, 0.385626, 0.209179], PointSize[
       NCache[
        Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[1.6]}, 
     {RGBColor[0.528488, 0.470624, 0.701351], PointSize[
       NCache[
        Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[1.6]}}, {
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
       NCache[
        Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[1.6]}, 
     {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
       NCache[
        Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[1.6]}, 
     {RGBColor[0.560181, 0.691569, 0.194885], PointSize[
       NCache[
        Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[1.6]}, 
     {RGBColor[0.922526, 0.385626, 0.209179], PointSize[
       NCache[
        Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[1.6]}, 
     {RGBColor[0.528488, 0.470624, 0.701351], PointSize[
       NCache[
        Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[
      1.6]}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}, {}}, {
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
       NCache[
        Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[1.6]}, 
     {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
       NCache[
        Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[1.6]}, 
     {RGBColor[0.560181, 0.691569, 0.194885], PointSize[
       NCache[
        Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[1.6]}, 
     {RGBColor[0.922526, 0.385626, 0.209179], PointSize[
       NCache[
        Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[1.6]}, 
     {RGBColor[0.528488, 0.470624, 0.701351], PointSize[
       NCache[
        Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[
      1.6]}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}, {}}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{1., 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->Small,
  Method->{
   "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{1, 20.}, {0, 1.}},
  PlotRangeClipping->True,
  PlotRangePadding->{{0, 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.7061301000255466`*^9, 3.7061301388825464`*^9, 3.7061304831795464`*^9, {
   3.7061305310245466`*^9, 3.706130543114547*^9}, 3.706195243352346*^9, 
   3.754947983666258*^9, {3.7549482430704412`*^9, 3.7549482766001883`*^9}, {
   3.75494831586065*^9, 3.7549483204978437`*^9}, {3.8042891682481956`*^9, 
   3.8042892078645782`*^9}, {3.805146356049556*^9, 3.805146364453855*^9}},
 CellLabel->
  "Out[173]=",ExpressionUUID->"81503947-6aaa-4eda-b294-f27f73da222b"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["GenerateReel", "Subsubsection",
 CellChangeTimes->{{3.754946904303904*^9, 
  3.754946906011847*^9}},ExpressionUUID->"482366d9-1a7e-4159-8bcf-\
d37d4bf6b4a4"],

Cell["\<\
Generates a sequence of power structure graph plots (a \
\[OpenCurlyDoubleQuote]reel\[CloseCurlyDoubleQuote]) from a simulation. \
Output: list of graph plots.\
\>", "Text",
 CellChangeTimes->{{3.677765929956317*^9, 3.6777659459248247`*^9}, {
  3.754946912917356*^9, 3.754946938667425*^9}, {3.754947025914481*^9, 
  3.7549470277258863`*^9}, {3.755800889319792*^9, 
  3.75580090109245*^9}},ExpressionUUID->"8227010e-03c5-4a9b-9d03-\
8e413cd42ba4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GenerateReel", "[", "simulation_List", "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{"ShowPowerStructure", ",", "simulation"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.704572060476878*^9, 3.7045721089192467`*^9}, {
   3.704573255093194*^9, 3.7045732563982*^9}, {3.704573291255951*^9, 
   3.704573296261888*^9}, {3.704573338325326*^9, 3.704573339595928*^9}, {
   3.704574759310091*^9, 3.7045747731586037`*^9}, {3.711307530505899*^9, 
   3.71130755977811*^9}, {3.716919191722575*^9, 3.71691922478421*^9}, 
   3.71691931819731*^9, {3.754946026007585*^9, 3.7549460308063803`*^9}, {
   3.754946066588772*^9, 3.754946089916774*^9}, 3.7549461643259573`*^9, {
   3.7549464108897676`*^9, 3.7549464157363653`*^9}, 3.754946960876568*^9},
 CellLabel->
  "In[162]:=",ExpressionUUID->"a0ed32e9-ea2d-4e18-8d00-64c52262ce7e"],

Cell[TextData[{
 "Same as above, but accepts options for ",
 StyleBox["ShowPowerStructure", "Input"],
 "."
}], "Text",
 CellChangeTimes->{{3.755800905135366*^9, 
  3.755800915035771*^9}},ExpressionUUID->"5458be1a-dd64-4d96-b7e3-\
185dab8143a5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GenerateReel", "[", 
   RowBox[{"simulation_List", ",", "options_Association"}], "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ShowPowerStructure", "[", 
      RowBox[{"#", ",", "options"}], "]"}], "&"}], ",", "simulation"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.704572060476878*^9, 3.7045721089192467`*^9}, {
   3.704573255093194*^9, 3.7045732563982*^9}, {3.704573291255951*^9, 
   3.704573296261888*^9}, {3.704573338325326*^9, 3.704573339595928*^9}, {
   3.704574759310091*^9, 3.7045747731586037`*^9}, {3.711307530505899*^9, 
   3.71130755977811*^9}, {3.716919191722575*^9, 3.71691922478421*^9}, 
   3.71691931819731*^9, {3.718228703640457*^9, 3.7182287129349747`*^9}, {
   3.754946382096737*^9, 3.754946422942123*^9}, 3.754946962210388*^9},
 CellLabel->
  "In[163]:=",ExpressionUUID->"6ad15519-e0f5-4f6b-b370-b42ad3add185"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Monte Carlo", "Subsection",
 CellChangeTimes->{{3.819317362555191*^9, 
  3.819317366511963*^9}},ExpressionUUID->"aee25611-6cbe-48af-af7b-\
f851340ae2fb"],

Cell[CellGroupData[{

Cell["ShowMonteCarloSimulation", "Subsubsection",
 CellChangeTimes->{{3.818679183763586*^9, 3.818679187513908*^9}, {
  3.819316735014551*^9, 
  3.819316739416318*^9}},ExpressionUUID->"dd219331-6e8b-4c28-bcaf-\
a49a52e4eb39"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ShowMonteCarloSimulation", "[", "sim_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"actors", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "0", "}"}], ",", 
        RowBox[{"mctsSimulationActors", "[", "sim", "]"}]}], "]"}]}], "}"}], 
    ",", 
    RowBox[{"SpacedRow", "[", 
     RowBox[{
      RowBox[{"MapIndexed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"AddCaption", "[", 
          RowBox[{
           RowBox[{"ShowPowerStructure", "[", 
            RowBox[{"#", ",", 
             RowBox[{"<|", 
              RowBox[{
               RowBox[{"\"\<circular\>\"", "\[Rule]", "True"}], ",", 
               RowBox[{"\"\<focal\>\"", "\[Rule]", 
                RowBox[{"actors", "[", 
                 RowBox[{"[", 
                  RowBox[{"First", "[", "#2", "]"}], "]"}], "]"}]}]}], 
              "|>"}]}], "]"}], ",", 
           RowBox[{"\"\<t=\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{
              RowBox[{"First", "[", "#2", "]"}], "-", "1"}], "]"}]}]}], "]"}],
          "&"}], ",", "sim"}], "]"}], ",", "20"}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8186832931356773`*^9, 3.818683326620508*^9}, {
   3.818783071044503*^9, 3.818783124777341*^9}, {3.8187831938953667`*^9, 
   3.818783201843532*^9}, {3.818783312557927*^9, 3.8187833139495497`*^9}, 
   3.8193167455815163`*^9},
 CellLabel->
  "In[164]:=",ExpressionUUID->"84e7ab77-99a0-4351-af3a-7d982c46c1ea"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SetParameters", "[", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\"\<\[Beta]\>\"", "\[Rule]", "1.25"}], ",", 
     RowBox[{"\"\<\[Mu]\>\"", "\[Rule]", "3"}], ",", 
     RowBox[{"\"\<\[Lambda]\>\"", "\[Rule]", ".99"}], ",", 
     RowBox[{"\"\<\[Alpha]\>\"", "\[Rule]", "2.05"}], ",", 
     RowBox[{"\"\<\[Delta]\>\"", "\[Rule]", "0.3"}], ",", 
     RowBox[{"\"\<\[Rho]\>\"", "\[Rule]", "0.98"}], ",", 
     RowBox[{"\"\<k\>\"", "\[Rule]", "10"}]}], "\[RightAssociation]"}], "]"}],
   ";", 
  RowBox[{"ShowMonteCarloSimulation", "[", 
   RowBox[{"MonteCarloSimulate", "[", 
    RowBox[{"ps", ",", "3", ",", "100", ",", "5"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.81868333445433*^9, 3.818683349431551*^9}, {
   3.818683483613433*^9, 3.8186834836889963`*^9}, {3.81868354292273*^9, 
   3.818683580772607*^9}, {3.818683693989399*^9, 3.818683701022654*^9}, 
   3.818683825040756*^9, 3.81868394822449*^9, {3.818684182189114*^9, 
   3.818684194853655*^9}, 3.818684371052549*^9, 3.8186880192954493`*^9, 
   3.8186884388635693`*^9, 3.8186887411904287`*^9, {3.8186889228704977`*^9, 
   3.81868892348106*^9}, 3.8186890385104113`*^9, 3.818689188390029*^9, 
   3.818689275417015*^9, {3.81868940409584*^9, 3.8186894085021677`*^9}, 
   3.81868947072538*^9, {3.8186896817825117`*^9, 3.818689682600852*^9}, {
   3.818689733844355*^9, 3.818689734551016*^9}, {3.818689892070883*^9, 
   3.818689904735715*^9}, {3.818689963858365*^9, 3.818689966833447*^9}, 
   3.8186902479370003`*^9, 3.818690376335*^9, {3.8186904485352793`*^9, 
   3.8186904521594543`*^9}, 3.818690493667144*^9, 3.8186905504636707`*^9, 
   3.81869059394105*^9, {3.818690631723946*^9, 3.81869063226818*^9}, {
   3.81869066991511*^9, 3.818690672597866*^9}, {3.818690752706779*^9, 
   3.818690767546369*^9}, {3.8186909166254587`*^9, 3.818690920672185*^9}, {
   3.818691047608547*^9, 3.818691051158503*^9}, 3.8186911512487717`*^9, {
   3.818691242282091*^9, 3.818691246638377*^9}, 3.818691607105691*^9, {
   3.818699862882391*^9, 3.818699866576395*^9}, 3.818783100266974*^9, 
   3.8193167516639442`*^9, {3.8204163928468943`*^9, 3.820416394302894*^9}},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[465]:=",ExpressionUUID->"1e889093-0e8c-4001-a87f-4820b61f839f"],

Cell[BoxData[
 TemplateBox[{
   TagBox[
    GridBox[{{
       TagBox[
        TooltipBox[
         GraphicsBox[
          NamespaceBox[{{
             Directive[
              Opacity[0.7], 
              Hue[0.6, 0.7, 0.5]], 
             Directive[
              GrayLevel[0]], 
             LineBox[{{
                DynamicLocation["VertexID$1", Automatic, Center], 
                DynamicLocation["VertexID$2", Automatic, Center]}, {
                DynamicLocation["VertexID$1", Automatic, Center], 
                DynamicLocation["VertexID$3", Automatic, Center]}, {
                DynamicLocation["VertexID$2", Automatic, Center], 
                DynamicLocation["VertexID$3", Automatic, Center]}}]}, {
             Directive[
              Hue[0.6, 0.2, 0.8], 
              EdgeForm[
               Directive[
                GrayLevel[0], 
                Opacity[0.7]]]], 
             Directive[
              GrayLevel[0]], 
             TagBox[
              StyleBox[
               DiskBox[{-1., 0.}, 0.28867513459481287`], {
                RGBColor[
                0.09033045527057296, 0.38066592927668996`, 
                 0.5277010316634796]}, StripOnInput -> False], "DynamicName", 
              BoxID -> "VertexID$1"], 
             TagBox[
              StyleBox[
               DiskBox[{0.5, 0.8660254037844386}, 0.20412414523193148`], {
                RGBColor[
                0.1076316251085862, 0.1117836270428279, 
                 0.44072992247616743`]}, StripOnInput -> False], 
              "DynamicName", BoxID -> "VertexID$2"], 
             TagBox[
              StyleBox[
               DiskBox[{0.5, -0.8660254037844386}, 0.20412414523193148`], {
                RGBColor[
                0.1076316251085862, 0.1117836270428279, 
                 0.44072992247616743`]}, StripOnInput -> False], 
              "DynamicName", BoxID -> "VertexID$3"]}}], {
          ImageSize -> 36, BaseStyle -> GrayLevel[0], FormatType -> 
           TraditionalForm, FrameTicks -> None}], 
         RowBox[{"\[LeftAssociation]", 
           RowBox[{
             RowBox[{"\"s\"", "\[Rule]", 
               TagBox[
                RowBox[{"(", "\[NoBreak]", 
                  TagBox[
                   
                   GridBox[{{"1.`"}, {"0.5`"}, {"0.5`"}}, ColumnAlignments -> 
                    Center, RowSpacings -> 1, ColumnAlignments -> Left], 
                   Column], "\[NoBreak]", ")"}], 
                Function[BoxForm`e$, 
                 MatrixForm[BoxForm`e$]]]}], ",", 
             RowBox[{"\"T\"", "\[Rule]", 
               TagBox[
                RowBox[{"(", "\[NoBreak]", 
                  
                  GridBox[{{"0.98`", "0.01`", "0.01`"}, {
                    "0.01`", "0.98`", "0.01`"}, {"0.01`", "0.01`", "0.98`"}}, 
                   RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> 
                   Baseline, ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
                Function[BoxForm`e$, 
                 MatrixForm[BoxForm`e$]]]}]}], "\[RightAssociation]"}]], 
        Annotation[#, 
         Association[
         "s" -> MatrixForm[{1., 0.5, 0.5}], "T" -> 
          MatrixForm[{{0.98, 0.01, 0.01}, {0.01, 0.98, 0.01}, {0.01, 0.01, 
            0.98}}]], "Tooltip"]& ]}, {
       InterpretationBox[
        Cell[
         BoxData[
          FormBox[
           StyleBox[
           "\"t=0\"", 11, FontFamily -> "Source Serif Pro", StripOnInput -> 
            False], TextForm]], "InlineText"], 
        Text[
         Style["t=0", 11, FontFamily -> "Source Serif Pro"]]]}}, 
     GridBoxAlignment -> {"Columns" -> {Center}, "Rows" -> {Center}}, 
     DefaultBaseStyle -> "Column", 
     GridBoxItemSize -> {"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
      GridBoxSpacings -> {"Columns" -> {{0}}, "Rows" -> {{0.75}}}], "Column"], 
   TemplateBox[{20}, "Spacer1"], 
   TagBox[
    GridBox[{{
       TagBox[
        TooltipBox[
         GraphicsBox[
          NamespaceBox[{{
             Directive[
              Opacity[0.7], 
              Hue[0.6, 0.7, 0.5]], 
             Directive[
              GrayLevel[0]], 
             LineBox[{
               DynamicLocation["VertexID$1", Automatic, Center], 
               DynamicLocation["VertexID$2", Automatic, Center]}], 
             StyleBox[
              LineBox[{
                DynamicLocation["VertexID$1", Automatic, Center], 
                DynamicLocation["VertexID$3", Automatic, Center]}], {{
                Dashing[{Small, Small}]}}, StripOnInput -> False]}, {
             Directive[
              Hue[0.6, 0.2, 0.8], 
              EdgeForm[
               Directive[
                GrayLevel[0], 
                Opacity[0.7]]]], 
             Directive[
              GrayLevel[0]], 
             TagBox[
              StyleBox[
               DiskBox[{-1., 0.}, 0.28867513459481287`], {
                Directive[
                 RGBColor[
                 0.09074477550390196, 0.38727083860647404`, 
                  0.5288516843971414], 
                 EdgeForm[{
                   Thickness[Large], 
                   RGBColor[1, 0, 0]}]]}, StripOnInput -> False], 
              "DynamicName", BoxID -> "VertexID$1"], 
             TagBox[
              StyleBox[
               DiskBox[{0.5, 0.8660254037844386}, 0.20862746459812076`], {
                Directive[
                 RGBColor[
                 0.10522329666520103`, 0.12888588524568353`, 
                  0.44779777353076233`], 
                 EdgeForm[{
                   Thickness[Large], 
                   RGBColor[1, 0, 0]}]]}, StripOnInput -> False], 
              "DynamicName", BoxID -> "VertexID$2"], 
             TagBox[
              StyleBox[
               DiskBox[{0.5, -0.8660254037844386}, 0.19951920796929096`], {
                Directive[
                 RGBColor[
                 0.11134923243692263`, 0.0853837891799036, 
                  0.42981966023667856`], 
                 EdgeForm[{
                   Thickness[Large], 
                   RGBColor[1, 0, 0]}]]}, StripOnInput -> False], 
              "DynamicName", BoxID -> "VertexID$3"]}}], {
          ImageSize -> 36, BaseStyle -> GrayLevel[0], FormatType -> 
           TraditionalForm, FrameTicks -> None}], 
         RowBox[{"\[LeftAssociation]", 
           RowBox[{
             RowBox[{"\"s\"", "\[Rule]", 
               TagBox[
                RowBox[{"(", "\[NoBreak]", 
                  TagBox[
                   
                   GridBox[{{"1.`"}, {"0.522`"}, {"0.47800000000000004`"}}, 
                    ColumnAlignments -> Center, RowSpacings -> 1, 
                    ColumnAlignments -> Left], Column], "\[NoBreak]", ")"}], 
                Function[BoxForm`e$, 
                 MatrixForm[BoxForm`e$]]]}], ",", 
             RowBox[{"\"T\"", "\[Rule]", 
               TagBox[
                RowBox[{"(", "\[NoBreak]", 
                  GridBox[{{"0.98`", "0.02`", 
                    RowBox[{"-", "0.02`"}]}, {"0.01`", "0.98`", "0.`"}, {
                    RowBox[{"-", "0.01`"}], "0.`", "0.98`"}}, RowSpacings -> 
                   1, ColumnSpacings -> 1, RowAlignments -> Baseline, 
                   ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
                Function[BoxForm`e$, 
                 MatrixForm[BoxForm`e$]]]}], ",", 
             RowBox[{"\"M\"", "\[Rule]", 
               TagBox[
                RowBox[{"(", "\[NoBreak]", 
                  GridBox[{{"0", "1", "1"}, {"1", "0", "0"}, {
                    RowBox[{"-", "1"}], "0", "0"}}, RowSpacings -> 1, 
                   ColumnSpacings -> 1, RowAlignments -> Baseline, 
                   ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
                Function[BoxForm`e$, 
                 MatrixForm[BoxForm`e$]]]}]}], "\[RightAssociation]"}]], 
        Annotation[#, 
         Association[
         "s" -> MatrixForm[{1., 0.522, 0.47800000000000004`}], "T" -> 
          MatrixForm[{{0.98, 0.02, -0.02}, {0.01, 0.98, 0.}, {-0.01, 0., 
            0.98}}], "M" -> MatrixForm[{{0, 1, 1}, {1, 0, 0}, {-1, 0, 0}}]], 
         "Tooltip"]& ]}, {
       InterpretationBox[
        Cell[
         BoxData[
          FormBox[
           StyleBox[
           "\"t=1\"", 11, FontFamily -> "Source Serif Pro", StripOnInput -> 
            False], TextForm]], "InlineText"], 
        Text[
         Style["t=1", 11, FontFamily -> "Source Serif Pro"]]]}}, 
     GridBoxAlignment -> {"Columns" -> {Center}, "Rows" -> {Center}}, 
     DefaultBaseStyle -> "Column", 
     GridBoxItemSize -> {"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
      GridBoxSpacings -> {"Columns" -> {{0}}, "Rows" -> {{0.75}}}], "Column"], 
   TemplateBox[{20}, "Spacer1"], 
   TagBox[
    GridBox[{{
       TagBox[
        TooltipBox[
         GraphicsBox[
          NamespaceBox[{{
             Directive[
              Opacity[0.7], 
              Hue[0.6, 0.7, 0.5]], 
             Directive[
              GrayLevel[0]], 
             StyleBox[
              LineBox[{
                DynamicLocation["VertexID$1", Automatic, Center], 
                DynamicLocation["VertexID$3", Automatic, Center]}], {{
                Dashing[{Small, Small}]}}, StripOnInput -> False]}, {
             Directive[
              Hue[0.6, 0.2, 0.8], 
              EdgeForm[
               Directive[
                GrayLevel[0], 
                Opacity[0.7]]]], 
             Directive[
              GrayLevel[0]], 
             TagBox[
              StyleBox[
               DiskBox[{-1., 0.}, 0.28867513459481287`], {
                Directive[
                 RGBColor[
                 0.09117036409506757, 0.39405538309722593`, 
                  0.530033631684401], 
                 EdgeForm[{
                   Thickness[Large], 
                   RGBColor[1, 0, 0]}]]}, StripOnInput -> False], 
              "DynamicName", BoxID -> "VertexID$1"], 
             TagBox[
              StyleBox[
               DiskBox[{0.5, 0.8660254037844386}, 0.21392920715461855`], {
                Directive[
                 RGBColor[
                 0.10263385388036644`, 0.14727429037763234`, 
                  0.45539715058744035`], 
                 EdgeForm[{
                   Thickness[Large], 
                   RGBColor[1, 0, 0]}]]}, StripOnInput -> False], 
              "DynamicName", BoxID -> "VertexID$2"], 
             TagBox[
              StyleBox[
               DiskBox[{0.5, -0.8660254037844386}, 0.18896894623524796`], {
                RGBColor[
                0.1151220301674465, 0.05859202781870319, 0.4187474277545612]},
                StripOnInput -> False], "DynamicName", BoxID -> 
              "VertexID$3"]}}], {
          ImageSize -> 36, BaseStyle -> GrayLevel[0], FormatType -> 
           TraditionalForm, FrameTicks -> None}], 
         RowBox[{"\[LeftAssociation]", 
           RowBox[{
             RowBox[{"\"s\"", "\[Rule]", 
               TagBox[
                RowBox[{"(", "\[NoBreak]", 
                  TagBox[
                   
                   GridBox[{{"1.`"}, {"0.549`"}, {"0.429`"}}, 
                    ColumnAlignments -> Center, RowSpacings -> 1, 
                    ColumnAlignments -> Left], Column], "\[NoBreak]", ")"}], 
                Function[BoxForm`e$, 
                 MatrixForm[BoxForm`e$]]]}], ",", 
             RowBox[{"\"T\"", "\[Rule]", 
               TagBox[
                RowBox[{"(", "\[NoBreak]", 
                  GridBox[{{"0.98`", "0.`", 
                    RowBox[{"-", "0.02`"}]}, {"0.`", "1.`", "0.`"}, {
                    RowBox[{"-", "0.02`"}], "0.`", "0.98`"}}, RowSpacings -> 
                   1, ColumnSpacings -> 1, RowAlignments -> Baseline, 
                   ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
                Function[BoxForm`e$, 
                 MatrixForm[BoxForm`e$]]]}], ",", 
             RowBox[{"\"M\"", "\[Rule]", 
               TagBox[
                RowBox[{"(", "\[NoBreak]", 
                  GridBox[{{"0", "0", "0"}, {"0", "0", "0"}, {
                    RowBox[{"-", "1"}], "0", "0"}}, RowSpacings -> 1, 
                   ColumnSpacings -> 1, RowAlignments -> Baseline, 
                   ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
                Function[BoxForm`e$, 
                 MatrixForm[BoxForm`e$]]]}]}], "\[RightAssociation]"}]], 
        Annotation[#, 
         Association[
         "s" -> MatrixForm[{1., 0.549, 0.429}], "T" -> 
          MatrixForm[{{0.98, 0., -0.02}, {0., 1., 0.}, {-0.02, 0., 0.98}}], 
          "M" -> MatrixForm[{{0, 0, 0}, {0, 0, 0}, {-1, 0, 0}}]], 
         "Tooltip"]& ]}, {
       InterpretationBox[
        Cell[
         BoxData[
          FormBox[
           StyleBox[
           "\"t=2\"", 11, FontFamily -> "Source Serif Pro", StripOnInput -> 
            False], TextForm]], "InlineText"], 
        Text[
         Style["t=2", 11, FontFamily -> "Source Serif Pro"]]]}}, 
     GridBoxAlignment -> {"Columns" -> {Center}, "Rows" -> {Center}}, 
     DefaultBaseStyle -> "Column", 
     GridBoxItemSize -> {"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
      GridBoxSpacings -> {"Columns" -> {{0}}, "Rows" -> {{0.75}}}], "Column"], 
   TemplateBox[{20}, "Spacer1"], 
   TagBox[
    GridBox[{{
       TagBox[
        TooltipBox[
         GraphicsBox[
          NamespaceBox[{{}, {
             Directive[
              Hue[0.6, 0.2, 0.8], 
              EdgeForm[
               Directive[
                GrayLevel[0], 
                Opacity[0.7]]]], 
             Directive[
              GrayLevel[0]], 
             TagBox[
              StyleBox[
               DiskBox[{-1., 0.}, 0.28867513459481287`], {
                Directive[
                 RGBColor[
                 0.09103567629183329, 0.39190824989776224`, 
                  0.5296595758780089], 
                 EdgeForm[{
                   Thickness[Large], 
                   RGBColor[1, 0, 0]}]]}, StripOnInput -> False], 
              "DynamicName", BoxID -> "VertexID$1"], 
             TagBox[
              StyleBox[
               DiskBox[{0.5, 0.8660254037844386}, 0.21392920715461855`], {
                RGBColor[
                0.10521661373005914`, 0.12893334276031915`, 
                 0.4478173863000755]}, StripOnInput -> False], "DynamicName", 
              BoxID -> "VertexID$2"], 
             TagBox[
              StyleBox[
               DiskBox[{0.5, -0.8660254037844386}, 0.18896894623524796`], {
                Directive[
                 RGBColor[
                 0.11194916284610205`, 0.08112350450415165, 
                  0.42805901218767645`], 
                 EdgeForm[{
                   Thickness[Large], 
                   RGBColor[1, 0, 0]}]]}, StripOnInput -> False], 
              "DynamicName", BoxID -> "VertexID$3"]}}], {
          ImageSize -> 36, BaseStyle -> GrayLevel[0], FormatType -> 
           TraditionalForm, FrameTicks -> None}], 
         RowBox[{"\[LeftAssociation]", 
           RowBox[{
             RowBox[{"\"s\"", "\[Rule]", 
               TagBox[
                RowBox[{"(", "\[NoBreak]", 
                  TagBox[
                   
                   GridBox[{{"1.`"}, {"0.549`"}, {"0.429`"}}, 
                    ColumnAlignments -> Center, RowSpacings -> 1, 
                    ColumnAlignments -> Left], Column], "\[NoBreak]", ")"}], 
                Function[BoxForm`e$, 
                 MatrixForm[BoxForm`e$]]]}], ",", 
             RowBox[{"\"T\"", "\[Rule]", 
               TagBox[
                RowBox[{"(", "\[NoBreak]", 
                  
                  GridBox[{{"1", "0", "0"}, {"0", "1", "0"}, {"0", "0", "1"}},
                    RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> 
                   Baseline, ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
                Function[BoxForm`e$, 
                 MatrixForm[BoxForm`e$]]]}], ",", 
             RowBox[{"\"M\"", "\[Rule]", 
               TagBox[
                RowBox[{"(", "\[NoBreak]", 
                  
                  GridBox[{{"0", "0", "0"}, {"0", "0", "0"}, {"0", "1", "0"}},
                    RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> 
                   Baseline, ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
                Function[BoxForm`e$, 
                 MatrixForm[BoxForm`e$]]]}]}], "\[RightAssociation]"}]], 
        Annotation[#, 
         Association[
         "s" -> MatrixForm[{1., 0.549, 0.429}], "T" -> 
          MatrixForm[{{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}], "M" -> 
          MatrixForm[{{0, 0, 0}, {0, 0, 0}, {0, 1, 0}}]], "Tooltip"]& ]}, {
       InterpretationBox[
        Cell[
         BoxData[
          FormBox[
           StyleBox[
           "\"t=3\"", 11, FontFamily -> "Source Serif Pro", StripOnInput -> 
            False], TextForm]], "InlineText"], 
        Text[
         Style["t=3", 11, FontFamily -> "Source Serif Pro"]]]}}, 
     GridBoxAlignment -> {"Columns" -> {Center}, "Rows" -> {Center}}, 
     DefaultBaseStyle -> "Column", 
     GridBoxItemSize -> {"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
      GridBoxSpacings -> {"Columns" -> {{0}}, "Rows" -> {{0.75}}}], "Column"], 
   TemplateBox[{20}, "Spacer1"], 
   TagBox[
    GridBox[{{
       TagBox[
        TooltipBox[
         GraphicsBox[
          NamespaceBox[{{
             Directive[
              Opacity[0.7], 
              Hue[0.6, 0.7, 0.5]], 
             Directive[
              GrayLevel[0]], 
             LineBox[{
               DynamicLocation["VertexID$1", Automatic, Center], 
               DynamicLocation["VertexID$3", Automatic, Center]}]}, {
             Directive[
              Hue[0.6, 0.2, 0.8], 
              EdgeForm[
               Directive[
                GrayLevel[0], 
                Opacity[0.7]]]], 
             Directive[
              GrayLevel[0]], 
             TagBox[
              StyleBox[
               DiskBox[{-1., 0.}, 0.2886751345948128], {
                Directive[
                 RGBColor[
                 0.09024283762236941, 0.3792691676041463, 0.5274576993849366], 
                 EdgeForm[{
                   Thickness[Large], 
                   RGBColor[1, 0, 0]}]]}, StripOnInput -> False], 
              "DynamicName", BoxID -> "VertexID$1"], 
             TagBox[
              StyleBox[
               DiskBox[{0.5, 0.8660254037844386}, 0.21491784774929532`], {
                RGBColor[
                0.10513757407644347`, 0.12949462690248512`, 
                 0.4480493482239969]}, StripOnInput -> False], "DynamicName", 
              BoxID -> "VertexID$2"], 
             TagBox[
              StyleBox[
               DiskBox[{0.5, -0.8660254037844386}, 0.1935023140680755], {
                Directive[
                 RGBColor[
                 0.10987855909753447`, 0.09582747897286152, 
                  0.4341357244102796], 
                 EdgeForm[{
                   Thickness[Large], 
                   RGBColor[1, 0, 0]}]]}, StripOnInput -> False], 
              "DynamicName", BoxID -> "VertexID$3"]}}], {
          ImageSize -> 36, BaseStyle -> GrayLevel[0], FormatType -> 
           TraditionalForm, FrameTicks -> None}], 
         RowBox[{"\[LeftAssociation]", 
           RowBox[{
             RowBox[{"\"s\"", "\[Rule]", 
               TagBox[
                RowBox[{"(", "\[NoBreak]", 
                  TagBox[
                   
                   GridBox[{{"1.`"}, {"0.554`"}, {"0.449`"}}, 
                    ColumnAlignments -> Center, RowSpacings -> 1, 
                    ColumnAlignments -> Left], Column], "\[NoBreak]", ")"}], 
                Function[BoxForm`e$, 
                 MatrixForm[BoxForm`e$]]]}], ",", 
             RowBox[{"\"T\"", "\[Rule]", 
               TagBox[
                RowBox[{"(", "\[NoBreak]", 
                  
                  GridBox[{{"0.98`", "0.`", "0.02`"}, {"0.`", "1.`", "0.`"}, {
                    "0.02`", "0.`", "0.98`"}}, RowSpacings -> 1, 
                   ColumnSpacings -> 1, RowAlignments -> Baseline, 
                   ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
                Function[BoxForm`e$, 
                 MatrixForm[BoxForm`e$]]]}], ",", 
             RowBox[{"\"M\"", "\[Rule]", 
               TagBox[
                RowBox[{"(", "\[NoBreak]", 
                  
                  GridBox[{{"0", "0", "1"}, {"0", "0", "0"}, {"1", "1", "0"}},
                    RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> 
                   Baseline, ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
                Function[BoxForm`e$, 
                 MatrixForm[BoxForm`e$]]]}]}], "\[RightAssociation]"}]], 
        Annotation[#, 
         Association[
         "s" -> MatrixForm[{1., 0.554, 0.449}], "T" -> 
          MatrixForm[{{0.98, 0., 0.02}, {0., 1., 0.}, {0.02, 0., 0.98}}], "M" -> 
          MatrixForm[{{0, 0, 1}, {0, 0, 0}, {1, 1, 0}}]], "Tooltip"]& ]}, {
       InterpretationBox[
        Cell[
         BoxData[
          FormBox[
           StyleBox[
           "\"t=4\"", 11, FontFamily -> "Source Serif Pro", StripOnInput -> 
            False], TextForm]], "InlineText"], 
        Text[
         Style["t=4", 11, FontFamily -> "Source Serif Pro"]]]}}, 
     GridBoxAlignment -> {"Columns" -> {Center}, "Rows" -> {Center}}, 
     DefaultBaseStyle -> "Column", 
     GridBoxItemSize -> {"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
      GridBoxSpacings -> {"Columns" -> {{0}}, "Rows" -> {{0.75}}}], "Column"], 
   TemplateBox[{20}, "Spacer1"], 
   TagBox[
    GridBox[{{
       TagBox[
        TooltipBox[
         GraphicsBox[
          NamespaceBox[{{}, {
             Directive[
              Hue[0.6, 0.2, 0.8], 
              EdgeForm[
               Directive[
                GrayLevel[0], 
                Opacity[0.7]]]], 
             Directive[
              GrayLevel[0]], 
             TagBox[
              StyleBox[
               DiskBox[{-1., 0.}, 0.2886751345948128], {
                Directive[
                 RGBColor[
                 0.09070738427913067, 0.38667476429130077`, 
                  0.528747841254719], 
                 EdgeForm[{
                   Thickness[Large], 
                   RGBColor[1, 0, 0]}]]}, StripOnInput -> False], 
              "DynamicName", BoxID -> "VertexID$1"], 
             TagBox[
              StyleBox[
               DiskBox[{0.5, 0.8660254037844386}, 0.21491784774929532`], {
                RGBColor[
                0.10516665300764433`, 0.12928812874355422`, 
                 0.44796400872011033`]}, StripOnInput -> False], 
              "DynamicName", BoxID -> "VertexID$2"], 
             TagBox[
              StyleBox[
               DiskBox[{0.5, -0.8660254037844386}, 0.1935023140680755], {
                Directive[
                 RGBColor[
                 0.11108974152153361`, 0.08722651152471812, 
                  0.43058120218708296`], 
                 EdgeForm[{
                   Thickness[Large], 
                   RGBColor[1, 0, 0]}]]}, StripOnInput -> False], 
              "DynamicName", BoxID -> "VertexID$3"]}}], {
          ImageSize -> 36, BaseStyle -> GrayLevel[0], FormatType -> 
           TraditionalForm, FrameTicks -> None}], 
         RowBox[{"\[LeftAssociation]", 
           RowBox[{
             RowBox[{"\"s\"", "\[Rule]", 
               TagBox[
                RowBox[{"(", "\[NoBreak]", 
                  TagBox[
                   
                   GridBox[{{"1.`"}, {"0.554`"}, {"0.449`"}}, 
                    ColumnAlignments -> Center, RowSpacings -> 1, 
                    ColumnAlignments -> Left], Column], "\[NoBreak]", ")"}], 
                Function[BoxForm`e$, 
                 MatrixForm[BoxForm`e$]]]}], ",", 
             RowBox[{"\"T\"", "\[Rule]", 
               TagBox[
                RowBox[{"(", "\[NoBreak]", 
                  
                  GridBox[{{"1", "0", "0"}, {"0", "1", "0"}, {"0", "0", "1"}},
                    RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> 
                   Baseline, ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
                Function[BoxForm`e$, 
                 MatrixForm[BoxForm`e$]]]}], ",", 
             RowBox[{"\"M\"", "\[Rule]", 
               TagBox[
                RowBox[{"(", "\[NoBreak]", 
                  
                  GridBox[{{"0", "1", "0"}, {"0", "0", "0"}, {"0", "0", "0"}},
                    RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> 
                   Baseline, ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
                Function[BoxForm`e$, 
                 MatrixForm[BoxForm`e$]]]}]}], "\[RightAssociation]"}]], 
        Annotation[#, 
         Association[
         "s" -> MatrixForm[{1., 0.554, 0.449}], "T" -> 
          MatrixForm[{{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}], "M" -> 
          MatrixForm[{{0, 1, 0}, {0, 0, 0}, {0, 0, 0}}]], "Tooltip"]& ]}, {
       InterpretationBox[
        Cell[
         BoxData[
          FormBox[
           StyleBox[
           "\"t=5\"", 11, FontFamily -> "Source Serif Pro", StripOnInput -> 
            False], TextForm]], "InlineText"], 
        Text[
         Style["t=5", 11, FontFamily -> "Source Serif Pro"]]]}}, 
     GridBoxAlignment -> {"Columns" -> {Center}, "Rows" -> {Center}}, 
     DefaultBaseStyle -> "Column", 
     GridBoxItemSize -> {"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
      GridBoxSpacings -> {"Columns" -> {{0}}, "Rows" -> {{0.75}}}], "Column"]},
  "RowDefault"]], "Output",
 CellChangeTimes->{
  3.818683368791355*^9, 3.818683406025449*^9, 3.81868351703928*^9, 
   3.81868361566258*^9, 3.818683778322011*^9, 3.8186839010584517`*^9, 
   3.818684032048321*^9, 3.818684145730072*^9, 3.818684273936314*^9, 
   3.818684449874605*^9, 3.818684565173005*^9, 3.818684692708514*^9, 
   3.818684892534812*^9, 3.8186851398650293`*^9, 3.818685246665928*^9, 
   3.81868809702335*^9, 3.818688416463749*^9, 3.8186885030775623`*^9, 
   3.818688785187724*^9, 3.818688874632003*^9, 3.818688966803071*^9, 
   3.818689032233533*^9, 3.818689082739626*^9, 3.8186892336201763`*^9, 
   3.818689318865911*^9, 3.818689448254591*^9, 3.818689509108773*^9, 
   3.818689716967141*^9, 3.8186897935291233`*^9, 3.818689959805626*^9, 
   3.8186900282661324`*^9, 3.818690303020308*^9, 3.818690431619184*^9, 
   3.818690484649406*^9, 3.818690525289103*^9, 3.818690581774151*^9, 
   3.8186906278531303`*^9, 3.818690663592518*^9, 3.8186907034924307`*^9, 
   3.818690828178693*^9, 3.818690982190303*^9, 3.818691112470078*^9, 
   3.8186912152898417`*^9, 3.81869132746393*^9, 3.818691460087668*^9, 
   3.8186916557562523`*^9, 3.818691735626416*^9, 3.818699870319008*^9, {
   3.818783101288352*^9, 3.818783127549161*^9}, 3.818783207187101*^9, 
   3.8187833174427834`*^9, 3.818784145634685*^9, 3.820416395849703*^9, {
   3.820417489703964*^9, 3.820417495141141*^9}},
 CellLabel->
  "Out[465]=",ExpressionUUID->"14827e6a-3a7a-41c2-9c84-66c652334ae6"]
}, Open  ]],

Cell["\<\
Given a simulation in which each power structure has a move matrix M, \
determine which actors caused the power structure to change from one time \
step to the next. Output: list of list of agent indexes.\
\>", "Text",
 CellChangeTimes->{{3.818782369488056*^9, 
  3.818782419394743*^9}},ExpressionUUID->"dee39586-a45e-426a-8749-\
c7e5c38519a3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mctsSimulationActors", "[", "sim_List", "]"}], ":=", " ", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[CapitalDelta]Ts", ",", "Ms"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[CapitalDelta]Ts", "=", 
      RowBox[{"Differences", "[", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ToTernary", "[", "#T", "]"}], "&"}], ",", "sim"}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ms", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{"#M", "&"}], ",", 
        RowBox[{"Rest", "[", "sim", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"mctsActors", "[", 
         RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[CapitalDelta]Ts", ",", "Ms"}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.818782422502179*^9, 3.818782428109761*^9}, {
   3.8187825123564577`*^9, 3.81878254503019*^9}, {3.8187825785317593`*^9, 
   3.8187826481026154`*^9}, {3.818782691811269*^9, 3.818782703341454*^9}, 
   3.8187827571344643`*^9, 3.8204163566084003`*^9},
 CellLabel->
  "In[165]:=",ExpressionUUID->"760cebe1-387b-4078-9f16-85c627dd40ac"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mctsSimulationActors", "[", "sim", "]"}]], "Input",
 CellChangeTimes->{{3.8187826580820513`*^9, 3.81878265983976*^9}, 
   3.818782759544949*^9},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[2386]:=",ExpressionUUID->"ed97fcd7-39dd-4390-b315-a4a9cee1ee07"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "4", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", "1", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.818782660221092*^9, {3.818782695655505*^9, 3.818782705306185*^9}, {
   3.818782762124187*^9, 3.818782774987754*^9}},
 CellLabel->
  "Out[2386]=",ExpressionUUID->"b98ba6bb-66ed-4189-8164-2c179098f94d"]
}, Open  ]],

Cell[TextData[{
 "Determine which actors caused a change in the power structure, given ",
 StyleBox["\[CapitalDelta]T",
  FontWeight->"Bold"],
 "=",
 Cell[BoxData[
  FormBox[
   SubscriptBox["T", "1"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "4ff0af9d-9c06-48d5-8c36-1dd0ee050ce5"],
 " - ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["T", "0"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "90b83775-f410-488d-9b29-d304d4f8ff71"],
 " (What changed?) and a move matrix ",
 StyleBox["M",
  FontWeight->"Bold"],
 " (Who changed it?). This is done by computing \
\[CapitalDelta]T*(M==SymmetrizeT[M]), and then getting the indexes of the \
nonzero agents."
}], "Text",
 CellChangeTimes->{{3.818781063898905*^9, 3.818781080965232*^9}, {
  3.818781583376145*^9, 3.818781781169407*^9}, {3.818782086174774*^9, 
  3.818782113953128*^9}},ExpressionUUID->"c9b3b006-00ff-4cf3-813c-\
78c209b7f122"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mctsActors", "[", 
   RowBox[{"\[CapitalDelta]T_List", ",", "M_List"}], "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Position", "[", 
    RowBox[{
     RowBox[{"RealAbs", "[", 
      RowBox[{"Sign", "[", 
       RowBox[{"Total", "[", 
        RowBox[{"\[CapitalDelta]T", "*", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Boole", "[", 
             RowBox[{"Equal", "[", 
              RowBox[{"#1", ",", "#2"}], "]"}], "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"M", ",", 
             RowBox[{"SymmetrizeT", "[", "M", "]"}]}], "}"}], ",", "2"}], 
          "]"}]}], "]"}], "]"}], "]"}], ",", "1"}], "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8187811726006002`*^9, 3.818781178602468*^9}, {
  3.818781243669237*^9, 3.8187812772615356`*^9}, {3.818781366023467*^9, 
  3.818781373002349*^9}, {3.818781458764868*^9, 3.818781463342656*^9}, {
  3.818782561504545*^9, 3.818782564245338*^9}, {3.818782803471199*^9, 
  3.818782804448159*^9}, {3.822341079623705*^9, 3.82234108093959*^9}},
 CellLabel->
  "In[166]:=",ExpressionUUID->"8dde36bd-212c-4672-896c-88c0c460b437"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mctsActors", "[", 
  RowBox[{
   RowBox[{"(", GridBox[{
      {"0", "0", "0", "0", "0"},
      {"0", "0", "1", "0", "0"},
      {"0", "1", "0", "0", "0"},
      {"0", "0", "0", "0", "0"},
      {"0", "0", "0", "0", "0"}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}], ")"}], ",", 
   RowBox[{"(", GridBox[{
      {"0", "1", "0", "1", "1"},
      {"1", "0", "1", "1", "1"},
      {"1", "1", "0", "1", "0"},
      {"1", "1", "0", "0", "1"},
      {"1", "0", "0", "1", "0"}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}], ")"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8187813792469473`*^9, 3.8187814008617287`*^9}, {
   3.8187814696814537`*^9, 3.8187814731192417`*^9}, {3.818781804834321*^9, 
   3.8187818093664637`*^9}, {3.818782025396407*^9, 3.818782031099493*^9}, 
   3.818782809306056*^9},
 Background->RGBColor[1, 0.9, 0.8],
 CellLabel->
  "In[2392]:=",ExpressionUUID->"9eeab55d-eece-4f34-b132-45164e7fa457"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "3"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8187814027738647`*^9, {3.8187814702819233`*^9, 3.81878148291555*^9}, 
   3.818781810895154*^9, 3.818781991458658*^9, 3.818782032533296*^9, 
   3.818782574385284*^9, 3.818782811867741*^9},
 CellLabel->
  "Out[2392]=",ExpressionUUID->"4b43cf4f-47d3-43ff-8e06-e942aa2da9f1"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["MonteCarloShowBestMove", "Subsubsection",
 CellChangeTimes->{{3.82179785889028*^9, 
  3.8217978657055798`*^9}},ExpressionUUID->"6906ab29-820d-46a4-a18b-\
26b4153ccca7"],

Cell["\<\
Look at the simultaneous best moves (one time step) based upon MCTS and \
ReciprocalizeT. Output: two power structure visualizations.\
\>", "Text",
 CellChangeTimes->{{3.820600374024241*^9, 3.82060040816159*^9}, {
  3.821797869096714*^9, 
  3.821797890895403*^9}},ExpressionUUID->"a469ef54-f6dd-4bf5-9505-\
db6e60eeecb9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MonteCarloShowBestMove", "[", 
   RowBox[{"ps_", ",", " ", "depth_", ",", "playouts_"}], "]"}], ":=", 
  RowBox[{"ShowMonteCarloSimulation", "[", 
   RowBox[{"MonteCarloSimulate", "[", 
    RowBox[{"ps", ",", "depth", ",", "playouts", ",", "1"}], "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8206004153040667`*^9, 3.820600445537148*^9}},
 CellLabel->
  "In[167]:=",ExpressionUUID->"575f16d7-04d5-49cb-933d-b01dbe9289f9"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Unit Tests", "Section",
 CellChangeTimes->{{3.684547311046467*^9, 3.684547348344494*^9}, 
   3.710410140821734*^9},ExpressionUUID->"8cca388b-1f40-4feb-91df-\
338ab1a0b026"],

Cell[CellGroupData[{

Cell["Tests", "Subsection",
 CellChangeTimes->{{3.684547362645547*^9, 
  3.684547363286663*^9}},ExpressionUUID->"dfec4cdc-5d38-4a82-92dc-\
c1f63ffd3e89"],

Cell["Master unit test report:", "Text",
 CellChangeTimes->{{3.755085492065805*^9, 
  3.755085499891468*^9}},ExpressionUUID->"8dbab509-e7fb-4f42-820a-\
e8845826026e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetParameters", "[", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\"\<\[Beta]\>\"", "\[Rule]", "2"}], ",", 
     RowBox[{"\"\<\[Mu]\>\"", "\[Rule]", "3"}], ",", 
     RowBox[{"\"\<\[Lambda]\>\"", "\[Rule]", "1"}], ",", 
     RowBox[{"\"\<\[Rho]\>\"", "\[Rule]", "0.9"}], ",", 
     RowBox[{"\"\<\[Delta]\>\"", "\[Rule]", "0.9"}], ",", 
     RowBox[{"\"\<\[Alpha]\>\"", "\[Rule]", "2.25"}], ",", " ", 
     RowBox[{"\"\<k\>\"", "\[Rule]", "29"}]}], "\[RightAssociation]"}], "]"}],
   ";", 
  RowBox[{"report", "=", 
   RowBox[{"TestReport", "[", 
    RowBox[{"Catenate", "[", 
     RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", "Tactics", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"unitTests", "[", "\"\<RandomS\>\"", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"unitTests", "[", "\"\<LegalTacticQ\>\"", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"unitTests", "[", "\"\<LegalTacticQ\>\"", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"unitTests", "[", "\"\<LegalTQ\>\"", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"unitTests", "[", "\"\<RandomTactic\>\"", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"unitTests", "[", "\"\<RandomTacticMatrix\>\"", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"unitTests", "[", "\"\<TernaryMatrixQ\>\"", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"unitTests", "[", "\"\<NormalizeS\>\"", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"unitTests", "[", "\"\<NormalizeTactic\>\"", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"unitTests", "[", "\"\<NormalizeTernaryT\>\"", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"unitTests", "[", "\"\<ToTernary\>\"", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"unitTests", "[", "\"\<PadS\>\"", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"unitTests", "[", "\"\<PadT\>\"", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"unitTests", "[", "\"\<TrimS\>\"", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"unitTests", "[", "\"\<TrimT\>\"", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"unitTests", "[", "\"\<ReorderT\>\"", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"unitTests", "[", "\"\<ReorderS\>\"", "]"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Simulation", " ", "Engine"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"unitTests", "[", "\"\<UpdateS\>\"", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"unitTests", "[", "\"\<SimulateLawOfMotion\>\"", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"unitTests", "[", "\"\<Utility\>\"", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"unitTests", "[", "\"\<PrinceRank\>\"", "]"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "PrinceNet", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"unitTests", "[", "\"\<NetTopology\>\"", "]"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "Visualization", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"unitTests", "[", "\"\<ShowPowerStructure\>\"", "]"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Helper", " ", "Functions"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"unitTests", "[", "\"\<HelperFunctions\>\"", "]"}]}], 
      "\[IndentingNewLine]", "}"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetParameters", "[", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\"\<\[Beta]\>\"", "\[Rule]", "2"}], ",", 
     RowBox[{"\"\<\[Mu]\>\"", "\[Rule]", "3"}], ",", 
     RowBox[{"\"\<\[Lambda]\>\"", "\[Rule]", "1"}], ",", 
     RowBox[{"\"\<\[Alpha]\>\"", "\[Rule]", "2.25"}], ",", " ", 
     RowBox[{"\"\<\[Rho]\>\"", "\[Rule]", "0.98"}]}], "\[RightAssociation]"}],
    "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.686156772033156*^9, 3.686156775693008*^9}, {
   3.686156809195079*^9, 3.686157138668849*^9}, {3.686157170974564*^9, 
   3.6861572653892612`*^9}, {3.686158361726322*^9, 3.686158445637783*^9}, {
   3.686158532211163*^9, 3.6861585519314737`*^9}, {3.686158614233506*^9, 
   3.6861587920264797`*^9}, {3.710410169871294*^9, 3.710410273086866*^9}, {
   3.710411351628539*^9, 3.7104113850899677`*^9}, {3.7104114306772213`*^9, 
   3.7104114819253397`*^9}, {3.710411643677153*^9, 3.710411695285136*^9}, {
   3.710411861209323*^9, 3.710411885097651*^9}, {3.7104121543887463`*^9, 
   3.71041224063713*^9}, {3.710412283087392*^9, 3.710412342385366*^9}, {
   3.710412407798431*^9, 3.710412443113146*^9}, {3.71041249865483*^9, 
   3.710412581181254*^9}, {3.71041262284713*^9, 3.71041273699049*^9}, {
   3.710412809378468*^9, 3.710412841846561*^9}, {3.710413087217443*^9, 
   3.710413123340972*^9}, {3.710413156595048*^9, 3.710413191907783*^9}, {
   3.7104132530654907`*^9, 3.710413270478098*^9}, {3.710413318303171*^9, 
   3.7104133418830967`*^9}, {3.710413400870171*^9, 3.710413449146318*^9}, {
   3.7104134815337353`*^9, 3.7104134881244783`*^9}, {3.710413571427999*^9, 
   3.7104136463941*^9}, {3.710413698689616*^9, 3.7104137085181847`*^9}, {
   3.710413828954381*^9, 3.71041384707368*^9}, {3.710413901845551*^9, 
   3.710413931054863*^9}, {3.710413974016609*^9, 3.7104140532935*^9}, {
   3.710414090811274*^9, 3.710414147639694*^9}, {3.710414251701889*^9, 
   3.710414270870657*^9}, {3.7104145159744883`*^9, 3.710414516625465*^9}, {
   3.710414566699204*^9, 3.710414590293901*^9}, {3.71041463488653*^9, 
   3.710414690154669*^9}, {3.710414738115891*^9, 3.710414755623864*^9}, {
   3.7104149348687963`*^9, 3.710415066023868*^9}, {3.710415150520677*^9, 
   3.710415218055983*^9}, {3.71041525865819*^9, 3.7104153288318443`*^9}, {
   3.710415372695043*^9, 3.710415448791482*^9}, {3.710415533595524*^9, 
   3.710415558426022*^9}, {3.710434714674308*^9, 3.710434742294389*^9}, 
   3.710434775198511*^9, {3.7104349472773123`*^9, 3.710434988553809*^9}, {
   3.710435046612584*^9, 3.710435055430696*^9}, {3.710435096591991*^9, 
   3.710435119484301*^9}, {3.710435247829042*^9, 3.710435276063127*^9}, {
   3.710436252232473*^9, 3.710436362197208*^9}, {3.710436447184214*^9, 
   3.7104364522782917`*^9}, {3.710436534792199*^9, 3.710436578916008*^9}, {
   3.710436646252187*^9, 3.710436708579536*^9}, {3.710436755612747*^9, 
   3.7104367794895077`*^9}, {3.710436863460878*^9, 3.7104369458482723`*^9}, {
   3.710437390174452*^9, 3.710437405749805*^9}, {3.710437841421946*^9, 
   3.710437871377837*^9}, {3.71043813682613*^9, 3.710438180305106*^9}, {
   3.710438331963044*^9, 3.710438355956264*^9}, {3.710438411896347*^9, 
   3.710438425592577*^9}, {3.710438687896859*^9, 3.7104387210179577`*^9}, {
   3.7104389693492317`*^9, 3.710439031720705*^9}, {3.7104391515479193`*^9, 
   3.7104391997284*^9}, {3.71043927467712*^9, 3.7104392753367167`*^9}, {
   3.710439382987832*^9, 3.7104394241220093`*^9}, {3.710439526270479*^9, 
   3.7104395341508417`*^9}, {3.7104395941803627`*^9, 3.710439601925539*^9}, 
   3.710439640694351*^9, {3.710440957745331*^9, 3.7104409773636923`*^9}, {
   3.710445674840085*^9, 3.710445678123386*^9}, {3.710445725516684*^9, 
   3.710445753197445*^9}, {3.710445790670698*^9, 3.710445871322274*^9}, {
   3.720631251643115*^9, 3.720631251738984*^9}, {3.720631294043125*^9, 
   3.720631294137883*^9}, {3.720631397374105*^9, 3.7206315251797037`*^9}, {
   3.72063157940107*^9, 3.7206316678979588`*^9}, {3.720631732863598*^9, 
   3.720631732993373*^9}, {3.720728277238584*^9, 3.720728286639843*^9}, {
   3.7207291238768797`*^9, 3.720729129762487*^9}, {3.72072978466289*^9, 
   3.7207298013830976`*^9}, {3.720729874866747*^9, 3.720729936249498*^9}, 
   3.728860401659309*^9, {3.728860448917309*^9, 3.728860455482309*^9}, {
   3.7288606570789027`*^9, 3.7288606919927993`*^9}, {3.7288608000822678`*^9, 
   3.728860958125983*^9}, {3.7288612159079833`*^9, 3.728861226792983*^9}, {
   3.7288613209279833`*^9, 3.7288615260559835`*^9}, {3.7288615644569836`*^9, 
   3.72886163794625*^9}, {3.7288616850149565`*^9, 3.7288616912065754`*^9}, {
   3.7288617242418785`*^9, 3.7288617316126156`*^9}, {3.7290788527749157`*^9, 
   3.7290788868306923`*^9}, {3.729082362933544*^9, 3.729082388842513*^9}, {
   3.729082565033389*^9, 3.729082568391748*^9}, {3.729089342879279*^9, 
   3.729089349364285*^9}, {3.729089429985359*^9, 3.7290894789013968`*^9}, {
   3.729089521825492*^9, 3.729089562029715*^9}, {3.72909338366337*^9, 
   3.729093458356638*^9}, {3.7290938811849546`*^9, 3.7290939506856737`*^9}, {
   3.7290940240959272`*^9, 3.729094100201942*^9}, {3.729095653979166*^9, 
   3.7290956974995117`*^9}, {3.729095822233182*^9, 3.729095848769516*^9}, {
   3.7290958901093884`*^9, 3.72909592917515*^9}, {3.729095970387271*^9, 
   3.729095984347332*^9}, {3.729096024924492*^9, 3.729096042071272*^9}, {
   3.7290961562383413`*^9, 3.729096220385428*^9}, {3.729096326639687*^9, 
   3.7290963520967093`*^9}, {3.72909642112709*^9, 3.729096443565207*^9}, {
   3.729096546581905*^9, 3.72909658066466*^9}, {3.72909666163321*^9, 
   3.729096673848333*^9}, {3.729465945732329*^9, 3.729465955206284*^9}, {
   3.729466026147829*^9, 3.729466031907769*^9}, {3.729467137712644*^9, 
   3.729467152990984*^9}, {3.729467384456954*^9, 3.729467386653006*^9}, {
   3.729785867526352*^9, 3.729785891089775*^9}, {3.729786087975765*^9, 
   3.729786124873485*^9}, {3.72979504344248*^9, 3.7297950449764433`*^9}, {
   3.7297952062516537`*^9, 3.729795220163679*^9}, {3.72979525131011*^9, 
   3.729795274790512*^9}, {3.729795398390234*^9, 3.7297954043534613`*^9}, {
   3.729795437747871*^9, 3.729795442418392*^9}, {3.729795473475479*^9, 
   3.729795514366832*^9}, {3.729795603427073*^9, 3.729795627265648*^9}, {
   3.729795840158901*^9, 3.729795852926899*^9}, {3.7297960117054377`*^9, 
   3.729796013482307*^9}, {3.729796082184332*^9, 3.7297960874969053`*^9}, {
   3.730392650900272*^9, 3.730392658284463*^9}, {3.730392766496244*^9, 
   3.730392771449211*^9}, {3.7303929021356*^9, 3.730392905009158*^9}, {
   3.7303929886674767`*^9, 3.7303931860366297`*^9}, {3.730393220973446*^9, 
   3.730393254626607*^9}, {3.730393291902746*^9, 3.730393303030066*^9}, 
   3.731849782470813*^9, {3.731849913510889*^9, 3.731849918827854*^9}, 
   3.731850048802411*^9, {3.732296604524*^9, 3.732296616047*^9}, {
   3.7322966541029997`*^9, 3.732296654917*^9}, {3.7322972773599997`*^9, 
   3.732297335428*^9}, {3.732301437102*^9, 3.732301509785*^9}, {
   3.7323015681099997`*^9, 3.7323016480769997`*^9}, {3.7323018309435067`*^9, 
   3.7323018390596857`*^9}, {3.7326422287786493`*^9, 3.732642233050001*^9}, {
   3.7326423256472597`*^9, 3.73264234562039*^9}, {3.734293951498477*^9, 
   3.734293956927786*^9}, {3.734369235722715*^9, 3.7343692732582703`*^9}, {
   3.7343693341043873`*^9, 3.734369387403139*^9}, {3.734369447833508*^9, 
   3.7343694693273067`*^9}, {3.7343695177009563`*^9, 3.73436954860131*^9}, {
   3.7343698594067297`*^9, 3.7343699020908403`*^9}, {3.7343699611690607`*^9, 
   3.7343700196085577`*^9}, {3.7343700738560123`*^9, 3.734370087883692*^9}, 
   3.735724185899798*^9, 3.7357242839117975`*^9, {3.7357280177003813`*^9, 
   3.735728018260381*^9}, {3.735728109973379*^9, 3.735728112006379*^9}, {
   3.735728253665378*^9, 3.7357282964603777`*^9}, {3.7357288437093744`*^9, 
   3.7357288478153744`*^9}, 3.735729072435373*^9, {3.735729110757373*^9, 
   3.7357291186073723`*^9}, {3.7357291923763723`*^9, 
   3.7357291940013723`*^9}, {3.735729527616372*^9, 3.7357295507113714`*^9}, {
   3.735729617234371*^9, 3.735729618887371*^9}, 3.7371191739182405`*^9, {
   3.7371192872076907`*^9, 3.737119291631298*^9}, {3.7421645790723624`*^9, 
   3.742164581707325*^9}, {3.7423037976368027`*^9, 3.7423038117382126`*^9}, {
   3.742408984746608*^9, 3.742409006254498*^9}, {3.7424095973505383`*^9, 
   3.742409631474687*^9}, {3.742414966186138*^9, 3.742414966527026*^9}, {
   3.75059886975978*^9, 3.750598871437014*^9}, {3.7508497213764753`*^9, 
   3.7508497963645597`*^9}, {3.750849829454582*^9, 3.7508498949391565`*^9}, {
   3.7508499304228277`*^9, 3.7508499343392735`*^9}, {3.7521797788874083`*^9, 
   3.752179790204788*^9}, {3.752179867663253*^9, 3.752179936417759*^9}, {
   3.752179976260127*^9, 3.752179976805023*^9}, {3.752180026853916*^9, 
   3.7521801757641783`*^9}, {3.7521802181893806`*^9, 3.752180243418276*^9}, {
   3.752180316713531*^9, 3.752180349658743*^9}, {3.75218038465784*^9, 
   3.752180388234223*^9}, {3.755084063221416*^9, 3.7550840851900883`*^9}, {
   3.755084198209807*^9, 3.755084216799932*^9}, 3.755085095364315*^9, {
   3.755085162945799*^9, 3.755085166162059*^9}, {3.755085341536984*^9, 
   3.7550853425700397`*^9}, {3.755085613464519*^9, 3.75508561411067*^9}, {
   3.755085692635586*^9, 3.755085693240098*^9}, {3.755085766609845*^9, 
   3.755085767210534*^9}, {3.755085812592225*^9, 3.755085813093261*^9}, {
   3.7550858784474487`*^9, 3.7550858789625797`*^9}, {3.7550859856602077`*^9, 
   3.755085986864205*^9}, {3.755086071791074*^9, 3.755086072347324*^9}, {
   3.7550861539111233`*^9, 3.7550861547916*^9}, {3.7550863532514553`*^9, 
   3.755086353767408*^9}, {3.7550864601010017`*^9, 3.755086460631796*^9}, {
   3.755086592581966*^9, 3.755086593409215*^9}, {3.755086713778367*^9, 
   3.7550867144773607`*^9}, {3.755086842149338*^9, 3.7550868426586657`*^9}, {
   3.755086986655493*^9, 3.755086987180319*^9}, {3.755087028666264*^9, 
   3.755087029193903*^9}, {3.7550871034682503`*^9, 3.75508710403516*^9}, {
   3.755087140396639*^9, 3.755087140890377*^9}, {3.755087482786627*^9, 
   3.7550874834545097`*^9}, {3.755087563286502*^9, 3.7550875639604673`*^9}, {
   3.755087608892277*^9, 3.7550876094725313`*^9}, {3.755087675459179*^9, 
   3.755087691713262*^9}, {3.755087728750574*^9, 3.755087770828499*^9}, {
   3.755088089686077*^9, 3.755088090236648*^9}, {3.755088122116796*^9, 
   3.755088127859645*^9}, {3.75508846712703*^9, 3.7550884793959703`*^9}, 
   3.755088750227737*^9, {3.755088909905243*^9, 3.755088910766451*^9}, {
   3.755088993106921*^9, 3.755088993672661*^9}, {3.755089082987103*^9, 
   3.7550890836213617`*^9}, {3.7550892592425957`*^9, 3.755089259713526*^9}, {
   3.755089402522809*^9, 3.755089403080286*^9}, {3.755089535660819*^9, 
   3.755089536189281*^9}, {3.755089585914312*^9, 3.755089592630649*^9}, {
   3.7550897260584593`*^9, 3.7550897283513412`*^9}, {3.755089896260969*^9, 
   3.7550899030206623`*^9}, 3.755089962230699*^9, {3.755090070451413*^9, 
   3.755090070928947*^9}, {3.755090178821047*^9, 3.755090179346987*^9}, {
   3.755090239392572*^9, 3.7550902399296503`*^9}, {3.755090661577806*^9, 
   3.755090662530229*^9}, {3.755090751688134*^9, 3.755090752307844*^9}, {
   3.755090937679098*^9, 3.755090938241291*^9}, {3.755091612283283*^9, 
   3.755091612748633*^9}, {3.755091879981657*^9, 3.755091887019253*^9}, {
   3.7550919483162746`*^9, 3.7550919489204683`*^9}, {3.755093772792091*^9, 
   3.755093785192857*^9}, {3.755120474362011*^9, 3.7551205484720716`*^9}, 
   3.755120586090744*^9, {3.755190890238669*^9, 3.7551909173503847`*^9}, {
   3.7556245867845287`*^9, 3.755624597243999*^9}, {3.755700588570071*^9, 
   3.755700614003138*^9}, {3.755724199381565*^9, 3.7557242036249447`*^9}, {
   3.7557244226157084`*^9, 3.755724423403035*^9}, {3.75572456052172*^9, 
   3.755724563444271*^9}, {3.755799046097818*^9, 3.755799058041793*^9}, {
   3.755799107080158*^9, 3.755799113801272*^9}, {3.755799188590918*^9, 
   3.755799196262706*^9}, {3.755799576229817*^9, 3.7557995766848383`*^9}, {
   3.7560367500380025`*^9, 3.7560367655288024`*^9}, {3.7560371056580048`*^9, 
   3.7560371066720047`*^9}, {3.756220939773604*^9, 3.756220946700004*^9}, {
   3.7562209922364044`*^9, 3.7562209960896044`*^9}, {3.7562227143828154`*^9, 
   3.7562227236960154`*^9}, {3.7562229398652167`*^9, 3.756222940224017*^9}, {
   3.75622344157682*^9, 3.75622350828242*^9}, {3.756223564910421*^9, 
   3.7562235705888205`*^9}, {3.75630981663135*^9, 3.756309826240048*^9}, {
   3.757018464596717*^9, 3.757018466217011*^9}, {3.758745814725486*^9, 
   3.758745818555202*^9}, 3.758906438236095*^9, 3.758911393404901*^9, 
   3.7589115005519123`*^9, 3.758912619298046*^9, {3.76962630400476*^9, 
   3.769626309489441*^9}, {3.801164238095771*^9, 3.801164367578567*^9}, {
   3.801164410268641*^9, 3.801164418665333*^9}, {3.80116503642487*^9, 
   3.8011650395942917`*^9}, {3.801165089107662*^9, 3.8011650918321323`*^9}, {
   3.8011651250842113`*^9, 3.8011651820687933`*^9}, {3.801165215576007*^9, 
   3.801165236507267*^9}, {3.801165267055305*^9, 3.801165271995224*^9}, {
   3.801165485970211*^9, 3.801165495097146*^9}, {3.802264999318507*^9, 
   3.802265009066136*^9}, {3.802357705845066*^9, 3.802357707223794*^9}, {
   3.802379397989447*^9, 3.802379404889267*^9}, 3.802430445801861*^9, {
   3.802431187550579*^9, 3.802431188670426*^9}, {3.802431367004014*^9, 
   3.8024313690864687`*^9}, {3.803986616712413*^9, 3.803986617984058*^9}, 
   3.8040744657840652`*^9, {3.804162047246656*^9, 3.804162047911371*^9}, {
   3.804172146288924*^9, 3.804172146671466*^9}, {3.808094458400387*^9, 
   3.8080944597486353`*^9}, {3.8081279458237133`*^9, 
   3.8081279468218937`*^9}, {3.808435816807761*^9, 3.8084358170024567`*^9}, {
   3.808438942379608*^9, 3.808438942782145*^9}, {3.8207828993735228`*^9, 
   3.820782899576799*^9}, {3.8221496536654577`*^9, 3.822149654000288*^9}, {
   3.822157981118134*^9, 3.82215798294142*^9}, {3.822158109942861*^9, 
   3.8221581383400183`*^9}, 3.822158200574909*^9, 3.822158240088504*^9, {
   3.8221583420020647`*^9, 3.822158343015669*^9}, {3.822243978872725*^9, 
   3.822243983338725*^9}, {3.822388852550362*^9, 3.82238885827525*^9}},
 CellLabel->
  "In[168]:=",ExpressionUUID->"f1ba1d9f-146f-40fe-8388-43f402848018"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["TestReportObject",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource[
               "FEBitmaps", "SquarePlusIconMedium"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 3.5 CurrentValue["FontCapHeight"]/
                AbsoluteCurrentValue[Magnification]}]], 
            GraphicsBox[{
              InsetBox[
               BoxData[
                FormBox[
                 PaneBox[
                  DynamicBox[
                   FEPrivate`FrontEndResource[
                   "MUnitExpressions", "SuccessIcon"]], Alignment -> Center, 
                  ImageSize -> 
                  Dynamic[{
                    Automatic, 3.5 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                 TraditionalForm]]]}, PlotRange -> {{0, 1}, {0, 1}}, 
             Background -> GrayLevel[0.93], Axes -> False, AspectRatio -> 1, 
             ImageSize -> 
             Dynamic[{
               Automatic, 3.5 CurrentValue["FontCapHeight"]/
                AbsoluteCurrentValue[Magnification]}], Frame -> True, 
             FrameTicks -> None, FrameStyle -> Directive[
               Thickness[Tiny], 
               GrayLevel[0.55]]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Title: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"Automatic\"", "SummaryItem"]}], 
               "\[SpanFromLeft]"}, {
               RowBox[{
                 TagBox["\"Success rate: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  TemplateBox[{"100", "\"%\""}, "RowDefault"], 
                  "SummaryItem"]}], 
               RowBox[{
                 TagBox["\"Tests run: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["64", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource[
               "FEBitmaps", "SquareMinusIconMedium"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 3.5 CurrentValue["FontCapHeight"]/
                AbsoluteCurrentValue[Magnification]}]], 
            GraphicsBox[{
              InsetBox[
               BoxData[
                FormBox[
                 PaneBox[
                  DynamicBox[
                   FEPrivate`FrontEndResource[
                   "MUnitExpressions", "SuccessIcon"]], Alignment -> Center, 
                  ImageSize -> 
                  Dynamic[{
                    Automatic, 3.5 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                 TraditionalForm]]]}, PlotRange -> {{0, 1}, {0, 1}}, 
             Background -> GrayLevel[0.93], Axes -> False, AspectRatio -> 1, 
             ImageSize -> 
             Dynamic[{
               Automatic, 3.5 CurrentValue["FontCapHeight"]/
                AbsoluteCurrentValue[Magnification]}], Frame -> True, 
             FrameTicks -> None, FrameStyle -> Directive[
               Thickness[Tiny], 
               GrayLevel[0.55]]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Title: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"Automatic\"", "SummaryItem"]}], 
               "\[SpanFromLeft]"}, {
               RowBox[{
                 TagBox["\"Success rate: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  TemplateBox[{"100", "\"%\""}, "RowDefault"], 
                  "SummaryItem"]}], 
               RowBox[{
                 TagBox["\"Tests run: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["64", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Succeeded: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["64", "SummaryItem"]}], "\[SpanFromLeft]"}, {
               RowBox[{
                 TagBox["\"Failed: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0", "SummaryItem"]}], "\[SpanFromLeft]"}, {
               RowBox[{
                 TagBox[
                 "\"Failed with wrong results: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0", "SummaryItem"]}], "\[SpanFromLeft]"}, {
               RowBox[{
                 TagBox[
                 "\"Failed with messages: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0", "SummaryItem"]}], "\[SpanFromLeft]"}, {
               RowBox[{
                 TagBox["\"Failed with errors: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0", "SummaryItem"]}], "\[SpanFromLeft]"}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  TestReportObject[
   Association[
   "Title" -> "Automatic", "TestResults" -> 
    Association[1 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 1, "TestID" -> "RandomS1", 
         "Outcome" -> "Success", "Input" -> HoldForm[
           Max[
            $CellContext`RandomS[5]]], "ExpectedOutput" -> HoldForm[1.], 
         "ActualOutput" -> HoldForm[1.], "ExpectedMessages" -> {}, 
         "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.00029`2.61291299573095, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00028800000004025605`, "Seconds"], "MemoryUsed" -> 
         Quantity[912, "Bytes"]]], 2 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 2, "TestID" -> "LegalTacticQ1", 
         "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`LegalTacticQ[{0.5, 0, 0, -0.5}]], "ExpectedOutput" -> 
         HoldForm[True], "ActualOutput" -> HoldForm[True], 
         "ExpectedMessages" -> {}, "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000155`2.340846696002285, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00015199999998571911`, "Seconds"], "MemoryUsed" -> 
         Quantity[448, "Bytes"]]], 3 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 3, "TestID" -> "LegalTacticQ2", 
         "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`LegalTacticQ[{0.5, 0.2, 0, -0.5}]], "ExpectedOutput" -> 
         HoldForm[False], "ActualOutput" -> HoldForm[False], 
         "ExpectedMessages" -> {}, "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000145`2.311883000066969, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00014300000000844193`, "Seconds"], "MemoryUsed" -> 
         Quantity[64, "Bytes"]]], 4 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 4, "TestID" -> "LegalTacticQ1", 
         "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`LegalTacticQ[{0.5, 0, 0, -0.5}]], "ExpectedOutput" -> 
         HoldForm[True], "ActualOutput" -> HoldForm[True], 
         "ExpectedMessages" -> {}, "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000129`2.261104708131243, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00012699999999199463`, "Seconds"], "MemoryUsed" -> 
         Quantity[64, "Bytes"]]], 5 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 5, "TestID" -> "LegalTacticQ2", 
         "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`LegalTacticQ[{0.5, 0.2, 0, -0.5}]], "ExpectedOutput" -> 
         HoldForm[False], "ActualOutput" -> HoldForm[False], 
         "ExpectedMessages" -> {}, "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000132`2.2710889290378433, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00013000000001284207`, "Seconds"], "MemoryUsed" -> 
         Quantity[64, "Bytes"]]], 6 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 6, "TestID" -> "LegalTQ1", 
         "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`LegalTQ[{{0.5, 0.3}, {-0.5, 0.7}}]], "ExpectedOutput" -> 
         HoldForm[True], "ActualOutput" -> HoldForm[True], 
         "ExpectedMessages" -> {}, "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000121`2.233300368148444, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00011799999998629573`, "Seconds"], "MemoryUsed" -> 
         Quantity[192, "Bytes"]]], 7 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 7, "TestID" -> "LegalTQ2", 
         "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`LegalTQ[{{0.6, 0.3}, {-0.5, 0.7}}]], "ExpectedOutput" -> 
         HoldForm[False], "ActualOutput" -> HoldForm[False], 
         "ExpectedMessages" -> {}, "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000114`2.2074198491684665, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00011199999997302257`, "Seconds"], "MemoryUsed" -> 
         Quantity[192, "Bytes"]]], 8 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 8, "TestID" -> 
         "RandomTacticVector1", "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`LegalTacticQ[
            $CellContext`RandomTactic[5]]], "ExpectedOutput" -> 
         HoldForm[True], "ActualOutput" -> HoldForm[True], 
         "ExpectedMessages" -> {}, "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.030692`4.637540187360689, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.009999999999990905, "Seconds"], "MemoryUsed" -> 
         Quantity[533384, "Bytes"]]], 9 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 9, "TestID" -> 
         "RandomTacticVector2", "Outcome" -> "Success", "Input" -> 
         HoldForm[First[
             $CellContext`RandomTactic[5, 1]] > 0], "ExpectedOutput" -> 
         HoldForm[True], "ActualOutput" -> HoldForm[True], 
         "ExpectedMessages" -> {}, "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000827`3.068020507384541, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.0005340000000160217, "Seconds"], "MemoryUsed" -> 
         Quantity[632, "Bytes"]]], 10 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 10, "TestID" -> 
         "RandomTacticMatrix1", "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`LegalTQ[
            $CellContext`RandomT[3]]], "ExpectedOutput" -> HoldForm[True], 
         "ActualOutput" -> HoldForm[True], "ExpectedMessages" -> {}, 
         "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.003817`3.732237157781093, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.001685000000037462, "Seconds"], "MemoryUsed" -> 
         Quantity[1168, "Bytes"]]], 11 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 11, "TestID" -> "TernaryMatrixQ1",
          "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`TernaryMatrixQ[
            N[
             IdentityMatrix[3]]]], "ExpectedOutput" -> HoldForm[True], 
         "ActualOutput" -> HoldForm[True], "ExpectedMessages" -> {}, 
         "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.00029`2.61291299573095, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00028800000001183435`, "Seconds"], "MemoryUsed" -> 
         Quantity[1744, "Bytes"]]], 12 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 12, "TestID" -> "TernaryMatrixQ2",
          "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`TernaryMatrixQ[
            RandomReal[{0, 1}, {3, 3}]]], "ExpectedOutput" -> HoldForm[False],
          "ActualOutput" -> HoldForm[False], "ExpectedMessages" -> {}, 
         "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000192`2.4338162265355434, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00018899999997756822`, "Seconds"], "MemoryUsed" -> 
         Quantity[72, "Bytes"]]], 13 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 13, "TestID" -> "NormalizeS1", 
         "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`NormalizeS[{0, 0, 0}]], "ExpectedOutput" -> 
         HoldForm[{0., 0., 0.}], "ActualOutput" -> HoldForm[{0., 0., 0.}], 
         "ExpectedMessages" -> {}, "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.00014`2.2966430335102315, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00013699999996674705`, "Seconds"], "MemoryUsed" -> 
         Quantity[232, "Bytes"]]], 14 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 14, "TestID" -> "NormalizeS2", 
         "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`NormalizeS[{0.5, 0.3, 0}]], "ExpectedOutput" -> 
         HoldForm[{1., 0.6, 0.}], "ActualOutput" -> HoldForm[{1., 0.6, 0.}], 
         "ExpectedMessages" -> {}, "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000134`2.2776197961968014, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00013000000001284207`, "Seconds"], "MemoryUsed" -> 
         Quantity[144, "Bytes"]]], 15 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 15, "TestID" -> "NormalizeS3", 
         "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`NormalizeS[{5, 13, 0.3}]], "ExpectedOutput" -> 
         HoldForm[{0.38461538461538464`, 1., 0.023076923076923078`}], 
         "ActualOutput" -> 
         HoldForm[{0.38461538461538464`, 1., 0.023076923076923078`}], 
         "ExpectedMessages" -> {}, "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000104`2.1675483371307744, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00010299999999574538`, "Seconds"], "MemoryUsed" -> 
         Quantity[264, "Bytes"]]], 16 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 16, "TestID" -> 
         "NormalizeTactic1", "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`NormalizeTactic[{0.1, 0, 0}]], "ExpectedOutput" -> 
         HoldForm[{1., 0., 0.}], "ActualOutput" -> HoldForm[{1., 0., 0.}], 
         "ExpectedMessages" -> {}, "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000103`2.163352222537166, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00010000000000331966`, "Seconds"], "MemoryUsed" -> 
         Quantity[232, "Bytes"]]], 17 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 17, "TestID" -> 
         "NormalizeTactic2", "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`NormalizeTactic[{0, 0, 0}]], "ExpectedOutput" -> 
         HoldForm[{0., 0., 0.}], "ActualOutput" -> HoldForm[{0., 0., 0.}], 
         "ExpectedMessages" -> {}, "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000098`2.1417410735244884, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00009499999998752173, "Seconds"], "MemoryUsed" -> 
         Quantity[232, "Bytes"]]], 18 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 18, "TestID" -> 
         "NormalizeTactic3", "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`NormalizeTactic[{1, 2, 4, 4.}]], "ExpectedOutput" -> 
         HoldForm[{0.09090909090909091, 0.18181818181818182`, 
           0.36363636363636365`, 0.36363636363636365`}], "ActualOutput" -> 
         HoldForm[{0.09090909090909091, 0.18181818181818182`, 
           0.36363636363636365`, 0.36363636363636365`}], 
         "ExpectedMessages" -> {}, "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000089`2.099905004476907, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00008700000000771979, "Seconds"], "MemoryUsed" -> 
         Quantity[232, "Bytes"]]], 19 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 19, "TestID" -> 
         "NormalizeTactic2", "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`NormalizeTactic[{-1, 0, 0, 1}]], "ExpectedOutput" -> 
         HoldForm[{-0.5, 0., 0., 0.5}], "ActualOutput" -> 
         HoldForm[{-0.5, 0., 0., 0.5}], "ExpectedMessages" -> {}, 
         "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000081`2.0590000167106437, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00007899999997107443, "Seconds"], "MemoryUsed" -> 
         Quantity[232, "Bytes"]]], 20 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 20, "TestID" -> 
         "NormalizeTernaryT1", "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`NormalizeTernaryT[{{0, 1}, {-1, 0}}]], 
         "ExpectedOutput" -> 
         HoldForm[{{0.9, 0.09999999999999998}, {-0.09999999999999998, 0.9}}], 
         "ActualOutput" -> 
         HoldForm[{{0.9, 0.09999999999999998}, {-0.09999999999999998, 0.9}}], 
         "ExpectedMessages" -> {}, "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000144`2.3088774899272435, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.0001420000000109667, "Seconds"], "MemoryUsed" -> 
         Quantity[368, "Bytes"]]], 21 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 21, "TestID" -> "ToTernary1", 
         "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`ToTernary[{{0.47593052648072004`, 
            0.38946778511397906`, 0.5887854695349517}, {0.36321528609957204`, 
            0.1477143527714231, -0.3520164533294082}, {0.16085418741970775`, 
            0.4628178621145978, 0.05919807713564013}}]], "ExpectedOutput" -> 
         HoldForm[{{0., 1., 1.}, {1., 0., -1.}, {1., 1., 0.}}], 
         "ActualOutput" -> 
         HoldForm[{{0., 1., 1.}, {1., 0., -1.}, {1., 1., 0.}}], 
         "ExpectedMessages" -> {}, "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000085`2.079933923546286, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00008299999998939711, "Seconds"], "MemoryUsed" -> 
         Quantity[304, "Bytes"]]], 22 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 22, "TestID" -> "PadS1", 
         "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`PadS[{1., 1., 0.3}, 5]], "ExpectedOutput" -> 
         HoldForm[{1., 1., 0.3, 0., 0.}], "ActualOutput" -> 
         HoldForm[{1., 1., 0.3, 0., 0.}], "ExpectedMessages" -> {}, 
         "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000081`2.0590000167106437, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00007899999999949614, "Seconds"], "MemoryUsed" -> 
         Quantity[144, "Bytes"]]], 23 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 23, "TestID" -> "PadT1", 
         "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`PadT[
            N[
             IdentityMatrix[3]], 5]], "ExpectedOutput" -> 
         HoldForm[{{1., 0., 0., 0., 0.}, {0., 1., 0., 0., 0.}, {0., 0., 1., 
           0., 0.}, {0., 0., 0., 0., 0.}, {0., 0., 0., 0., 0.}}], 
         "ActualOutput" -> 
         HoldForm[{{1., 0., 0., 0., 0.}, {0., 1., 0., 0., 0.}, {0., 0., 1., 
           0., 0.}, {0., 0., 0., 0., 0.}, {0., 0., 0., 0., 0.}}], 
         "ExpectedMessages" -> {}, "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.005525`3.8928472801891427, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.003119999999967149, "Seconds"], "MemoryUsed" -> 
         Quantity[142272, "Bytes"]]], 24 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 24, "TestID" -> "TrimS1", 
         "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`TrimS[{1, 0.9, 1, 0.5, 0.5, 0, 0, 0}, 5]], 
         "ExpectedOutput" -> HoldForm[{1, 0.9, 1, 0.5, 0.5}], "ActualOutput" -> 
         HoldForm[{1, 0.9, 1, 0.5, 0.5}], "ExpectedMessages" -> {}, 
         "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000149`2.323701266244268, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00014999999999076863`, "Seconds"], "MemoryUsed" -> 
         Quantity[144, "Bytes"]]], 25 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 25, "TestID" -> "TrimT1", 
         "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`TrimT[{{1, 0, 0}, {0, 1, 0}, {0, 0, 0}}, 3]], 
         "ExpectedOutput" -> HoldForm[{{1, 0, 0}, {0, 1, 0}, {0, 0, 0}}], 
         "ActualOutput" -> HoldForm[{{1, 0, 0}, {0, 1, 0}, {0, 0, 0}}], 
         "ExpectedMessages" -> {}, "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000278`2.59455979375007, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00023600000000101318`, "Seconds"], "MemoryUsed" -> 
         Quantity[320, "Bytes"]]], 26 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 26, "TestID" -> "ReorderT1", 
         "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`ReorderT[{{1., 2., 3.}, {4., 5., 6.}, {7., 8., 9.}}, {
            2, 3, 1}]], "ExpectedOutput" -> 
         HoldForm[{{9., 7., 8.}, {3., 1., 2.}, {6., 4., 5.}}], "ActualOutput" -> 
         HoldForm[{{9., 7., 8.}, {3., 1., 2.}, {6., 4., 5.}}], 
         "ExpectedMessages" -> {}, "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000331`2.6703429916077126, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.000269000000031383, "Seconds"], "MemoryUsed" -> 
         Quantity[304, "Bytes"]]], 27 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 27, "TestID" -> "ReorderT2", 
         "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`ReorderT[{{11., 12., 13.}, {21., 22., 23.}, {31., 32.,
             33.}}, {1, 3, 2}]], "ExpectedOutput" -> 
         HoldForm[{{11., 13., 12.}, {31., 33., 32.}, {21., 23., 22.}}], 
         "ActualOutput" -> 
         HoldForm[{{11., 13., 12.}, {31., 33., 32.}, {21., 23., 22.}}], 
         "ExpectedMessages" -> {}, "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000128`2.257724967479862, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00012800000001789158`, "Seconds"], "MemoryUsed" -> 
         Quantity[304, "Bytes"]]], 28 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 28, "TestID" -> "ReorderS1", 
         "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`ReorderS[{4, 7, 2, 1, 9}, 2]], "ExpectedOutput" -> 
         HoldForm[{{7, 9, 4, 2, 1}, {2, 5, 1, 3, 4}}], "ActualOutput" -> 
         HoldForm[{{7, 9, 4, 2, 1}, {2, 5, 1, 3, 4}}], 
         "ExpectedMessages" -> {}, "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000149`2.323701266244268, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00014899999999329339`, "Seconds"], "MemoryUsed" -> 
         Quantity[368, "Bytes"]]], 29 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 29, "TestID" -> "ReorderS2", 
         "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`reorderSizes[{1, 9, 8, 101, 27, 64, 2}]], 
         "ExpectedOutput" -> 
         HoldForm[{{101, 64, 27, 9, 8, 2, 1}, {4, 6, 5, 2, 3, 7, 1}}], 
         "ActualOutput" -> 
         HoldForm[{{101, 64, 27, 9, 8, 2, 1}, {4, 6, 5, 2, 3, 7, 1}}], 
         "ExpectedMessages" -> {}, "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000098`2.1417410735244884, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00009699999998247222, "Seconds"], "MemoryUsed" -> 
         Quantity[384, "Bytes"]]], 30 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 30, "TestID" -> "UpdateS1", 
         "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`UpdateS[{1, 0.4}, {{0.9, -0.17}, {0.1, 0.83}}, {2., 
            3., 1.}]], "ExpectedOutput" -> HoldForm[{0.696, 0.532}], 
         "ActualOutput" -> HoldForm[{0.696, 0.532}], "ExpectedMessages" -> {},
          "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000136`2.284053906202211, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00013400000000274304`, "Seconds"], "MemoryUsed" -> 
         Quantity[232, "Bytes"]]], 31 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 31, "TestID" -> "UpdateS2", 
         "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`UpdateS[{1., 0.4}, 
            N[
             IdentityMatrix[2]], {2., 3., 1.}]], "ExpectedOutput" -> 
         HoldForm[{1., 0.4}], "ActualOutput" -> HoldForm[{1., 0.4}], 
         "ExpectedMessages" -> {}, "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000112`2.1997330205021752, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00011200000002986599`, "Seconds"], "MemoryUsed" -> 
         Quantity[232, "Bytes"]]], 32 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 32, "TestID" -> "UpdateS3", 
         "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`UpdateS[{1., 0.4}, 
            N[
             IdentityMatrix[2]], {2., 3., 0.7}]], "ExpectedOutput" -> 
         HoldForm[{0.7, 0.27999999999999997`}], "ActualOutput" -> 
         HoldForm[{0.7, 0.27999999999999997`}], "ExpectedMessages" -> {}, 
         "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000421`2.774797093667662, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.000181000000026188, "Seconds"], "MemoryUsed" -> 
         Quantity[232, "Bytes"]]], 33 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 33, "TestID" -> "UpdateS4", 
         "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`UpdateS[
            Range[10], 
            N[
             IdentityMatrix[10]], {1.2, 2., 0.98}]], "ExpectedOutput" -> 
         HoldForm[{0.98, 1.96, 2.94, 3.92, 4.9, 5.88, 6.86, 7.84, 8.82, 9.8}],
          "ActualOutput" -> 
         HoldForm[{0.98, 1.96, 2.94, 3.92, 4.9, 5.88, 6.859999999999999, 7.84,
            8.82, 9.8}], "ExpectedMessages" -> {}, "ActualMessages" -> {}, 
         "AbsoluteTimeUsed" -> 
         Quantity[0.000164`2.3653588458796917, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00016200000001731496`, "Seconds"], "MemoryUsed" -> 
         Quantity[296, "Bytes"]]], 34 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 34, "TestID" -> "UpdateS5", 
         "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`UpdateS[{1, 1, 1}, 
            N[{{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}], {1.2, 3., 1.}]], 
         "ExpectedOutput" -> HoldForm[{1., 1., 1.}], "ActualOutput" -> 
         HoldForm[{1., 1., 1.}], "ExpectedMessages" -> {}, 
         "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000099`2.146150192429544, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00009700000001089393, "Seconds"], "MemoryUsed" -> 
         Quantity[232, "Bytes"]]], 35 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 35, "TestID" -> "UpdateS6", 
         "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`UpdateS[{0, 0, 0}, 
            N[{{0, 1, 0}, {1, 0, 1}, {0, 0, 0}}], {2., 3., 1.}]], 
         "ExpectedOutput" -> HoldForm[{0., 0., 0.}], "ActualOutput" -> 
         HoldForm[{0., 0., 0.}], "ExpectedMessages" -> {}, 
         "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000152`2.3323585857767664, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00014899999999329339`, "Seconds"], "MemoryUsed" -> 
         Quantity[232, "Bytes"]]], 36 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 36, "TestID" -> "UpdateS7", 
         "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`UpdateS[{1, 1, 1}, 
            N[{{0, 1, 0}, {1, 0, -1}, {0, 0, 0}}], {2., 3., 1.}]], 
         "ExpectedOutput" -> HoldForm[{2., 0., 0.}], "ActualOutput" -> 
         HoldForm[{2., 0., 0.}], "ExpectedMessages" -> {}, 
         "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000567`2.9040980567249, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.0005709999999794491, "Seconds"], "MemoryUsed" -> 
         Quantity[232, "Bytes"]]], 37 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 37, "TestID" -> "UpdateS8", 
         "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`UpdateS[{1., 1., 1.}, 
            N[{{0.9, 0, 0}, {0.1, 1, 0}, {0, 0, 1}}], {2., 3., 1.}]], 
         "ExpectedOutput" -> HoldForm[{0.9, 1.2, 1.}], "ActualOutput" -> 
         HoldForm[{0.9, 1.2, 1.}], "ExpectedMessages" -> {}, 
         "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000342`2.6845411038881286, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.0001719999999920674, "Seconds"], "MemoryUsed" -> 
         Quantity[232, "Bytes"]]], 38 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 38, "TestID" -> "UpdateS9", 
         "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`UpdateS[{1, 1, 1}, 
            N[{{0.9, 0, 0}, {-0.1, 1, 0}, {0, 0, 1}}], {2., 3., 1.}]], 
         "ExpectedOutput" -> HoldForm[{0.9, 0.7, 1.}], "ActualOutput" -> 
         HoldForm[{0.9, 0.7, 1.}], "ExpectedMessages" -> {}, 
         "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000371`2.7198889074470394, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.0002829999999960364, "Seconds"], "MemoryUsed" -> 
         Quantity[232, "Bytes"]]], 39 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 39, "TestID" -> "UpdateS10", 
         "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`UpdateS[{1, 1, 1}, 
            N[{{0.5, 0, 0}, {-0.5, 1, 0}, {0, 0, 1}}], {2., 3., 1.}]], 
         "ExpectedOutput" -> HoldForm[{0.5, 0., 1.}], "ActualOutput" -> 
         HoldForm[{0.5, 0., 1.}], "ExpectedMessages" -> {}, 
         "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000154`2.3380357186684573, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00015100000001666558`, "Seconds"], "MemoryUsed" -> 
         Quantity[232, "Bytes"]]], 40 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 40, "TestID" -> "UpdateS11", 
         "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`UpdateS[{1, 1, 1}, 
            N[{{0.5, 0, 0}, {-0.5, 1, 0}, {0, 0, 1}}], {2., 3., 0.9}]], 
         "ExpectedOutput" -> HoldForm[{0.45, 0., 0.9}], "ActualOutput" -> 
         HoldForm[{0.45, 0., 0.9}], "ExpectedMessages" -> {}, 
         "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000467`2.819831878398106, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00017300000001796434`, "Seconds"], "MemoryUsed" -> 
         Quantity[232, "Bytes"]]], 41 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 41, "TestID" -> "UpdateS12", 
         "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`UpdateS[{1, 1, 1}, 
            N[{{0, 0, 0}, {0, 0, 0}, {0, 0, 0}}], {1.2, 2., 1.}]], 
         "ExpectedOutput" -> HoldForm[{0., 0., 0.}], "ActualOutput" -> 
         HoldForm[{0., 0., 0.}], "ExpectedMessages" -> {}, 
         "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000174`2.3910642461145937, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00015199999998571911`, "Seconds"], "MemoryUsed" -> 
         Quantity[232, "Bytes"]]], 42 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 42, "TestID" -> "UpdateS13", 
         "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`UpdateS[{1, 1, 1}, 
            N[{{1, 0, 0}, {0, 1, 0}, {0, 0, 1}}], {2., 3., 1.}]], 
         "ExpectedOutput" -> HoldForm[{1., 1., 1.}], "ActualOutput" -> 
         HoldForm[{1., 1., 1.}], "ExpectedMessages" -> {}, 
         "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000127`2.2543187187879505, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00012700000002041634`, "Seconds"], "MemoryUsed" -> 
         Quantity[232, "Bytes"]]], 43 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 43, "TestID" -> "UpdateS14", 
         "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`UpdateS[{1, 1, 1}, 
            N[{{-1, 0, 0}, {0, -1, 0}, {0, 0, -1}}], {2., 3., 1.}]], 
         "ExpectedOutput" -> HoldForm[{0., 0., 0.}], "ActualOutput" -> 
         HoldForm[{0., 0., 0.}], "ExpectedMessages" -> {}, 
         "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000237`2.5252633438420977, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.0001650000000097407, "Seconds"], "MemoryUsed" -> 
         Quantity[232, "Bytes"]]], 44 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 44, "TestID" -> "UpdateS15", 
         "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`UpdateS[{1, 1, 1}, 
            N[{{0.9, 0.1, 0}, {0.1, 0.9, 0}, {0, 0, 1}}], {2., 3., 1.}]], 
         "ExpectedOutput" -> HoldForm[{1.1, 1.1, 1.}], "ActualOutput" -> 
         HoldForm[{1.1, 1.1, 1.}], "ExpectedMessages" -> {}, 
         "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000146`2.3148678536164313, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.0001420000000109667, "Seconds"], "MemoryUsed" -> 
         Quantity[232, "Bytes"]]], 45 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 45, "TestID" -> "UpdateS16", 
         "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`UpdateS[{1, 1, 1}, 
            N[{{0.9, 0.1, 0}, {0.1, 0.9, 0}, {0, 0, 1}}], {2., 3., 0.8}]], 
         "ExpectedOutput" -> 
         HoldForm[{0.9200000000000002, 0.9200000000000002, 0.8}], 
         "ActualOutput" -> 
         HoldForm[{0.9200000000000002, 0.9200000000000002, 0.8}], 
         "ExpectedMessages" -> {}, "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000127`2.2543187187879505, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00012500000002546585`, "Seconds"], "MemoryUsed" -> 
         Quantity[232, "Bytes"]]], 46 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 46, "TestID" -> "UpdateS17", 
         "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`UpdateS[{1, 1, 1}, 
            N[{{0.9, 0.1, 0}, {0.1, 0.9, -0.2}, {0, 0, 0.8}}], {2., 3., 1.}]],
          "ExpectedOutput" -> HoldForm[{1.1, 0.5, 0.8}], "ActualOutput" -> 
         HoldForm[{1.1, 0.5, 0.8}], "ExpectedMessages" -> {}, 
         "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000161`2.3573408738638433, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.0001490000000217151, "Seconds"], "MemoryUsed" -> 
         Quantity[232, "Bytes"]]], 47 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 47, "TestID" -> 
         "SimulateLawOfMotion1", "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`LegalTQ[
            RandomChoice[
             $CellContext`SimulateLawOfMotion[
              $CellContext`RandomTernaryPowerStructure[6]]]["T"]]], 
         "ExpectedOutput" -> HoldForm[True], "ActualOutput" -> HoldForm[True],
          "ExpectedMessages" -> {}, "ActualMessages" -> {}, 
         "AbsoluteTimeUsed" -> 
         Quantity[0.015676`4.345750252638059, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.002053000000017846, "Seconds"], "MemoryUsed" -> 
         Quantity[0, "Bytes"]]], 48 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 48, "TestID" -> "Utility1", 
         "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`UtilityCompiled[
            N[{1, 2, 3, 3, 1}], 2.5]], "ExpectedOutput" -> 
         HoldForm[{0.041666666666666664`, 0.23570226039551584`, 
           0.649519052838329, 0.649519052838329, 0.041666666666666664`}], 
         "ActualOutput" -> 
         HoldForm[{0.041666666666666664`, 0.23570226039551587`, 
           0.649519052838329, 0.649519052838329, 0.041666666666666664`}], 
         "ExpectedMessages" -> {}, "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000133`2.2743666387990795, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.0001310000000103173, "Seconds"], "MemoryUsed" -> 
         Quantity[232, "Bytes"]]], 49 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 49, "TestID" -> "Utility2", 
         "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`UtilityCompiled[
            N[{0, 0, 0}], 2.5]], "ExpectedOutput" -> HoldForm[{0., 0., 0.}], 
         "ActualOutput" -> HoldForm[{0., 0., 0.}], "ExpectedMessages" -> {}, 
         "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000073`2.01383785795245, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00007199999998874773, "Seconds"], "MemoryUsed" -> 
         Quantity[232, "Bytes"]]], 50 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 50, "TestID" -> "PrinceRank1", 
         "Outcome" -> "Success", "Input" -> HoldForm[
           Length[
            $CellContext`PrinceRank[
             $CellContext`RandomTernaryPowerStructure[5]]]], "ExpectedOutput" -> 
         HoldForm[5], "ActualOutput" -> HoldForm[5], "ExpectedMessages" -> {},
          "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000506`2.854665514671793, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.0005040000000064992, "Seconds"], "MemoryUsed" -> 
         Quantity[152, "Bytes"]]], 51 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 51, "TestID" -> "NetTopology1", 
         "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`NetTopology[25, 4, 10]], "ExpectedOutput" -> 
         HoldForm[{25, 22, 19, 16, 13, 10}], "ActualOutput" -> 
         HoldForm[{25, 22, 19, 16, 13, 10}], "ExpectedMessages" -> {}, 
         "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000096`2.132786230871562, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00009499999998752173, "Seconds"], "MemoryUsed" -> 
         Quantity[152, "Bytes"]]], 52 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 52, "TestID" -> "NetTopology2", 
         "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`NetTopology[12, 6, 2]], "ExpectedOutput" -> 
         HoldForm[{12, 10, 9, 7, 6, 4, 3, 2}], "ActualOutput" -> 
         HoldForm[{12, 10, 9, 7, 6, 4, 3, 2}], "ExpectedMessages" -> {}, 
         "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000097`2.1372867320982385, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00009599999998499698, "Seconds"], "MemoryUsed" -> 
         Quantity[168, "Bytes"]]], 53 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 53, "TestID" -> 
         "ShowPowerStructure1", "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`undirectedEdges[{{0, 1, 1}, {0, 0, -1}, {-1, -1, 
            0}}]], "ExpectedOutput" -> HoldForm[{
            UndirectedEdge[2, 3]}], "ActualOutput" -> HoldForm[{
            UndirectedEdge[2, 3]}], "ExpectedMessages" -> {}, 
         "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000096`2.132786230871562, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00009299999999257125, "Seconds"], "MemoryUsed" -> 
         Quantity[296, "Bytes"]]], 54 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 54, "TestID" -> 
         "ShowPowerStructure2", "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`undirectedEdges[{{0, 1, -1}, {0, 0, -1}, {-1, -1, 
            0}}]], "ExpectedOutput" -> HoldForm[{
            UndirectedEdge[1, 3], 
            UndirectedEdge[2, 3]}], "ActualOutput" -> HoldForm[{
            UndirectedEdge[1, 3], 
            UndirectedEdge[2, 3]}], "ExpectedMessages" -> {}, 
         "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.00014`2.2966430335102315, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00013699999999516876`, "Seconds"], "MemoryUsed" -> 
         Quantity[440, "Bytes"]]], 55 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 55, "TestID" -> 
         "ShowPowerStructure3", "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`undirectedEdges[{{0, 1, 0}, {1, 0, -1}, {0, -1, 0}}]],
          "ExpectedOutput" -> HoldForm[{
            UndirectedEdge[1, 2], 
            UndirectedEdge[1, 3], 
            UndirectedEdge[2, 3]}], "ActualOutput" -> HoldForm[{
            UndirectedEdge[1, 2], 
            UndirectedEdge[1, 3], 
            UndirectedEdge[2, 3]}], "ExpectedMessages" -> {}, 
         "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000103`2.163352222537166, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00010200000002669185`, "Seconds"], "MemoryUsed" -> 
         Quantity[424, "Bytes"]]], 56 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 56, "TestID" -> 
         "ShowPowerStructure4", "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`undirectedEdges[{{0, 0}, {0, 0}}]], "ExpectedOutput" -> 
         HoldForm[{
            UndirectedEdge[1, 2]}], "ActualOutput" -> HoldForm[{
            UndirectedEdge[1, 2]}], "ExpectedMessages" -> {}, 
         "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000119`2.2260619592245243, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00011599999999134525`, "Seconds"], "MemoryUsed" -> 
         Quantity[360, "Bytes"]]], 57 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 57, "TestID" -> 
         "ShowPowerStructure5", "Outcome" -> "Success", "Input" -> HoldForm[
           $CellContext`replaceDirectedEdges[{
             DirectedEdge[1, 2], 
             DirectedEdge[1, 3], 
             DirectedEdge[2, 3], 
             DirectedEdge[3, 1], 
             DirectedEdge[3, 2]}, {
             UndirectedEdge[2, 3]}]], "ExpectedOutput" -> HoldForm[{
            DirectedEdge[1, 2], 
            DirectedEdge[1, 3], 
            DirectedEdge[3, 1], 
            UndirectedEdge[2, 3]}], "ActualOutput" -> HoldForm[{
            DirectedEdge[1, 2], 
            DirectedEdge[1, 3], 
            DirectedEdge[3, 1], 
            UndirectedEdge[2, 3]}], "ExpectedMessages" -> {}, 
         "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000091`2.1095563901530876, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00008999999997172381, "Seconds"], "MemoryUsed" -> 
         Quantity[136, "Bytes"]]], 58 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 58, "TestID" -> 
         "HelperFunctions_MapTransposed1", "Outcome" -> "Success", "Input" -> 
         HoldForm[
           $CellContext`MapTransposed[Differences, 
            IdentityMatrix[4]]], "ExpectedOutput" -> 
         HoldForm[{{-1, 1, 0, 0}, {0, -1, 1, 0}, {0, 0, -1, 1}}], 
         "ActualOutput" -> 
         HoldForm[{{-1, 1, 0, 0}, {0, -1, 1, 0}, {0, 0, -1, 1}}], 
         "ExpectedMessages" -> {}, "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000486`2.837151267094287, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00020700000001738772`, "Seconds"], "MemoryUsed" -> 
         Quantity[304, "Bytes"]]], 59 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 59, "TestID" -> 
         "HelperFunctions_ReplaceColumn1", "Outcome" -> "Success", "Input" -> 
         HoldForm[
           $CellContext`ReplaceColumn[
            IdentityMatrix[3], 1, {5, 6, 7}]], "ExpectedOutput" -> 
         HoldForm[{{5, 0, 0}, {6, 1, 0}, {7, 0, 1}}], "ActualOutput" -> 
         HoldForm[{{5, 0, 0}, {6, 1, 0}, {7, 0, 1}}], 
         "ExpectedMessages" -> {}, "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000092`2.114302825177549, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00009099999996919905, "Seconds"], "MemoryUsed" -> 
         Quantity[320, "Bytes"]]], 60 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 60, "TestID" -> 
         "HelperFunctions_ReplaceDiagonal1", "Outcome" -> "Success", "Input" -> 
         HoldForm[
           $CellContext`ReplaceDiagonalReals[
            N[
             IdentityMatrix[3]], 
            N[{9, 10, 11}]]], "ExpectedOutput" -> 
         HoldForm[{{9., 0., 0.}, {0., 10., 0.}, {0., 0., 11.}}], 
         "ActualOutput" -> 
         HoldForm[{{9., 0., 0.}, {0., 10., 0.}, {0., 0., 11.}}], 
         "ExpectedMessages" -> {}, "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000079`2.048142089122435, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00007700000000454565, "Seconds"], "MemoryUsed" -> 
         Quantity[304, "Bytes"]]], 61 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 61, "TestID" -> 
         "HelperFunctions_PositionLargest1", "Outcome" -> "Success", "Input" -> 
         HoldForm[
           $CellContext`PositionLargest[{100, 200, 100, 200, 50}]], 
         "ExpectedOutput" -> HoldForm[2], "ActualOutput" -> HoldForm[2], 
         "ExpectedMessages" -> {}, "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000085`2.079933923546286, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00008199999999192187, "Seconds"], "MemoryUsed" -> 
         Quantity[64, "Bytes"]]], 62 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 62, "TestID" -> 
         "HelperFunctions_PositionLargest2", "Outcome" -> "Success", "Input" -> 
         HoldForm[
           $CellContext`PositionLargest[{100, 200, 100, 200, 50}, 1]], 
         "ExpectedOutput" -> HoldForm[{2}], "ActualOutput" -> HoldForm[{2}], 
         "ExpectedMessages" -> {}, "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000112`2.1997330205021752, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00011099999997554733`, "Seconds"], "MemoryUsed" -> 
         Quantity[272, "Bytes"]]], 63 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 63, "TestID" -> 
         "HelperFunctions_PositionLargest3", "Outcome" -> "Success", "Input" -> 
         HoldForm[
           $CellContext`PositionLargest[{100, 200, 100, 200, 50}, 3]], 
         "ExpectedOutput" -> HoldForm[{2, 4, 1}], "ActualOutput" -> 
         HoldForm[{2, 4, 1}], "ExpectedMessages" -> {}, 
         "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000096`2.132786230871562, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00009399999999004649, "Seconds"], "MemoryUsed" -> 
         Quantity[128, "Bytes"]]], 64 -> TestResultObject[
        Association[
        "TestClass" -> None, "TestIndex" -> 64, "TestID" -> 
         "HelperFunctions_ZeroDiagonalize1", "Outcome" -> "Success", "Input" -> 
         HoldForm[
           $CellContext`ZeroDiagonalize[
            N[{{2, 6, 8}, {5, 9, 6}, {6, 6, 2}}]]], "ExpectedOutput" -> 
         HoldForm[{{0., 6., 8.}, {5., 0., 6.}, {6., 6., 0.}}], "ActualOutput" -> 
         HoldForm[{{0., 6., 8.}, {5., 0., 6.}, {6., 6., 0.}}], 
         "ExpectedMessages" -> {}, "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
         Quantity[0.000082`2.0643288502157104, "Seconds"], "CPUTimeUsed" -> 
         Quantity[0.00007999999999697138, "Seconds"], "MemoryUsed" -> 
         Quantity[304, "Bytes"]]]], 
    "TestsSucceededIndices" -> {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
      15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 
     33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 
     51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64}, 
    "TestsFailedIndices" -> {}, "TestsFailedWrongResultsIndices" -> {}, 
    "TestsFailedWithMessagesIndices" -> {}, 
    "TestsFailedWithErrorsIndices" -> {}, "TimeElapsed" -> 
    Quantity[0.0667399999999999998`3.168721226166881, "Seconds"], 
    "TestsSucceededCount" -> 64, "TestsFailedCount" -> 0, 
    "TestsFailedWrongResultsCount" -> 0, "TestsFailedWithMessagesCount" -> 0, 
    "TestsFailedWithErrorsCount" -> 0, "Aborted" -> False]],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{
  3.755094715482111*^9, 3.7550959332815104`*^9, 3.755111717146256*^9, 
   3.7551186331032476`*^9, 3.755118806397813*^9, 3.7551189778179893`*^9, 
   3.7551191977316933`*^9, 3.755119267896051*^9, 3.7551197097318077`*^9, 
   3.75511981271315*^9, {3.755120438386221*^9, 3.7551204509631023`*^9}, {
   3.7551204857080393`*^9, 3.755120549704561*^9}, 3.755120587330576*^9, {
   3.755181789257057*^9, 3.7551817971779747`*^9}, {3.75519089581528*^9, 
   3.755190911634594*^9}, 3.755190949477871*^9, 3.755191078277948*^9, 
   3.755191274972185*^9, 3.755194617833254*^9, 3.755198813846715*^9, 
   3.7552022601022587`*^9, 3.755203176340534*^9, 3.75525944695182*^9, 
   3.755346987763163*^9, 3.7553693756275997`*^9, 3.755369488117897*^9, 
   3.755370791399993*^9, 3.75562336728195*^9, 3.755624039523219*^9, 
   3.755624202551567*^9, 3.755624600044216*^9, 3.755624731798642*^9, 
   3.7556869547941837`*^9, 3.755700614949829*^9, 3.7557208958806*^9, 
   3.755723250539853*^9, 3.755723347195212*^9, 3.755723918482375*^9, 
   3.755724204970992*^9, 3.75572442443747*^9, 3.755724564483028*^9, 
   3.755799062657905*^9, {3.755799108798244*^9, 3.755799132529422*^9}, 
   3.7557991971643248`*^9, 3.755799577708309*^9, 3.755799653473052*^9, 
   3.755804267623148*^9, 3.755812405500011*^9, 3.7558125545011683`*^9, {
   3.7560364438880005`*^9, 3.7560364527176003`*^9}, 3.7560367665428023`*^9, 
   3.756036849771203*^9, 3.7560371077172046`*^9, 3.756037179820405*^9, 
   3.7560407075420275`*^9, {3.756041382444832*^9, 3.756041410119232*^9}, 
   3.7560414468728323`*^9, 3.756041496106433*^9, 3.7560415655576334`*^9, 
   3.756042784520441*^9, 3.756043052497243*^9, 3.7560437391156473`*^9, 
   3.756220625730002*^9, 3.7562209478700037`*^9, 3.7562210004576044`*^9, {
   3.7562227274868155`*^9, 3.7562227454424157`*^9}, 3.7562228545644164`*^9, {
   3.756222933984017*^9, 3.756222941908817*^9}, 3.756223246904419*^9, {
   3.756223315591219*^9, 3.756223342532419*^9}, {3.7562234306568203`*^9, 
   3.7562234494548197`*^9}, {3.7562235093120203`*^9, 
   3.7562235374076204`*^9}, {3.7562235727884207`*^9, 3.756223589917221*^9}, 
   3.756224499191227*^9, {3.756309808563349*^9, 3.756309827387329*^9}, 
   3.756310012597385*^9, {3.756310298476881*^9, 3.75631030161656*^9}, 
   3.756395374241082*^9, 3.75639725945967*^9, 3.756986326912609*^9, 
   3.756996228382854*^9, 3.756996324851379*^9, {3.756996442507571*^9, 
   3.7569964502722178`*^9}, 3.756996623090701*^9, 3.757018492166141*^9, 
   3.757018545742464*^9, 3.757281306693*^9, 3.757281401059031*^9, 
   3.757340325053894*^9, 3.757340543507184*^9, {3.7573484012232103`*^9, 
   3.757348405347375*^9}, {3.757348608244928*^9, 3.7573486383886642`*^9}, 
   3.7573487607230577`*^9, 3.757348803810685*^9, 3.7573488967994957`*^9, 
   3.757455064550736*^9, 3.757508255531893*^9, 3.757515498359309*^9, 
   3.757517545614387*^9, 3.7576139572797213`*^9, 3.757890438709662*^9, 
   3.757971008452734*^9, 3.7581409635551987`*^9, 3.7581460893191843`*^9, 
   3.758293321866576*^9, 3.75832002555081*^9, 3.758541949632454*^9, 
   3.758542505683193*^9, 3.758654582177619*^9, 3.758654728700582*^9, 
   3.7586548612037907`*^9, 3.758654919359811*^9, 3.758655870243024*^9, 
   3.75874348642983*^9, 3.758748720651862*^9, 3.7587970130184393`*^9, 
   3.758797318220158*^9, {3.758906450318321*^9, 3.758906453210669*^9}, 
   3.758911418709716*^9, 3.758911509489749*^9, {3.758912634236891*^9, 
   3.758912636959466*^9}, 3.758924370042139*^9, 3.758925016075324*^9, 
   3.758925103922452*^9, 3.758925136468045*^9, 3.760101586785878*^9, 
   3.7601189081371727`*^9, 3.7609760541969357`*^9, 3.760977072959628*^9, 
   3.760980515178748*^9, 3.7660549054331093`*^9, 3.766343672642775*^9, 
   3.76694803001828*^9, 3.767087815923965*^9, 3.768470824646172*^9, 
   3.769299398215351*^9, 3.769626311866119*^9, 3.769626358036639*^9, 
   3.769695453708169*^9, 3.770142120566333*^9, 3.7702340735115833`*^9, 
   3.773647921257525*^9, 3.77883575660126*^9, 3.781188288091447*^9, 
   3.7830671085114098`*^9, 3.784137652755024*^9, 3.7861894492054653`*^9, 
   3.787390296498508*^9, 3.790980735549329*^9, 3.791055858620398*^9, 
   3.7921517555182247`*^9, 3.7925351702782097`*^9, 3.794219158574301*^9, 
   3.796220465944911*^9, 3.7962446340258837`*^9, {3.796246025404608*^9, 
   3.7962460453721867`*^9}, 3.7963043446066236`*^9, 3.796308723214514*^9, 
   3.7963327477051086`*^9, 3.7963340325974493`*^9, 3.796813964599409*^9, 
   3.796941788199793*^9, 3.797459733075522*^9, 3.7978062995133533`*^9, 
   3.797806554504575*^9, 3.797806619511441*^9, 3.798021758893628*^9, 
   3.798232246070753*^9, 3.798579385937394*^9, 3.798727264735828*^9, 
   3.7987272959370327`*^9, 3.798727807341124*^9, 3.7993595756635*^9, 
   3.79941371438874*^9, 3.7994484681177692`*^9, 3.7994851759460583`*^9, 
   3.799613237095388*^9, 3.799928023419339*^9, 3.80040040786088*^9, 
   3.800873482121904*^9, 3.8011641939435987`*^9, {3.801164394905858*^9, 
   3.801164424711666*^9}, 3.8011645694504642`*^9, 3.80116494681523*^9, 
   3.801165427322833*^9, {3.801165489914467*^9, 3.801165495738967*^9}, {
   3.8011656529128113`*^9, 3.801165668197556*^9}, 3.8011656992520037`*^9, 
   3.8011657503740463`*^9, {3.801165840546164*^9, 3.8011658704051857`*^9}, {
   3.801168889887309*^9, 3.8011688954238787`*^9}, 3.801174133780834*^9, {
   3.8012382779664803`*^9, 3.801238282230566*^9}, 3.801306157169429*^9, 
   3.801307254290455*^9, 3.801307489373906*^9, 3.801308398428102*^9, 
   3.801948156757324*^9, 3.802213438016223*^9, 3.802264971028583*^9, {
   3.802265003661573*^9, 3.802265010775227*^9}, 3.802350218723628*^9, 
   3.8023508872153797`*^9, 3.802354465483694*^9, 3.8023545158701773`*^9, 
   3.8023545530646048`*^9, 3.80235461352386*^9, {3.802357689660885*^9, 
   3.802357708158288*^9}, 3.802358162457611*^9, {3.802360074411775*^9, 
   3.802360079461013*^9}, {3.802360403520543*^9, 3.802360408825438*^9}, 
   3.802360486121283*^9, {3.802368323425148*^9, 3.80236832653615*^9}, {
   3.802373073769472*^9, 3.802373079191989*^9}, 3.8023738045689707`*^9, 
   3.802373857429668*^9, 3.802373931756181*^9, 3.802373963423175*^9, 
   3.8023741077642097`*^9, {3.8023745179613*^9, 3.802374533754682*^9}, 
   3.802379367911265*^9, {3.802379400602208*^9, 3.8023794059941187`*^9}, 
   3.80237943869706*^9, 3.8023795608313293`*^9, 3.802379937603364*^9, 
   3.802379974696967*^9, 3.802380039963015*^9, 3.802384884647997*^9, {
   3.802384922378079*^9, 3.802384936716461*^9}, 3.802427469730844*^9, 
   3.802427595992468*^9, {3.802428055955627*^9, 3.802428116250485*^9}, {
   3.8024304626491623`*^9, 3.802430473531455*^9}, 3.8024311893919983`*^9, 
   3.802431283808297*^9, 3.8024313403831797`*^9, {3.802431370420731*^9, 
   3.802431398486198*^9}, 3.802431517074238*^9, 3.8024315881344347`*^9, 
   3.802431630182333*^9, 3.802431744682167*^9, 3.802431783583825*^9, 
   3.802431837300764*^9, 3.802431875072791*^9, 3.802431914203374*^9, 
   3.802432923291952*^9, 3.802438620531707*^9, 3.8024386534589863`*^9, 
   3.802439995785898*^9, 3.8024422077742367`*^9, 3.8024566725675898`*^9, 
   3.803894544143248*^9, 3.8038965175757627`*^9, 3.803916599426437*^9, 
   3.8039864428754396`*^9, {3.803986597094509*^9, 3.803986619314855*^9}, 
   3.803987496083506*^9, 3.803987974068487*^9, 3.804074510257379*^9, 
   3.804074578579232*^9, 3.804162056104484*^9, 3.8041721548721724`*^9, 
   3.804519130154599*^9, 3.8051461065634203`*^9, 3.8051495705564833`*^9, 
   3.8056673940374517`*^9, 3.8057482646061*^9, 3.80658576310145*^9, 
   3.806674366770852*^9, 3.807356869292927*^9, 3.8074593849866543`*^9, 
   3.807548531728058*^9, 3.808094233837308*^9, 3.8080944604780483`*^9, 
   3.80812794790569*^9, 3.808140147858872*^9, 3.808157162938465*^9, 
   3.808157236714622*^9, 3.808258570299182*^9, 3.808433942052001*^9, 
   3.8084358199765882`*^9, {3.808438897312221*^9, 3.808438904358192*^9}, 
   3.808438943461499*^9, 3.808485358732236*^9, 3.808486209438669*^9, 
   3.808597919962409*^9, 3.8085982784771557`*^9, {3.808598328113323*^9, 
   3.808598330762762*^9}, 3.80859839260883*^9, 3.808678525199449*^9, 
   3.808678964562289*^9, {3.808693616541131*^9, 3.808693640909111*^9}, 
   3.80875365673737*^9, 3.8087538817517557`*^9, 3.808767286159911*^9, 
   3.808812638629307*^9, 3.809028642261018*^9, 3.809460327759707*^9, 
   3.80950501982008*^9, 3.809505147350868*^9, 3.81022547733185*^9, 
   3.810409699886323*^9, 3.812051611486102*^9, 3.814012566235921*^9, 
   3.815400422567082*^9, 3.81781221657131*^9, 3.817813530138966*^9, 
   3.818165114556913*^9, 3.818519318724022*^9, 3.819525389932769*^9, 
   3.820703640887649*^9, 3.820703705547358*^9, 3.8207488058339787`*^9, 
   3.820748921728798*^9, 3.821102048491633*^9, 3.821207395365259*^9, 
   3.8212080113360977`*^9, 3.821288122990136*^9, 3.821385875060727*^9, 
   3.821624511978388*^9, 3.822073600669153*^9, 3.8221494180455637`*^9, 
   3.8221496563712893`*^9, {3.822158166012594*^9, 3.8221581709902983`*^9}, 
   3.82215820124459*^9, {3.822158233787201*^9, 3.822158243259907*^9}, {
   3.822158343729267*^9, 3.8221583826532*^9}, 3.822219262786758*^9, 
   3.822243984404428*^9, 3.822246485772666*^9, 3.822325399548196*^9, 
   3.822388859782633*^9, 3.822489782698423*^9},
 CellLabel->
  "Out[168]=",ExpressionUUID->"785afb5a-5202-429c-9310-8b520fd470dc"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Analyzing Failures", "Subsection",
 CellChangeTimes->{{3.710411512383787*^9, 3.71041151957971*^9}, {
  3.710412373458767*^9, 3.710412374170734*^9}, {3.7290934845086308`*^9, 
  3.729093488535424*^9}},ExpressionUUID->"9a7b165c-5042-4798-ba1d-\
1e95632c3a22"],

Cell["Shows which test cases failed:", "Text",
 CellChangeTimes->{{3.684767394831428*^9, 3.684767403525343*^9}, 
   3.710412434736627*^9, 
   3.7551909564312677`*^9},ExpressionUUID->"35c4cbd3-de33-4bc0-9cc0-\
64edf603a849"],

Cell[BoxData[
 RowBox[{
  RowBox[{"report", "[", "\"\<TestsFailedWrongResults\>\"", "]"}], 
  " "}]], "Input",
 CellChangeTimes->{3.732642271975168*^9},
 CellLabel->
  "In[2362]:=",ExpressionUUID->"17a0326e-981e-4d1c-a23f-9a688bfaa7b8"]
}, Open  ]]
}, Closed]]
}, Open  ]]
},
WindowSize->{1097, 847},
WindowMargins->{{Automatic, 126}, {Automatic, 0}},
Magnification:>1.25 Inherited,
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (June 19, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"b2c31a99-fed2-4667-b8ae-b1cae74f3508"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 527, 8, 86, "Chapter",ExpressionUUID->"e032b05b-cd00-4572-9c6c-a9a26be56083"],
Cell[CellGroupData[{
Cell[1132, 34, 156, 3, 84, "Section",ExpressionUUID->"2715d97a-f9b0-4ea8-b2b1-5dfaf4d1e610"],
Cell[CellGroupData[{
Cell[1313, 41, 167, 3, 67, "Subsection",ExpressionUUID->"f2086a09-da04-4e0f-8f72-6e8c8a0c11af"],
Cell[CellGroupData[{
Cell[1505, 48, 169, 3, 56, "Subsubsection",ExpressionUUID->"2fa5c1cb-6be8-4490-b5da-f9dc2b36a8b7"],
Cell[1677, 53, 307, 7, 73, "Text",ExpressionUUID->"30c28822-228e-4872-a48e-a01544a260d7"]
}, Closed]],
Cell[CellGroupData[{
Cell[2021, 65, 170, 3, 45, "Subsubsection",ExpressionUUID->"132b521d-eec3-4c34-b335-990aa4eb8907"],
Cell[2194, 70, 232, 6, 44, "Text",ExpressionUUID->"e474443b-6905-49b7-b666-c8e9869a4312"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[2475, 82, 161, 3, 46, "Subsection",ExpressionUUID->"9b5b2019-ceaf-483d-99fa-5afc3329422e"],
Cell[CellGroupData[{
Cell[2661, 89, 207, 4, 56, "Subsubsection",ExpressionUUID->"51907911-1543-4a38-8968-e28e17494e85"],
Cell[CellGroupData[{
Cell[2893, 97, 335, 7, 40, "ItemNumbered",ExpressionUUID->"2c00d0a8-d489-4366-8017-8b323ef5cdfb"],
Cell[3231, 106, 285, 6, 40, "ItemNumbered",ExpressionUUID->"9aa7cc33-1e5c-465b-b4ab-447e79a22a62"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[3565, 118, 229, 4, 45, "Subsubsection",ExpressionUUID->"1aae7f62-88f1-4dcf-9bf2-bf8319f210ab"],
Cell[3797, 124, 461, 15, 159, "Text",ExpressionUUID->"ac51f238-28dd-4662-893d-ca29dde48653"]
}, Closed]],
Cell[CellGroupData[{
Cell[4295, 144, 163, 3, 45, "Subsubsection",ExpressionUUID->"7ba111bd-3d5f-4e3f-9abd-5fd9eda92fde"],
Cell[4461, 149, 215, 3, 64, "Text",ExpressionUUID->"07d03c79-e548-4e17-93d3-3131fb0a3ef3"],
Cell[4679, 154, 227, 3, 64, "Text",ExpressionUUID->"e1938aa8-d4b9-4069-b070-0e77efd3945d"],
Cell[4909, 159, 213, 3, 64, "Text",ExpressionUUID->"d944d52b-6640-4cc9-9621-4b9a1d1a1e22"],
Cell[5125, 164, 219, 3, 64, "Text",ExpressionUUID->"281b74d7-181a-4b85-8130-1db100638697"],
Cell[5347, 169, 212, 3, 64, "Text",ExpressionUUID->"933bf063-5fe1-4eeb-8674-a51bad5dd692"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[5608, 178, 157, 3, 46, "Subsection",ExpressionUUID->"c7c2d8e3-c160-4f82-9d63-e3b306f83bfb"],
Cell[5768, 183, 144, 3, 44, "Text",ExpressionUUID->"d46be57b-1b04-4ae8-8e88-a2a131b05bce"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[5961, 192, 160, 3, 65, "Section",ExpressionUUID->"569c4edd-10ae-430b-924b-fe830f881668"],
Cell[CellGroupData[{
Cell[6146, 199, 209, 4, 67, "Subsection",ExpressionUUID->"1f0dc824-0eea-452e-8eb2-cd040f79499a"],
Cell[CellGroupData[{
Cell[6380, 207, 164, 3, 56, "Subsubsection",ExpressionUUID->"49ce4e80-1dec-4c1e-b49a-43de4a65ffff"],
Cell[6547, 212, 432, 8, 73, "Text",ExpressionUUID->"3f3168e2-e5c7-4960-bea1-00ad66f21a03"],
Cell[6982, 222, 4368, 97, 292, "Input",ExpressionUUID->"ee5a77b2-10cf-4757-bce4-8367daad93f6",
 InitializationCell->True],
Cell[11353, 321, 229, 4, 44, "Text",ExpressionUUID->"04b5a5f7-8712-4b59-818e-57215c27e06c"],
Cell[11585, 327, 1083, 20, 57, "Input",ExpressionUUID->"e469c755-088c-4fba-a5ed-53cc6df42d97",
 InitializationCell->True],
Cell[12671, 349, 253, 4, 44, "Text",ExpressionUUID->"d38bcfd0-8c25-4ac3-85fe-4421ed52d2bb"],
Cell[12927, 355, 1208, 23, 57, "Input",ExpressionUUID->"d6fdecfe-ef81-4379-ba5e-22176d46939c"],
Cell[14138, 380, 269, 6, 44, "Text",ExpressionUUID->"42fcc785-0832-43ed-b834-6bc517fb524f"],
Cell[14410, 388, 1140, 19, 57, "Input",ExpressionUUID->"10e4ed7a-3c5e-49a6-ac41-1d44e75a0ac6",
 InitializationCell->True],
Cell[15553, 409, 294, 4, 44, "Text",ExpressionUUID->"6ca3a15f-d645-4b97-9a88-467b14bdf1d8"],
Cell[15850, 415, 1332, 21, 110, "Input",ExpressionUUID->"c5653cb2-40d2-4d3d-9493-5f586ce670f9",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[17219, 441, 252, 5, 45, "Subsubsection",ExpressionUUID->"ae5b0b64-30df-405e-9ef8-ed1dd3024239"],
Cell[17474, 448, 468, 8, 72, "Text",ExpressionUUID->"7ea9b458-1167-457e-9bc1-4743cd445d96"],
Cell[17945, 458, 648, 15, 85, "Input",ExpressionUUID->"60531b0b-40b5-41f8-b258-0feda9fdd5b7",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[18630, 478, 177, 3, 45, "Subsubsection",ExpressionUUID->"d9ec568d-6cc4-40bf-85b5-0d58a9e7e10b"],
Cell[18810, 483, 226, 4, 44, "Text",ExpressionUUID->"41b0bae5-c418-4e5d-adfc-06193d58533b"],
Cell[19039, 489, 444, 8, 57, "Input",ExpressionUUID->"bc1a9d5f-383d-4c33-ba80-f3dd017c1f1a",
 InitializationCell->True],
Cell[19486, 499, 322, 7, 44, "Text",ExpressionUUID->"769215bc-1382-427b-abda-dc6f9b4df0f9"],
Cell[19811, 508, 737, 14, 57, "Input",ExpressionUUID->"27536425-dab3-4c1b-bd78-cea8c1c59635",
 InitializationCell->True],
Cell[20551, 524, 805, 17, 57, "Input",ExpressionUUID->"c17f1eca-3314-421f-b8fb-41bc431b5de0"],
Cell[21359, 543, 261, 6, 44, "Text",ExpressionUUID->"bc5dccd7-5491-493d-bd14-6485995d8a69"],
Cell[21623, 551, 603, 11, 57, "Input",ExpressionUUID->"95e12c90-a564-48c6-8b13-06e746148eac",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[22275, 568, 213, 4, 46, "Subsection",ExpressionUUID->"8506c672-2421-4bfe-9241-d3e8767168c6"],
Cell[CellGroupData[{
Cell[22513, 576, 195, 4, 56, "Subsubsection",ExpressionUUID->"5d7ce8a4-12ff-4e73-b0ae-691ec4d61daf"],
Cell[22711, 582, 839, 20, 73, "Text",ExpressionUUID->"c60b6a89-3f16-4065-8125-3018f9366a38"],
Cell[23553, 604, 837, 21, 57, "Input",ExpressionUUID->"05e0d7ec-c884-404e-968c-9a3b0bd76f62"],
Cell[24393, 627, 265, 6, 44, "Text",ExpressionUUID->"29e03def-44ed-48a7-bc8d-178610f41ea4"],
Cell[24661, 635, 1708, 27, 57, "Input",ExpressionUUID->"8aa05fda-3ab3-4117-86e4-a7d2d4850cb7",
 InitializationCell->True],
Cell[26372, 664, 489, 9, 44, "Text",ExpressionUUID->"9015265f-45af-45b3-9561-be070744d0ef"],
Cell[26864, 675, 1738, 29, 57, "Input",ExpressionUUID->"f7465fa8-56eb-4032-913a-34b1f9a7757c",
 InitializationCell->True],
Cell[28605, 706, 471, 9, 73, "Text",ExpressionUUID->"7c3b1160-2d89-43a6-94ad-8b273299b45e"],
Cell[29079, 717, 1763, 27, 57, "Input",ExpressionUUID->"8500c6c7-eeb0-484a-87eb-21243d57ad1c",
 InitializationCell->True],
Cell[30845, 746, 325, 5, 44, "Text",ExpressionUUID->"462d5b84-98ce-41e2-b4c4-be4852e6a4fe"],
Cell[31173, 753, 1686, 29, 57, "Input",ExpressionUUID->"a0e2a544-5c45-4d20-8c74-a47fcdaeb644",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[32896, 787, 142, 3, 45, "Subsubsection",ExpressionUUID->"6ba37977-2522-43f3-bcf2-c59198a4eeb8"],
Cell[33041, 792, 262, 6, 44, "Text",ExpressionUUID->"87c489b0-5530-407a-92ec-717bcd00f725"],
Cell[33306, 800, 477, 11, 57, "Input",ExpressionUUID->"35ec4c56-7d9f-4a67-b6f3-e869e9594d94",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[33820, 816, 139, 3, 45, "Subsubsection",ExpressionUUID->"7a002ec9-5cd0-4bc7-ac3f-b544a7eb2e59"],
Cell[33962, 821, 260, 6, 44, "Text",ExpressionUUID->"6d8e35fb-f852-42a6-80de-a24dc64d5943"],
Cell[34225, 829, 501, 12, 57, "Input",ExpressionUUID->"4f5cd28b-aa15-47a9-bae2-95968514bff8",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[34763, 846, 157, 3, 45, "Subsubsection",ExpressionUUID->"0168f3ab-0c5c-4b1b-bdd7-c997d3fd7214"],
Cell[34923, 851, 394, 8, 44, "Text",ExpressionUUID->"fdf8324f-66fe-4fae-aa8b-3183513c1a1d"],
Cell[35320, 861, 1417, 32, 110, "Input",ExpressionUUID->"04631f1a-2e84-495e-a2ad-088c068d1477",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[36762, 897, 319, 6, 57, "Input",ExpressionUUID->"c63325e2-e052-4f92-881a-1096aa0013a0"],
Cell[37084, 905, 1937, 52, 83, "Output",ExpressionUUID->"32698c8a-52a0-4f34-8c00-41453a2dd227"]
}, Open  ]],
Cell[39036, 960, 225, 5, 44, "Text",ExpressionUUID->"f63300ad-3616-42fd-b9e3-8a161ea508fc"],
Cell[39264, 967, 398, 9, 57, "Input",ExpressionUUID->"9e196b7d-defc-4ee2-ba02-e1726659019a",
 InitializationCell->True]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[39723, 983, 161, 3, 65, "Section",ExpressionUUID->"e0823931-620a-4c85-9d94-6f3c5c4352cb"],
Cell[CellGroupData[{
Cell[39909, 990, 156, 3, 67, "Subsection",ExpressionUUID->"71fe9890-3461-4228-b16a-af76f2d5d8b6"],
Cell[CellGroupData[{
Cell[40090, 997, 141, 3, 56, "Subsubsection",ExpressionUUID->"6f92986c-6cf1-4168-ad25-fe2bd8f47bad"],
Cell[40234, 1002, 263, 6, 43, "Text",ExpressionUUID->"d0374ac5-17c7-412f-91ad-3482d1f0a24b"],
Cell[40500, 1010, 566, 12, 57, "Input",ExpressionUUID->"332aa180-841f-4115-892c-e480d6079234",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[41115, 1028, 151, 3, 46, "Subsection",ExpressionUUID->"e5084a88-68a9-4d27-ae86-35ecd408efb8"],
Cell[CellGroupData[{
Cell[41291, 1035, 166, 3, 56, "Subsubsection",ExpressionUUID->"fdd52929-a3e7-4409-836c-83a85d246b25"],
Cell[41460, 1040, 403, 9, 73, "Text",ExpressionUUID->"c0f5cd0e-c8eb-405c-8139-f6d2d2f2fa3d"],
Cell[41866, 1051, 721, 16, 57, "Input",ExpressionUUID->"f90b618e-9dcf-4166-976f-ec42e1d9f804",
 InitializationCell->True,
 CellID->27851604],
Cell[42590, 1069, 978, 24, 84, "Input",ExpressionUUID->"8ec6264a-caba-4c52-a6f1-3174cd922ee1",
 InitializationCell->True,
 CellID->395511347],
Cell[43571, 1095, 1180, 29, 84, "Input",ExpressionUUID->"5c46d030-552f-4ec8-ba33-f557c431def8",
 InitializationCell->True,
 CellID->323133670]
}, Closed]],
Cell[CellGroupData[{
Cell[44788, 1129, 165, 3, 45, "Subsubsection",ExpressionUUID->"791e6515-e661-4159-b114-09bf7467f0de"],
Cell[44956, 1134, 535, 15, 43, "Text",ExpressionUUID->"4f053fa2-654c-4c87-a92c-c2f760f93981"],
Cell[45494, 1151, 500, 11, 57, "Input",ExpressionUUID->"70c61667-bfdc-4757-98bc-cc6bbe991194",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[46019, 1166, 343, 8, 57, "Input",ExpressionUUID->"bf2690ba-4ba4-4ca0-a039-08450e03ddcc"],
Cell[46365, 1176, 177, 3, 42, "Output",ExpressionUUID->"702b8e23-3e26-4b93-8e1f-ad58d2fef061"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[46591, 1185, 158, 3, 45, "Subsubsection",ExpressionUUID->"96db0ed2-69e3-4637-b324-21336c5e55ff"],
Cell[46752, 1190, 327, 8, 44, "Text",ExpressionUUID->"2a04d710-9b3a-4a3b-a98d-89b36a8d57b0"],
Cell[47082, 1200, 357, 8, 57, "Input",ExpressionUUID->"5133cedb-0757-4c02-90e6-908192ea753d",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[47488, 1214, 158, 3, 46, "Subsection",ExpressionUUID->"e73bef0c-d049-4c78-ad44-b4ed8469b04d"],
Cell[CellGroupData[{
Cell[47671, 1221, 241, 4, 56, "Subsubsection",ExpressionUUID->"14e84133-f928-4ba1-8fb5-7484be2628bf"],
Cell[47915, 1227, 263, 6, 43, "Text",ExpressionUUID->"1060bf40-42e8-4dae-864e-96e384c51044"],
Cell[48181, 1235, 920, 20, 85, "Input",ExpressionUUID->"931a8962-1c73-4d0b-8d39-5e040defb1a1",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[49138, 1260, 163, 3, 45, "Subsubsection",ExpressionUUID->"22069f9d-0eca-4eaa-b2d7-03c65c45ac30"],
Cell[49304, 1265, 326, 8, 43, "Text",ExpressionUUID->"1a7a8d71-7284-4fe2-88b9-f357cc5f937a"],
Cell[49633, 1275, 1011, 23, 137, "Input",ExpressionUUID->"a5cbbd06-98a3-4224-9ac1-ee0fed09487f",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[50681, 1303, 166, 3, 45, "Subsubsection",ExpressionUUID->"0b56b242-72b4-4890-82c1-e5988c6db015"],
Cell[50850, 1308, 540, 9, 43, "Text",ExpressionUUID->"d685bb37-f6b9-4302-91b1-211ff526084d"],
Cell[51393, 1319, 664, 14, 57, "Input",ExpressionUUID->"e9806dc7-9b23-4e7d-a1e2-285b9b086343"],
Cell[52060, 1335, 268, 6, 43, "Text",ExpressionUUID->"a517e66f-1a27-4152-be4b-3c2b5a726f0b"],
Cell[52331, 1343, 2052, 49, 268, "Input",ExpressionUUID->"bdb876d0-a0e1-4b50-8946-bbf1c3fe3a20",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[54420, 1397, 170, 3, 45, "Subsubsection",ExpressionUUID->"82b9f309-b584-4a15-8f41-4e1648278058"],
Cell[54593, 1402, 373, 7, 72, "Text",ExpressionUUID->"ad725d68-8d95-4187-8e30-b7effc0b2e12"],
Cell[54969, 1411, 734, 14, 57, "Input",ExpressionUUID->"a1387404-2ee9-4cd8-b0a9-b92684ce38bc",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[55740, 1430, 163, 3, 45, "Subsubsection",ExpressionUUID->"a98ae373-a640-438b-b026-cbfc4f21f394"],
Cell[55906, 1435, 221, 5, 43, "Text",ExpressionUUID->"c6311e98-7a44-4a0a-9f8d-1ecb4aa6eded"],
Cell[56130, 1442, 479, 12, 57, "Input",ExpressionUUID->"7d6da790-fc33-43df-97a5-4a97e6520422",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[56634, 1458, 248, 5, 57, "Input",ExpressionUUID->"357aa799-c6d0-408a-887c-3019dbb87763"],
Cell[56885, 1465, 516, 13, 42, "Output",ExpressionUUID->"19f06388-7953-4483-84a3-d70620742f59"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[57462, 1485, 160, 3, 46, "Subsection",ExpressionUUID->"cc26c9e7-5dc7-4ccf-9827-1bf5e85d9f51"],
Cell[57625, 1490, 273, 4, 43, "Text",ExpressionUUID->"6aac6bc5-f681-4656-ab02-3d2defb24223"],
Cell[57901, 1496, 7900, 167, 1003, "Input",ExpressionUUID->"e655e5ca-96ec-4a50-ab44-a108c89eece4",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[65850, 1669, 222, 4, 65, "Section",ExpressionUUID->"12a285f5-b612-46b1-b366-d09dd462e4ff"],
Cell[CellGroupData[{
Cell[66097, 1677, 163, 3, 67, "Subsection",ExpressionUUID->"a4331544-ea50-4beb-8671-e3432c341f8c"],
Cell[CellGroupData[{
Cell[66285, 1684, 234, 4, 56, "Subsubsection",ExpressionUUID->"581d3789-9c5a-4340-9e22-f260f6a2da06"],
Cell[66522, 1690, 527, 9, 102, "Text",ExpressionUUID->"58afa13f-d4eb-4290-85d0-88c2b6398f70"],
Cell[67052, 1701, 1157, 23, 110, "Input",ExpressionUUID->"a5e4d0e7-d62d-4c86-9b94-7949671a123f",
 InitializationCell->True],
Cell[68212, 1726, 218, 5, 44, "Text",ExpressionUUID->"26e7ef8e-4ad4-42be-a25d-5321f29ef663"],
Cell[68433, 1733, 775, 19, 136, "Input",ExpressionUUID->"0182e3d1-47db-4202-b80d-853914145471",
 InitializationCell->True],
Cell[69211, 1754, 153, 3, 44, "Text",ExpressionUUID->"2c00ac8e-98fb-46ad-96aa-3de21449f3ac"],
Cell[69367, 1759, 2283, 50, 474, "Input",ExpressionUUID->"5fb5d78e-9d0b-40a3-ab82-3096ea647306",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[71687, 1814, 166, 3, 45, "Subsubsection",ExpressionUUID->"7b18151a-2297-47d4-aae0-29f41291c91a"],
Cell[71856, 1819, 805, 18, 102, "Text",ExpressionUUID->"51410b13-2bbe-4d8a-9534-02659154110a"],
Cell[72664, 1839, 784, 13, 57, "Input",ExpressionUUID->"f8bc0f93-4fe1-498c-8dae-1ee400f02937",
 InitializationCell->True],
Cell[73451, 1854, 1608, 34, 136, "Input",ExpressionUUID->"3078804f-b5f7-4048-8e64-dedc169d08cd",
 InitializationCell->True],
Cell[75062, 1890, 153, 3, 44, "Text",ExpressionUUID->"047917e6-aecc-4f49-99fe-6d38607265b4"],
Cell[75218, 1895, 3024, 65, 630, "Input",ExpressionUUID->"84df6515-1916-4245-a240-158aaf55debc",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[78279, 1965, 258, 4, 45, "Subsubsection",ExpressionUUID->"0bc484df-8b1c-4fcf-978b-2bca2e956652"],
Cell[78540, 1971, 177, 3, 44, "Text",ExpressionUUID->"d598fb19-0f9c-4889-85be-99a088c3fc73"],
Cell[78720, 1976, 518, 10, 57, "Input",ExpressionUUID->"0bb49d5d-e4b4-4bea-9098-89477234bf40",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[79275, 1991, 295, 5, 45, "Subsubsection",ExpressionUUID->"c31d912d-e18b-4bd4-a2a0-976c4597146a"],
Cell[79573, 1998, 553, 10, 102, "Text",ExpressionUUID->"0d4af79c-117a-48f2-a9e5-8dafe2a28899"],
Cell[80129, 2010, 1178, 27, 136, "Input",ExpressionUUID->"02a7961a-310f-4841-9b9e-a942904679f3"],
Cell[81310, 2039, 209, 4, 44, "Text",ExpressionUUID->"37f10875-1648-4ff7-b935-0d05d2a3cb8d"],
Cell[81522, 2045, 1855, 44, 136, "Input",ExpressionUUID->"6742c770-4354-4231-929c-f0ada24626f6",
 InitializationCell->True],
Cell[83380, 2091, 153, 3, 44, "Text",ExpressionUUID->"25be8066-7ca4-4af4-99fa-b4c893d470d9"],
Cell[83536, 2096, 1715, 38, 214, "Input",ExpressionUUID->"de89ab68-ea32-422c-a781-071c922e9c76",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[85288, 2139, 422, 6, 45, "Subsubsection",ExpressionUUID->"eb5b4d15-ad84-4b9e-9db3-4fa1f5bdd905"],
Cell[85713, 2147, 627, 11, 102, "Text",ExpressionUUID->"ecd40e32-6b58-4080-8b42-a9cb5b5264b9"],
Cell[86343, 2160, 270, 7, 64, "Text",ExpressionUUID->"9868d6ab-d26e-4bf1-9fd6-8d1b540c38d5"],
Cell[86616, 2169, 1135, 21, 84, "Input",ExpressionUUID->"4e248999-6fda-4a2e-96eb-6c1d1a29aeff",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[87800, 2196, 171, 3, 46, "Subsection",ExpressionUUID->"e760fc8f-70ca-4c64-a5b6-d0951b1e0960"],
Cell[CellGroupData[{
Cell[87996, 2203, 467, 8, 56, "Subsubsection",ExpressionUUID->"2ecc0880-c683-42a0-9674-060966962af2"],
Cell[88466, 2213, 762, 13, 73, "Text",ExpressionUUID->"566f6f43-24db-4c6b-a071-2977eefac2aa"],
Cell[89231, 2228, 2009, 31, 57, "Input",ExpressionUUID->"82127684-67fd-44fd-b520-ef73e0f7cae2",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[91277, 2264, 160, 3, 45, "Subsubsection",ExpressionUUID->"d8f424fd-2465-4a68-bac0-c87e19b08cbf"],
Cell[91440, 2269, 325, 8, 44, "Text",ExpressionUUID->"820ac0b6-b306-4896-8f26-737764da7627"],
Cell[91768, 2279, 564, 12, 57, "Input",ExpressionUUID->"78801d66-0068-47e6-850b-0958933da4c5",
 InitializationCell->True],
Cell[92335, 2293, 153, 3, 44, "Text",ExpressionUUID->"88c357ae-c049-45dd-810e-b90d9fd7fb5d"],
Cell[92491, 2298, 1439, 26, 214, "Input",ExpressionUUID->"85c9f8a7-593f-4374-b985-6a30f0f8ae4c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[93967, 2329, 236, 4, 45, "Subsubsection",ExpressionUUID->"2e80c3c9-f865-46b6-ba32-6e33f96849ab"],
Cell[94206, 2335, 296, 7, 44, "Text",ExpressionUUID->"25054d41-0608-46c5-921c-1de798149a75"],
Cell[94505, 2344, 649, 13, 57, "Input",ExpressionUUID->"655b3504-977d-4b39-84f6-1d30b97abbba",
 InitializationCell->True],
Cell[95157, 2359, 461, 9, 73, "Text",ExpressionUUID->"c6bbb1e4-9dce-478e-9eae-12bc7e94ca08"],
Cell[95621, 2370, 1319, 29, 110, "Input",ExpressionUUID->"d827cbdd-c066-430d-8b38-32bb44601d12",
 InitializationCell->True],
Cell[96943, 2401, 153, 3, 44, "Text",ExpressionUUID->"e80d08a5-0a72-4a30-9aa1-a52127a93016"],
Cell[97099, 2406, 1612, 32, 344, "Input",ExpressionUUID->"d01b6b38-7eb0-4e2d-9a05-ca6823fa4402",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[98748, 2443, 235, 4, 45, "Subsubsection",ExpressionUUID->"f9affc49-91d0-40fd-ac8c-711f62964e8f"],
Cell[98986, 2449, 304, 8, 44, "Text",ExpressionUUID->"01f97a09-488c-40c7-8fc8-c8134586b5dc"],
Cell[99293, 2459, 755, 16, 57, "Input",ExpressionUUID->"fd1f6a41-1b95-47e6-9781-67cee9aefa05",
 InitializationCell->True],
Cell[100051, 2477, 153, 3, 44, "Text",ExpressionUUID->"fdcc0722-f0fa-4dc4-88d2-17d573b2730e"],
Cell[100207, 2482, 1322, 24, 214, "Input",ExpressionUUID->"3276fdcc-651d-4b72-a6f4-53cb29f47e3f",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[101566, 2511, 301, 5, 45, "Subsubsection",ExpressionUUID->"c09796df-0b88-4cf8-81c8-22e229ac78ab"],
Cell[101870, 2518, 381, 7, 73, "Text",ExpressionUUID->"a84d0564-a5cf-45b8-8027-af3e81ccf546"],
Cell[102254, 2527, 493, 10, 57, "Input",ExpressionUUID->"9533717c-a028-4ce0-9e21-73ef8de49264",
 InitializationCell->True],
Cell[102750, 2539, 767, 16, 84, "Input",ExpressionUUID->"51460cbf-ba19-4656-a0e4-c721df9dfe18",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[103554, 2560, 190, 3, 45, "Subsubsection",ExpressionUUID->"0d0c48df-fde4-43d2-97d9-a78f5e867780"],
Cell[103747, 2565, 709, 14, 102, "Text",ExpressionUUID->"65bdde95-9385-4018-90e5-507f39cd3bd0"],
Cell[104459, 2581, 368, 8, 57, "Input",ExpressionUUID->"ede7e7f0-b64e-4801-bc8a-2fc01a07244c",
 InitializationCell->True],
Cell[104830, 2591, 2595, 61, 214, "Input",ExpressionUUID->"324f85c1-76b5-4a3f-91c5-712ed26c3ebb",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[107474, 2658, 219, 4, 46, "Subsection",ExpressionUUID->"839559cd-c490-402c-acd5-535fe6ddbeac"],
Cell[CellGroupData[{
Cell[107718, 2666, 146, 3, 56, "Subsubsection",ExpressionUUID->"b68fefcc-3720-4341-9fe0-12186ee379c5"],
Cell[107867, 2671, 409, 8, 73, "Text",ExpressionUUID->"74bbc5bf-1ebd-4251-9293-493d758b07f5"],
Cell[108279, 2681, 513, 10, 57, "Input",ExpressionUUID->"7528b720-5639-48df-8496-bf5d99a25e15",
 InitializationCell->True],
Cell[108795, 2693, 486, 9, 73, "Text",ExpressionUUID->"59c8c2f5-f9a3-4195-8da3-be6834eb490e"],
Cell[109284, 2704, 763, 19, 84, "Input",ExpressionUUID->"fe79a586-2730-45f3-b374-179d73c68b30"],
Cell[110050, 2725, 235, 6, 44, "Text",ExpressionUUID->"241ce7b2-2b2c-43b5-b6e5-61a70ef5179c"],
Cell[110288, 2733, 776, 17, 84, "Input",ExpressionUUID->"2c859201-3c03-4e01-a48d-564643af1aed"]
}, Closed]],
Cell[CellGroupData[{
Cell[111101, 2755, 141, 3, 45, "Subsubsection",ExpressionUUID->"13556158-5359-4c5a-9ed6-389ec5de6d70"],
Cell[111245, 2760, 839, 14, 131, "Text",ExpressionUUID->"fa82e1cd-d6c5-4f1f-939d-2def57b9a5f4"],
Cell[112087, 2776, 565, 12, 159, "Text",ExpressionUUID->"29694a1f-4b8a-4fbb-b70b-1c43a7dcb064"],
Cell[112655, 2790, 1151, 23, 84, "Input",ExpressionUUID->"103fc6d3-aada-4df2-a0f4-2b2bb04ec184",
 InitializationCell->True],
Cell[113809, 2815, 4626, 98, 292, "Input",ExpressionUUID->"939f7989-5312-4ef3-a2d1-92ef4a2573f6",
 InitializationCell->True],
Cell[118438, 2915, 382, 7, 44, "Text",ExpressionUUID->"40c1af07-ac82-4199-9868-a8ad44b57272"],
Cell[118823, 2924, 3194, 67, 266, "Input",ExpressionUUID->"b2079691-a687-40a9-a503-1fa04e440f89",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[122042, 2995, 1608, 37, 120, "Input",ExpressionUUID->"ae291f37-ac1d-4be7-b1fc-641ba94cecc6"],
Cell[123653, 3034, 1685, 36, 105, "Output",ExpressionUUID->"7946d931-1d8f-41db-bfdd-97a36f01dae3"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[125387, 3076, 210, 4, 45, "Subsubsection",ExpressionUUID->"a0845bc2-ef2d-479a-8f9a-69b7395f39d0"],
Cell[125600, 3082, 393, 8, 73, "Text",ExpressionUUID->"a6ee423f-bc98-4d05-b11f-01b326cc68ad"],
Cell[125996, 3092, 205, 3, 64, "Text",ExpressionUUID->"5b1e48e4-00d1-4ddd-972f-40ff1a1f5702"],
Cell[126204, 3097, 1434, 29, 136, "Input",ExpressionUUID->"6d3460e9-70c8-443b-9c49-7103d3041a63",
 InitializationCell->True],
Cell[127641, 3128, 191, 3, 44, "Text",ExpressionUUID->"aead966a-dfe3-493d-a66a-d473164ab7fc"],
Cell[127835, 3133, 587, 13, 57, "Input",ExpressionUUID->"3d41713e-d6d5-49e7-aad0-986175c3d018"],
Cell[CellGroupData[{
Cell[128447, 3150, 1056, 29, 120, "Input",ExpressionUUID->"00f028fb-fb3f-47eb-87e6-bc9d24149d54"],
Cell[129506, 3181, 1012, 28, 105, "Output",ExpressionUUID->"597d9263-8a76-432c-8c91-af8601ee04ae"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[130567, 3215, 243, 5, 45, "Subsubsection",ExpressionUUID->"4b479416-5c39-4984-ae57-0ea2b16b1cfe"],
Cell[130813, 3222, 660, 14, 73, "Text",ExpressionUUID->"12dc004f-b0a7-4433-825e-dcdd055fb705"],
Cell[131476, 3238, 851, 19, 57, "Input",ExpressionUUID->"f4bc1baa-6306-4aa1-a977-ad2f5244fe16",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[132364, 3262, 304, 4, 45, "Subsubsection",ExpressionUUID->"7cbbc220-e8c1-4e71-8e5c-45cbfa77fe18"],
Cell[132671, 3268, 221, 5, 44, "Text",ExpressionUUID->"640eb7d5-6bf6-4250-8ebc-608e05bb4d71"],
Cell[132895, 3275, 2625, 55, 240, "Input",ExpressionUUID->"52a7ec57-79df-4787-8639-bc72a96bd6ae",
 InitializationCell->True],
Cell[135523, 3332, 250, 4, 44, "Text",ExpressionUUID->"affa3f24-ae31-4989-a8f0-0df6e5ae1037"],
Cell[135776, 3338, 629, 14, 57, "Input",ExpressionUUID->"3142a577-b315-4d47-bbbe-955c9bb78926"],
Cell[136408, 3354, 292, 7, 44, "Text",ExpressionUUID->"13f42feb-14e6-463e-bcb0-3be3a74d257e"],
Cell[136703, 3363, 787, 16, 57, "Input",ExpressionUUID->"3bf67af0-533a-48a7-9f63-d908867f37f9"],
Cell[137493, 3381, 153, 3, 44, "Text",ExpressionUUID->"0cf567e5-491b-46da-b946-1b91acd9b07f"],
Cell[137649, 3386, 2642, 53, 266, "Input",ExpressionUUID->"01beb232-5b70-41be-afd0-e6bc1e33105e",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[140340, 3445, 237, 4, 46, "Subsection",ExpressionUUID->"d05c7ee2-1cd4-4432-aa86-dc751a17c080"],
Cell[CellGroupData[{
Cell[140602, 3453, 270, 5, 56, "Subsubsection",ExpressionUUID->"7da04c68-dbc5-4661-8c8e-a860ea92e723"],
Cell[140875, 3460, 920, 16, 73, "Text",ExpressionUUID->"b8cc3696-a187-4418-870e-8b76d7eef9d0"],
Cell[141798, 3478, 2233, 50, 136, "Input",ExpressionUUID->"62257dcf-cc53-418e-a7da-e61e5c8c0974",
 InitializationCell->True],
Cell[144034, 3530, 379, 7, 44, "Text",ExpressionUUID->"bdfc9f88-f005-440d-a028-ccd687e7a63d"],
Cell[144416, 3539, 2817, 54, 110, "Input",ExpressionUUID->"87178107-1c3f-4f40-925c-2e588e51f747",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[147258, 3597, 468, 10, 57, "Input",ExpressionUUID->"c7910955-96f0-4802-8213-8c893cbfebe3"],
Cell[147729, 3609, 873, 21, 42, "Output",ExpressionUUID->"cc68ffdd-f2dc-497d-84ab-a894ab89689c"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[148651, 3636, 493, 7, 45, "Subsubsection",ExpressionUUID->"1cb647ee-be6b-4c77-a0a2-038532bfe1ab"],
Cell[149147, 3645, 620, 12, 73, "Text",ExpressionUUID->"9dd06a13-48cb-47d6-acaa-0eb6e6bd75dc"],
Cell[149770, 3659, 1119, 21, 84, "Input",ExpressionUUID->"4f34c424-c047-4ce7-96ee-c22b4797263d",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[150914, 3684, 749, 15, 57, "Input",ExpressionUUID->"98799bae-eed3-417b-b3c7-2abe649569bb"],
Cell[151666, 3701, 3396, 93, 83, "Output",ExpressionUUID->"e508c67d-c7a3-4b6e-82d7-630d62efd6a8"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[155111, 3800, 218, 4, 45, "Subsubsection",ExpressionUUID->"269f9bb7-fdf4-4d42-be99-367418032fe2"],
Cell[155332, 3806, 764, 12, 102, "Text",ExpressionUUID->"502deb38-3837-4113-a65e-13384b0022fc"],
Cell[156099, 3820, 2676, 51, 136, "Input",ExpressionUUID->"1a56da0b-f91a-4636-8205-4334d777d831",
 InitializationCell->True],
Cell[158778, 3873, 374, 8, 73, "Text",ExpressionUUID->"cdb2887c-53e3-4e48-b17f-aab6381c5565"],
Cell[159155, 3883, 2750, 52, 162, "Input",ExpressionUUID->"19af98f5-b79b-4ef0-9498-ff3c58fc3a11"],
Cell[CellGroupData[{
Cell[161930, 3939, 832, 14, 57, "Input",ExpressionUUID->"abadf106-9f49-4105-8d0d-7b11ab4f1f63"],
Cell[162765, 3955, 3504, 71, 127, "Output",ExpressionUUID->"0a231f36-c046-46a8-be20-9dc1f2210015"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[166318, 4032, 194, 3, 45, "Subsubsection",ExpressionUUID->"b6ba4c3d-2177-4cc2-a753-36e7219ce528"],
Cell[166515, 4037, 300, 6, 73, "Text",ExpressionUUID->"c8fe195e-a859-465e-90e0-fccda36f7d37"],
Cell[166818, 4045, 3564, 74, 266, "Input",ExpressionUUID->"6afd3391-f0d5-4a73-95c1-af220bb8df4f",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[170407, 4123, 287, 6, 37, "Input",ExpressionUUID->"ae2d5cab-ccc2-42b8-9822-1fa20529a628"],
Cell[170697, 4131, 893, 25, 127, "Output",ExpressionUUID->"6a8547fb-81bc-48b2-bea7-3cf09cb2bfd6"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[171639, 4162, 239, 4, 45, "Subsubsection",ExpressionUUID->"2e8e5032-6e89-4f0c-ba6d-8d1072eb44fb"],
Cell[171881, 4168, 1413, 22, 159, "Text",ExpressionUUID->"23d81d5c-290a-47b7-aad3-f0e96e291a0c"],
Cell[173297, 4192, 1896, 35, 84, "Input",ExpressionUUID->"b6042656-6c9c-467a-98d3-0ba7ae30fe7b",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[175230, 4232, 162, 3, 45, "Subsubsection",ExpressionUUID->"662463f1-7170-46c1-9b53-37344ce01fcc"],
Cell[175395, 4237, 1086, 25, 105, "Text",ExpressionUUID->"e2d01c50-3910-46ce-82d4-7ff1707cac16"],
Cell[176484, 4264, 2801, 69, 214, "Input",ExpressionUUID->"cc37af47-d574-47af-a5eb-1882193155b6",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[179334, 4339, 269, 4, 46, "Subsection",ExpressionUUID->"fdb12f19-feb0-497e-8983-20d8c0826b0f"],
Cell[CellGroupData[{
Cell[179628, 4347, 433, 7, 56, "Subsubsection",ExpressionUUID->"9fc15f72-f93e-4d66-8848-5337d645e229"],
Cell[180064, 4356, 703, 16, 102, "Text",ExpressionUUID->"28fe4a80-4ae3-49fc-9eaf-29c48056fba9"],
Cell[180770, 4374, 1012, 21, 84, "Input",ExpressionUUID->"dbbe6fbf-f417-4c2a-9e3c-ca2f1f244f0c",
 InitializationCell->True],
Cell[181785, 4397, 237, 4, 44, "Text",ExpressionUUID->"72491e59-41d2-41ae-9528-1b3fc8d533c3"],
Cell[182025, 4403, 608, 12, 57, "Input",ExpressionUUID->"c3a5563a-ba63-42d4-b65f-702c6c21cd34",
 InitializationCell->True],
Cell[182636, 4417, 153, 3, 44, "Text",ExpressionUUID->"e5dedd0c-1b5d-4cdc-b32a-b5e8c1e71dc5"],
Cell[182792, 4422, 2205, 38, 214, "Input",ExpressionUUID->"84249ab0-5f22-49d5-8195-27632a8de8ae",
 InitializationCell->True],
Cell[185000, 4462, 239, 4, 44, "Text",ExpressionUUID->"a92cdacf-3338-4ffc-a6ac-8502d83016bc"],
Cell[185242, 4468, 1085, 27, 110, "Input",ExpressionUUID->"69afca7f-57be-4585-b1f8-a0509ee751e5",
 InitializationCell->True],
Cell[186330, 4497, 153, 3, 44, "Text",ExpressionUUID->"859533bb-c6a8-4302-a776-37f66eecd9f4"],
Cell[186486, 4502, 2647, 51, 240, "Input",ExpressionUUID->"fec55cff-9bb2-49e0-866e-57c7a842a819",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[189170, 4558, 229, 4, 45, "Subsubsection",ExpressionUUID->"505a6011-4d9c-49f0-bda9-5caac965471c"],
Cell[189402, 4564, 340, 10, 44, "Text",ExpressionUUID->"d520801a-b954-421d-896c-92b512d703ef"],
Cell[189745, 4576, 1102, 22, 57, "Input",ExpressionUUID->"08d5c969-3085-4621-bdc8-1c31b51142f0",
 InitializationCell->True],
Cell[190850, 4600, 236, 4, 44, "Text",ExpressionUUID->"a8217635-b04f-42d7-981c-aca4144166a3"],
Cell[191089, 4606, 636, 12, 57, "Input",ExpressionUUID->"eb2c6180-d27d-46ef-b560-8b4ac6d123d8",
 InitializationCell->True],
Cell[191728, 4620, 153, 3, 44, "Text",ExpressionUUID->"8f8ec67c-75e1-43ab-82a9-bcafa66d6532"],
Cell[191884, 4625, 2130, 38, 214, "Input",ExpressionUUID->"0a6d3b61-8690-4780-a56f-661b4d32328a",
 InitializationCell->True],
Cell[194017, 4665, 237, 4, 44, "Text",ExpressionUUID->"b30b8039-d44a-4290-a2a6-1009fbbfa2e0"],
Cell[194257, 4671, 850, 21, 110, "Input",ExpressionUUID->"f54d11ed-ee8a-4f4a-8a9c-cab493023b6e",
 InitializationCell->True],
Cell[195110, 4694, 153, 3, 44, "Text",ExpressionUUID->"f74e3dd8-02b9-4bb8-9279-bbbdaeb2a7be"],
Cell[195266, 4699, 2797, 57, 297, "Input",ExpressionUUID->"a299ba87-10d2-4541-a404-f0fcdb048977",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[198100, 4761, 211, 4, 45, "Subsubsection",ExpressionUUID->"4f8063a5-be1f-497f-a786-7dce017b7881"],
Cell[198314, 4767, 774, 16, 102, "Text",ExpressionUUID->"5dd4a489-e013-41bd-8372-041184bd4215"],
Cell[199091, 4785, 3125, 67, 292, "Input",ExpressionUUID->"f71fa231-d54a-44df-bfeb-489f2ebfa56f",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[202241, 4856, 976, 26, 98, "Input",ExpressionUUID->"c51859fd-40e5-4a4f-80e2-a46057eb4d9e"],
Cell[203220, 4884, 751, 22, 83, "Output",ExpressionUUID->"f3ff1d73-1cf0-4cbb-bfe9-4d22aa11e5b5"]
}, Open  ]],
Cell[203986, 4909, 153, 3, 44, "Text",ExpressionUUID->"d6f55a41-b3c3-451d-ba9d-d176c33fe7b5"],
Cell[204142, 4914, 5274, 113, 493, "Input",ExpressionUUID->"135d47d6-d945-4bba-ad4f-7de5788c69cc",
 InitializationCell->True],
Cell[209419, 5029, 727, 13, 131, "Text",ExpressionUUID->"3cf34b74-42c0-41e7-93ce-7c2ef91f31af"],
Cell[210149, 5044, 1185, 25, 110, "Input",ExpressionUUID->"f281c59b-f621-4fc7-bfef-cb37142dd2bc",
 InitializationCell->True],
Cell[211337, 5071, 472, 8, 73, "Text",ExpressionUUID->"2e1532b5-1aed-4b52-a2b2-690523078625"],
Cell[211812, 5081, 610, 14, 57, "Input",ExpressionUUID->"6d14fe14-6fa7-4de1-ac90-2a03ec1cc9b6",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[212447, 5099, 479, 11, 57, "Input",ExpressionUUID->"3d64c791-5d75-48b4-b1af-b1a006ccc79b"],
Cell[212929, 5112, 436, 12, 42, "Output",ExpressionUUID->"044270f4-6ecb-49b9-91a0-7d85c663c021"]
}, Open  ]],
Cell[213380, 5127, 153, 3, 44, "Text",ExpressionUUID->"ade7da1d-020f-4404-a48c-a5476d422a85"],
Cell[213536, 5132, 3411, 66, 344, "Input",ExpressionUUID->"1ec4eaf7-d20d-43ba-b09f-4258ed451230",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[216996, 5204, 216, 4, 46, "Subsection",ExpressionUUID->"dd949207-8819-46a2-a4a2-4dcd9e2e3265"],
Cell[CellGroupData[{
Cell[217237, 5212, 243, 4, 56, "Subsubsection",ExpressionUUID->"1fc10e31-d241-4350-86a4-97b3ea387f4a"],
Cell[217483, 5218, 233, 6, 43, "Text",ExpressionUUID->"0314c909-5038-4080-946d-b6e21bfb4be1"],
Cell[217719, 5226, 891, 23, 137, "Input",ExpressionUUID->"75831bd9-895f-4687-97fd-286e571ec71e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[218647, 5254, 190, 3, 45, "Subsubsection",ExpressionUUID->"34608bf4-bb0f-4696-96cd-60c0db220bd8"],
Cell[218840, 5259, 245, 6, 43, "Text",ExpressionUUID->"4a4222e7-5c86-4f28-aa4a-0e27b95b0a93"],
Cell[219088, 5267, 682, 17, 85, "Input",ExpressionUUID->"fa479d0b-9a01-4291-a573-267772555b58",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[219807, 5289, 160, 3, 45, "Subsubsection",ExpressionUUID->"b37a0b63-0a68-431b-a2ee-3476b181468a"],
Cell[219970, 5294, 444, 9, 57, "Input",ExpressionUUID->"1c738852-7fdd-44b8-9ae6-bb9b9a804aa3",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[220451, 5308, 228, 4, 45, "Subsubsection",ExpressionUUID->"cc55d909-059d-4e57-9e3a-f02763180171"],
Cell[220682, 5314, 237, 6, 44, "Text",ExpressionUUID->"b3c4a156-035f-4b1b-bc32-33b5705f922e"],
Cell[220922, 5322, 1103, 27, 100, "Input",ExpressionUUID->"2811c8c9-88b7-4fd3-9239-02d18deb0403",
 InitializationCell->True],
Cell[222028, 5351, 283, 7, 44, "Text",ExpressionUUID->"7ba515a7-956f-4c29-973f-741a124f8726"],
Cell[222314, 5360, 2436, 67, 136, "Input",ExpressionUUID->"dad76317-a854-4c80-a596-e9a74ac40d01",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[224799, 5433, 289, 5, 46, "Subsection",ExpressionUUID->"d88ee721-908b-47bb-b969-ed0e71e92b4b"],
Cell[CellGroupData[{
Cell[225113, 5442, 288, 5, 56, "Subsubsection",ExpressionUUID->"f3da0bfa-0224-4f86-a3fc-3d17d1996d08"],
Cell[225404, 5449, 334, 7, 73, "Text",ExpressionUUID->"e0fbb145-3453-4bc4-a42d-6c1e298f1a79"],
Cell[225741, 5458, 660, 14, 57, "Input",ExpressionUUID->"17fa623b-9563-4b2f-b789-d77117caf5b9",
 InitializationCell->True],
Cell[226404, 5474, 153, 3, 44, "Text",ExpressionUUID->"e65d337b-2af2-4e4c-b357-979b4ca125b7"],
Cell[226560, 5479, 1891, 37, 344, "Input",ExpressionUUID->"3c6964c3-5c62-424e-93af-bf5a9d10a015",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[228488, 5521, 183, 3, 45, "Subsubsection",ExpressionUUID->"a4fb631c-f0d9-412d-80d8-82b4363eece4"],
Cell[228674, 5526, 224, 5, 44, "Text",ExpressionUUID->"9c97b3f9-3337-4d8f-8e28-c415f9cbb2ae"],
Cell[228901, 5533, 1008, 20, 57, "Input",ExpressionUUID->"395b6552-019a-4a27-8125-d5b0c7392b3f",
 InitializationCell->True],
Cell[229912, 5555, 153, 3, 44, "Text",ExpressionUUID->"374456bc-d141-4fd4-9c39-bdd24005f38d"],
Cell[230068, 5560, 3158, 69, 443, "Input",ExpressionUUID->"8d9fe989-bc9b-4c29-a8f3-21a82fba0595",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[233263, 5634, 238, 4, 45, "Subsubsection",ExpressionUUID->"eb4c6a30-fe09-4db6-813a-e04c970108df"],
Cell[233504, 5640, 310, 7, 44, "Text",ExpressionUUID->"af970a27-14cb-4cda-bfb4-545c04ad9205"],
Cell[233817, 5649, 667, 16, 57, "Input",ExpressionUUID->"55220695-cbf3-4330-ae82-05d660118d44",
 InitializationCell->True],
Cell[234487, 5667, 153, 3, 44, "Text",ExpressionUUID->"ceba56ee-151e-4b94-88b3-a5e551ea6d89"],
Cell[234643, 5672, 2581, 47, 344, "Input",ExpressionUUID->"ac312053-2783-4caf-bda1-1093ce464af6",
 InitializationCell->True]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[237285, 5726, 215, 4, 65, "Section",ExpressionUUID->"b41532c4-8477-4382-ab10-02db2a91dbb3"],
Cell[CellGroupData[{
Cell[237525, 5734, 161, 3, 67, "Subsection",ExpressionUUID->"057eee5c-9c9c-4a5e-940b-58eb169c33a4"],
Cell[CellGroupData[{
Cell[237711, 5741, 279, 5, 56, "Subsubsection",ExpressionUUID->"cca2c86a-d275-4dc6-aeae-607c61bfd75e"],
Cell[237993, 5748, 791, 17, 101, "Text",ExpressionUUID->"357b6f20-14a9-46e6-bc70-50e8bb92d6bc"],
Cell[238787, 5767, 5404, 77, 57, "Input",ExpressionUUID->"890f0b18-195d-46b4-96de-69779d16a7f1",
 InitializationCell->True],
Cell[244194, 5846, 3245, 74, 268, "Input",ExpressionUUID->"f573c691-7d69-43d3-8136-e7b9de4259d4",
 InitializationCell->True],
Cell[247442, 5922, 398, 8, 43, "Text",ExpressionUUID->"4565b7c1-d7f2-40aa-b3af-89e3cdd6fea1"],
Cell[247843, 5932, 1273, 23, 57, "Input",ExpressionUUID->"64392b69-9608-4797-aa23-a515512b9649",
 InitializationCell->True],
Cell[249119, 5957, 302, 7, 43, "Text",ExpressionUUID->"4730deec-65ad-4748-b608-825aed1dc123"],
Cell[249424, 5966, 973, 19, 57, "Input",ExpressionUUID->"0db361d5-aecf-4865-a24c-3de81a705a0d",
 InitializationCell->True],
Cell[250400, 5987, 153, 3, 43, "Text",ExpressionUUID->"553489c5-bb30-448b-adf3-3981dd20f501"],
Cell[250556, 5992, 22106, 529, 3162, "Input",ExpressionUUID->"97f90c39-7743-4bf8-92de-2dcff0b895b0",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[272699, 6526, 338, 5, 45, "Subsubsection",ExpressionUUID->"291409ae-96d1-4348-9b21-9f622bf73d39"],
Cell[273040, 6533, 613, 12, 72, "Text",ExpressionUUID->"3962441d-dc23-4b6d-99d8-0012f1e7714b"],
Cell[273656, 6547, 6285, 92, 57, "Input",ExpressionUUID->"09dc131c-d43f-4a1b-b4d9-8d9297fb8a5d",
 InitializationCell->True],
Cell[279944, 6641, 349, 7, 43, "Text",ExpressionUUID->"f7e4b9aa-6559-4f35-af86-8263cd71216b"],
Cell[280296, 6650, 6148, 87, 57, "Input",ExpressionUUID->"72f23bdb-2555-4c8e-9992-fd6b554fab1d",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[286481, 6742, 225, 4, 45, "Subsubsection",ExpressionUUID->"49d564d4-0ed6-4bd4-a946-4ac57dac6655"],
Cell[286709, 6748, 299, 7, 73, "Text",ExpressionUUID->"19d86897-d133-44fd-b0df-92fb0f4e4cb7"],
Cell[287011, 6757, 1114, 26, 110, "Input",ExpressionUUID->"8e5e8b66-4058-45b9-96db-effd06f96fcf",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[288162, 6788, 169, 3, 45, "Subsubsection",ExpressionUUID->"6495795f-4be9-42da-9e60-4adf6d3da416"],
Cell[288334, 6793, 372, 7, 73, "Text",ExpressionUUID->"4993fdf8-eed6-4761-be0f-9ae03bb5bcf0"],
Cell[288709, 6802, 742, 16, 84, "Input",ExpressionUUID->"ded864de-7e55-4a5c-8a6d-9eabda5454e1",
 InitializationCell->True],
Cell[289454, 6820, 879, 14, 73, "Text",ExpressionUUID->"7ed686b5-0511-4c99-b49f-8d317a9573b4"],
Cell[290336, 6836, 1264, 24, 84, "Input",ExpressionUUID->"81473f9b-9e59-49eb-b4a6-711da5c39eb2",
 InitializationCell->True],
Cell[291603, 6862, 153, 3, 44, "Text",ExpressionUUID->"f3b3bb51-d8ea-4f7d-bdab-fda58a7c1950"],
Cell[291759, 6867, 2720, 45, 266, "Input",ExpressionUUID->"fa7c7cd5-d090-4b88-a8a3-62c7a07d692e",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[294528, 6918, 206, 4, 46, "Subsection",ExpressionUUID->"596e19ab-ba32-4756-bcbc-79d9ad5b7d9f"],
Cell[CellGroupData[{
Cell[294759, 6926, 279, 5, 56, "Subsubsection",ExpressionUUID->"4705b7a3-89d9-44c3-95de-3c84f01b563b"],
Cell[295041, 6933, 832, 17, 44, "Text",ExpressionUUID->"cee83901-01f7-4da4-a3e7-8443c21f109c"],
Cell[295876, 6952, 698, 14, 57, "Input",ExpressionUUID->"38b74a49-4aec-4baa-bb86-005da1e62ce5",
 InitializationCell->True],
Cell[296577, 6968, 1468, 35, 136, "Input",ExpressionUUID->"52d1f944-396a-409f-a41c-5adc4791bd51",
 InitializationCell->True],
Cell[298048, 7005, 601, 14, 73, "Text",ExpressionUUID->"ded35b01-6f4b-4164-99b2-9c08a33423c3"],
Cell[298652, 7021, 1208, 25, 84, "Input",ExpressionUUID->"4178276e-2733-4e5b-9563-5ab2770a62ee",
 InitializationCell->True],
Cell[299863, 7048, 1798, 41, 136, "Input",ExpressionUUID->"67853d9b-1037-4c2d-8fcf-1793152f4336",
 InitializationCell->True],
Cell[301664, 7091, 290, 5, 44, "Text",ExpressionUUID->"d83a7522-12b3-4886-a471-2cf244703a46"],
Cell[301957, 7098, 384, 10, 57, "Input",ExpressionUUID->"3b12e47b-db0d-4a5f-80cb-cddf25f2cecb"],
Cell[302344, 7110, 153, 3, 44, "Text",ExpressionUUID->"cd55b7d8-795d-4a58-b1bb-d451153b7b4c"],
Cell[302500, 7115, 3546, 65, 370, "Input",ExpressionUUID->"6c554bb8-eb89-48ea-9ff4-9b22c5a34051",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[306083, 7185, 353, 6, 45, "Subsubsection",ExpressionUUID->"dcc578af-a0f6-4912-a21f-5eff1a77b0e2"],
Cell[306439, 7193, 1910, 32, 217, "Text",ExpressionUUID->"ec694549-0a99-457e-88f2-41a4d1f885b2"],
Cell[308352, 7227, 3098, 57, 162, "Input",ExpressionUUID->"9ffe47c1-91bf-431e-9505-114198ea7a29",
 InitializationCell->True],
Cell[311453, 7286, 5210, 118, 422, "Input",ExpressionUUID->"a4ed54b8-6333-430f-9d2b-38fd757ca4a7",
 InitializationCell->True],
Cell[316666, 7406, 241, 6, 44, "Text",ExpressionUUID->"e7ebeb3b-bf8c-4ac2-a148-d17051f456cb"],
Cell[316910, 7414, 5314, 119, 396, "Input",ExpressionUUID->"d81194b8-e3d9-4ca2-b2ca-0be9ac05b3a9",
 InitializationCell->True],
Cell[322227, 7535, 219, 4, 44, "Text",ExpressionUUID->"b0bb8c2a-d5d2-4533-a4c1-350b94d105dc"],
Cell[322449, 7541, 2358, 43, 110, "Input",ExpressionUUID->"4f5b5541-c6cb-4c4e-8287-0ee79762a0c0"],
Cell[324810, 7586, 153, 3, 44, "Text",ExpressionUUID->"1a8f92fd-6e48-4ac8-9488-d76c64f0cb0f"],
Cell[324966, 7591, 2820, 46, 214, "Input",ExpressionUUID->"4090dcfa-4f69-4900-9818-328d09462365",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[327823, 7642, 163, 3, 45, "Subsubsection",ExpressionUUID->"03b6e0b4-b670-4652-a488-eeab291724bc"],
Cell[327989, 7647, 1065, 17, 158, "Text",ExpressionUUID->"89ed911b-b0b0-4a1b-9cc3-f7fdf567617d"],
Cell[329057, 7666, 692, 15, 57, "Input",ExpressionUUID->"876cb6d9-5ed3-431d-8cf0-285d2ade627f",
 InitializationCell->True],
Cell[329752, 7683, 385, 7, 43, "Text",ExpressionUUID->"d3378058-62b8-4f19-babd-996b47b899c8"],
Cell[330140, 7692, 379, 9, 57, "Input",ExpressionUUID->"3e3a4f5b-364c-4afd-8e1d-2b7e7eef15cf",
 InitializationCell->True],
Cell[330522, 7703, 254, 4, 43, "Text",ExpressionUUID->"dd7b8ab8-9ed4-491d-8292-c32ebbde114a"],
Cell[330779, 7709, 346, 8, 57, "Input",ExpressionUUID->"402cd2cf-0b23-4f3f-b3ab-b413018e808e"],
Cell[331128, 7719, 284, 6, 72, "Text",ExpressionUUID->"29d0e0b1-71a6-4bb4-8a9d-8b1a92fa16ff"],
Cell[331415, 7727, 246, 6, 57, "Input",ExpressionUUID->"29544e88-ca9b-439c-ab47-a1d88706bf9d"],
Cell[331664, 7735, 195, 3, 43, "Text",ExpressionUUID->"12e40f2c-408a-4412-81f5-4d596b69e837"],
Cell[331862, 7740, 716, 20, 57, "Input",ExpressionUUID->"2c6395b9-0081-4421-ad77-17554413189a"],
Cell[332581, 7762, 1026, 27, 137, "Input",ExpressionUUID->"1db70220-a84d-46a3-930b-2bb6cde8b289"]
}, Closed]],
Cell[CellGroupData[{
Cell[333644, 7794, 169, 3, 45, "Subsubsection",ExpressionUUID->"ae89e43c-7829-464a-943c-379406ebe01c"],
Cell[333816, 7799, 299, 6, 72, "Text",ExpressionUUID->"92f3dc0a-1b98-428c-a86a-30c604b38c33"],
Cell[334118, 7807, 505, 13, 57, "Input",ExpressionUUID->"f99d1c37-d034-49a5-9a7a-6ccf1a2c71be",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[334660, 7825, 174, 3, 45, "Subsubsection",ExpressionUUID->"70621a01-e0aa-4adb-9bfa-584b98ba4f99"],
Cell[334837, 7830, 317, 7, 72, "Text",ExpressionUUID->"5afbd06c-873e-4e40-b9ef-adef1047d3c9"],
Cell[335157, 7839, 615, 16, 57, "Input",ExpressionUUID->"2651f4e5-6bd9-413a-8713-113b3edbd856",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[335809, 7860, 163, 3, 45, "Subsubsection",ExpressionUUID->"b7e9ee19-58c0-4737-a726-a54eb20289f2"],
Cell[335975, 7865, 385, 7, 72, "Text",ExpressionUUID->"5b0e255c-31ad-4b53-b292-83750d763ce0"],
Cell[336363, 7874, 584, 16, 57, "Input",ExpressionUUID->"b5c45008-4438-4999-a78e-fcadb442507d",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[336972, 7894, 215, 4, 37, "Input",ExpressionUUID->"7bcb7b0f-fe8c-46e1-a2cc-6be802e3285e"],
Cell[337190, 7900, 172, 3, 42, "Output",ExpressionUUID->"8f8c8a66-f77e-4d43-bd7e-b45d22165ceb"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[337411, 7909, 160, 3, 45, "Subsubsection",ExpressionUUID->"4950f28e-fc70-46f6-90c6-9ab458b11413"],
Cell[337574, 7914, 387, 8, 72, "Text",ExpressionUUID->"7bcb26eb-2249-4e58-bb34-22cad7f29b97"],
Cell[337964, 7924, 917, 27, 111, "Input",ExpressionUUID->"184d7a7a-91a4-4f6c-acc0-162e5c14e5a1",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[338918, 7956, 158, 3, 45, "Subsubsection",ExpressionUUID->"040b2add-4707-47cd-8df7-46bdc05700e2"],
Cell[339079, 7961, 220, 5, 43, "Text",ExpressionUUID->"c778c4e5-1840-4341-9adb-a8c402d4c908"],
Cell[339302, 7968, 3888, 81, 452, "Input",ExpressionUUID->"b887c31e-7550-4e01-80fc-130b038e2051",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[343239, 8055, 196, 3, 46, "Subsection",ExpressionUUID->"479e36ad-8b2e-4930-8fdd-11f24799e2c0"],
Cell[CellGroupData[{
Cell[343460, 8062, 212, 4, 56, "Subsubsection",ExpressionUUID->"8767aa0a-c504-40b4-aad3-1c1e143fc099"],
Cell[343675, 8068, 201, 3, 44, "Text",ExpressionUUID->"a33188f4-e7c4-45f0-8b1b-d10eab9e82fe"]
}, Closed]],
Cell[CellGroupData[{
Cell[343913, 8076, 188, 3, 45, "Subsubsection",ExpressionUUID->"903247a1-7ae3-40a7-853e-09bb6ea939f3"],
Cell[344104, 8081, 592, 11, 73, "Text",ExpressionUUID->"ef2ac7fa-3093-4507-b429-e5b973766c83"],
Cell[344699, 8094, 280, 6, 64, "Text",ExpressionUUID->"b1a57182-368f-4ef7-a4ca-0c837824750c"],
Cell[344982, 8102, 824, 15, 57, "Input",ExpressionUUID->"bb4445cb-6934-4d17-bb3c-942bcae76308",
 InitializationCell->True],
Cell[345809, 8119, 291, 8, 44, "Text",ExpressionUUID->"569666a1-5e66-4660-ae72-667775e2acbc"],
Cell[346103, 8129, 861, 15, 57, "Input",ExpressionUUID->"011af7ec-cf95-4050-984d-294f05dd7598"],
Cell[346967, 8146, 370, 8, 57, "Input",ExpressionUUID->"09976b95-377f-4ef1-b2bf-921083aae6aa"]
}, Closed]],
Cell[CellGroupData[{
Cell[347374, 8159, 177, 3, 45, "Subsubsection",ExpressionUUID->"8751f837-974d-430b-87cd-2253d8a3b7a4"],
Cell[347554, 8164, 950, 17, 102, "Text",ExpressionUUID->"35f172a5-d5e3-4461-a0cd-84865444d83b"],
Cell[348507, 8183, 297, 6, 64, "Text",ExpressionUUID->"904a17f9-3e85-409b-ab3c-1787e0f5ed34"],
Cell[348807, 8191, 8021, 166, 500, "Input",ExpressionUUID->"bc79f9b9-9114-443f-b94f-c7600669410e",
 InitializationCell->True],
Cell[356831, 8359, 242, 6, 37, "Input",ExpressionUUID->"d26e70b2-0ad5-4d1c-a1c3-070331715191"],
Cell[CellGroupData[{
Cell[357098, 8369, 1112, 20, 37, "Input",ExpressionUUID->"451a9ad1-b11e-4953-9463-e17d0c25dee8"],
Cell[358213, 8391, 3207, 57, 277, "Output",ExpressionUUID->"47a24781-54bd-4e22-8203-b707b7f3246f"]
}, Open  ]],
Cell[361435, 8451, 335, 7, 44, "Text",ExpressionUUID->"99d0a389-c62b-44c4-aa85-1a607ab80d65"],
Cell[361773, 8460, 1892, 41, 162, "Input",ExpressionUUID->"19139d35-4aa1-4d40-9c6c-ff1ab515b6f6",
 InitializationCell->True],
Cell[363668, 8503, 1788, 36, 136, "Input",ExpressionUUID->"c9724d4c-45f8-49c1-a718-4c0badd3a368",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[365493, 8544, 194, 3, 45, "Subsubsection",ExpressionUUID->"c244599d-7dbc-458e-b82f-b18713c5a85f"],
Cell[365690, 8549, 531, 9, 73, "Text",ExpressionUUID->"038b57ec-78cc-4f51-8c8c-00fe7d95d45d"],
Cell[366224, 8560, 2949, 51, 136, "Input",ExpressionUUID->"095de7ad-e8b5-438a-ac07-52ead6dd8c7d",
 InitializationCell->True],
Cell[369176, 8613, 424, 8, 44, "Text",ExpressionUUID->"f5b11f98-f01a-4621-aec1-43a0e43706ad"],
Cell[369603, 8623, 204, 3, 64, "Text",ExpressionUUID->"541fa816-a63a-4f14-8bea-3b2596385ba2"],
Cell[369810, 8628, 454, 11, 57, "Input",ExpressionUUID->"bf6c0b18-b8ca-4b85-96f3-a6e4b1a136ea",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[370301, 8644, 246, 4, 45, "Subsubsection",ExpressionUUID->"6ae8b92f-9241-47c9-8434-ef36f43945c1"],
Cell[370550, 8650, 340, 8, 73, "Text",ExpressionUUID->"b9072104-adb5-41b9-9d58-fbeac40f16f6"],
Cell[370893, 8660, 748, 18, 84, "Input",ExpressionUUID->"1a41b21e-9450-4af2-bee3-ae16bed4ef72",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[371666, 8682, 500, 10, 57, "Input",ExpressionUUID->"551e758b-f3f8-428b-81da-2289fc45cb75"],
Cell[372169, 8694, 1843, 50, 95, "Output",ExpressionUUID->"e51fb85e-755e-44eb-a240-919d9fea3331"]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[374085, 8752, 203, 4, 65, "Section",ExpressionUUID->"21b34e05-4a7d-4379-94ef-23649bf47c05"],
Cell[CellGroupData[{
Cell[374313, 8760, 158, 3, 67, "Subsection",ExpressionUUID->"be024ea0-c2bc-49fd-ab98-03f678d13d2e"],
Cell[374474, 8765, 899, 16, 131, "Text",ExpressionUUID->"c614f5b2-a839-4db4-946a-ee3448ee5318"],
Cell[375376, 8783, 1082, 18, 159, "Text",ExpressionUUID->"c5f9ac04-c6ce-4eda-8783-212e0e4ceff3"],
Cell[376461, 8803, 1354, 23, 188, "Text",ExpressionUUID->"e8f2528e-f00c-452d-811b-4aa415d8601d"],
Cell[377818, 8828, 887, 18, 102, "Text",ExpressionUUID->"65655ac2-a27c-4825-95dc-756acfa6cfea"],
Cell[378708, 8848, 1038, 20, 102, "Text",ExpressionUUID->"467ffc72-4bdc-461e-930d-9b554f572435"],
Cell[379749, 8870, 873, 20, 102, "Text",ExpressionUUID->"19cd687b-954f-4f22-9e62-82c7e387f277"],
Cell[380625, 8892, 647, 13, 102, "Text",ExpressionUUID->"9c308bf9-c14f-4c91-984a-be20032908fe"]
}, Closed]],
Cell[CellGroupData[{
Cell[381309, 8910, 258, 4, 46, "Subsection",ExpressionUUID->"4d599acc-12be-4528-9b6e-8f1d952b8f73"],
Cell[CellGroupData[{
Cell[381592, 8918, 290, 5, 56, "Subsubsection",ExpressionUUID->"471b4cda-dd77-413b-9af5-b07a51476308"],
Cell[381885, 8925, 787, 16, 131, "Text",ExpressionUUID->"ec1a188f-18d1-4ac7-83a2-3b961743ad91"],
Cell[382675, 8943, 807, 19, 84, "Input",ExpressionUUID->"6a54c53a-8e53-486f-9a9c-f90e3bd09226",
 InitializationCell->True],
Cell[383485, 8964, 435, 8, 73, "Text",ExpressionUUID->"b5159c8e-5183-4ab2-8dc6-df955629880e"],
Cell[383923, 8974, 709, 18, 105, "Input",ExpressionUUID->"8b8dcf26-f030-46ce-a96d-33cd1ed5b759",
 InitializationCell->True],
Cell[384635, 8994, 334, 7, 44, "Text",ExpressionUUID->"36b69730-bf7e-4e5d-88ef-64e9d85611fe"],
Cell[384972, 9003, 862, 17, 84, "Input",ExpressionUUID->"75b8a4e8-da11-471c-ab16-73cd06d37052",
 InitializationCell->True],
Cell[385837, 9022, 153, 3, 44, "Text",ExpressionUUID->"4d76cd81-4b79-45aa-815e-bb10b95b36c4"],
Cell[385993, 9027, 2923, 52, 344, "Input",ExpressionUUID->"f2352676-f90f-4feb-ba53-8f248eb2f396",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[388953, 9084, 338, 5, 45, "Subsubsection",ExpressionUUID->"89642f05-5c43-4454-a8f6-48eb417024d7"],
Cell[389294, 9091, 634, 20, 102, "Text",ExpressionUUID->"825948bc-f8ea-48e7-89e1-2cc64437cd5f"],
Cell[389931, 9113, 1862, 50, 214, "Input",ExpressionUUID->"43aaae6b-79e8-4adc-8599-2fc8c8034c3e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[391830, 9168, 162, 3, 45, "Subsubsection",ExpressionUUID->"f6f0e7fe-d33e-44d7-a724-c3a26f751579"],
Cell[391995, 9173, 1331, 20, 159, "Text",ExpressionUUID->"9a88b640-ddbf-4bac-acf0-1c6968f0e65f"],
Cell[393329, 9195, 3624, 74, 266, "Input",ExpressionUUID->"03e93f2d-3c4a-40ff-ab52-ccc138840d78",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[396978, 9273, 827, 16, 57, "Input",ExpressionUUID->"ea1b7dbf-94e1-492a-8d35-6a9c62fc9e39"],
Cell[397808, 9291, 978, 22, 69, "Output",ExpressionUUID->"0eef065a-199b-497e-85ce-7ddc8d3fcb0e"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[398835, 9319, 169, 3, 45, "Subsubsection",ExpressionUUID->"75962e48-0901-418b-b375-1f3951cd2992"],
Cell[399007, 9324, 431, 9, 44, "Text",ExpressionUUID->"4df3e3d7-b7a0-45c0-85aa-0973240541ae"],
Cell[399441, 9335, 1810, 38, 162, "Input",ExpressionUUID->"a3c381e3-9e0f-493e-a15b-d6cb9edac47c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[401288, 9378, 159, 3, 45, "Subsubsection",ExpressionUUID->"aba8174a-b8f7-4465-b8b2-2153b4f9e634"],
Cell[401450, 9383, 512, 11, 102, "Text",ExpressionUUID->"b64a53a4-eab3-4c16-9855-09adc1501cd6"],
Cell[401965, 9396, 2087, 49, 188, "Input",ExpressionUUID->"59fd9498-47ee-46b3-8f24-11bb04408983",
 InitializationCell->True],
Cell[404055, 9447, 260, 7, 44, "Text",ExpressionUUID->"eb7d0140-e933-4004-925f-1262ec150b00"],
Cell[404318, 9456, 445, 12, 57, "Input",ExpressionUUID->"5bb2f2e8-1651-47be-b96d-a2eee72963d0",
 InitializationCell->True],
Cell[404766, 9470, 481, 10, 84, "Input",ExpressionUUID->"3c89492e-dd73-4f17-842e-fe95edb9d195"]
}, Closed]],
Cell[CellGroupData[{
Cell[405284, 9485, 291, 5, 45, "Subsubsection",ExpressionUUID->"623a5ec0-1539-4d5c-8793-af552aa8e232"],
Cell[405578, 9492, 380, 9, 73, "Text",ExpressionUUID->"07613b52-96aa-48cf-9fcf-e7d906265653"],
Cell[405961, 9503, 535, 10, 57, "Input",ExpressionUUID->"b01086fc-2729-4a9d-bc79-cf372d74ac0b",
 InitializationCell->True],
Cell[406499, 9515, 370, 8, 73, "Text",ExpressionUUID->"4850f262-f4f3-410e-8ec0-706854fe7cc0"],
Cell[406872, 9525, 616, 13, 57, "Input",ExpressionUUID->"bf42e51e-b9e3-4198-a31e-7295d7f806eb",
 InitializationCell->True],
Cell[407491, 9540, 382, 8, 73, "Text",ExpressionUUID->"f10d4c58-4769-4e36-b4f3-9ada0afc75a3"],
Cell[407876, 9550, 931, 23, 188, "Input",ExpressionUUID->"426cfff8-9e9f-4779-8c44-58d6d0781f40",
 InitializationCell->True],
Cell[408810, 9575, 410, 8, 73, "Text",ExpressionUUID->"0608228a-b6c3-4cbd-8e5e-4d9dd7548d0e"],
Cell[409223, 9585, 987, 24, 162, "Input",ExpressionUUID->"4f0f0f75-3a94-4869-bf28-fd9ae860571b",
 InitializationCell->True],
Cell[410213, 9611, 483, 12, 84, "Input",ExpressionUUID->"c7cae5d5-1aab-4cb2-9253-7a1b3dceb90e"]
}, Closed]],
Cell[CellGroupData[{
Cell[410733, 9628, 394, 6, 45, "Subsubsection",ExpressionUUID->"25b9cc34-4ca9-45e3-8d3b-1dce392ad221"],
Cell[411130, 9636, 725, 14, 159, "Text",ExpressionUUID->"1f548dd5-8f81-47f4-a4c6-707b74ef4620"],
Cell[411858, 9652, 3561, 55, 110, "Input",ExpressionUUID->"97c7cc27-0992-473f-9aa3-64d4c00d8cd6",
 InitializationCell->True],
Cell[415422, 9709, 443, 10, 57, "Input",ExpressionUUID->"d74264dd-90a4-4a93-8010-dda3cbf477ae"],
Cell[CellGroupData[{
Cell[415890, 9723, 990, 17, 57, "Input",ExpressionUUID->"93883a28-a2c4-4131-8df6-0f88e1d70180"],
Cell[416883, 9742, 2222, 55, 173, "Output",ExpressionUUID->"6e85ac10-b3cc-45c3-ac0f-13e61fc46218"]
}, Open  ]],
Cell[CellGroupData[{
Cell[419142, 9802, 321, 8, 37, "Input",ExpressionUUID->"5b396cef-e724-464c-bdf7-bad3271e9e80"],
Cell[419466, 9812, 3749, 90, 82, "Output",ExpressionUUID->"cd2abecd-479c-4a6a-bc73-7afbb06da635"]
}, Open  ]],
Cell[CellGroupData[{
Cell[423252, 9907, 462, 11, 64, "Input",ExpressionUUID->"c7005e6a-d724-4a1b-8ae5-09244f330731"],
Cell[423717, 9920, 4937, 112, 204, "Output",ExpressionUUID->"e2122c9a-eee3-4668-a952-0d2250f241b5"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[428703, 10038, 444, 7, 45, "Subsubsection",ExpressionUUID->"1155692a-59b4-45e3-8f22-e256a7c65747"],
Cell[429150, 10047, 613, 12, 102, "Text",ExpressionUUID->"652cc703-18e5-490a-882a-9058dd87c040"],
Cell[429766, 10061, 3607, 55, 110, "Input",ExpressionUUID->"7499faef-fc55-4d23-8485-276700a2aeef",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[433410, 10121, 216, 4, 45, "Subsubsection",ExpressionUUID->"0cdfa22c-b9e7-48dd-9b64-d642096ec40b"],
Cell[433629, 10127, 225, 4, 44, "Text",ExpressionUUID->"b69752cc-3c9c-4ecd-b497-ec263278b244"],
Cell[433857, 10133, 1012, 19, 110, "Input",ExpressionUUID->"1632f534-ffeb-41fe-a93f-909dbd41ec89",
 InitializationCell->True],
Cell[434872, 10154, 410, 8, 57, "Input",ExpressionUUID->"b3159bf6-eeba-49aa-a16f-d5673fd5772c"],
Cell[435285, 10164, 339, 8, 57, "Input",ExpressionUUID->"a1346d9c-a5fb-4619-a2d6-eab09f07c5ed",
 InitializationCell->True],
Cell[435627, 10174, 219, 4, 44, "Text",ExpressionUUID->"8d774837-dc33-4fb2-9f05-826bef59ddce"],
Cell[435849, 10180, 483, 11, 57, "Input",ExpressionUUID->"345c0935-6362-4799-b43b-8eae18fb09be"],
Cell[436335, 10193, 475, 12, 57, "Input",ExpressionUUID->"75fa5566-430b-4cd1-a425-c388a477a961"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[436859, 10211, 157, 3, 46, "Subsection",ExpressionUUID->"4d41d13e-24ff-41e6-a12a-6f2b1e41d9e9"],
Cell[CellGroupData[{
Cell[437041, 10218, 162, 3, 56, "Subsubsection",ExpressionUUID->"c4e3a627-0db6-42f9-9b1a-c2d380ce6977"],
Cell[437206, 10223, 264, 7, 44, "Text",ExpressionUUID->"17ccfd99-d22f-487a-bd01-53f6e0d301ab"],
Cell[CellGroupData[{
Cell[437495, 10234, 501, 10, 57, "Input",ExpressionUUID->"ef4b114b-a0d7-4913-bf42-f5317521f641"],
Cell[437999, 10246, 44336, 899, 77, "Output",ExpressionUUID->"f2b6af18-18a0-4f8e-8cff-66ccaf228cfe"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[482384, 11151, 163, 3, 45, "Subsubsection",ExpressionUUID->"e1ae09a1-be02-457c-b44e-1cc01f366e51"],
Cell[482550, 11156, 649, 13, 73, "Text",ExpressionUUID->"00d2e047-7dbf-4f62-afaa-0e5018967849"],
Cell[483202, 11171, 639, 17, 57, "Input",ExpressionUUID->"d33f8577-1c42-4f45-be6a-3ae61edda93c",
 InitializationCell->True],
Cell[483844, 11190, 309, 7, 44, "Text",ExpressionUUID->"1124fdd8-4edc-43cb-a6c5-a9b265759bb5"],
Cell[484156, 11199, 822, 21, 57, "Input",ExpressionUUID->"5bb402b8-b46a-4d06-97ec-5587ec203387",
 InitializationCell->True],
Cell[484981, 11222, 656, 11, 73, "Text",ExpressionUUID->"0fa35c12-6a00-4184-b687-f744ddda7df0"],
Cell[485640, 11235, 1523, 34, 84, "Input",ExpressionUUID->"71ed09ab-0d8a-4da4-9700-6e6978cff92c",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[487212, 11275, 257, 4, 46, "Subsection",ExpressionUUID->"a6121053-dcf1-4e4a-872b-ab5f3ce72a31"],
Cell[CellGroupData[{
Cell[487494, 11283, 166, 3, 56, "Subsubsection",ExpressionUUID->"1d512065-66a2-4e9a-a810-0dd9dee0f5ff"],
Cell[487663, 11288, 575, 14, 102, "Text",ExpressionUUID->"4e97f219-90ff-4a5e-a49e-5dbfc525a4c9"],
Cell[488241, 11304, 2948, 64, 266, "Input",ExpressionUUID->"1fd6af80-3155-4fd5-89ca-50c82dd71c75"]
}, Closed]],
Cell[CellGroupData[{
Cell[491226, 11373, 189, 3, 45, "Subsubsection",ExpressionUUID->"d891cf13-b78d-421e-afb7-612da0332b22"],
Cell[491418, 11378, 393, 8, 73, "Text",ExpressionUUID->"73286031-2b67-42ef-ac12-abd5f8c898bf"],
Cell[491814, 11388, 10142, 242, 231, "Input",ExpressionUUID->"28ebbbcd-9642-4a69-bcce-4673b5e46714",
 InitializationCell->True],
Cell[501959, 11632, 925, 17, 84, "Input",ExpressionUUID->"f9a640a5-94bc-4dff-af4c-8f211f08daac"]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[502945, 11656, 155, 3, 65, "Section",ExpressionUUID->"3cf65aaf-64e8-4a93-b75e-1013cf8fb93a"],
Cell[CellGroupData[{
Cell[503125, 11663, 226, 4, 67, "Subsection",ExpressionUUID->"aa775d16-e53a-40a2-9907-bd326a5d37f0"],
Cell[CellGroupData[{
Cell[503376, 11671, 161, 3, 56, "Subsubsection",ExpressionUUID->"a0105012-d790-4998-9809-50751ce2fa29"],
Cell[503540, 11676, 1023, 19, 127, "Text",ExpressionUUID->"afd22ac9-c4fa-401d-85db-cd2f6d653917"]
}, Closed]],
Cell[CellGroupData[{
Cell[504600, 11700, 169, 3, 45, "Subsubsection",ExpressionUUID->"d1fc2745-f10d-4268-98a7-b0ad95909326"],
Cell[504772, 11705, 694, 14, 102, "Text",ExpressionUUID->"727b2616-b7a5-400d-ae81-2adc65b34ce1"],
Cell[505469, 11721, 373, 8, 57, "Input",ExpressionUUID->"79fffc9a-dda9-46fe-8d40-28aea1919b2e",
 InitializationCell->True],
Cell[505845, 11731, 184, 3, 44, "Text",ExpressionUUID->"65ddafd7-b025-4e48-9dbd-6256c191c259"],
Cell[506032, 11736, 1455, 35, 188, "Input",ExpressionUUID->"2ff5f6a4-d8d5-486c-9a78-1bc7885e8f59"],
Cell[CellGroupData[{
Cell[507512, 11775, 606, 16, 57, "Input",ExpressionUUID->"0bd133a3-3dda-401b-bc3b-265a53e47fc5"],
Cell[508121, 11793, 1649, 45, 127, "Output",ExpressionUUID->"88f6ad3d-0a52-4823-8ba2-f069b7eb8f47"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[509819, 11844, 168, 3, 45, "Subsubsection",ExpressionUUID->"ff982f35-8d53-43ae-804b-1f69512691a7"],
Cell[509990, 11849, 521, 10, 73, "Text",ExpressionUUID->"e68e9754-2563-4f63-9bae-0ad23ba0ecf5"],
Cell[510514, 11861, 712, 20, 84, "Input",ExpressionUUID->"617685f5-7605-46c0-81a0-efa22d5cf30e",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[511251, 11885, 477, 12, 57, "Input",ExpressionUUID->"e58cfe68-cee0-45b9-bb57-bd3f5cdf797d"],
Cell[511731, 11899, 791, 24, 105, "Output",ExpressionUUID->"d41bb5a4-0361-4087-a371-b6fd8b6788b8"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[512571, 11929, 164, 3, 45, "Subsubsection",ExpressionUUID->"384ecfbd-b5aa-4733-b041-423f59e2f903"],
Cell[512738, 11934, 446, 8, 73, "Text",ExpressionUUID->"35055ffb-d8d4-4a6a-9908-f51dc6b06d62"],
Cell[513187, 11944, 1005, 26, 84, "Input",ExpressionUUID->"96e92e9c-8d35-4599-bab7-1fbaba399d30",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[514217, 11974, 478, 12, 57, "Input",ExpressionUUID->"bfa2ca4b-2aae-4ee9-9894-bdb7c6aced6f"],
Cell[514698, 11988, 719, 21, 105, "Output",ExpressionUUID->"65e1638c-1e0f-4f35-8a60-7bc3322c24cc"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[515466, 12015, 172, 3, 45, "Subsubsection",ExpressionUUID->"7ab02aba-1472-4c7f-8c10-9d4fde782876"],
Cell[515641, 12020, 555, 10, 102, "Text",ExpressionUUID->"76135476-a6c8-4ffc-8002-9b726039fe7c"],
Cell[516199, 12032, 1655, 40, 136, "Input",ExpressionUUID->"69511289-74ef-4a4f-9090-3900555292d8",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[517879, 12076, 866, 25, 120, "Input",ExpressionUUID->"109a931f-2a95-4764-ab89-d4bd3c04b262"],
Cell[518748, 12103, 807, 25, 105, "Output",ExpressionUUID->"3e4740f3-04b0-4bed-8cd8-2fc82a65ef3a"]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[519628, 12136, 158, 3, 65, "Section",ExpressionUUID->"829e4991-385b-429e-b662-a7f0da1ad933"],
Cell[CellGroupData[{
Cell[519811, 12143, 367, 6, 67, "Subsection",ExpressionUUID->"7f2ae6de-2ee4-4d78-8d60-791c88b355b5"],
Cell[CellGroupData[{
Cell[520203, 12153, 219, 4, 56, "Subsubsection",ExpressionUUID->"1f9d3445-7e55-4cad-9096-1c35022ccd70"],
Cell[520425, 12159, 2350, 41, 361, "Text",ExpressionUUID->"f0037c55-934e-4672-b5cd-d9ed16098b49"],
Cell[522778, 12202, 754, 14, 57, "Input",ExpressionUUID->"08273472-420f-47a2-8c86-34b266f74104",
 InitializationCell->True],
Cell[523535, 12218, 14958, 311, 1150, "Input",ExpressionUUID->"51a2e6e0-74d7-4012-8502-008ec23de29b",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[538518, 12533, 4172, 86, 318, "Input",ExpressionUUID->"8bbdc926-e44f-458c-b864-f12d4b6ac5ce"],
Cell[542693, 12621, 51655, 1230, 112, "Output",ExpressionUUID->"232df647-b7eb-46cc-9d5a-253b435b5085"]
}, Open  ]],
Cell[594363, 13854, 576, 13, 73, "Text",ExpressionUUID->"78e729f4-14ab-4681-997b-98f6f49bd9a1"],
Cell[594942, 13869, 1030, 22, 84, "Input",ExpressionUUID->"f7554b2f-ea76-4a0e-a0cb-66e68b20977f",
 InitializationCell->True],
Cell[595975, 13893, 294, 4, 44, "Text",ExpressionUUID->"6d501bbf-982a-466a-9f6e-240bbd2e603d"],
Cell[596272, 13899, 3228, 64, 188, "Input",ExpressionUUID->"e0a4decf-238c-420b-9996-beb7cf9e1db1",
 InitializationCell->True],
Cell[599503, 13965, 342, 7, 44, "Text",ExpressionUUID->"2bddc41a-62bf-4c27-a8df-24ba63570251"],
Cell[599848, 13974, 1260, 30, 110, "Input",ExpressionUUID->"ad45c2dd-8226-4172-ac38-41c672da19ac",
 InitializationCell->True],
Cell[601111, 14006, 190, 3, 44, "Text",ExpressionUUID->"0f966cff-3409-4ea8-af3e-113904302d59"],
Cell[601304, 14011, 1257, 32, 110, "Input",ExpressionUUID->"4fb3890f-072e-4ff7-96aa-8a08d6e56e32",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[602586, 14047, 627, 14, 57, "Input",ExpressionUUID->"9b88bfb6-c6e6-4342-8dfa-b80ff2219133"],
Cell[603216, 14063, 3663, 86, 84, "Output",ExpressionUUID->"ebf7f486-2ba9-4e8d-8b33-959424ed0d9e"]
}, Open  ]],
Cell[606894, 14152, 190, 3, 44, "Text",ExpressionUUID->"8a0fca8e-27f9-42f2-a422-e41c125e8565"],
Cell[CellGroupData[{
Cell[607109, 14159, 3324, 82, 266, "Input",ExpressionUUID->"2d18a1b3-adaf-433a-b895-1622396c7aa5"],
Cell[610436, 14243, 6351, 170, 271, "Output",ExpressionUUID->"802d9096-37ff-4cb6-a8e1-15c5cf9aea71"]
}, Open  ]],
Cell[616802, 14416, 153, 3, 44, "Text",ExpressionUUID->"fabbcc12-af12-490c-b6e3-06b85aea0427"],
Cell[616958, 14421, 7482, 168, 988, "Input",ExpressionUUID->"4c379d5c-804c-41c8-88fa-2fee59e10c58",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[624477, 14594, 158, 3, 45, "Subsubsection",ExpressionUUID->"d60cca53-b090-46d9-b7a1-58015253484b"],
Cell[624638, 14599, 239, 7, 43, "Text",ExpressionUUID->"37d03a58-be64-4643-88ca-4027f9f1f6de"],
Cell[624880, 14608, 625, 14, 57, "Input",ExpressionUUID->"3ccffaad-fa8f-4843-9ed1-fbbf1595571a",
 InitializationCell->True],
Cell[625508, 14624, 171, 3, 43, "Text",ExpressionUUID->"be054b80-586f-47f8-90ac-dec24d866727"],
Cell[625682, 14629, 788, 20, 85, "Input",ExpressionUUID->"2adb373b-c672-4ba6-9cca-2baf14fb4a46",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[626507, 14654, 160, 3, 45, "Subsubsection",ExpressionUUID->"90bcb38f-70cf-4be8-8449-83acfeb82181"],
Cell[626670, 14659, 196, 3, 43, "Text",ExpressionUUID->"dd14fea3-10d2-4f88-8f22-63ecae2ad7e9"],
Cell[626869, 14664, 1033, 25, 85, "Input",ExpressionUUID->"38c42cc5-ebb6-4f45-81b1-ee54244f5309",
 InitializationCell->True],
Cell[627905, 14691, 173, 3, 43, "Text",ExpressionUUID->"fda0b89a-c41a-4f2b-8589-c01579ad2775"],
Cell[628081, 14696, 443, 11, 57, "Input",ExpressionUUID->"98af0ad6-1629-4ef6-b0dc-1c5f6f93cdd5",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[628561, 14712, 162, 3, 45, "Subsubsection",ExpressionUUID->"d9f91487-718a-40ef-8036-79d7911e4c94"],
Cell[628726, 14717, 185, 3, 43, "Text",ExpressionUUID->"20bf1fd8-5359-4564-8b6c-4d34171bc9fc"],
Cell[628914, 14722, 548, 13, 57, "Input",ExpressionUUID->"8ec8f4e2-cfa8-468d-a986-5742140e8b4d",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[629499, 14740, 212, 4, 45, "Subsubsection",ExpressionUUID->"40ffe6ae-a766-46ed-b5a1-e44b3f704714"],
Cell[629714, 14746, 264, 6, 43, "Text",ExpressionUUID->"e64ebea9-de97-4030-bc9b-963784dec83f"],
Cell[629981, 14754, 950, 23, 85, "Input",ExpressionUUID->"f44766c6-eb0f-433d-bf4b-ac5ddc0925a1",
 InitializationCell->True],
Cell[630934, 14779, 166, 3, 43, "Text",ExpressionUUID->"b5c6486a-4dd6-4d68-a572-17c548dbf766"],
Cell[631103, 14784, 1027, 25, 111, "Input",ExpressionUUID->"ccefcca1-53fe-4673-8408-f4c24956614e",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[632155, 14813, 865, 20, 85, "Input",ExpressionUUID->"e98f4ecb-aac0-4f7c-b2b8-c50c7177f865"],
Cell[633023, 14835, 6487, 143, 165, "Output",ExpressionUUID->"81503947-6aaa-4eda-b294-f27f73da222b"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[639559, 14984, 163, 3, 45, "Subsubsection",ExpressionUUID->"482366d9-1a7e-4159-8bcf-d37d4bf6b4a4"],
Cell[639725, 14989, 456, 9, 44, "Text",ExpressionUUID->"8227010e-03c5-4a9b-9d03-8e413cd42ba4"],
Cell[640184, 15000, 874, 15, 57, "Input",ExpressionUUID->"a0ed32e9-ea2d-4e18-8d00-64c52262ce7e",
 InitializationCell->True],
Cell[641061, 15017, 244, 7, 44, "Text",ExpressionUUID->"5458be1a-dd64-4d96-b7e3-185dab8143a5"],
Cell[641308, 15026, 926, 19, 84, "Input",ExpressionUUID->"6ad15519-e0f5-4f6b-b370-b42ad3add185",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[642283, 15051, 159, 3, 46, "Subsection",ExpressionUUID->"aee25611-6cbe-48af-af7b-f851340ae2fb"],
Cell[CellGroupData[{
Cell[642467, 15058, 224, 4, 56, "Subsubsection",ExpressionUUID->"dd219331-6e8b-4c28-bcaf-a49a52e4eb39"],
Cell[642694, 15064, 1583, 41, 214, "Input",ExpressionUUID->"84e7ab77-99a0-4351-af3a-7d982c46c1ea",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[644302, 15109, 2275, 38, 84, "Input",ExpressionUUID->"1e889093-0e8c-4001-a87f-4820b61f839f"],
Cell[646580, 15149, 26945, 622, 101, "Output",ExpressionUUID->"14827e6a-3a7a-41c2-9c84-66c652334ae6"]
}, Open  ]],
Cell[673540, 15774, 354, 7, 73, "Text",ExpressionUUID->"dee39586-a45e-426a-8749-c7e5c38519a3"],
Cell[673897, 15783, 1373, 36, 162, "Input",ExpressionUUID->"760cebe1-387b-4078-9f16-85c627dd40ac",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[675295, 15823, 288, 6, 57, "Input",ExpressionUUID->"ed97fcd7-39dd-4390-b315-a4a9cee1ee07"],
Cell[675586, 15831, 464, 13, 42, "Output",ExpressionUUID->"b98ba6bb-66ed-4189-8164-2c179098f94d"]
}, Open  ]],
Cell[676065, 15847, 938, 26, 102, "Text",ExpressionUUID->"c9b3b006-00ff-4cf3-813c-78c209b7f122"],
Cell[677006, 15875, 1209, 28, 136, "Input",ExpressionUUID->"8dde36bd-212c-4672-896c-88c0c460b437",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[678240, 15907, 1464, 39, 142, "Input",ExpressionUUID->"9eeab55d-eece-4f34-b132-45164e7fa457"],
Cell[679707, 15948, 369, 8, 42, "Output",ExpressionUUID->"4b43cf4f-47d3-43ff-8e06-e942aa2da9f1"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[680125, 15962, 174, 3, 45, "Subsubsection",ExpressionUUID->"6906ab29-820d-46a4-a18b-26b4153ccca7"],
Cell[680302, 15967, 331, 7, 73, "Text",ExpressionUUID->"a469ef54-f6dd-4bf5-9505-db6e60eeecb9"],
Cell[680636, 15976, 489, 11, 84, "Input",ExpressionUUID->"575f16d7-04d5-49cb-933d-b01dbe9289f9",
 InitializationCell->True]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[681186, 15994, 178, 3, 65, "Section",ExpressionUUID->"8cca388b-1f40-4feb-91df-338ab1a0b026"],
Cell[CellGroupData[{
Cell[681389, 16001, 153, 3, 67, "Subsection",ExpressionUUID->"dfec4cdc-5d38-4a82-92dc-c1f63ffd3e89"],
Cell[681545, 16006, 166, 3, 44, "Text",ExpressionUUID->"8dbab509-e7fb-4f42-820a-e8845826026e"],
Cell[CellGroupData[{
Cell[681736, 16013, 17843, 271, 1020, "Input",ExpressionUUID->"f1ba1d9f-146f-40fe-8388-43f402848018",
 InitializationCell->True],
Cell[699582, 16286, 60112, 1017, 70, "Output",ExpressionUUID->"785afb5a-5202-429c-9310-8b520fd470dc"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[759743, 17309, 262, 4, 67, "Subsection",ExpressionUUID->"9a7b165c-5042-4798-ba1d-1e95632c3a22"],
Cell[760008, 17315, 223, 4, 44, "Text",ExpressionUUID->"35c4cbd3-de33-4bc0-9cc0-64edf603a849"],
Cell[760234, 17321, 236, 6, 37, "Input",ExpressionUUID->"17a0326e-981e-4d1c-a23f-9a688bfaa7b8"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}
]
*)

